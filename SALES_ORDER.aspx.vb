Partial Class _SALES_ORDER
 Inherits System.Web.UI.Page 
Public d, d1 As Int32
Public ds1, ds2, ds3, ds4, ds5 As New Data.DataSet()
Public sxml, vn, vn1, vn2 As String
Public primary1, primary2, primary3, primary4,primary5,primary6 As String
Public dfetch As New Data.DataSet()
Public sc, scn, scn2 As String
Protected dbad As New OleDbDataAdapter
 Public dbadc As New OleDbCommand
Public newBox As New MessageBox
       public conn As New Dbconn
Public save_sucess_flag As String
public dbboundSALESREPBYSALESORDER as Integer
public dbboundORDERDETAIL as Integer
public dbboundBILLING_STAGE as Integer
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
Try
        dbad.SelectCommand = New OleDbCommand
        dbad.InsertCommand = New OleDbCommand
        dbad.UpdateCommand = New OleDbCommand
        dbad.DeleteCommand = New OleDbCommand
err_message.Text=""
exception_message.Text=""
mpanel.Visible = False
dbboundSALESREPBYSALESORDER=1
dbboundORDERDETAIL=1
dbboundBILLING_STAGE=1
If (Request.Browser.Browser = "IE") Then
    related_links123.ImageAlign = ImageAlign.Middle
    TextLabel.ImageAlign = ImageAlign.Middle
    Add_favorates.ImageAlign = ImageAlign.Middle
    img_notes.ImageAlign = ImageAlign.Middle
End If
 If Not IsPostBack Then
Save.Attributes.Add("onclick", "isDirty = 0;")
Delete.Attributes.Add("onclick", "isDirty = 0;")
Retrive.Attributes.Add("onclick", "isDirty = 0;")
Copy1.Attributes.Add("onclick", "isDirty = 0;")
help_links.Attributes.Add("onclick", "isDirty = 0;")
 Session("SALES_ORDER_move_record") = -1
 Session("SD_ORDERS_SEARCH") = ""
SD_ORDER_HEADER_ORDER_NO.Attributes.Add("onblur", "this.value = this.value.toUpperCase()")
SD_ORDER_HEADER_ITEM_NO.Attributes.Add("onblur", "this.value = this.value.toUpperCase()")
SD_ORDER_HEADER_ORDERING_UOM.Attributes.Add("onblur", "this.value = this.value.toUpperCase()")
SD_ORDER_HEADER_PRICING_UOM.Attributes.Add("onblur", "this.value = this.value.toUpperCase()")
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_CUSTOMER_NO.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_NAME.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_CONTACT_NAME.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_INVOICE_BY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_CUSTOMER_PO_NO.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BLANKET_ORDER.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_SHIPTO_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_CONTACT_EMAIL.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_CONTACT_PHONE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_ADVANCE_AMOUNT.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SE1.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SE_PCT1.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SE4.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SE3.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SE2.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SE_PCT2.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SE_PCT3.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SE_PCT4.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FLS_ORDER_NO.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_HOLD.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_EXPORT_HOLD.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_SHIP_COMPLETE.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_AFFINITY_NO.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_ATEX_HOLD.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_LICENSE_APPLICATION_REF.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_PULL_INVENTORY_FROM_QRC.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_DO_NOT_SERVICE.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_QUICK_SHIP.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_AES_HOLD.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_NONAG.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_INPROCESS.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_QRC_LOCATION.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_INTERNAL_NOTES.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_ORDER_NOTES.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_STREET.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_CITY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_STATE_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_POSTAL_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_COUNTRY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_PHONE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FAX.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_EMAIL.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_CUSTOMER_MESSAGE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILLING_NAME.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILLING_STREET.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILLING_CITY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILLING_POSTAL_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILLING_PHONE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILLING_FAX.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILLING_EMAIL.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILLING_CONTACT_NAME.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_NAME.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_STREET.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_CITY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_STATE_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_COUNTRY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_PHONE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_FAX.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_EMAIL.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIPPING_CONTACT_NAME.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BILLING_NAME.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BILLING_STREET.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BILLING_STATE_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BILLING_COUNTRY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BILLING_PHONE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BILLING_FAX.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BILLING_EMAIL.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BILLING_CONTACT_NAME.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BILLING_CITY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BALANCE_QTY_LINE.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_ITEM_NO.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BLANKET_QTY.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_ORDERING_UOM.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SALES_PRICE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_PRICING_UOM.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_BLANKET_RELEASE_NO.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO.Attributes.Add("OnCheckedChanged", "setDirty();")
SD_ORDER_HEADER_SHIP_VIA.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FOB.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_PAYMENT_METHOD.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_TERMS_CODE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Attributes.Add("onchange", "setDirty();")
SD_ORDER_HEADER_INCOTERMS_LOCATION.Attributes.Add("onchange", "setDirty();")
ok_mline_1.Attributes.Add("onclick", "setTextValue('" + mline_label1.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "');")
cancel_mline_1.Attributes.Add("onclick", "cancelTextValue('" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "');")
session("show_hide_links")="N"
session("open_window_no")="100"
session("SALES_ORDER_page_name_doc")=""
session("SALES_ORDER_primay_field_value1")=""
session("SALES_ORDER_primay_field_list1")=""
session("SALES_ORDER_primay_field_value")=""
session("SALES_ORDER_primay_field_list")=""
session("SALES_ORDER_tag_field_list")=""
session("SALES_ORDER_tag_field_value")=""
session("SALES_ORDER_tag_field_list1")=""
session("SALES_ORDER_tag_field_value1")=""
session("SALES_ORDER_new_record")="Y"
If (Session("dd_click") = "") Then
Session("dd_click") = "0"
Copy1.visible=True
 If (Equals(Session("db_connection"), System.DBNull.Value)) Then
 		Session("db_connection") = conn.getconnection()
End If
End If
help_links.Attributes.Add("OnClick", "open_window_doc('Display_page_help.aspx?PAGE_ID=SALES_ORDER')")
            Dim sec_id As Label
            Dim pageid As Label
            sec_id = Master.FindControl("search_id")
            pageid = Master.FindControl("Page_name1")
            pageid.Text = "SALES_ORDER.aspx"
            sec_id.Text = "SD_ORDERS_SEARCH"
            Dim retrive_id As Label
            retrive_id = Master.FindControl("retrive_id")
            retrive_id.Text = Retrive.ClientID
            Dim pk1 As Label
            pk1 = Master.FindControl("primarykey1")
            pk1.Text = SD_ORDER_HEADER_ORDER_NO.ClientID
 		dbad.SelectCommand.Connection = Session("db_connection")
Try
Dim s_m_level as integer
s_m_level=3
s_m_level=2
If (cint(Session("MAINTENANCE_LEVEL"))=3 and s_m_level>=2) then
                pagepre_panel.Visible = True
Else
                pagepre_panel.Visible = False
End If
If (cint(Session("MAINTENANCE_LEVEL"))<=s_m_level) then
                pageedit_panel.Visible = True
                pagepre_panel.Visible = True
Else
                pageedit_panel.Visible = False
End If
Catch ex As Exception
call insert_sys_log("Preferences",ex.Message)
End Try
            Dim dbpage_acess As New Data.DataSet
            Dim aclevel As Integer
            aclevel = 2
If (session("aclevel")<>"") then
            aclevel = cint(session("aclevel"))
End If
call conn.call_onpage_Load("SALES_ORDER", session("user_id"),Request.QueryString.Get("mid"),Request.QueryString.Get("sssid"), Session.SessionID,"SD_ORDERS_SEARCH")
Try
            dbad.SelectCommand.CommandText = "select ACCESS_LEVEL from VS_USER_ACCESS_LEVEL where USER_ID='" & UCase(Session("User_id")) & "' and  upper(MENU_FILE_NAME)='SALES_ORDER.ASPX' and ACCESS_LEVEL is not null"
            dbpage_acess.Clear()
            dbad.Fill(dbpage_acess)
            If (dbpage_acess.Tables(0).Rows.Count > 0) Then
                aclevel = dbpage_acess.Tables(0).Rows(0)("ACCESS_LEVEL")
Else
          Response.redirect("notauthorized.aspx")
            End If
Catch ex As Exception
End Try
session("aclevel")=cstr(aclevel)
            If (aclevel = 1) Then
                Save.Visible = True
                delete.Visible = True
                Clear.Visible = True
                Copy1.Visible = True
            End If
            If (aclevel = 2) Then
                Save.Visible = True
                delete.Visible = True
                Clear.Visible = True
                Copy1.Visible = True
            End If
            If (aclevel = 3) Then
                Save.Visible = True
                delete.Visible = False
                Clear.Visible = True
                Copy1.Visible = True
            End If
            If (aclevel = 4) Then
                Save.Visible = True
                delete.Visible = False
                Clear.Visible = True
                Copy1.Visible = True
            End If
            If (aclevel = 5) Then
                Save.Visible = False
                delete.Visible = False
                Clear.Visible = False
                Copy1.Visible = False
            End If
            dbad.SelectCommand.Connection.Close()
Session("SD_ORDER_DETAIL_DUE_DATE_sort") = "0"
SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Style("text-align") = "right"
SD_ORDER_HEADER_ADVANCE_AMOUNT.Style("text-align") = "right"
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Style("text-align") = "right"
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Style("text-align") = "right"
SD_ORDER_HEADER_BLANKET_QTY.Style("text-align") = "right"
SD_ORDER_HEADER_BLANKET_QTY_BUOM.Style("text-align") = "right"
SD_ORDER_HEADER_SALES_PRICE.Style("text-align") = "right"
BL_BAL_QTY.Style("text-align") = "right"
SD_ORDER_HEADER_SE_PCT2.Style("text-align") = "right"
SD_ORDER_HEADER_SE_PCT1.Style("text-align") = "right"
SD_ORDER_HEADER_SE_PCT3.Style("text-align") = "right"
SD_ORDER_HEADER_SE_PCT4.Style("text-align") = "right"
SD_ORDER_HEADER_TERMS_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_TERMS_CODE.ClientID & "',29);")
SD_ORDER_HEADER_AFFINITY_NO.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_AFFINITY_NO.ClientID & "',149);")
SD_ORDER_HEADER_SHIP_VIA.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIP_VIA.ClientID & "',29);")
SD_ORDER_HEADER_ITEM_NO.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "',59);")
SD_ORDER_HEADER_INCOTERMS_LOCATION.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_INCOTERMS_LOCATION.ClientID & "',59);")
SD_ORDER_HEADER_ORDERING_UOM.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "',9);")
SD_ORDER_HEADER_PRICING_UOM.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_PRICING_UOM.ClientID & "',9);")
SD_ORDER_HEADER_ORDER_NO.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_ORDER_NO.ClientID & "',29);")
SD_ORDER_HEADER_FLS_ORDER_NO.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_FLS_ORDER_NO.ClientID & "',29);")
SD_ORDER_HEADER_STATE_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_STATE_CODE.ClientID & "',59);")
SD_ORDER_HEADER_BILLING_STATE_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_BILLING_STATE_CODE.ClientID & "',59);")
SD_ORDER_HEADER_SHIPPING_STATE_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIPPING_STATE_CODE.ClientID & "',59);")
SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.ClientID & "',59);")
SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.ClientID & "',59);")
SD_ORDER_HEADER_NAME.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_NAME.ClientID & "',59);")
SD_ORDER_HEADER_CONTACT_NAME.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_CONTACT_NAME.ClientID & "',59);")
SD_ORDER_HEADER_BILLING_NAME.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_BILLING_NAME.ClientID & "',59);")
SD_ORDER_HEADER_BILLING_CONTACT_NAME.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_BILLING_CONTACT_NAME.ClientID & "',59);")
SD_ORDER_HEADER_SHIPPING_NAME.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIPPING_NAME.ClientID & "',59);")
SD_ORDER_HEADER_SHIPPING_CONTACT_NAME.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIPPING_CONTACT_NAME.ClientID & "',59);")
SD_ORDER_HEADER_FREIGHT_BILLING_NAME.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_FREIGHT_BILLING_NAME.ClientID & "',59);")
SD_ORDER_HEADER_FREIGHT_BILLING_CONTACT_NAME.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_FREIGHT_BILLING_CONTACT_NAME.ClientID & "',59);")
SD_ORDER_HEADER_STREET.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_STREET.ClientID & "',999);")
SD_ORDER_HEADER_BILLING_STREET.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_BILLING_STREET.ClientID & "',999);")
SD_ORDER_HEADER_SHIPPING_STREET.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIPPING_STREET.ClientID & "',999);")
SD_ORDER_HEADER_FREIGHT_BILLING_STREET.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_FREIGHT_BILLING_STREET.ClientID & "',999);")
SD_ORDER_HEADER_CITY.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_CITY.ClientID & "',59);")
SD_ORDER_HEADER_BILLING_CITY.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_BILLING_CITY.ClientID & "',59);")
SD_ORDER_HEADER_SHIPPING_CITY.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIPPING_CITY.ClientID & "',59);")
SD_ORDER_HEADER_FREIGHT_BILLING_CITY.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_FREIGHT_BILLING_CITY.ClientID & "',59);")
SD_ORDER_HEADER_POSTAL_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_POSTAL_CODE.ClientID & "',19);")
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_BILLING_POSTAL_CODE.ClientID & "',19);")
SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.ClientID & "',19);")
SD_ORDER_HEADER_FREIGHT_BILLING_POSTAL_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_FREIGHT_BILLING_POSTAL_CODE.ClientID & "',19);")
SD_ORDER_HEADER_CUSTOMER_PO_NO.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_CUSTOMER_PO_NO.ClientID & "',59);")
SD_ORDER_HEADER_BLANKET_RELEASE_NO.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_BLANKET_RELEASE_NO.ClientID & "',29);")
SD_ORDER_HEADER_COUNTRY.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_COUNTRY.ClientID & "',59);")
SD_ORDER_HEADER_BILLING_COUNTRY.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "',59);")
SD_ORDER_HEADER_SHIPPING_COUNTRY.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "',59);")
SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "',59);")
SD_ORDER_HEADER_PHONE.Attributes.Add("onkeyup", "return DisplayEvent1('" & SD_ORDER_HEADER_PHONE.ClientID & "',49);")
SD_ORDER_HEADER_BILLING_PHONE.Attributes.Add("onkeyup", "return DisplayEvent1('" & SD_ORDER_HEADER_BILLING_PHONE.ClientID & "',49);")
SD_ORDER_HEADER_SHIPPING_PHONE.Attributes.Add("onkeyup", "return DisplayEvent1('" & SD_ORDER_HEADER_SHIPPING_PHONE.ClientID & "',49);")
SD_ORDER_HEADER_FREIGHT_BILLING_PHONE.Attributes.Add("onkeyup", "return DisplayEvent1('" & SD_ORDER_HEADER_FREIGHT_BILLING_PHONE.ClientID & "',49);")
SD_ORDER_HEADER_CONTACT_PHONE.Attributes.Add("onkeyup", "return DisplayEvent1('" & SD_ORDER_HEADER_CONTACT_PHONE.ClientID & "',49);")
SD_ORDER_HEADER_FAX.Attributes.Add("onkeyup", "return DisplayEvent1('" & SD_ORDER_HEADER_FAX.ClientID & "',49);")
SD_ORDER_HEADER_BILLING_FAX.Attributes.Add("onkeyup", "return DisplayEvent1('" & SD_ORDER_HEADER_BILLING_FAX.ClientID & "',49);")
SD_ORDER_HEADER_SHIPPING_FAX.Attributes.Add("onkeyup", "return DisplayEvent1('" & SD_ORDER_HEADER_SHIPPING_FAX.ClientID & "',49);")
SD_ORDER_HEADER_FREIGHT_BILLING_FAX.Attributes.Add("onkeyup", "return DisplayEvent1('" & SD_ORDER_HEADER_FREIGHT_BILLING_FAX.ClientID & "',49);")
SD_ORDER_HEADER_EMAIL.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_EMAIL.ClientID & "',199);")
SD_ORDER_HEADER_BILLING_EMAIL.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_BILLING_EMAIL.ClientID & "',199);")
SD_ORDER_HEADER_SHIPPING_EMAIL.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIPPING_EMAIL.ClientID & "',199);")
SD_ORDER_HEADER_FREIGHT_BILLING_EMAIL.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_FREIGHT_BILLING_EMAIL.ClientID & "',199);")
SD_ORDER_HEADER_CONTACT_EMAIL.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_CONTACT_EMAIL.ClientID & "',199);")
SD_ORDER_HEADER_CUSTOMER_NO.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "',29);")
SD_ORDER_HEADER_SHIPTO_CODE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIPTO_CODE.ClientID & "',29);")
SD_ORDER_HEADER_INTERNAL_NOTES.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_INTERNAL_NOTES.ClientID & "',3999);")
SD_ORDER_HEADER_ORDER_NOTES.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_ORDER_NOTES.ClientID & "',3999);")
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.ClientID & "',3999);")
SD_ORDER_HEADER_CUSTOMER_MESSAGE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_CUSTOMER_MESSAGE.ClientID & "',3999);")
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.ClientID & "',3999);")
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.ClientID & "',59);")
SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "',99);")
SD_ORDER_HEADER_SE1.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SE1.ClientID & "',29);")
SD_ORDER_HEADER_SE4.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SE4.ClientID & "',29);")
SD_ORDER_HEADER_SE3.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SE3.ClientID & "',29);")
SD_ORDER_HEADER_SE2.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_SE2.ClientID & "',29);")
SD_ORDER_HEADER_LICENSE_APPLICATION_REF.Attributes.Add("onkeyup", "return DisplayEvent('" & SD_ORDER_HEADER_LICENSE_APPLICATION_REF.ClientID & "',9);")
if (Session("HIDE_MENU_OPTIONS") = "Y") Then
SD_ORDER_HEADER_SHIPTO_CODE.Attributes.Add("ontouchmove", "open_window_drdlbd('SD_SHIPTOS.aspx?PARENT_ACCOUNT_NO='+ document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.CLIENTID & "').value+'&SHIPTO_CODE=','" & SD_ORDER_HEADER_SHIPTO_CODE.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_HEADER_SHIPTO_CODE.Attributes.Add("ondblclick", "open_window_drdlbd('SD_SHIPTOS.aspx?PARENT_ACCOUNT_NO='+ document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.CLIENTID & "').value+'&SHIPTO_CODE=','" & SD_ORDER_HEADER_SHIPTO_CODE.ClientID & "');")
Else
SD_ORDER_HEADER_SHIPTO_CODE.Attributes.Add("ondblclick", "open_window_drdl('SD_SHIPTOS.aspx?PARENT_ACCOUNT_NO='+ document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.CLIENTID & "').value+'&SHIPTO_CODE=','" & SD_ORDER_HEADER_SHIPTO_CODE.ClientID & "');")
End If
End If
if (Session("HIDE_MENU_OPTIONS") = "Y") Then
SD_ORDER_HEADER_CUSTOMER_NO.Attributes.Add("ontouchmove", "open_window_drdlbd('CUSTOMERS.aspx?account_no=','" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_HEADER_CUSTOMER_NO.Attributes.Add("ondblclick", "open_window_drdlbd('CUSTOMERS.aspx?account_no=','" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "');")
Else
SD_ORDER_HEADER_CUSTOMER_NO.Attributes.Add("ondblclick", "open_window_drdl('CUSTOMERS.aspx?account_no=','" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "');")
End If
End If
if (Session("HIDE_MENU_OPTIONS") = "Y") Then
SD_ORDER_HEADER_FLS_ORDER_NO.Attributes.Add("ontouchmove", "open_window_drdlbd('SALES_ORDER.aspx?order_no=','" & SD_ORDER_HEADER_FLS_ORDER_NO.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_HEADER_FLS_ORDER_NO.Attributes.Add("ondblclick", "open_window_drdlbd('SALES_ORDER.aspx?order_no=','" & SD_ORDER_HEADER_FLS_ORDER_NO.ClientID & "');")
Else
SD_ORDER_HEADER_FLS_ORDER_NO.Attributes.Add("ondblclick", "open_window_drdl('SALES_ORDER.aspx?order_no=','" & SD_ORDER_HEADER_FLS_ORDER_NO.ClientID & "');")
End If
End If
if (Session("HIDE_MENU_OPTIONS") = "Y") Then
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Attributes.Add("ontouchmove", "open_window_drdlbd('BUSINESS_UNIT.aspx?BUSINESS_UNIT_CODE=','" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Attributes.Add("ondblclick", "open_window_drdlbd('BUSINESS_UNIT.aspx?BUSINESS_UNIT_CODE=','" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.ClientID & "');")
Else
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Attributes.Add("ondblclick", "open_window_drdl('BUSINESS_UNIT.aspx?BUSINESS_UNIT_CODE=','" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.ClientID & "');")
End If
End If
if (Session("HIDE_MENU_OPTIONS") = "Y") Then
SD_ORDER_HEADER_INCOTERMS_LOCATION.Attributes.Add("ontouchmove", "open_window_drdlbd('ITEMS.aspx?ITEM_NO=','" & SD_ORDER_HEADER_INCOTERMS_LOCATION.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_HEADER_INCOTERMS_LOCATION.Attributes.Add("ondblclick", "open_window_drdlbd('ITEMS.aspx?ITEM_NO=','" & SD_ORDER_HEADER_INCOTERMS_LOCATION.ClientID & "');")
Else
SD_ORDER_HEADER_INCOTERMS_LOCATION.Attributes.Add("ondblclick", "open_window_drdl('ITEMS.aspx?ITEM_NO=','" & SD_ORDER_HEADER_INCOTERMS_LOCATION.ClientID & "');")
End If
End If
if (Session("HIDE_MENU_OPTIONS") = "Y") Then
SD_ORDER_HEADER_ITEM_NO.Attributes.Add("ontouchmove", "open_window_drdlbd('ITEMS.aspx?ITEM_NO=','" & SD_ORDER_HEADER_ITEM_NO.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_HEADER_ITEM_NO.Attributes.Add("ondblclick", "open_window_drdlbd('ITEMS.aspx?ITEM_NO=','" & SD_ORDER_HEADER_ITEM_NO.ClientID & "');")
Else
SD_ORDER_HEADER_ITEM_NO.Attributes.Add("ondblclick", "open_window_drdl('ITEMS.aspx?ITEM_NO=','" & SD_ORDER_HEADER_ITEM_NO.ClientID & "');")
End If
End If
if (Session("HIDE_MENU_OPTIONS") = "Y") Then
SD_ORDER_HEADER_QRC_LOCATION.Attributes.Add("ontouchmove", "open_window_drdlbd('LOCATION_MASTER.ASPX?LOCATION_CODE=','" & SD_ORDER_HEADER_QRC_LOCATION.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_HEADER_QRC_LOCATION.Attributes.Add("ondblclick", "open_window_drdlbd('LOCATION_MASTER.ASPX?LOCATION_CODE=','" & SD_ORDER_HEADER_QRC_LOCATION.ClientID & "');")
Else
SD_ORDER_HEADER_QRC_LOCATION.Attributes.Add("ondblclick", "open_window_drdl('LOCATION_MASTER.ASPX?LOCATION_CODE=','" & SD_ORDER_HEADER_QRC_LOCATION.ClientID & "');")
End If
End If
SD_ORDER_HEADER_INTERNAL_NOTES.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDER_HEADER_INTERNAL_NOTES.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
SD_ORDER_HEADER_ORDER_NOTES.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDER_HEADER_ORDER_NOTES.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
SD_ORDER_HEADER_CUSTOMER_MESSAGE.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDER_HEADER_CUSTOMER_MESSAGE.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
SD_ORDER_HEADER_STREET.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDER_HEADER_STREET.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
SD_ORDER_HEADER_FREIGHT_BILLING_STREET.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDER_HEADER_FREIGHT_BILLING_STREET.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
SD_ORDER_HEADER_SHIPPING_STREET.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDER_HEADER_SHIPPING_STREET.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
SD_ORDER_HEADER_BILLING_STREET.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDER_HEADER_BILLING_STREET.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
        dbad.SelectCommand.Connection = Session("db_connection")
Dim dsp43 as new Data.Dataset()
Dim sdrpi13 as Integer
Dim sdrp13 as string
Dim jjpp3 as Integer
jjpp3 =0
sdrp13="Select BUSINESS_UNIT_CODE,BUSINESS_UNIT_CODE From GL_BUSINESS_UNITS Where BUSINESS_UNIT_TYPE='CO' Order By 1"
dbad.SelectCommand.CommandText = sdrp13
dsp43.Clear()
dbad.Fill(dsp43)
If (dsp43.Tables(0).Rows.Count > 0) Then
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Items.Clear()
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Items.Add("")
    For sdrpi13 = 0 To dsp43.Tables(0).Rows.Count - 1
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Items.Add("")
If Not (Equals(dsp43.Tables(0).Rows(sdrpi13)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Items( sdrpi13 + 1 ).Text= dsp43.Tables(0).Rows(sdrpi13)(0) 
Else
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Items( sdrpi13 + 1 ).Text= ""
End IF
If Not (Equals(dsp43.Tables(0).Rows(sdrpi13)(1), System.DBNull.Value)) Then
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Items( sdrpi13 + 1 ).Value= dsp43.Tables(0).Rows(sdrpi13)(1) 
Else
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.Items( sdrpi13 + 1 ).Value= ""
End If
    Next
End If
dbad.SelectCommand.Connection.Close()
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVSALES_ENTRY_CODE_LOV2028968.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.ClientID & "').value; else sval=''; window.open('SALES_ENTRY_CODE_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.ClientID & "&sval='+encodeURIComponent(sval),'WIN700','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVSALES_ENTRY_CODE_LOV2028968.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('SALES_ENTRY_CODE_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:700px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCUSTOMER_LOV1088.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else sval=''; window.open('CUSTOMER_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "&sval='+encodeURIComponent(sval),'WIN700','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCUSTOMER_LOV1088.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('CUSTOMER_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:700px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVORDERS_CONTACTS_LOV1098.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_CONTACT_NAME.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_CONTACT_NAME.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1=''; window.open('ORDERS_CONTACTS_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_CONTACT_NAME.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN500','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVORDERS_CONTACTS_LOV1098.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_CONTACT_NAME.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_CONTACT_NAME.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('ORDERS_CONTACTS_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_CONTACT_NAME.ClientID & "').value=strReturn;isDirty = 1;}")
End If
SD_ORDER_HEADER_INVOICE_BY.Items.Clear()
SD_ORDER_HEADER_INVOICE_BY.Items.Add("")
SD_ORDER_HEADER_INVOICE_BY.Items.Add("")
SD_ORDER_HEADER_INVOICE_BY.Items(1).Text="Packing Slip"
SD_ORDER_HEADER_INVOICE_BY.Items(1).Value="PACKINGSLIP"
SD_ORDER_HEADER_INVOICE_BY.SelectedIndex=1
SD_ORDER_HEADER_INVOICE_BY.Items.Add("")
SD_ORDER_HEADER_INVOICE_BY.Items(2).Text="Multiple Packing Slip"
SD_ORDER_HEADER_INVOICE_BY.Items(2).Value="MUL_PACKINGSLIP"
SD_ORDER_HEADER_INVOICE_BY.Items.Add("")
SD_ORDER_HEADER_INVOICE_BY.Items(3).Text="Order/Progress Billing"
SD_ORDER_HEADER_INVOICE_BY.Items(3).Value="ORDER"
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVSHIPTO_LOV1152.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SHIPTO_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SHIPTO_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1=''; window.open('SHIPTO_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_SHIPTO_CODE.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN500','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVSHIPTO_LOV1152.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SHIPTO_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SHIPTO_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('SHIPTO_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_SHIPTO_CODE.ClientID & "').value=strReturn;isDirty = 1;}")
End If
        dbad.SelectCommand.Connection = Session("db_connection")
Dim dsp425 as new Data.Dataset()
Dim sdrpi125 as Integer
Dim sdrp125 as string
Dim jjpp25 as Integer
jjpp25 =0
sdrp125="select  OPTION_TEXT,OPTION_VALUE from SYS_DATAELEMENT_ALLOWED_VALUES WHERE ACTIVE_FLAG='Y' and  DATAELEMENT_ID='ORDER_ACKNOWLEDGEMENT_PREFERENCE' order by line_no"
dbad.SelectCommand.CommandText = sdrp125
dsp425.Clear()
dbad.Fill(dsp425)
If (dsp425.Tables(0).Rows.Count > 0) Then
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.Items.Clear()
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.Items.Add("")
    For sdrpi125 = 0 To dsp425.Tables(0).Rows.Count - 1
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.Items.Add("")
If Not (Equals(dsp425.Tables(0).Rows(sdrpi125)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.Items( sdrpi125 + 1 ).Text= dsp425.Tables(0).Rows(sdrpi125)(0) 
Else
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.Items( sdrpi125 + 1 ).Text= ""
End IF
If Not (Equals(dsp425.Tables(0).Rows(sdrpi125)(1), System.DBNull.Value)) Then
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.Items( sdrpi125 + 1 ).Value= dsp425.Tables(0).Rows(sdrpi125)(1) 
If (UCase("N") = UCase(dsp425.Tables(0).Rows(sdrpi125)(1))) Then
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.SelectedIndex=sdrpi125 + 1
jjpp25 =1
End If
Else
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.Items( sdrpi125 + 1 ).Value= ""
End If
    Next
If jjpp25=0 then
err_message.Text=err_message.Text & "<br> Default value for ORDER_ACK_PREFERENCE does not match. "
err_message.Visible=True
mpanel.Visible = True
exception_message.visible=false
End If
End If
dbad.SelectCommand.Connection.Close()
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVORDER_ULTIMATE_CONSIGNMENT_LOV18547.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1=''; window.open('ORDER_ULTIMATE_CONSIGNMENT_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN500','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVORDER_ULTIMATE_CONSIGNMENT_LOV18547.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('ORDER_ULTIMATE_CONSIGNMENT_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCUSTOMERS_MESSAGE_DOC_TYPE_LOV1151.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_MESSAGE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_MESSAGE.ClientID & "').value; else sval=''; window.open('CUSTOMERS_MESSAGE_DOC_TYPE_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_CUSTOMER_MESSAGE.ClientID & "&sval='+encodeURIComponent(sval),'WIN500','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCUSTOMERS_MESSAGE_DOC_TYPE_LOV1151.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_MESSAGE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_MESSAGE.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('CUSTOMERS_MESSAGE_DOC_TYPE_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_MESSAGE.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVTERMS_CODE_LOV1131.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_TERMS_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_TERMS_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_TERMS_CODE.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_TERMS_CODE.ClientID & "').value; else x1=''; window.open('TERMS_CODE_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_TERMS_CODE.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN500','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVTERMS_CODE_LOV1131.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_TERMS_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_TERMS_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_TERMS_CODE.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_TERMS_CODE.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('TERMS_CODE_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_TERMS_CODE.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCUST_SHIP_VIA_LOV1132.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SHIP_VIA.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SHIP_VIA.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1=''; window.open('CUST_SHIP_VIA_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_SHIP_VIA.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN500','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCUST_SHIP_VIA_LOV1132.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SHIP_VIA.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SHIP_VIA.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('CUST_SHIP_VIA_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_SHIP_VIA.ClientID & "').value=strReturn;isDirty = 1;}")
End If
        dbad.SelectCommand.Connection = Session("db_connection")
Dim dsp439 as new Data.Dataset()
Dim sdrpi139 as Integer
Dim sdrp139 as string
Dim jjpp39 as Integer
jjpp39 =0
sdrp139="Select DESCRIPTION,FOB From V_INCOTERMS Order By 1"
dbad.SelectCommand.CommandText = sdrp139
dsp439.Clear()
dbad.Fill(dsp439)
If (dsp439.Tables(0).Rows.Count > 0) Then
SD_ORDER_HEADER_FOB.Items.Clear()
SD_ORDER_HEADER_FOB.Items.Add("")
    For sdrpi139 = 0 To dsp439.Tables(0).Rows.Count - 1
SD_ORDER_HEADER_FOB.Items.Add("")
If Not (Equals(dsp439.Tables(0).Rows(sdrpi139)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_FOB.Items( sdrpi139 + 1 ).Text= dsp439.Tables(0).Rows(sdrpi139)(0) 
Else
SD_ORDER_HEADER_FOB.Items( sdrpi139 + 1 ).Text= ""
End IF
If Not (Equals(dsp439.Tables(0).Rows(sdrpi139)(1), System.DBNull.Value)) Then
SD_ORDER_HEADER_FOB.Items( sdrpi139 + 1 ).Value= dsp439.Tables(0).Rows(sdrpi139)(1) 
Else
SD_ORDER_HEADER_FOB.Items( sdrpi139 + 1 ).Value= ""
End If
    Next
End If
dbad.SelectCommand.Connection.Close()
        dbad.SelectCommand.Connection = Session("db_connection")
Dim dsp440 as new Data.Dataset()
Dim sdrpi140 as Integer
Dim sdrp140 as string
Dim jjpp40 as Integer
jjpp40 =0
sdrp140="Select PAYMENT_METHOD,PAYMENT_METHOD From GE_PAYMENT_METHOD Where NVL(INACTIVE,'N')='N' Order By 1"
dbad.SelectCommand.CommandText = sdrp140
dsp440.Clear()
dbad.Fill(dsp440)
If (dsp440.Tables(0).Rows.Count > 0) Then
SD_ORDER_HEADER_PAYMENT_METHOD.Items.Clear()
SD_ORDER_HEADER_PAYMENT_METHOD.Items.Add("")
    For sdrpi140 = 0 To dsp440.Tables(0).Rows.Count - 1
SD_ORDER_HEADER_PAYMENT_METHOD.Items.Add("")
If Not (Equals(dsp440.Tables(0).Rows(sdrpi140)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_PAYMENT_METHOD.Items( sdrpi140 + 1 ).Text= dsp440.Tables(0).Rows(sdrpi140)(0) 
Else
SD_ORDER_HEADER_PAYMENT_METHOD.Items( sdrpi140 + 1 ).Text= ""
End IF
If Not (Equals(dsp440.Tables(0).Rows(sdrpi140)(1), System.DBNull.Value)) Then
SD_ORDER_HEADER_PAYMENT_METHOD.Items( sdrpi140 + 1 ).Value= dsp440.Tables(0).Rows(sdrpi140)(1) 
Else
SD_ORDER_HEADER_PAYMENT_METHOD.Items( sdrpi140 + 1 ).Value= ""
End If
    Next
End If
dbad.SelectCommand.Connection.Close()
        dbad.SelectCommand.Connection = Session("db_connection")
Dim dsp441 as new Data.Dataset()
Dim sdrpi141 as Integer
Dim sdrp141 as string
Dim jjpp41 as Integer
jjpp41 =0
sdrp141="Select DISTINCT CURRENCY_DESCRIPTION,CURRENCY_CODE From GE_COUNTRY_CODES Where CURRENCY_CODE IS NOT NULL AND NVL(INACTIVE,'N')='N' Order By CURRENCY_DESCRIPTION"
dbad.SelectCommand.CommandText = sdrp141
dsp441.Clear()
dbad.Fill(dsp441)
If (dsp441.Tables(0).Rows.Count > 0) Then
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Items.Clear()
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Items.Add("")
    For sdrpi141 = 0 To dsp441.Tables(0).Rows.Count - 1
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Items.Add("")
If Not (Equals(dsp441.Tables(0).Rows(sdrpi141)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Items( sdrpi141 + 1 ).Text= dsp441.Tables(0).Rows(sdrpi141)(0) 
Else
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Items( sdrpi141 + 1 ).Text= ""
End IF
If Not (Equals(dsp441.Tables(0).Rows(sdrpi141)(1), System.DBNull.Value)) Then
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Items( sdrpi141 + 1 ).Value= dsp441.Tables(0).Rows(sdrpi141)(1) 
Else
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Items( sdrpi141 + 1 ).Value= ""
End If
    Next
End If
dbad.SelectCommand.Connection.Close()
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCITIES_LOV1091.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_CITY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_CITY.ClientID & "').value; else sval=''; window.open('CITIES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_CITY.ClientID & "&sval='+encodeURIComponent(sval),'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCITIES_LOV1091.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_CITY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_CITY.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('CITIES_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_CITY.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVSTATES_LOV1092.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_STATE_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_STATE_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_COUNTRY.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_COUNTRY.ClientID & "').value; else x1=''; window.open('STATES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_STATE_CODE.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVSTATES_LOV1092.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_STATE_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_STATE_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_COUNTRY.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_COUNTRY.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('STATES_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_STATE_CODE.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCOUNTRY_CODES_LOV1094.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_COUNTRY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_COUNTRY.ClientID & "').value; else sval=''; window.open('COUNTRY_CODES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_COUNTRY.ClientID & "&sval='+encodeURIComponent(sval),'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCOUNTRY_CODES_LOV1094.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_COUNTRY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_COUNTRY.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('COUNTRY_CODES_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_COUNTRY.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCITIES_LOV1123.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_CITY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_CITY.ClientID & "').value; else sval=''; window.open('CITIES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_FREIGHT_BILLING_CITY.ClientID & "&sval='+encodeURIComponent(sval),'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCITIES_LOV1123.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_CITY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_CITY.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('CITIES_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_CITY.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVSTATES_LOV1124.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "').value; else x1=''; window.open('STATES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVSTATES_LOV1124.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('STATES_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCOUNTRY_CODES_LOV1126.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "').value; else sval=''; window.open('COUNTRY_CODES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "&sval='+encodeURIComponent(sval),'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCOUNTRY_CODES_LOV1126.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('COUNTRY_CODES_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCITIES_LOV1113.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SHIPPING_CITY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SHIPPING_CITY.ClientID & "').value; else sval=''; window.open('CITIES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_SHIPPING_CITY.ClientID & "&sval='+encodeURIComponent(sval),'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCITIES_LOV1113.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SHIPPING_CITY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SHIPPING_CITY.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('CITIES_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_SHIPPING_CITY.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVSTATES_LOV1114.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SHIPPING_STATE_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SHIPPING_STATE_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "').value; else x1=''; window.open('STATES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_SHIPPING_STATE_CODE.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVSTATES_LOV1114.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SHIPPING_STATE_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SHIPPING_STATE_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('STATES_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_SHIPPING_STATE_CODE.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCOUNTRY_CODES_LOV1116.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "').value; else sval=''; window.open('COUNTRY_CODES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "&sval='+encodeURIComponent(sval),'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCOUNTRY_CODES_LOV1116.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('COUNTRY_CODES_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCITIES_LOV1102.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_BILLING_CITY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_BILLING_CITY.ClientID & "').value; else sval=''; window.open('CITIES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_BILLING_CITY.ClientID & "&sval='+encodeURIComponent(sval),'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCITIES_LOV1102.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_BILLING_CITY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_BILLING_CITY.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('CITIES_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_BILLING_CITY.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVSTATES_LOV1103.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_BILLING_STATE_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_BILLING_STATE_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "').value; else x1=''; window.open('STATES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_BILLING_STATE_CODE.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVSTATES_LOV1103.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_BILLING_STATE_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_BILLING_STATE_CODE.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('STATES_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_BILLING_STATE_CODE.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVCOUNTRY_CODES_LOV1105.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "').value; else sval=''; window.open('COUNTRY_CODES_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "&sval='+encodeURIComponent(sval),'WIN350','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVCOUNTRY_CODES_LOV1105.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('COUNTRY_CODES_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:350px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_BILLING_COUNTRY.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVITEMS_LOV1143.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "').value; else sval=''; window.open('ITEMS_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_ITEM_NO.ClientID & "&sval='+encodeURIComponent(sval),'WIN500','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVITEMS_LOV1143.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('ITEMS_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVUOM_CONVERSION_LOV1145.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "').value; else x1=''; window.open('UOM_CONVERSION_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN800','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVUOM_CONVERSION_LOV1145.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('UOM_CONVERSION_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:800px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVUOM_CONVERSION_LOV1147.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_PRICING_UOM.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_PRICING_UOM.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "').value; else x1=''; window.open('UOM_CONVERSION_LOV.aspx?RETURN_ID="  & SD_ORDER_HEADER_PRICING_UOM.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIN800','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVUOM_CONVERSION_LOV1147.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_PRICING_UOM.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_PRICING_UOM.ClientID & "').value; else sval='';if (document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "').value; else x1='';  strReturn=window.showModalDialog('UOM_CONVERSION_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:800px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_PRICING_UOM.ClientID & "').value=strReturn;isDirty = 1;}")
End If
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items.Clear()
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items.Add("")
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items.Add("")
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items(1).Text="Collect"
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items(1).Value="RECEIVER"
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items.Add("")
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items(2).Text="Shipper"
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items(2).Value="SHIPPER"
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items.Add("")
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items(3).Text="3rd Party"
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.Items(3).Value="3RD_PARTY"
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVLOV_SE_BRANCHES18887.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SE2.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SE2.ClientID & "').value; else sval=''; window.open('LOV_SE_BRANCHES.aspx?RETURN_ID="  & SD_ORDER_HEADER_SE2.ClientID & "&sval='+encodeURIComponent(sval),'WIN700','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVLOV_SE_BRANCHES18887.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SE2.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SE2.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('LOV_SE_BRANCHES.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:700px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_SE2.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVLOV_SE_BRANCHES18883.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SE1.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SE1.ClientID & "').value; else sval=''; window.open('LOV_SE_BRANCHES.aspx?RETURN_ID="  & SD_ORDER_HEADER_SE1.ClientID & "&sval='+encodeURIComponent(sval),'WIN700','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVLOV_SE_BRANCHES18883.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SE1.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SE1.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('LOV_SE_BRANCHES.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:700px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_SE1.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVLOV_SE_BRANCHES18886.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SE3.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SE3.ClientID & "').value; else sval=''; window.open('LOV_SE_BRANCHES.aspx?RETURN_ID="  & SD_ORDER_HEADER_SE3.ClientID & "&sval='+encodeURIComponent(sval),'WIN700','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVLOV_SE_BRANCHES18886.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SE3.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SE3.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('LOV_SE_BRANCHES.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:700px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_SE3.ClientID & "').value=strReturn;isDirty = 1;}")
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
LOVLOV_SE_BRANCHES18885.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SE4.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SE4.ClientID & "').value; else sval=''; window.open('LOV_SE_BRANCHES.aspx?RETURN_ID="  & SD_ORDER_HEADER_SE4.ClientID & "&sval='+encodeURIComponent(sval),'WIN700','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
LOVLOV_SE_BRANCHES18885.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_HEADER_SE4.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_HEADER_SE4.ClientID & "').value; else sval='';  strReturn=window.showModalDialog('LOV_SE_BRANCHES.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:700px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SD_ORDER_HEADER_SE4.ClientID & "').value=strReturn;isDirty = 1;}")
End If
        dbad.SelectCommand.Connection = Session("db_connection")
Dim dsp4121 as new Data.Dataset()
Dim sdrpi1121 as Integer
Dim sdrp1121 as string
Dim jjpp121 as Integer
jjpp121 =0
sdrp1121="select  OPTION_TEXT,OPTION_VALUE from SYS_DATAELEMENT_ALLOWED_VALUES WHERE ACTIVE_FLAG='Y' and  DATAELEMENT_ID='NONAG' order by line_no"
dbad.SelectCommand.CommandText = sdrp1121
dsp4121.Clear()
dbad.Fill(dsp4121)
If (dsp4121.Tables(0).Rows.Count > 0) Then
SD_ORDER_HEADER_NONAG.Items.Clear()
SD_ORDER_HEADER_NONAG.Items.Add("")
    For sdrpi1121 = 0 To dsp4121.Tables(0).Rows.Count - 1
SD_ORDER_HEADER_NONAG.Items.Add("")
If Not (Equals(dsp4121.Tables(0).Rows(sdrpi1121)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_NONAG.Items( sdrpi1121 + 1 ).Text= dsp4121.Tables(0).Rows(sdrpi1121)(0) 
Else
SD_ORDER_HEADER_NONAG.Items( sdrpi1121 + 1 ).Text= ""
End IF
If Not (Equals(dsp4121.Tables(0).Rows(sdrpi1121)(1), System.DBNull.Value)) Then
SD_ORDER_HEADER_NONAG.Items( sdrpi1121 + 1 ).Value= dsp4121.Tables(0).Rows(sdrpi1121)(1) 
Else
SD_ORDER_HEADER_NONAG.Items( sdrpi1121 + 1 ).Value= ""
End If
    Next
End If
dbad.SelectCommand.Connection.Close()
        dbad.SelectCommand.Connection = Session("db_connection")
Dim dsp4124 as new Data.Dataset()
Dim sdrpi1124 as Integer
Dim sdrp1124 as string
Dim jjpp124 as Integer
jjpp124 =0
sdrp1124="Select DESCRIPTION,LOCATION_CODE From V_QRC_LOCATION"
dbad.SelectCommand.CommandText = sdrp1124
dsp4124.Clear()
dbad.Fill(dsp4124)
If (dsp4124.Tables(0).Rows.Count > 0) Then
SD_ORDER_HEADER_QRC_LOCATION.Items.Clear()
SD_ORDER_HEADER_QRC_LOCATION.Items.Add("")
    For sdrpi1124 = 0 To dsp4124.Tables(0).Rows.Count - 1
SD_ORDER_HEADER_QRC_LOCATION.Items.Add("")
If Not (Equals(dsp4124.Tables(0).Rows(sdrpi1124)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_QRC_LOCATION.Items( sdrpi1124 + 1 ).Text= dsp4124.Tables(0).Rows(sdrpi1124)(0) 
Else
SD_ORDER_HEADER_QRC_LOCATION.Items( sdrpi1124 + 1 ).Text= ""
End IF
If Not (Equals(dsp4124.Tables(0).Rows(sdrpi1124)(1), System.DBNull.Value)) Then
SD_ORDER_HEADER_QRC_LOCATION.Items( sdrpi1124 + 1 ).Value= dsp4124.Tables(0).Rows(sdrpi1124)(1) 
Else
SD_ORDER_HEADER_QRC_LOCATION.Items( sdrpi1124 + 1 ).Value= ""
End If
    Next
End If
dbad.SelectCommand.Connection.Close()
  End if
Call fill_post_query_ddls()
        dbad.SelectCommand.Connection = Session("db_connection")
Dim dbgquery0 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''AR_CASH_RECEIPTS.aspx?RECORD_NO=' ||RECORD_NO ||''') >' ||RECORD_NO || '</a>'  as  ""Record #"",TO_CHAR(TRANSACTION_DATE,'MM/DD/YYYY') As ""Date"", TO_CHAR(ADVANCE_AMOUNT,'999999999.99') as ""Amount"" FROM VL_AR_ADVANCES WHERE ORDER_NO_FILTER='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery0.Clear()
dbad.Fill(dbgquery0)
If (dbgquery0.Tables(0).Rows.Count > 0) Then
dbgADVANCES.Visible=True
dbgADVANCES.DataSource=dbgquery0.Tables(0)
dbgADVANCES.DataBind()
Else
dbgADVANCES.Visible=false
End If
Catch ex as exception
dbgADVANCES.Visible=false
End Try
Dim dbgquery1 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT  '<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''ORDER_DETAILS.aspx?LINE_NO=' || LINE_NO || '&ORDER_NO=' ||ORDER_NO ||''') >' ||LINE_NO || '</a>'   ""LNo"",ITEM_NO ""Item No"",DESCRIPTION ""Description"",TO_CHAR(SHIPED_QTY,'999,999,999.99') ""Qty"", ORDER_UOM ""UOM"", TO_CHAR(SALES_PRICE,'999,999,999.99') ""Sales<br />Price"",PRICING_UOM ""Pricing<br />UOM"", TO_CHAR(((LINE_EXTENDED_AMOUNT*SHIPED_QTY)/ORDER_QTY),'999,999,999.99') ""Extended<br />Amount"",TO_CHAR(((LINE_TOTAL_AMOUNT*SHIPED_QTY)/ORDER_QTY),'999,999,999.99') AS ""Line<br />Total Amount"",TO_CHAR(DUE_DATE,'MM/DD/RRRR') ""Promised<br />Ship date"" FROM V_ORDER_PACKING_SLIP_DETAILS  WHERE  NVL(BLANKET_ORDER,'N')='Y' AND SHIPED_QTY>0 AND ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery1.Clear()
dbad.Fill(dbgquery1)
If (dbgquery1.Tables(0).Rows.Count > 0) Then
dbgBLANKET_LINES.Visible=True
dbgBLANKET_LINES.DataSource=dbgquery1.Tables(0)
dbgBLANKET_LINES.DataBind()
Else
dbgBLANKET_LINES.Visible=false
End If
Catch ex as exception
dbgBLANKET_LINES.Visible=false
End Try
Dim dbgquery2 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a href=''##'' onClick=open_window_doc(''SD_INVOICE.aspx?INVOICE_NO=' ||INVOICE_NO ||''')>' ||INVOICE_NO || '</a>'  as  ""Invoice No #"",billing_stage,TO_CHAR(INVOICE_DATE,'MM/DD/YYYY') As ""INVOICE_DATE"" FROM SD_INVOICE_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery2.Clear()
dbad.Fill(dbgquery2)
If (dbgquery2.Tables(0).Rows.Count > 0) Then
dbgINVOICE_DETAILS.Visible=True
dbgINVOICE_DETAILS.DataSource=dbgquery2.Tables(0)
dbgINVOICE_DETAILS.DataBind()
Else
dbgINVOICE_DETAILS.Visible=false
End If
Catch ex as exception
dbgINVOICE_DETAILS.Visible=false
End Try
Dim dbgquery3 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''PACKING_SLIP.aspx?PACKING_SLIP_NO=' ||PACKING_SLIP_NO ||''') >' ||PACKING_SLIP_NO || '</a>'  as  ""PACKING_SLIP #"",PACKING_SLIP_DATE FROM V_ORDER_PACKING_SLIP WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery3.Clear()
dbad.Fill(dbgquery3)
If (dbgquery3.Tables(0).Rows.Count > 0) Then
dbgPACLING_SLIP.Visible=True
dbgPACLING_SLIP.DataSource=dbgquery3.Tables(0)
dbgPACLING_SLIP.DataBind()
Else
dbgPACLING_SLIP.Visible=false
End If
Catch ex as exception
dbgPACLING_SLIP.Visible=false
End Try
Dim dbgquery4 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''##'' onClick=open_window_doc(''PURCHASE_ORDER.aspx?mid=PURCHASE_ORDER&PO_NO=' ||PO_NO ||''') >' ||PO_NO || '</a>'  as  ""PO #"",TO_CHAR(PO_DATE,'MM/DD/YYYY') AS ""PO Date"",LINE_NO AS ""Line No"",ORDER_LINE_NO AS ""Order Lno""  FROM V_PO_SO_DETAILS  WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' order by 1 desc"
dbgquery4.Clear()
dbad.Fill(dbgquery4)
If (dbgquery4.Tables(0).Rows.Count > 0) Then
dbgPO_DETAILS.Visible=True
dbgPO_DETAILS.DataSource=dbgquery4.Tables(0)
dbgPO_DETAILS.DataBind()
Else
dbgPO_DETAILS.Visible=false
End If
Catch ex as exception
dbgPO_DETAILS.Visible=false
End Try
Dim dbgquery5 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''##'' onClick=open_window_doc(''QUOTATION.aspx?mid=QUOTATION&QUOTATION_NO=' ||QUOTATION_NO ||''') >' ||QUOTATION_NO || '</a>'  as  ""QUOTATION #"",QUOTATION_DATE FROM V_ORDER_QUOTATION_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery5.Clear()
dbad.Fill(dbgquery5)
If (dbgquery5.Tables(0).Rows.Count > 0) Then
dbgQUOTATION_ORDERS.Visible=True
dbgQUOTATION_ORDERS.DataSource=dbgquery5.Tables(0)
dbgQUOTATION_ORDERS.DataBind()
Else
dbgQUOTATION_ORDERS.Visible=false
End If
Catch ex as exception
dbgQUOTATION_ORDERS.Visible=false
End Try
Dim dbgquery6 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''RMA.aspx?RMA_NO=' ||RMA_NO ||''') >' ||RMA_NO || '</a>'  as  ""RMA #"",LINE_NO as ""Line #"",TO_CHAR(RMA_DATE,'MM/DD/YYYY') as ""Date"",ORDER_LINE_NO as ""Order Line #"",'<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''ITEMS.aspx?ITEM_NO=' ||ITEM_NO ||''') >' ||ITEM_NO || '</a>'  as  ""Item #"",DESCRIPTION as ""Description"" FROM V_RMA_REPORT1 WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery6.Clear()
dbad.Fill(dbgquery6)
If (dbgquery6.Tables(0).Rows.Count > 0) Then
dbgRMA.Visible=True
dbgRMA.DataSource=dbgquery6.Tables(0)
dbgRMA.DataBind()
Else
dbgRMA.Visible=false
End If
Catch ex as exception
dbgRMA.Visible=false
End Try
Dim dbgquery7 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''INVENTORY_TRANSFER_BY_ORDER.aspx?RECORD_NO=' ||RECORD_NO ||''') >' ||RECORD_NO || '</a>'  as  ""Transfer #"",TO_CHAR(TRANSFER_DATE,'MM/DD/YYYY') AS ""Transfer Date""  FROM V_INVENTORY_TRANSFER_BY_ORDER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ORDER BY 1"
dbgquery7.Clear()
dbad.Fill(dbgquery7)
If (dbgquery7.Tables(0).Rows.Count > 0) Then
dbgTRANSFER_DETAILS.Visible=True
dbgTRANSFER_DETAILS.DataSource=dbgquery7.Tables(0)
dbgTRANSFER_DETAILS.DataBind()
Else
dbgTRANSFER_DETAILS.Visible=false
End If
Catch ex as exception
dbgTRANSFER_DETAILS.Visible=false
End Try
Dim dbgquery8 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct  '<a class=''lbfont'' href=''##'' onClick=open_window_doc(''WORK_ORDER.aspx?mid=WORK_ORDER&WORK_ORDER_NO=' || WORK_ORDER_NO ||''') >' ||WORK_ORDER_NO || '</a>'  as ""WORK_ORDER #"",WO_DATE,ORDER_LINE_NO AS LINE_NO, ITEM_NO as ITEM_NO,TO_CHAR(QTY) AS QTY, SCHEDULED_START_DATE, SCHEDULED_COMPLETION_DATE, SORT_ORDER S FROM V_SO_WO_ORDERS WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'  and allocation_type='SO_WO' order by line_no, S"
dbgquery8.Clear()
dbad.Fill(dbgquery8)
If (dbgquery8.Tables(0).Rows.Count > 0) Then
dbgWO_ORDERS.Visible=True
dbgWO_ORDERS.DataSource=dbgquery8.Tables(0)
dbgWO_ORDERS.DataBind()
Else
dbgWO_ORDERS.Visible=false
End If
Catch ex as exception
dbgWO_ORDERS.Visible=false
End Try
Dim dbgquery9 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct ORDER_LINE_NO AS ""Order Line #"", '<a class=''lbfont'' href=''##'' onClick=open_window_doc('''||DECODE(WORK_ORDER_TYPE,'REPAIR','WORK_ORDER_SR','WORK_ORDER')||'.aspx?mid=WORK_ORDER&WORK_ORDER_NO=' || WORK_ORDER_NO ||''') >' ||WORK_ORDER_NO || '</a>'  as ""WO #"",Sf_Wrap_Text(sf_Get_order_serial_no(ORDER_NO,ORDER_LINE_NO),30) AS ""Serial #""  FROM V_WORK_ORDER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ORDER BY ORDER_LINE_NO"
dbgquery9.Clear()
dbad.Fill(dbgquery9)
If (dbgquery9.Tables(0).Rows.Count > 0) Then
dbgWO_ORDERS_1.Visible=True
dbgWO_ORDERS_1.DataSource=dbgquery9.Tables(0)
dbgWO_ORDERS_1.DataBind()
Else
dbgWO_ORDERS_1.Visible=false
End If
Catch ex as exception
dbgWO_ORDERS_1.Visible=false
End Try
dbad.SelectCommand.Connection.Close()
 If Not IsPostBack Then
primary1 = Request.QueryString.Get("ORDER_NO")
if (primary1<>"") Then
SD_ORDER_HEADER_ORDER_NO.Text=primary1
End If
 if (primary1<>"" or  primary2<>"" or  primary3<>"" or primary4<>"" or primary5<>"" or primary6<>"" ) Then
      Call fill_header_info()
Else
call clear_header()
call clear_detail_grid()
call clear_detail_form()
      End if
SD_ORDER_HEADER_ORDER_NO.Focus()
Call Document_related_functions()
  End if
Call page_rules_every_time()
If not IsPostBack Then
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_BALANCE_QTY_LINE.Focus()
Else
    ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_HEADER_BALANCE_QTY_LINE.ClientID & "');", True)
    ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_HEADER_BALANCE_QTY_LINE.ClientID & "');", True)
End If
End If
call conn.call_afterpage_Load("SALES_ORDER", session("user_id"),Request.QueryString.Get("mid"),Request.QueryString.Get("sssid"), Session.SessionID,"SD_ORDERS_SEARCH")
Catch ex As Exception
call insert_sys_log("Page Load",ex.Message)
End Try
End Sub
Public Sub page_rules_every_time()
 If (SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=TRUE) Then
PANEL5BILLING_ADDRESS.Visible=True
Else
PANEL5BILLING_ADDRESS.Visible=False
End If
 If (SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=TRUE) Then
PANEL5SHIPPING_ADDRESS.Visible=True
Else
PANEL5SHIPPING_ADDRESS.Visible=False
End If
 If (SD_ORDER_HEADER_BASE_CURRENCY_CODE.TEXT<>SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.SELECTEDITEM.VALUE) Then
SD_ORDER_HEADER_BASE_CURRENCY_CODE_L.Visible=True
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY_L.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR_L.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Visible=True
Else
SD_ORDER_HEADER_BASE_CURRENCY_CODE_L.Visible=False
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY_L.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR_L.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Visible=False
End If
 If (SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=TRUE) Then
LOVSHIPTO_LOV1152.Visible=True
SD_ORDER_HEADER_SHIPTO_CODE_L.Visible=True
SD_ORDER_HEADER_SHIPTO_CODE.Visible=True
Else
LOVSHIPTO_LOV1152.Visible=False
SD_ORDER_HEADER_SHIPTO_CODE_L.Visible=False
SD_ORDER_HEADER_SHIPTO_CODE.Visible=False
End If
 If (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE) Then
PANEL5BLANKET_ORDER.Visible=True
PANEL5BLANKET_LINES.Visible=True
Else
PANEL5BLANKET_ORDER.Visible=False
PANEL5BLANKET_LINES.Visible=False
End If
 If ((CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="10146685") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="DAREK") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="BARNAS")) Then
EVENT_BTN_RUN_SCH.Visible=True
Else
EVENT_BTN_RUN_SCH.Visible=False
End If
 If (SD_ORDER_HEADER_SHIP_COMPLETE.CHECKED<>TRUE) Then
EVENT_SHIP_COMPLETE.Visible=True
Else
EVENT_SHIP_COMPLETE.Visible=False
End If
 If ((CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS" ) OR  (CONN.SF_EXECUTE_SQL("SELECT SF_GET_SALES_APPRVAL('" & SESSION("USER_ID") & "')  FROM DUAL")=1) OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT" )) Then
SD_ORDER_HEADER_SUGGESTED_DATE_L.Visible=True
SD_ORDER_HEADER_SUGGESTED_DATE.Visible=True
Else
SD_ORDER_HEADER_SUGGESTED_DATE_L.Visible=False
SD_ORDER_HEADER_SUGGESTED_DATE.Visible=False
End If
 If ((SD_ORDER_HEADER_SUGGESTED_DATE.text<>"" AND (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS") OR  (CONN.SF_EXECUTE_SQL("SELECT SF_GET_SALES_APPRVAL('" & SESSION("USER_ID") & "')  FROM DUAL")=1) OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT"))) Then
EVENT_BTN_UNDO_SUGGEST_DATE.Visible=True
Else
EVENT_BTN_UNDO_SUGGEST_DATE.Visible=False
End If
 If (1=2) Then
COPY1.Visible=True
Else
COPY1.Visible=False
End If
 If ((SD_ORDER_HEADER_SUGGESTED_DATE.text<>"" AND (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS") OR  (CONN.SF_EXECUTE_SQL("SELECT SF_GET_SALES_APPRVAL('" & SESSION("USER_ID") & "') FROM DUAL")=1) OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT"))) Then
EVENT_BTN_SUGGEST_DATE.Visible=True
Else
EVENT_BTN_SUGGEST_DATE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL("SELECT count(*) FROM GE_TERMS_CODES_DETAILS WHERE TERMS_CODE=NVL('" & SD_ORDER_HEADER_TERMS_CODE.TEXT & "' ,'NOTERMS_!@#')")>0) Then
PANEL5BILLING_STAGE.Visible=True
Else
PANEL5BILLING_STAGE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT EDIT_SHIP_DELIVERY_DATE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="D") Then
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE_L.Visible=True
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Visible=True
Else
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE_L.Visible=False
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT EDIT_SHIP_DELIVERY_DATE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="S") Then
SD_ORDER_HEADER_DUE_DATE_L.Visible=True
SD_ORDER_HEADER_DUE_DATE.Visible=True
Else
SD_ORDER_HEADER_DUE_DATE_L.Visible=False
SD_ORDER_HEADER_DUE_DATE.Visible=False
End If
 If (CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<>"Close") Then
SAVE.Visible=True
Else
SAVE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT SF_CHECK_EXPORT_HOLD('" & SESSION("USER_ID") & "') FROM DUAL ")<>"N") Then
SD_ORDER_HEADER_EXPORT_HOLD.Enabled=True
Else
SD_ORDER_HEADER_EXPORT_HOLD.Enabled=False
End If
 If ((SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE AND CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<> "Close") OR (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE AND CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")= "Open") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,'H','" & SESSION("USER_ID") & "')")="Y")) Then
AddGridRowORDERDETAIL.Enabled=True
AddGridRowORDERDETAIL_1.Enabled=True
DELETEGridRowORDERDETAIL.Enabled=True
DELETEGridRowORDERDETAIL_1.Enabled=True
Else
AddGridRowORDERDETAIL.Enabled=False
AddGridRowORDERDETAIL_1.Enabled=False
DELETEGridRowORDERDETAIL.Enabled=False
DELETEGridRowORDERDETAIL_1.Enabled=False
End If
 If (CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<> "Close") Then
SD_ORDER_HEADER_REQUESTED_DATE.Enabled=True
SD_ORDER_HEADER_ORDER_DATE.Enabled=True
Else
SD_ORDER_HEADER_REQUESTED_DATE.Enabled=False
SD_ORDER_HEADER_ORDER_DATE.Enabled=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT SF_CHECK_AES_HOLD('" & SESSION("USER_ID") & "') FROM DUAL ")<>"N") Then
SD_ORDER_HEADER_AES_HOLD.Enabled=True
Else
SD_ORDER_HEADER_AES_HOLD.Enabled=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT SF_CHECK_ATEX_HOLD('" & SESSION("USER_ID") & "') FROM DUAL ")<>"N") Then
SD_ORDER_HEADER_ATEX_HOLD.Enabled=True
Else
SD_ORDER_HEADER_ATEX_HOLD.Enabled=False
End If
 If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM SD_INVOICE_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ")=0) Then
LOVTERMS_CODE_LOV1131.Enabled=True
SD_ORDER_HEADER_TERMS_CODE.Enabled=True
SD_ORDER_HEADER_TERMS_CODE.ReadOnly=False
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Enabled=True
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.ReadOnly=False
LOVCUST_SHIP_VIA_LOV1132.Enabled=True
SD_ORDER_HEADER_SHIP_VIA.Enabled=True
SD_ORDER_HEADER_SHIP_VIA.ReadOnly=False
SD_ORDER_HEADER_PAYMENT_METHOD.Enabled=True
SD_ORDER_HEADER_FOB.Enabled=True
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Enabled=True
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Enabled=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Enabled=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.ReadOnly=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Enabled=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.ReadOnly=False
Else
LOVTERMS_CODE_LOV1131.Enabled=False
SD_ORDER_HEADER_TERMS_CODE.Enabled=True
SD_ORDER_HEADER_TERMS_CODE.ReadOnly=True
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Enabled=True
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.ReadOnly=True
LOVCUST_SHIP_VIA_LOV1132.Enabled=False
SD_ORDER_HEADER_SHIP_VIA.Enabled=True
SD_ORDER_HEADER_SHIP_VIA.ReadOnly=True
SD_ORDER_HEADER_PAYMENT_METHOD.Enabled=False
SD_ORDER_HEADER_FOB.Enabled=False
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Enabled=False
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Enabled=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Enabled=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.ReadOnly=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Enabled=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.ReadOnly=True
End If
End Sub
Public Sub fill_post_query_ddls()
End Sub
Public Sub verify_year_period()
End Sub
Public Function return_year_period_status() As String
Dim st1 as string
st1="Y"
Return st1
End Function
Public sub Document_related_functions()
Try
Session("SALES_ORDER_primay_field_list") = "ORDER_NO"
Session("SALES_ORDER_primay_field_value") =SD_ORDER_HEADER_ORDER_NO.Text
Session("SALES_ORDER_primay_field_labels") ="Order No"
session("SALES_ORDER_page_name_doc")= Header_text_123.text 
Session("SALES_ORDER_tag_field_list") = "ORDER_NO,CUSTOMER_NO,NAME"
Session("SALES_ORDER_tag_field_value") =SD_ORDER_HEADER_ORDER_NO.Text & "{-}" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "{-}" & SD_ORDER_HEADER_NAME.Text 
Session("SALES_ORDER_tag_field_labels") ="Order No{-}Customer No{-}Name"
Catch ex As Exception
call insert_sys_log("Doc related function",ex.Message)
End Try
    End Sub
 Public Sub fill_header_info1(ByVal r0 As String, ByVal r1 As String, ByVal r2 As String, ByVal r3 As String, ByVal r4 As String, ByVal r5 As String)
Try
SD_ORDER_HEADER_ORDER_NO.Text=r0
 Call fill_header_info()
Catch ex As Exception
call insert_sys_log("Fill Details from search",ex.Message)
End Try
    End Sub
Protected Sub SD_ORDER_HEADER_ORDER_NO_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_ORDER_NO.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds0 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_ORDER_NO.Text <>"") Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(1) FROM SD_ORDER_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'")=0) Then
SD_ORDER_HEADER_ORDER_NO.TEXT=CONN.SF_EXECUTE_SQL("select SF_GET_SEQUENCE_ORDER_NO from DUAL")
End If
End If
If SD_ORDER_HEADER_ORDER_NO.Text<>"" Then
Call fill_header_info()
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_SE_PCT1.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep", "setff1('" & SD_ORDER_HEADER_SE_PCT1.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep1", "setff1('" & SD_ORDER_HEADER_SE_PCT1.ClientID & "');", True)
End If
Exit sub
End If
If (SD_ORDER_HEADER_ORDER_NO.Text <>"") Then
Dim dbsqlst4 as new Data.Dataset
dbad.SelectCommand.CommandText ="select Pkg_Status.Sf_Check_Status ('SD_ORDER_HEADER','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL)  from dual"
dbsqlst4.Clear()
dbad.Fill(dbsqlst4)
if (dbsqlst4.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst4.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
ORDER_STATUS.Text=dbsqlst4.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst4.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
SD_ORDER_HEADER_ORDER_NO.Text=Ucase(SD_ORDER_HEADER_ORDER_NO.Text)
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_SE_PCT1.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep0", "setff1('" & SD_ORDER_HEADER_SE_PCT1.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus0", "setff1('" & SD_ORDER_HEADER_SE_PCT1.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("ORDER_NO_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_BUSINESS_UNIT_CODE_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SelectedIndexChanged
If (SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SelectedIndex >=0) Then
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds4 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
Dim dbsqlst1 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT CURRENCY_CODE,CURRENCY_CODE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SELECTEDITEM.VALUE & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Text=dbsqlst1.Tables(0).Rows(0)(0)
Else
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Text=""
End If
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE,dbsqlst1.Tables(0).Rows(0)(1))
Else
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.SelectedIndex=-1
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Text=""
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.SelectedIndex=-1
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Try
 If (CONN.SF_EXECUTE_SQL ("SELECT NVL(ORDER_TYPE_VISIBLE,'N') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="N") Then
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Order Doc Type*")) Then
dcols(rii).Visible = False
End If
Next
Else
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Order Doc Type*")) Then
dcols(rii).Visible = True
End If
Next
End If
Catch ex As Exception
End Try
Try
 If (CONN.SF_EXECUTE_SQL(" SELECT NVL(CUSTOMER_ITEM_NO_REQUIRED,'N') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "' ")<>"Y") Then
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Customer Item No")) Then
dcols(rii).Visible = False
dcols(rii+1).Visible = False
End If
Next
Else
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Customer Item No")) Then
dcols(rii).Visible = True
dcols(rii+1).Visible = True
End If
Next
End If
Catch ex As Exception
End Try
 If (CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<> "Close") Then
LOVCUSTOMER_LOV1088.Enabled=True
SD_ORDER_HEADER_CUSTOMER_NO.Enabled=True
SD_ORDER_HEADER_CUSTOMER_NO.ReadOnly=False
SD_ORDER_HEADER_INVOICE_BY.Enabled=True
Else
LOVCUSTOMER_LOV1088.Enabled=False
SD_ORDER_HEADER_CUSTOMER_NO.Enabled=True
SD_ORDER_HEADER_CUSTOMER_NO.ReadOnly=True
SD_ORDER_HEADER_INVOICE_BY.Enabled=False
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep4", "setff1('" & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus4", "setff1('" & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("BUSINESS_UNIT_CODE_Event",ex.Message)
End Try
End If
End Sub
Protected Sub SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds6 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text<>"" Then
  dbad.SelectCommand.CommandText="Select ORDER_ENTRY_SALES_CODE from SD_CUSTOMERS Where  UPPER(CRM_CATEGORY)='CUSTOMER' AND NVL(INACTIVE,'N')='N' And ORDER_ENTRY_SALES_CODE='" & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text & "'"
Cust_ds6.Clear()
dbad.Fill(cust_ds6)
If Not(cust_ds6.Tables(0).rows.Count>0)Then
SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text=""
err_message.Text = " Please enter valid Sales order entry code"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <>"") Then
Dim dbsqlst1 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT ACCOUNT_NO FROM V_SALES_ENTRY_CODE_LOV WHERE ORDER_ENTRY_SALES_CODE = '" & SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.TEXT & "' AND ROWNUM<2"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_CUSTOMER_NO.Text=dbsqlst1.Tables(0).Rows(0)(0)
Else
SD_ORDER_HEADER_CUSTOMER_NO.Text=""
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
SD_ORDER_HEADER_CUSTOMER_NO.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <>"") Then
If (CONN.sf_execute_db_function("SF_CREDIT_DAYS_EXCEEDS('" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "')")="Y" AND CONN.SF_EXECUTE_SQL("SELECT NVL(CREDIT_HOLD_DAYS,'P') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SELECTEDITEM.VALUE & "'")="S") Then
SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text=""

 Dim strFile2 As String = "slk332"
        Dim strCmd2 As String
        strCmd2 = String.Format("alert('Credit hold. Days exceeded. ');", strFile2)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN5612", strCmd2, True)
End If
End If
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <>"") Then
If (CONN.sf_execute_db_function("SF_CREDIT_DAYS_EXCEEDS('" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "')")="Y" AND CONN.SF_EXECUTE_SQL("SELECT NVL(CREDIT_HOLD_DAYS,'P') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SELECTEDITEM.VALUE & "'")="W") Then
SD_ORDER_HEADER_CUSTOMER_NO.Text=SD_ORDER_HEADER_CUSTOMER_NO.Text

 Dim strFile3 As String = "slk333"
        Dim strCmd3 As String
        strCmd3 = String.Format("alert('Credit hold. Days exceeded.');", strFile3)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN5613", strCmd3, True)
End If
End If
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <>"") Then
If (CONN.sf_execute_db_function("SF_CREDIT_DOLLAR_EXCEEDS('" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "')")="Y" AND CONN.SF_EXECUTE_SQL("SELECT NVL(CREDIT_HOLD_AMOUNT,'P') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SELECTEDITEM.VALUE & "'")="W") Then
SD_ORDER_HEADER_CUSTOMER_NO.Text=SD_ORDER_HEADER_CUSTOMER_NO.Text

 Dim strFile4 As String = "slk334"
        Dim strCmd4 As String
        strCmd4 = String.Format("alert('Credit hold Amount exceeded. ');", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN5614", strCmd4, True)
End If
End If
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <>"") Then
If (CONN.sf_execute_db_function("SF_CREDIT_DOLLAR_EXCEEDS('" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "')")="Y" AND CONN.SF_EXECUTE_SQL("SELECT NVL(CREDIT_HOLD_AMOUNT,'P') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SELECTEDITEM.VALUE & "'")="S") Then
SD_ORDER_HEADER_CUSTOMER_NO.Text=""

 Dim strFile5 As String = "slk335"
        Dim strCmd5 As String
        strCmd5 = String.Format("alert('Credit hold Amount exceeded. ');", strFile5)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN5615", strCmd5, True)
End If
End If
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <> "") Then
dbad.SelectCommand.CommandText = "Select NAME,STREET,CITY,STATE_CODE,POSTAL_CODE,COUNTRY,PHONE,FAX,EMAIL,TERMS_CODE,SHIP_VIA,FOB,PAYMENT_METHOD,DIFFERENT_BILLING_ADDRESS,BILLING_NAME,BILLING_STREET,BILLING_CITY,BILLING_STATE_CODE,BILLING_POSTAL_CODE,BILLING_COUNTRY,BILLING_PHONE,BILLING_FAX,BILLING_EMAIL,ORDER_ACK_PREFERENCE,CUSTOMER_NOTES,SE_ID,DECODE(NVL(SE_CODE,0),0,'',DECODE(NVL(SE_CODE2,0),0,'100','50')),DECODE(COUNTRY,'USA',DECODE(BILLING_COUNTRY,'USA','N','Y'),'Y'),FREIGHT_BILL_TYPE,SHIPPING_INSTRUCTIONS,THIRD_PARTY_ADDRESS,SE_ID2,DECODE(NVL(SE_CODE2,0),0,'','50'),DECODE(COUNTRY,'USA','Y','Y') from SD_CUSTOMERS where ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.text & "' AND NVL(INACTIVE,'N')='N'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc.Tables(0).Rows(0)("NAME"), System.DBNull.Value)) Then
SD_ORDER_HEADER_NAME.Text=dstruc.Tables(0).Rows(0)("NAME")
Else
SD_ORDER_HEADER_NAME.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("STREET"), System.DBNull.Value)) Then
SD_ORDER_HEADER_STREET.Text=dstruc.Tables(0).Rows(0)("STREET")
Else
SD_ORDER_HEADER_STREET.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("CITY"), System.DBNull.Value)) Then
SD_ORDER_HEADER_CITY.Text=dstruc.Tables(0).Rows(0)("CITY")
Else
SD_ORDER_HEADER_CITY.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("STATE_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_STATE_CODE.Text=dstruc.Tables(0).Rows(0)("STATE_CODE")
Else
SD_ORDER_HEADER_STATE_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("POSTAL_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_POSTAL_CODE.Text=dstruc.Tables(0).Rows(0)("POSTAL_CODE")
Else
SD_ORDER_HEADER_POSTAL_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("COUNTRY"), System.DBNull.Value)) Then
SD_ORDER_HEADER_COUNTRY.Text=dstruc.Tables(0).Rows(0)("COUNTRY")
Else
SD_ORDER_HEADER_COUNTRY.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("PHONE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_PHONE.Text=dstruc.Tables(0).Rows(0)("PHONE")
Else
SD_ORDER_HEADER_PHONE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("FAX"), System.DBNull.Value)) Then
SD_ORDER_HEADER_FAX.Text=dstruc.Tables(0).Rows(0)("FAX")
Else
SD_ORDER_HEADER_FAX.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("EMAIL"), System.DBNull.Value)) Then
SD_ORDER_HEADER_EMAIL.Text=dstruc.Tables(0).Rows(0)("EMAIL")
Else
SD_ORDER_HEADER_EMAIL.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("TERMS_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_TERMS_CODE.Text=dstruc.Tables(0).Rows(0)("TERMS_CODE")
SD_ORDER_HEADER_TERMS_CODE_TextChanged(sender,e)
Else
SD_ORDER_HEADER_TERMS_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SHIP_VIA"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIP_VIA.Text=dstruc.Tables(0).Rows(0)("SHIP_VIA")
Else
SD_ORDER_HEADER_SHIP_VIA.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("FOB"), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_FOB,dstruc.Tables(0).Rows(0)("FOB"))
Else
SD_ORDER_HEADER_FOB.SelectedIndex=-1
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("PAYMENT_METHOD"), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_PAYMENT_METHOD,dstruc.Tables(0).Rows(0)("PAYMENT_METHOD"))
Else
SD_ORDER_HEADER_PAYMENT_METHOD.SelectedIndex=-1
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("DIFFERENT_BILLING_ADDRESS"), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS,dstruc.Tables(0).Rows(0)("DIFFERENT_BILLING_ADDRESS"))
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_NAME"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_NAME.Text=dstruc.Tables(0).Rows(0)("BILLING_NAME")
Else
SD_ORDER_HEADER_BILLING_NAME.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_STREET"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_STREET.Text=dstruc.Tables(0).Rows(0)("BILLING_STREET")
Else
SD_ORDER_HEADER_BILLING_STREET.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_CITY"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_CITY.Text=dstruc.Tables(0).Rows(0)("BILLING_CITY")
Else
SD_ORDER_HEADER_BILLING_CITY.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_STATE_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_STATE_CODE.Text=dstruc.Tables(0).Rows(0)("BILLING_STATE_CODE")
Else
SD_ORDER_HEADER_BILLING_STATE_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_POSTAL_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text=dstruc.Tables(0).Rows(0)("BILLING_POSTAL_CODE")
Else
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_COUNTRY"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_COUNTRY.Text=dstruc.Tables(0).Rows(0)("BILLING_COUNTRY")
Else
SD_ORDER_HEADER_BILLING_COUNTRY.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_PHONE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_PHONE.Text=dstruc.Tables(0).Rows(0)("BILLING_PHONE")
Else
SD_ORDER_HEADER_BILLING_PHONE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_FAX"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_FAX.Text=dstruc.Tables(0).Rows(0)("BILLING_FAX")
Else
SD_ORDER_HEADER_BILLING_FAX.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_EMAIL"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_EMAIL.Text=dstruc.Tables(0).Rows(0)("BILLING_EMAIL")
Else
SD_ORDER_HEADER_BILLING_EMAIL.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("ORDER_ACK_PREFERENCE"), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_ORDER_ACK_PREFERENCE,dstruc.Tables(0).Rows(0)("ORDER_ACK_PREFERENCE"))
Else
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.SelectedIndex=-1
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("CUSTOMER_NOTES"), System.DBNull.Value)) Then
SD_ORDER_HEADER_ORDER_NOTES.Text=dstruc.Tables(0).Rows(0)("CUSTOMER_NOTES")
Else
SD_ORDER_HEADER_ORDER_NOTES.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SE_ID"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SE1.Text=dstruc.Tables(0).Rows(0)("SE_ID")
Else
SD_ORDER_HEADER_SE1.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(NVL(SE_CODE,0),0,'',DECODE(NVL(SE_CODE2,0),0,'100','50'))"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SE_PCT1.Text=String.Format("{0:0.00}",dstruc.Tables(0).Rows(0)("DECODE(NVL(SE_CODE,0),0,'',DECODE(NVL(SE_CODE2,0),0,'100','50'))"))
Else
SD_ORDER_HEADER_SE_PCT1.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(COUNTRY,'USA',DECODE(BILLING_COUNTRY,'USA','N','Y'),'Y')"), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_EXPORT_HOLD,dstruc.Tables(0).Rows(0)("DECODE(COUNTRY,'USA',DECODE(BILLING_COUNTRY,'USA','N','Y'),'Y')"))
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("FREIGHT_BILL_TYPE"), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_FREIGHT_BILL_TYPE,dstruc.Tables(0).Rows(0)("FREIGHT_BILL_TYPE"))
Else
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex=-1
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SHIPPING_INSTRUCTIONS"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=dstruc.Tables(0).Rows(0)("SHIPPING_INSTRUCTIONS")
Else
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("THIRD_PARTY_ADDRESS"), System.DBNull.Value)) Then
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text=dstruc.Tables(0).Rows(0)("THIRD_PARTY_ADDRESS")
Else
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SE_ID2"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SE2.Text=dstruc.Tables(0).Rows(0)("SE_ID2")
Else
SD_ORDER_HEADER_SE2.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(NVL(SE_CODE2,0),0,'','50')"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SE_PCT2.Text=String.Format("{0:0.00}",dstruc.Tables(0).Rows(0)("DECODE(NVL(SE_CODE2,0),0,'','50')"))
Else
SD_ORDER_HEADER_SE_PCT2.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(COUNTRY,'USA','Y','Y')"), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS,dstruc.Tables(0).Rows(0)("DECODE(COUNTRY,'USA','Y','Y')"))
End If
Else
SD_ORDER_HEADER_NAME.Text=""
SD_ORDER_HEADER_STREET.Text=""
SD_ORDER_HEADER_CITY.Text=""
SD_ORDER_HEADER_STATE_CODE.Text=""
SD_ORDER_HEADER_POSTAL_CODE.Text=""
SD_ORDER_HEADER_COUNTRY.Text=""
SD_ORDER_HEADER_PHONE.Text=""
SD_ORDER_HEADER_FAX.Text=""
SD_ORDER_HEADER_EMAIL.Text=""
SD_ORDER_HEADER_TERMS_CODE.Text=""
SD_ORDER_HEADER_SHIP_VIA.Text=""
SD_ORDER_HEADER_FOB.SelectedIndex=-1
SD_ORDER_HEADER_PAYMENT_METHOD.SelectedIndex=-1
SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.Checked=False
SD_ORDER_HEADER_BILLING_NAME.Text=""
SD_ORDER_HEADER_BILLING_STREET.Text=""
SD_ORDER_HEADER_BILLING_CITY.Text=""
SD_ORDER_HEADER_BILLING_STATE_CODE.Text=""
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text=""
SD_ORDER_HEADER_BILLING_COUNTRY.Text=""
SD_ORDER_HEADER_BILLING_PHONE.Text=""
SD_ORDER_HEADER_BILLING_FAX.Text=""
SD_ORDER_HEADER_BILLING_EMAIL.Text=""
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.SelectedIndex=-1
SD_ORDER_HEADER_ORDER_NOTES.Text=""
SD_ORDER_HEADER_SE1.Text=""
SD_ORDER_HEADER_SE_PCT1.Text=""
SD_ORDER_HEADER_EXPORT_HOLD.Checked=False
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex=-1
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=""
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text=""
SD_ORDER_HEADER_SE2.Text=""
SD_ORDER_HEADER_SE_PCT2.Text=""
SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.Checked=False
End If
Else
SD_ORDER_HEADER_NAME.Text=""
SD_ORDER_HEADER_STREET.Text=""
SD_ORDER_HEADER_CITY.Text=""
SD_ORDER_HEADER_STATE_CODE.Text=""
SD_ORDER_HEADER_POSTAL_CODE.Text=""
SD_ORDER_HEADER_COUNTRY.Text=""
SD_ORDER_HEADER_PHONE.Text=""
SD_ORDER_HEADER_FAX.Text=""
SD_ORDER_HEADER_EMAIL.Text=""
SD_ORDER_HEADER_TERMS_CODE.Text=""
SD_ORDER_HEADER_SHIP_VIA.Text=""
SD_ORDER_HEADER_FOB.SelectedIndex=-1
SD_ORDER_HEADER_PAYMENT_METHOD.SelectedIndex=-1
SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.Checked=False
SD_ORDER_HEADER_BILLING_NAME.Text=""
SD_ORDER_HEADER_BILLING_STREET.Text=""
SD_ORDER_HEADER_BILLING_CITY.Text=""
SD_ORDER_HEADER_BILLING_STATE_CODE.Text=""
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text=""
SD_ORDER_HEADER_BILLING_COUNTRY.Text=""
SD_ORDER_HEADER_BILLING_PHONE.Text=""
SD_ORDER_HEADER_BILLING_FAX.Text=""
SD_ORDER_HEADER_BILLING_EMAIL.Text=""
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.SelectedIndex=-1
SD_ORDER_HEADER_ORDER_NOTES.Text=""
SD_ORDER_HEADER_SE1.Text=""
SD_ORDER_HEADER_SE_PCT1.Text=""
SD_ORDER_HEADER_EXPORT_HOLD.Checked=False
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex=-1
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=""
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text=""
SD_ORDER_HEADER_SE2.Text=""
SD_ORDER_HEADER_SE_PCT2.Text=""
SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.Checked=False
        End If
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SALES_REP_NO SALES_REP_NO,TO_CHAR(EFFECTIVE_FROM,'MM/DD/RRRR') EFFECTIVE_FROM,TO_CHAR(EFFECTIVE_TILL,'MM/DD/RRRR') EFFECTIVE_TILL,COMMISSION_RATE COMMISSION_RATE,ROWNUM LINE_NO from ( select *  from SD_SALES_REP_BY_CUSTOMER where ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.text & "' )"
dstrucd.Clear()
dbad.Fill(dstrucd)
If (dstrucd.Tables(0).Rows.Count > 0) Then
dbgSALESREPBYSALESORDER.visible=True
dbgSALESREPBYSALESORDER.DataSource =dstrucd.Tables(0)
dbgSALESREPBYSALESORDER.DataBind()
Else
call Fill_detail_grid_dbgSALESREPBYSALESORDER()
End If
Else
call Fill_detail_grid_dbgSALESREPBYSALESORDER()
End If
 If (SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=TRUE) Then
PANEL5BILLING_ADDRESS.Visible=True
Else
PANEL5BILLING_ADDRESS.Visible=False
End If
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <>"") Then
Dim dbsqlst9 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_GET_EXPORT_HOLD('" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "') FROM DUAL"
dbsqlst9.Clear()
dbad.Fill(dbsqlst9)
if (dbsqlst9.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst9.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_EXPORT_HOLD,dbsqlst9.Tables(0).Rows(0)(0))
End If
ELSE
if (dbsqlst9.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <>"") Then
Dim dbsqlst10 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT CARRIER_ACC_NO from SD_CUSTOMER_SHIP_VIA where SHIP_VIA='"& SD_ORDER_HEADER_SHIP_VIA.TEXT &"' and ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'"
dbsqlst10.Clear()
dbad.Fill(dbsqlst10)
if (dbsqlst10.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst10.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_CARRIER_ACC_NO.Text=dbsqlst10.Tables(0).Rows(0)(0)
Else
SD_ORDER_HEADER_CARRIER_ACC_NO.Text=""
End If
ELSE
if (dbsqlst10.Tables(0).Rows.Count=0) Then
SD_ORDER_HEADER_CARRIER_ACC_NO.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <>"") Then
Dim dbsqlst11 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DEFAULT_SALES_PRICE_ZERO FROM SD_CUSTOMERS WHERE ACCOUNT_NO = '" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'"
dbsqlst11.Clear()
dbad.Fill(dbsqlst11)
if (dbsqlst11.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst11.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DEFAULT_SALES_PRICE_ZERO.Text=dbsqlst11.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst11.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
If (SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text <>"") Then
Dim dbsqlst12 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_GET_AES_HOLD('" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "') FROM DUAL"
dbsqlst12.Clear()
dbad.Fill(dbsqlst12)
if (dbsqlst12.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst12.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_AES_HOLD,dbsqlst12.Tables(0).Rows(0)(0))
End If
ELSE
if (dbsqlst12.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_CUSTOMER_NO.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep6", "setff1('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus6", "setff1('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("ORDER_ENTRY_SALES_CODE_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_ORDER_DATE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_ORDER_DATE.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds7 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_CUSTOMER_NO.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep7", "setff1('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus7", "setff1('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("ORDER_DATE_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_CUSTOMER_NO_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_CUSTOMER_NO.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds8 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <>"") Then
If (CONN.sf_execute_db_function("SF_CREDIT_DAYS_EXCEEDS('" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "')")="Y" AND CONN.SF_EXECUTE_SQL("SELECT NVL(CREDIT_HOLD_DAYS,'P') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SELECTEDITEM.VALUE & "'")="S") Then
SD_ORDER_HEADER_CUSTOMER_NO.Text=""

 Dim strFile1 As String = "slk331"
        Dim strCmd1 As String
        strCmd1 = String.Format("alert('Credit hold. Days exceeded. ');", strFile1)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN5611", strCmd1, True)
End If
End If
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <>"") Then
If (CONN.sf_execute_db_function("SF_CREDIT_DAYS_EXCEEDS('" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "')")="Y" AND CONN.SF_EXECUTE_SQL("SELECT NVL(CREDIT_HOLD_DAYS,'P') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SELECTEDITEM.VALUE & "'")="W") Then
SD_ORDER_HEADER_CUSTOMER_NO.Text=SD_ORDER_HEADER_CUSTOMER_NO.Text

 Dim strFile2 As String = "slk332"
        Dim strCmd2 As String
        strCmd2 = String.Format("alert('Credit hold. Days exceeded.');", strFile2)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN5612", strCmd2, True)
End If
End If
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <>"") Then
If (CONN.sf_execute_db_function("SF_CREDIT_DOLLAR_EXCEEDS('" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "')")="Y" AND CONN.SF_EXECUTE_SQL("SELECT NVL(CREDIT_HOLD_AMOUNT,'P') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SELECTEDITEM.VALUE & "'")="W") Then
SD_ORDER_HEADER_CUSTOMER_NO.Text=SD_ORDER_HEADER_CUSTOMER_NO.Text

 Dim strFile3 As String = "slk333"
        Dim strCmd3 As String
        strCmd3 = String.Format("alert('Credit hold Amount exceeded. ');", strFile3)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN5613", strCmd3, True)
End If
End If
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <>"") Then
If (CONN.sf_execute_db_function("SF_CREDIT_DOLLAR_EXCEEDS('" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "')")="Y" AND CONN.SF_EXECUTE_SQL("SELECT NVL(CREDIT_HOLD_AMOUNT,'P') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SELECTEDITEM.VALUE & "'")="S") Then
SD_ORDER_HEADER_CUSTOMER_NO.Text=""

 Dim strFile4 As String = "slk334"
        Dim strCmd4 As String
        strCmd4 = String.Format("alert('Credit hold Amount exceeded. ');", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN5614", strCmd4, True)
End If
End If
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <> "") Then
dbad.SelectCommand.CommandText = "Select NAME,STREET,CITY,STATE_CODE,POSTAL_CODE,COUNTRY,PHONE,FAX,EMAIL,TERMS_CODE,SHIP_VIA,FOB,PAYMENT_METHOD,DIFFERENT_BILLING_ADDRESS,BILLING_NAME,BILLING_STREET,BILLING_CITY,BILLING_STATE_CODE,BILLING_POSTAL_CODE,BILLING_COUNTRY,BILLING_PHONE,BILLING_FAX,BILLING_EMAIL,ORDER_ACK_PREFERENCE,CUSTOMER_NOTES,SE_ID,DECODE(NVL(SE_CODE,0),0,'',DECODE(NVL(SE_CODE2,0),0,'100','50')),DECODE(COUNTRY,'USA',DECODE(BILLING_COUNTRY,'USA','N','Y'),'Y'),FREIGHT_BILL_TYPE,SHIPPING_INSTRUCTIONS,THIRD_PARTY_ADDRESS,SE_ID2,DECODE(NVL(SE_CODE2,0),0,'','50'),DECODE(COUNTRY,'USA','Y','Y') from SD_CUSTOMERS where ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.text & "' AND NVL(INACTIVE,'N')='N'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc.Tables(0).Rows(0)("NAME"), System.DBNull.Value)) Then
SD_ORDER_HEADER_NAME.Text=dstruc.Tables(0).Rows(0)("NAME")
Else
SD_ORDER_HEADER_NAME.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("STREET"), System.DBNull.Value)) Then
SD_ORDER_HEADER_STREET.Text=dstruc.Tables(0).Rows(0)("STREET")
Else
SD_ORDER_HEADER_STREET.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("CITY"), System.DBNull.Value)) Then
SD_ORDER_HEADER_CITY.Text=dstruc.Tables(0).Rows(0)("CITY")
Else
SD_ORDER_HEADER_CITY.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("STATE_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_STATE_CODE.Text=dstruc.Tables(0).Rows(0)("STATE_CODE")
Else
SD_ORDER_HEADER_STATE_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("POSTAL_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_POSTAL_CODE.Text=dstruc.Tables(0).Rows(0)("POSTAL_CODE")
Else
SD_ORDER_HEADER_POSTAL_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("COUNTRY"), System.DBNull.Value)) Then
SD_ORDER_HEADER_COUNTRY.Text=dstruc.Tables(0).Rows(0)("COUNTRY")
Else
SD_ORDER_HEADER_COUNTRY.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("PHONE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_PHONE.Text=dstruc.Tables(0).Rows(0)("PHONE")
Else
SD_ORDER_HEADER_PHONE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("FAX"), System.DBNull.Value)) Then
SD_ORDER_HEADER_FAX.Text=dstruc.Tables(0).Rows(0)("FAX")
Else
SD_ORDER_HEADER_FAX.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("EMAIL"), System.DBNull.Value)) Then
SD_ORDER_HEADER_EMAIL.Text=dstruc.Tables(0).Rows(0)("EMAIL")
Else
SD_ORDER_HEADER_EMAIL.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("TERMS_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_TERMS_CODE.Text=dstruc.Tables(0).Rows(0)("TERMS_CODE")
SD_ORDER_HEADER_TERMS_CODE_TextChanged(sender,e)
Else
SD_ORDER_HEADER_TERMS_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SHIP_VIA"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIP_VIA.Text=dstruc.Tables(0).Rows(0)("SHIP_VIA")
Else
SD_ORDER_HEADER_SHIP_VIA.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("FOB"), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_FOB,dstruc.Tables(0).Rows(0)("FOB"))
Else
SD_ORDER_HEADER_FOB.SelectedIndex=-1
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("PAYMENT_METHOD"), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_PAYMENT_METHOD,dstruc.Tables(0).Rows(0)("PAYMENT_METHOD"))
Else
SD_ORDER_HEADER_PAYMENT_METHOD.SelectedIndex=-1
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("DIFFERENT_BILLING_ADDRESS"), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS,dstruc.Tables(0).Rows(0)("DIFFERENT_BILLING_ADDRESS"))
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_NAME"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_NAME.Text=dstruc.Tables(0).Rows(0)("BILLING_NAME")
Else
SD_ORDER_HEADER_BILLING_NAME.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_STREET"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_STREET.Text=dstruc.Tables(0).Rows(0)("BILLING_STREET")
Else
SD_ORDER_HEADER_BILLING_STREET.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_CITY"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_CITY.Text=dstruc.Tables(0).Rows(0)("BILLING_CITY")
Else
SD_ORDER_HEADER_BILLING_CITY.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_STATE_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_STATE_CODE.Text=dstruc.Tables(0).Rows(0)("BILLING_STATE_CODE")
Else
SD_ORDER_HEADER_BILLING_STATE_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_POSTAL_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text=dstruc.Tables(0).Rows(0)("BILLING_POSTAL_CODE")
Else
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_COUNTRY"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_COUNTRY.Text=dstruc.Tables(0).Rows(0)("BILLING_COUNTRY")
Else
SD_ORDER_HEADER_BILLING_COUNTRY.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_PHONE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_PHONE.Text=dstruc.Tables(0).Rows(0)("BILLING_PHONE")
Else
SD_ORDER_HEADER_BILLING_PHONE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_FAX"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_FAX.Text=dstruc.Tables(0).Rows(0)("BILLING_FAX")
Else
SD_ORDER_HEADER_BILLING_FAX.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("BILLING_EMAIL"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BILLING_EMAIL.Text=dstruc.Tables(0).Rows(0)("BILLING_EMAIL")
Else
SD_ORDER_HEADER_BILLING_EMAIL.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("ORDER_ACK_PREFERENCE"), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_ORDER_ACK_PREFERENCE,dstruc.Tables(0).Rows(0)("ORDER_ACK_PREFERENCE"))
Else
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.SelectedIndex=-1
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("CUSTOMER_NOTES"), System.DBNull.Value)) Then
SD_ORDER_HEADER_ORDER_NOTES.Text=dstruc.Tables(0).Rows(0)("CUSTOMER_NOTES")
Else
SD_ORDER_HEADER_ORDER_NOTES.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SE_ID"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SE1.Text=dstruc.Tables(0).Rows(0)("SE_ID")
Else
SD_ORDER_HEADER_SE1.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(NVL(SE_CODE,0),0,'',DECODE(NVL(SE_CODE2,0),0,'100','50'))"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SE_PCT1.Text=String.Format("{0:0.00}",dstruc.Tables(0).Rows(0)("DECODE(NVL(SE_CODE,0),0,'',DECODE(NVL(SE_CODE2,0),0,'100','50'))"))
Else
SD_ORDER_HEADER_SE_PCT1.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(COUNTRY,'USA',DECODE(BILLING_COUNTRY,'USA','N','Y'),'Y')"), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_EXPORT_HOLD,dstruc.Tables(0).Rows(0)("DECODE(COUNTRY,'USA',DECODE(BILLING_COUNTRY,'USA','N','Y'),'Y')"))
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("FREIGHT_BILL_TYPE"), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_FREIGHT_BILL_TYPE,dstruc.Tables(0).Rows(0)("FREIGHT_BILL_TYPE"))
Else
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex=-1
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SHIPPING_INSTRUCTIONS"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=dstruc.Tables(0).Rows(0)("SHIPPING_INSTRUCTIONS")
Else
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("THIRD_PARTY_ADDRESS"), System.DBNull.Value)) Then
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text=dstruc.Tables(0).Rows(0)("THIRD_PARTY_ADDRESS")
Else
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SE_ID2"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SE2.Text=dstruc.Tables(0).Rows(0)("SE_ID2")
Else
SD_ORDER_HEADER_SE2.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(NVL(SE_CODE2,0),0,'','50')"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SE_PCT2.Text=String.Format("{0:0.00}",dstruc.Tables(0).Rows(0)("DECODE(NVL(SE_CODE2,0),0,'','50')"))
Else
SD_ORDER_HEADER_SE_PCT2.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(COUNTRY,'USA','Y','Y')"), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS,dstruc.Tables(0).Rows(0)("DECODE(COUNTRY,'USA','Y','Y')"))
End If
Else
SD_ORDER_HEADER_NAME.Text=""
SD_ORDER_HEADER_STREET.Text=""
SD_ORDER_HEADER_CITY.Text=""
SD_ORDER_HEADER_STATE_CODE.Text=""
SD_ORDER_HEADER_POSTAL_CODE.Text=""
SD_ORDER_HEADER_COUNTRY.Text=""
SD_ORDER_HEADER_PHONE.Text=""
SD_ORDER_HEADER_FAX.Text=""
SD_ORDER_HEADER_EMAIL.Text=""
SD_ORDER_HEADER_TERMS_CODE.Text=""
SD_ORDER_HEADER_SHIP_VIA.Text=""
SD_ORDER_HEADER_FOB.SelectedIndex=-1
SD_ORDER_HEADER_PAYMENT_METHOD.SelectedIndex=-1
SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.Checked=False
SD_ORDER_HEADER_BILLING_NAME.Text=""
SD_ORDER_HEADER_BILLING_STREET.Text=""
SD_ORDER_HEADER_BILLING_CITY.Text=""
SD_ORDER_HEADER_BILLING_STATE_CODE.Text=""
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text=""
SD_ORDER_HEADER_BILLING_COUNTRY.Text=""
SD_ORDER_HEADER_BILLING_PHONE.Text=""
SD_ORDER_HEADER_BILLING_FAX.Text=""
SD_ORDER_HEADER_BILLING_EMAIL.Text=""
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.SelectedIndex=-1
SD_ORDER_HEADER_ORDER_NOTES.Text=""
SD_ORDER_HEADER_SE1.Text=""
SD_ORDER_HEADER_SE_PCT1.Text=""
SD_ORDER_HEADER_EXPORT_HOLD.Checked=False
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex=-1
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=""
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text=""
SD_ORDER_HEADER_SE2.Text=""
SD_ORDER_HEADER_SE_PCT2.Text=""
SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.Checked=False
End If
Else
SD_ORDER_HEADER_NAME.Text=""
SD_ORDER_HEADER_STREET.Text=""
SD_ORDER_HEADER_CITY.Text=""
SD_ORDER_HEADER_STATE_CODE.Text=""
SD_ORDER_HEADER_POSTAL_CODE.Text=""
SD_ORDER_HEADER_COUNTRY.Text=""
SD_ORDER_HEADER_PHONE.Text=""
SD_ORDER_HEADER_FAX.Text=""
SD_ORDER_HEADER_EMAIL.Text=""
SD_ORDER_HEADER_TERMS_CODE.Text=""
SD_ORDER_HEADER_SHIP_VIA.Text=""
SD_ORDER_HEADER_FOB.SelectedIndex=-1
SD_ORDER_HEADER_PAYMENT_METHOD.SelectedIndex=-1
SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.Checked=False
SD_ORDER_HEADER_BILLING_NAME.Text=""
SD_ORDER_HEADER_BILLING_STREET.Text=""
SD_ORDER_HEADER_BILLING_CITY.Text=""
SD_ORDER_HEADER_BILLING_STATE_CODE.Text=""
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text=""
SD_ORDER_HEADER_BILLING_COUNTRY.Text=""
SD_ORDER_HEADER_BILLING_PHONE.Text=""
SD_ORDER_HEADER_BILLING_FAX.Text=""
SD_ORDER_HEADER_BILLING_EMAIL.Text=""
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.SelectedIndex=-1
SD_ORDER_HEADER_ORDER_NOTES.Text=""
SD_ORDER_HEADER_SE1.Text=""
SD_ORDER_HEADER_SE_PCT1.Text=""
SD_ORDER_HEADER_EXPORT_HOLD.Checked=False
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex=-1
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=""
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text=""
SD_ORDER_HEADER_SE2.Text=""
SD_ORDER_HEADER_SE_PCT2.Text=""
SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.Checked=False
        End If
If SD_ORDER_HEADER_CUSTOMER_NO.Text<>"" Then
  dbad.SelectCommand.CommandText="Select ACCOUNT_NO from SD_CUSTOMERS Where  UPPER(CRM_CATEGORY)='CUSTOMER' AND NVL(INACTIVE,'N')='N' And ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "'"
Cust_ds8.Clear()
dbad.Fill(cust_ds8)
If Not(cust_ds8.Tables(0).rows.Count>0)Then
SD_ORDER_HEADER_CUSTOMER_NO.Text=""
err_message.Text = "Customer is inactive. Please select other Customer."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SALES_REP_NO SALES_REP_NO,TO_CHAR(EFFECTIVE_FROM,'MM/DD/RRRR') EFFECTIVE_FROM,TO_CHAR(EFFECTIVE_TILL,'MM/DD/RRRR') EFFECTIVE_TILL,COMMISSION_RATE COMMISSION_RATE,ROWNUM LINE_NO from ( select *  from SD_SALES_REP_BY_CUSTOMER where ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.text & "' )"
dstrucd.Clear()
dbad.Fill(dstrucd)
If (dstrucd.Tables(0).Rows.Count > 0) Then
dbgSALESREPBYSALESORDER.visible=True
dbgSALESREPBYSALESORDER.DataSource =dstrucd.Tables(0)
dbgSALESREPBYSALESORDER.DataBind()
Else
call Fill_detail_grid_dbgSALESREPBYSALESORDER()
End If
Else
call Fill_detail_grid_dbgSALESREPBYSALESORDER()
End If
 If (SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=TRUE) Then
PANEL5BILLING_ADDRESS.Visible=True
Else
PANEL5BILLING_ADDRESS.Visible=False
End If
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <>"") Then
Dim dbsqlst9 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_GET_EXPORT_HOLD('" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "') ,SF_GET_ORDER_FOB('" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "')   FROM DUAL"
dbsqlst9.Clear()
dbad.Fill(dbsqlst9)
if (dbsqlst9.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst9.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_EXPORT_HOLD,dbsqlst9.Tables(0).Rows(0)(0))
End If
If Not (Equals(dbsqlst9.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_FOB,dbsqlst9.Tables(0).Rows(0)(1))
Else
SD_ORDER_HEADER_FOB.SelectedIndex=-1
End If
ELSE
if (dbsqlst9.Tables(0).Rows.Count=0) Then
SD_ORDER_HEADER_FOB.SelectedIndex=-1
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <>"") Then
Dim dbsqlst10 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT CARRIER_ACC_NO from SD_CUSTOMER_SHIP_VIA where SHIP_VIA='"& SD_ORDER_HEADER_SHIP_VIA.TEXT &"' and ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'"
dbsqlst10.Clear()
dbad.Fill(dbsqlst10)
if (dbsqlst10.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst10.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_CARRIER_ACC_NO.Text=dbsqlst10.Tables(0).Rows(0)(0)
Else
SD_ORDER_HEADER_CARRIER_ACC_NO.Text=""
End If
ELSE
if (dbsqlst10.Tables(0).Rows.Count=0) Then
SD_ORDER_HEADER_CARRIER_ACC_NO.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
 If (SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=TRUE) Then
PANEL5SHIPPING_ADDRESS.Visible=True
LOVSHIPTO_LOV1152.Visible=True
SD_ORDER_HEADER_SHIPTO_CODE_L.Visible=True
SD_ORDER_HEADER_SHIPTO_CODE.Visible=True
Else
PANEL5SHIPPING_ADDRESS.Visible=False
LOVSHIPTO_LOV1152.Visible=False
SD_ORDER_HEADER_SHIPTO_CODE_L.Visible=False
SD_ORDER_HEADER_SHIPTO_CODE.Visible=False
End If
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <>"") Then
Dim dbsqlst12 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DEFAULT_SALES_PRICE_ZERO FROM SD_CUSTOMERS WHERE ACCOUNT_NO = '" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'"
dbsqlst12.Clear()
dbad.Fill(dbsqlst12)
if (dbsqlst12.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst12.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DEFAULT_SALES_PRICE_ZERO.Text=dbsqlst12.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst12.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <>"") Then
Dim dbsqlst13 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_GET_AES_HOLD('" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "') FROM DUAL"
dbsqlst13.Clear()
dbad.Fill(dbsqlst13)
if (dbsqlst13.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst13.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_AES_HOLD,dbsqlst13.Tables(0).Rows(0)(0))
End If
ELSE
if (dbsqlst13.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
If (SD_ORDER_HEADER_CUSTOMER_NO.Text <>"") Then
If (SD_ORDER_HEADER_SHIP_COMPLETE.CHECKED=TRUE) Then
 Dim dgItemORDERDETAIL110 As DataGridItem

For Each dgItemORDERDETAIL110 In dbgORDERDETAIL.Items

Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL110.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)

SD_ORDER_DETAIL_DUE_DATE.Enabled=False


Next


Else
 Dim dgItemORDERDETAIL110 As DataGridItem

For Each dgItemORDERDETAIL110 In dbgORDERDETAIL.Items

Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL110.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)

SD_ORDER_DETAIL_DUE_DATE.Enabled=True


Next
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_NAME.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep8", "setff1('" & SD_ORDER_HEADER_NAME.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus8", "setff1('" & SD_ORDER_HEADER_NAME.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("CUSTOMER_NO_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_DUE_DATE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_DUE_DATE.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds9 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_DUE_DATE.Text <>"") Then
If (CONN.SF_EXECUTE_SQL("SELECT SF_VALIDATE_REQ_SHIP_DATE('" & SD_ORDER_HEADER_DUE_DATE.TEXT & "')  FROM DUAL")<>0) Then
SD_ORDER_HEADER_DUE_DATE.TEXT=""
 Dim strFile0 As String = "slk330"
        Dim strCmd0 As String
        strCmd0 = String.Format("alert('Please enter valid Promised  Ship date');", strFile0)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN5610", strCmd0, True)
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_NAME.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep9", "setff1('" & SD_ORDER_HEADER_NAME.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus9", "setff1('" & SD_ORDER_HEADER_NAME.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("DUE_DATE_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_NAME_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_NAME.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds10 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_CUSTOMER_PO_NO.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep10", "setff1('" & SD_ORDER_HEADER_CUSTOMER_PO_NO.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus10", "setff1('" & SD_ORDER_HEADER_CUSTOMER_PO_NO.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("NAME_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_BLANKET_ORDER_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_BLANKET_ORDER.CheckedChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds11 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If ( check_box_r(SD_ORDER_HEADER_BLANKET_ORDER) <>"") Then
If (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE) Then
SD_ORDER_HEADER_ITEM_NO.TEXT=""
End If
End If
If (SD_ORDER_HEADER_BLANKET_ORDER.Text <> "") Then
dbad.SelectCommand.CommandText = "Select ORDERING_UOM,SALES_PRICE,SALES_PRICE_UOM from IM_ITEMS where ITEM_NO='" & SD_ORDER_HEADER_ITEM_NO.text & "'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc.Tables(0).Rows(0)("ORDERING_UOM"), System.DBNull.Value)) Then
SD_ORDER_HEADER_ORDERING_UOM.Text=dstruc.Tables(0).Rows(0)("ORDERING_UOM")
SD_ORDER_HEADER_ORDERING_UOM_TextChanged(sender,e)
Else
SD_ORDER_HEADER_ORDERING_UOM.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SALES_PRICE.Text=String.Format("{0:0.00}",dstruc.Tables(0).Rows(0)("SALES_PRICE"))
Else
SD_ORDER_HEADER_SALES_PRICE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE_UOM"), System.DBNull.Value)) Then
SD_ORDER_HEADER_PRICING_UOM.Text=dstruc.Tables(0).Rows(0)("SALES_PRICE_UOM")
SD_ORDER_HEADER_PRICING_UOM_TextChanged(sender,e)
Else
SD_ORDER_HEADER_PRICING_UOM.Text=""
End If
Else
SD_ORDER_HEADER_ORDERING_UOM.Text=""
SD_ORDER_HEADER_SALES_PRICE.Text=""
SD_ORDER_HEADER_PRICING_UOM.Text=""
End If
Else
SD_ORDER_HEADER_ORDERING_UOM.Text=""
SD_ORDER_HEADER_SALES_PRICE.Text=""
SD_ORDER_HEADER_PRICING_UOM.Text=""
        End If
If ( check_box_r(SD_ORDER_HEADER_BLANKET_ORDER) <>"") Then
If (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE) Then
SD_ORDER_HEADER_BLANKET_QTY.TEXT=""
End If
End If
If ( check_box_r(SD_ORDER_HEADER_BLANKET_ORDER) <>"") Then
If (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE) Then
SD_ORDER_HEADER_BLANKET_EFFECTIVE_FROM.TEXT=""
End If
End If
If ( check_box_r(SD_ORDER_HEADER_BLANKET_ORDER) <>"") Then
If (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE) Then
SD_ORDER_HEADER_BLANKET_EFFECTIVE_TILL.TEXT=""
End If
End If
If ( check_box_r(SD_ORDER_HEADER_BLANKET_ORDER) <>"") Then
If (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE) Then
SD_ORDER_HEADER_BLANKET_RELEASE_NO.TEXT=""
End If
End If
If ( check_box_r(SD_ORDER_HEADER_BLANKET_ORDER) <>"") Then
If (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE) Then
SD_ORDER_HEADER_BLANKET_QTY_BUOM.TEXT=""
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_CUSTOMER_PO_NO.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep11", "setff1('" & SD_ORDER_HEADER_CUSTOMER_PO_NO.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus11", "setff1('" & SD_ORDER_HEADER_CUSTOMER_PO_NO.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("BLANKET_ORDER_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_CONTACT_NAME_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_CONTACT_NAME.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds14 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_CONTACT_NAME.Text <> "") Then
dbad.SelectCommand.CommandText = "Select PHONE,EMAIL from SD_CONTACTS where PARENT_ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.text & "' AND FIRST_NAME ||' '|| LAST_NAME='" & SD_ORDER_HEADER_CONTACT_NAME.text & "'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc.Tables(0).Rows(0)("PHONE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_CONTACT_PHONE.Text=dstruc.Tables(0).Rows(0)("PHONE")
Else
SD_ORDER_HEADER_CONTACT_PHONE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("EMAIL"), System.DBNull.Value)) Then
SD_ORDER_HEADER_CONTACT_EMAIL.Text=dstruc.Tables(0).Rows(0)("EMAIL")
Else
SD_ORDER_HEADER_CONTACT_EMAIL.Text=""
End If
Else
SD_ORDER_HEADER_CONTACT_PHONE.Text=""
SD_ORDER_HEADER_CONTACT_EMAIL.Text=""
End If
Else
SD_ORDER_HEADER_CONTACT_PHONE.Text=""
SD_ORDER_HEADER_CONTACT_EMAIL.Text=""
        End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_CONTACT_PHONE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep14", "setff1('" & SD_ORDER_HEADER_CONTACT_PHONE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus14", "setff1('" & SD_ORDER_HEADER_CONTACT_PHONE.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("CONTACT_NAME_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_SHIPTO_CODE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_SHIPTO_CODE.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds21 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If SD_ORDER_HEADER_SHIPTO_CODE.Text<>"" Then
  dbad.SelectCommand.CommandText="Select SHIPTO_CODE from SD_SHIPTOS Where  PARENT_ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "' AND NVL(INACTIVE,'N')='N' And SHIPTO_CODE='" & SD_ORDER_HEADER_SHIPTO_CODE.Text & "'"
Cust_ds21.Clear()
dbad.Fill(cust_ds21)
If Not(cust_ds21.Tables(0).rows.Count>0)Then
SD_ORDER_HEADER_SHIPTO_CODE.Text=""
err_message.Text = "Please Enter Valid Shipto Code"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (SD_ORDER_HEADER_SHIPTO_CODE.Text <> "") Then
dbad.SelectCommand.CommandText = "Select NAME,STREET,CITY,STATE_CODE,POSTAL_CODE,COUNTRY,PHONE,FAX,EMAIL,SHIP_VIA,FOB,PACKING_SLIP_NOTES,DECODE(COUNTRY,'USA','N','Y') from SD_SHIPTOS where SHIPTO_CODE='" & SD_ORDER_HEADER_SHIPTO_CODE.text & "' AND PARENT_ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.text & "'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc.Tables(0).Rows(0)("NAME"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_NAME.Text=dstruc.Tables(0).Rows(0)("NAME")
Else
SD_ORDER_HEADER_SHIPPING_NAME.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("STREET"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_STREET.Text=dstruc.Tables(0).Rows(0)("STREET")
Else
SD_ORDER_HEADER_SHIPPING_STREET.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("CITY"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_CITY.Text=dstruc.Tables(0).Rows(0)("CITY")
Else
SD_ORDER_HEADER_SHIPPING_CITY.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("STATE_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_STATE_CODE.Text=dstruc.Tables(0).Rows(0)("STATE_CODE")
Else
SD_ORDER_HEADER_SHIPPING_STATE_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("POSTAL_CODE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Text=dstruc.Tables(0).Rows(0)("POSTAL_CODE")
Else
SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("COUNTRY"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_COUNTRY.Text=dstruc.Tables(0).Rows(0)("COUNTRY")
Else
SD_ORDER_HEADER_SHIPPING_COUNTRY.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("PHONE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_PHONE.Text=dstruc.Tables(0).Rows(0)("PHONE")
Else
SD_ORDER_HEADER_SHIPPING_PHONE.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("FAX"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_FAX.Text=dstruc.Tables(0).Rows(0)("FAX")
Else
SD_ORDER_HEADER_SHIPPING_FAX.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("EMAIL"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_EMAIL.Text=dstruc.Tables(0).Rows(0)("EMAIL")
Else
SD_ORDER_HEADER_SHIPPING_EMAIL.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("SHIP_VIA"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIP_VIA.Text=dstruc.Tables(0).Rows(0)("SHIP_VIA")
Else
SD_ORDER_HEADER_SHIP_VIA.Text=""
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("FOB"), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_HEADER_FOB,dstruc.Tables(0).Rows(0)("FOB"))
Else
SD_ORDER_HEADER_FOB.SelectedIndex=-1
End If
If Not (Equals(dstruc.Tables(0).Rows(0)("PACKING_SLIP_NOTES"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=dstruc.Tables(0).Rows(0)("PACKING_SLIP_NOTES")
Else
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=""
End If
Else
SD_ORDER_HEADER_SHIPPING_NAME.Text=""
SD_ORDER_HEADER_SHIPPING_STREET.Text=""
SD_ORDER_HEADER_SHIPPING_CITY.Text=""
SD_ORDER_HEADER_SHIPPING_STATE_CODE.Text=""
SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Text=""
SD_ORDER_HEADER_SHIPPING_COUNTRY.Text=""
SD_ORDER_HEADER_SHIPPING_PHONE.Text=""
SD_ORDER_HEADER_SHIPPING_FAX.Text=""
SD_ORDER_HEADER_SHIPPING_EMAIL.Text=""
SD_ORDER_HEADER_SHIP_VIA.Text=""
SD_ORDER_HEADER_FOB.SelectedIndex=-1
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=""
End If
Else
SD_ORDER_HEADER_SHIPPING_NAME.Text=""
SD_ORDER_HEADER_SHIPPING_STREET.Text=""
SD_ORDER_HEADER_SHIPPING_CITY.Text=""
SD_ORDER_HEADER_SHIPPING_STATE_CODE.Text=""
SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Text=""
SD_ORDER_HEADER_SHIPPING_COUNTRY.Text=""
SD_ORDER_HEADER_SHIPPING_PHONE.Text=""
SD_ORDER_HEADER_SHIPPING_FAX.Text=""
SD_ORDER_HEADER_SHIPPING_EMAIL.Text=""
SD_ORDER_HEADER_SHIP_VIA.Text=""
SD_ORDER_HEADER_FOB.SelectedIndex=-1
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text=""
        End If
If (SD_ORDER_HEADER_SHIPTO_CODE.Text <>"") Then
Dim dbsqlst2 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DECODE('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.TEXT &"','USA','N','Y')FROM DUAL"
dbsqlst2.Clear()
dbad.Fill(dbsqlst2)
if (dbsqlst2.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_EXPORT_HOLD,dbsqlst2.Tables(0).Rows(0)(0))
End If
ELSE
if (dbsqlst2.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep21", "setff1('" & SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus21", "setff1('" & SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("SHIPTO_CODE_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CheckedChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds24 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
 If (SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=TRUE) Then
PANEL5BILLING_ADDRESS.Visible=True
Else
PANEL5BILLING_ADDRESS.Visible=False
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_HOLD.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep24", "setff1('" & SD_ORDER_HEADER_HOLD.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus24", "setff1('" & SD_ORDER_HEADER_HOLD.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("DIFFERENT_BILLING_ADDRESS_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_SHIP_COMPLETE_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_SHIP_COMPLETE.CheckedChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds28 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If ( check_box_r(SD_ORDER_HEADER_SHIP_COMPLETE) <>"") Then
If (SD_ORDER_HEADER_SHIP_COMPLETE.CHECKED=TRUE) Then
 Dim dgItemORDERDETAIL110 As DataGridItem

For Each dgItemORDERDETAIL110 In dbgORDERDETAIL.Items

Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL110.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)

SD_ORDER_DETAIL_DUE_DATE.Enabled=False


Next


Else
 Dim dgItemORDERDETAIL110 As DataGridItem

For Each dgItemORDERDETAIL110 In dbgORDERDETAIL.Items

Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL110.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)

SD_ORDER_DETAIL_DUE_DATE.Enabled=True


Next
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_INTERNAL_NOTES.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep28", "setff1('" & SD_ORDER_HEADER_INTERNAL_NOTES.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus28", "setff1('" & SD_ORDER_HEADER_INTERNAL_NOTES.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("SHIP_COMPLETE_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_TERMS_CODE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_TERMS_CODE.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds34 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_TERMS_CODE.Text <>"") Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(1) FROM GE_TERMS_CODES WHERE UPPER(TERMS_CODE)=UPPER(TRIM('" & SD_ORDER_HEADER_TERMS_CODE.TEXT & "')) AND INACTIVE='N'")=0) Then
SD_ORDER_HEADER_TERMS_CODE.TEXT = ""
err_message.Text = "Please Enter Valid Terms Code"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (SD_ORDER_HEADER_TERMS_CODE.Text <>"") Then
Dim dbsqlst1 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DESCRIPTION FROM GE_TERMS_CODES WHERE UPPER(TERMS_CODE) = UPPER(TRIM('" & SD_ORDER_HEADER_TERMS_CODE.TEXT & "'))"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DESCRIPTION.Text=dbsqlst1.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
If (SD_ORDER_HEADER_TERMS_CODE.Text <> "") Then
dbad.SelectCommand.CommandText = "Select ADVANCE_PERCENTAGE from GE_TERMS_CODES where TERMS_CODE ='" & SD_ORDER_HEADER_TERMS_CODE.TEXT & "' "
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc.Tables(0).Rows(0)("ADVANCE_PERCENTAGE"), System.DBNull.Value)) Then
SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Text=String.Format("{0:0.00}",dstruc.Tables(0).Rows(0)("ADVANCE_PERCENTAGE"))
Else
SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Text=""
End If
Else
SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Text=""
End If
Else
SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Text=""
        End If
If (SD_ORDER_HEADER_TERMS_CODE.Text <> "") Then
dbad.SelectCommand.CommandText = "Select STAGE STAGE,BILLING_PERCENTAGE BILLING_PERCENTAGE,'' READY_FOR_INOVICE_DATE,'' APPROVED_FOR_INOVICE,LINE_NO LINE_NO from ( select *  from GE_TERMS_CODES_DETAILS where terms_code ='" & SD_ORDER_HEADER_TERMS_CODE.TEXT & "' ORDER BY LINE_NO)"
dstrucd.Clear()
dbad.Fill(dstrucd)
If (dstrucd.Tables(0).Rows.Count > 0) Then
dbgBILLING_STAGE.visible=True
dbgBILLING_STAGE.DataSource =dstrucd.Tables(0)
dbgBILLING_STAGE.DataBind()
Else
call Fill_detail_grid_dbgBILLING_STAGE()
End If
Else
call Fill_detail_grid_dbgBILLING_STAGE()
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_SHIP_VIA.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep34", "setff1('" & SD_ORDER_HEADER_SHIP_VIA.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus34", "setff1('" & SD_ORDER_HEADER_SHIP_VIA.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("TERMS_CODE_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_SHIP_VIA_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_SHIP_VIA.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds35 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_SHIP_VIA.Text <>"") Then
Dim dbsqlst0 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT CARRIER_ACC_NO from SD_CUSTOMER_SHIP_VIA where SHIP_VIA='"& SD_ORDER_HEADER_SHIP_VIA.TEXT &"' and ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'"
dbsqlst0.Clear()
dbad.Fill(dbsqlst0)
if (dbsqlst0.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst0.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_CARRIER_ACC_NO.Text=dbsqlst0.Tables(0).Rows(0)(0)
Else
SD_ORDER_HEADER_CARRIER_ACC_NO.Text=""
End If
ELSE
if (dbsqlst0.Tables(0).Rows.Count=0) Then
SD_ORDER_HEADER_CARRIER_ACC_NO.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_FOB.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep35", "setff1('" & SD_ORDER_HEADER_FOB.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus35", "setff1('" & SD_ORDER_HEADER_FOB.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("SHIP_VIA_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_COUNTRY_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_COUNTRY.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds50 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_COUNTRY.Text <>"") Then
Dim dbsqlst0 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DECODE(' " & SD_ORDER_HEADER_BILLING_COUNTRY.TEXT & "','USA','N','Y') FROM DUAL"
dbsqlst0.Clear()
dbad.Fill(dbsqlst0)
if (dbsqlst0.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst0.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_EXPORT_HOLD,dbsqlst0.Tables(0).Rows(0)(0))
End If
ELSE
if (dbsqlst0.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
If SD_ORDER_HEADER_COUNTRY.Text<>"" Then
  dbad.SelectCommand.CommandText="Select COUNTRY from GE_COUNTRY_CODES Where COUNTRY='" & SD_ORDER_HEADER_COUNTRY.Text & "'"
Cust_ds50.Clear()
dbad.Fill(cust_ds50)
If Not(cust_ds50.Tables(0).rows.Count>0)Then
SD_ORDER_HEADER_COUNTRY.Text=""
err_message.Text = "Please Enter Valid Country"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_FREIGHT_BILLING_NAME.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep50", "setff1('" & SD_ORDER_HEADER_FREIGHT_BILLING_NAME.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus50", "setff1('" & SD_ORDER_HEADER_FREIGHT_BILLING_NAME.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("COUNTRY_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds60 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.Text<>"" Then
  dbad.SelectCommand.CommandText="Select COUNTRY from GE_COUNTRY_CODES Where COUNTRY='" & SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.Text & "'"
Cust_ds60.Clear()
dbad.Fill(cust_ds60)
If Not(cust_ds60.Tables(0).rows.Count>0)Then
SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.Text=""
err_message.Text = "Please Enter Valid Freight Billing Country"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_SHIPPING_NAME.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep60", "setff1('" & SD_ORDER_HEADER_SHIPPING_NAME.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus60", "setff1('" & SD_ORDER_HEADER_SHIPPING_NAME.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("FREIGHT_BILLING_COUNTRY_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_SHIPPING_COUNTRY_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_SHIPPING_COUNTRY.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds70 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If SD_ORDER_HEADER_SHIPPING_COUNTRY.Text<>"" Then
  dbad.SelectCommand.CommandText="Select COUNTRY from GE_COUNTRY_CODES Where COUNTRY='" & SD_ORDER_HEADER_SHIPPING_COUNTRY.Text & "'"
Cust_ds70.Clear()
dbad.Fill(cust_ds70)
If Not(cust_ds70.Tables(0).rows.Count>0)Then
SD_ORDER_HEADER_SHIPPING_COUNTRY.Text=""
err_message.Text = "Please Enter Valid Shipping Country"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (SD_ORDER_HEADER_SHIPPING_COUNTRY.Text <>"") Then
Dim dbsqlst1 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DECODE('" & SD_ORDER_HEADER_SHIPPING_COUNTRY.TEXT &"','USA','N','Y')FROM DUAL"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_EXPORT_HOLD,dbsqlst1.Tables(0).Rows(0)(0))
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_BILLING_NAME.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep70", "setff1('" & SD_ORDER_HEADER_BILLING_NAME.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus70", "setff1('" & SD_ORDER_HEADER_BILLING_NAME.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("SHIPPING_COUNTRY_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_BILLING_COUNTRY_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_BILLING_COUNTRY.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds80 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_BILLING_COUNTRY.Text <>"") Then
Dim dbsqlst0 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DECODE(' " & SD_ORDER_HEADER_BILLING_COUNTRY.TEXT & "','USA','N','Y') FROM DUAL"
dbsqlst0.Clear()
dbad.Fill(dbsqlst0)
if (dbsqlst0.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst0.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_HEADER_EXPORT_HOLD,dbsqlst0.Tables(0).Rows(0)(0))
End If
ELSE
if (dbsqlst0.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
If SD_ORDER_HEADER_BILLING_COUNTRY.Text<>"" Then
  dbad.SelectCommand.CommandText="Select COUNTRY from GE_COUNTRY_CODES Where COUNTRY='" & SD_ORDER_HEADER_BILLING_COUNTRY.Text & "'"
Cust_ds80.Clear()
dbad.Fill(cust_ds80)
If Not(cust_ds80.Tables(0).rows.Count>0)Then
SD_ORDER_HEADER_BILLING_COUNTRY.Text=""
err_message.Text = "Please Enter Valid Billing Country"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_ITEM_NO.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep80", "setff1('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus80", "setff1('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("BILLING_COUNTRY_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_ITEM_NO_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_ITEM_NO.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds81 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
SD_ORDER_HEADER_ITEM_NO.Text=Ucase(SD_ORDER_HEADER_ITEM_NO.Text)
If SD_ORDER_HEADER_ITEM_NO.Text<>"" Then
  dbad.SelectCommand.CommandText="Select ITEM_NO from IM_ITEMS Where  nvl(INACTIVE,'Y')='N' And ITEM_NO='" & SD_ORDER_HEADER_ITEM_NO.Text & "'"
Cust_ds81.Clear()
dbad.Fill(cust_ds81)
If Not(cust_ds81.Tables(0).rows.Count>0)Then
SD_ORDER_HEADER_ITEM_NO.Text=""
err_message.Text = "<b>Please select valid Item No</b>"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (SD_ORDER_HEADER_ITEM_NO.Text <>"") Then
Dim dbsqlst2 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT ORDERING_UOM,PURCHASE_COST,PURCHASE_PRICE_UOM FROM IM_ITEMS WHERE ITEM_NO='" & SD_ORDER_HEADER_ITEM_NO.TEXT & "'"
dbsqlst2.Clear()
dbad.Fill(dbsqlst2)
if (dbsqlst2.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_ORDERING_UOM.Text=dbsqlst2.Tables(0).Rows(0)(0)
Else
SD_ORDER_HEADER_ORDERING_UOM.Text=""
End If
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_ORDER_HEADER_SALES_PRICE.Text=String.Format("{0:0.00}",dbsqlst2.Tables(0).Rows(0)(1))
Else
SD_ORDER_HEADER_SALES_PRICE.Text=""
End If
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(2), System.DBNull.Value)) Then
SD_ORDER_HEADER_PRICING_UOM.Text=dbsqlst2.Tables(0).Rows(0)(2)
Else
SD_ORDER_HEADER_PRICING_UOM.Text=""
End If
ELSE
if (dbsqlst2.Tables(0).Rows.Count=0) Then
SD_ORDER_HEADER_ORDERING_UOM.Text=""
SD_ORDER_HEADER_SALES_PRICE.Text=""
SD_ORDER_HEADER_PRICING_UOM.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_BLANKET_QTY.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep81", "setff1('" & SD_ORDER_HEADER_BLANKET_QTY.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus81", "setff1('" & SD_ORDER_HEADER_BLANKET_QTY.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("ITEM_NO_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_BLANKET_QTY_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_BLANKET_QTY.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds82 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
dbad.SelectCommand.CommandText = "Select SF_CALC_QTY_BASE_UOM('" & SD_ORDER_HEADER_ITEM_NO.TEXT & "',NULL,'" & SD_ORDER_HEADER_ORDERING_UOM.TEXT & "','" & SD_ORDER_HEADER_BLANKET_QTY.TEXT & "') fval0 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("fval0"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BLANKET_QTY_BUOM.Text=dstruc_1.Tables(0).Rows(0)("fval0")
Else
SD_ORDER_HEADER_BLANKET_QTY_BUOM.Text=""
End If
End If
dbad.SelectCommand.CommandText = "Select PKG_MATERIAL_PRICING.SF_GET_SALES_PRICE('" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_HEADER_ITEM_NO.TEXT & "','" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "','" & SD_ORDER_HEADER_BLANKET_QTY_BUOM.TEXT & "','N') fval1 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("fval1"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SALES_PRICE.Text=dstruc_1.Tables(0).Rows(0)("fval1")
Else
SD_ORDER_HEADER_SALES_PRICE.Text=""
End If
End If
dbad.SelectCommand.CommandText = "Select PKG_MATERIAL_PRICING.SF_GET_SALES_UOM('" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_HEADER_ITEM_NO.TEXT & "','" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "','" & SD_ORDER_HEADER_BLANKET_QTY_BUOM.TEXT & "','N') fval2 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("fval2"), System.DBNull.Value)) Then
SD_ORDER_HEADER_PRICING_UOM.Text=dstruc_1.Tables(0).Rows(0)("fval2")
Else
SD_ORDER_HEADER_PRICING_UOM.Text=""
End If
End If
If (SD_ORDER_HEADER_BLANKET_QTY.Text <>"") Then
Dim dbsqlst3 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_GET_BLANKET_BAL_QTY('SO','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & CHECK_BOX_R(SD_ORDER_HEADER_BLANKET_ORDER) & "') FROM DUAL"
dbsqlst3.Clear()
dbad.Fill(dbsqlst3)
if (dbsqlst3.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst3.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
BL_BAL_QTY.Text=dbsqlst3.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst3.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_ORDERING_UOM.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep82", "setff1('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus82", "setff1('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("BLANKET_QTY_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_ORDERING_UOM_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_ORDERING_UOM.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds83 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
SD_ORDER_HEADER_ORDERING_UOM.Text=Ucase(SD_ORDER_HEADER_ORDERING_UOM.Text)
If SD_ORDER_HEADER_ORDERING_UOM.Text<>"" Then
  dbad.SelectCommand.CommandText="Select CONV_UOM from V_UOM_CONVERTION Where  NVL(ITEM_NO,'@#') = NVL('" & SD_ORDER_HEADER_ITEM_NO.TEXT & "','@#') And CONV_UOM='" & SD_ORDER_HEADER_ORDERING_UOM.Text & "'"
Cust_ds83.Clear()
dbad.Fill(cust_ds83)
If Not(cust_ds83.Tables(0).rows.Count>0)Then
SD_ORDER_HEADER_ORDERING_UOM.Text=""
err_message.Text = "Please select valid Ordering UOM"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
dbad.SelectCommand.CommandText = "Select SF_CALC_QTY_BASE_UOM('" & SD_ORDER_HEADER_ITEM_NO.TEXT & "',NULL,'" & SD_ORDER_HEADER_ORDERING_UOM.TEXT & "','" & SD_ORDER_HEADER_BLANKET_QTY.TEXT & "') fval2 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("fval2"), System.DBNull.Value)) Then
SD_ORDER_HEADER_BLANKET_QTY_BUOM.Text=dstruc_1.Tables(0).Rows(0)("fval2")
Else
SD_ORDER_HEADER_BLANKET_QTY_BUOM.Text=""
End If
End If
dbad.SelectCommand.CommandText = "Select PKG_MATERIAL_PRICING.SF_GET_SALES_PRICE('" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_HEADER_ITEM_NO.TEXT & "','" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "','" & SD_ORDER_HEADER_BLANKET_QTY_BUOM.TEXT & "','N') fval3 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("fval3"), System.DBNull.Value)) Then
SD_ORDER_HEADER_SALES_PRICE.Text=dstruc_1.Tables(0).Rows(0)("fval3")
Else
SD_ORDER_HEADER_SALES_PRICE.Text=""
End If
End If
dbad.SelectCommand.CommandText = "Select PKG_MATERIAL_PRICING.SF_GET_SALES_UOM('" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_HEADER_ITEM_NO.TEXT & "','" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "','" & SD_ORDER_HEADER_BLANKET_QTY_BUOM.TEXT & "','N') fval4 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("fval4"), System.DBNull.Value)) Then
SD_ORDER_HEADER_PRICING_UOM.Text=dstruc_1.Tables(0).Rows(0)("fval4")
Else
SD_ORDER_HEADER_PRICING_UOM.Text=""
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep83", "setff1('" & SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus83", "setff1('" & SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("ORDERING_UOM_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_PRICING_UOM_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_PRICING_UOM.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds87 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
SD_ORDER_HEADER_PRICING_UOM.Text=Ucase(SD_ORDER_HEADER_PRICING_UOM.Text)
If SD_ORDER_HEADER_PRICING_UOM.Text<>"" Then
  dbad.SelectCommand.CommandText="Select CONV_UOM from V_UOM_CONVERTION Where  NVL(ITEM_NO,'@#') = NVL('" & SD_ORDER_HEADER_ITEM_NO.TEXT & "','@#') And CONV_UOM='" & SD_ORDER_HEADER_PRICING_UOM.Text & "'"
Cust_ds87.Clear()
dbad.Fill(cust_ds87)
If Not(cust_ds87.Tables(0).rows.Count>0)Then
SD_ORDER_HEADER_PRICING_UOM.Text=""
err_message.Text = "Please select valid Price UOM"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_BLANKET_EFFECTIVE_FROM.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep87", "setff1('" & SD_ORDER_HEADER_BLANKET_EFFECTIVE_FROM.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus87", "setff1('" & SD_ORDER_HEADER_BLANKET_EFFECTIVE_FROM.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("PRICING_UOM_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_SE1_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_SE1.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds99 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_SE1.Text <>"") Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(1) FROM V_SE_BRANCHES_DETAIL WHERE SE_ID='" & SD_ORDER_HEADER_SE1.TEXT & "' ")=0) Then
SD_ORDER_HEADER_SE1.TEXT = ""
err_message.Text = "Please Enter Valid SE Code1"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (SD_ORDER_HEADER_SE1.Text <>"") Then
Dim dbsqlst1 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  SE_CODE|| ' - '||SE_NAME||'  /  '||BRANCH_CODE||' - '||BRANCH_NAME FROM GE_SE_BRANCHES WHERE SE_ID='" & SD_ORDER_HEADER_SE1.TEXT & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DISP_SE_CODE1.Text=dbsqlst1.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "Please Enter Valid SE Code1"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_SE_PCT1.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep99", "setff1('" & SD_ORDER_HEADER_SE_PCT1.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus99", "setff1('" & SD_ORDER_HEADER_SE_PCT1.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("SE1_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_SE2_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_SE2.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds100 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_SE2.Text <>"") Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(1) FROM V_SE_BRANCHES_DETAIL WHERE SE_ID='" & SD_ORDER_HEADER_SE2.TEXT & "' ")=0) Then
SD_ORDER_HEADER_SE2.TEXT = ""
err_message.Text = "Please Enter Valid SE Code2"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (SD_ORDER_HEADER_SE2.Text <>"") Then
Dim dbsqlst1 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  SE_CODE||' - '||SE_NAME||'  /  '||BRANCH_CODE||' - '||BRANCH_NAME FROM GE_SE_BRANCHES WHERE SE_ID='" & SD_ORDER_HEADER_SE2.TEXT & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DISP_SE_CODE2.Text=dbsqlst1.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "Please Enter Valid SE Code1"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_SE_PCT2.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep100", "setff1('" & SD_ORDER_HEADER_SE_PCT2.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus100", "setff1('" & SD_ORDER_HEADER_SE_PCT2.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("SE2_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_SE3_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_SE3.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds103 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_SE3.Text <>"") Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(1) FROM V_SE_BRANCHES_DETAIL WHERE SE_ID='" & SD_ORDER_HEADER_SE3.TEXT & "' ")=0) Then
SD_ORDER_HEADER_SE3.TEXT = ""
err_message.Text = "Please Enter Valid SE Code3"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (SD_ORDER_HEADER_SE3.Text <>"") Then
Dim dbsqlst1 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  SE_CODE||' - '||SE_NAME||'  /  '||BRANCH_CODE||' - '||BRANCH_NAME FROM GE_SE_BRANCHES WHERE SE_ID='" & SD_ORDER_HEADER_SE3.TEXT & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DISP_SE_CODE3.Text=dbsqlst1.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "Please Enter Valid SE Code1"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_SE_PCT3.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep103", "setff1('" & SD_ORDER_HEADER_SE_PCT3.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus103", "setff1('" & SD_ORDER_HEADER_SE_PCT3.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("SE3_Event",ex.Message)
End Try
End Sub
Protected Sub SD_ORDER_HEADER_SE4_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles SD_ORDER_HEADER_SE4.TextChanged
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dstruc, dstruc1 As New Data.DataSet
Dim dstrucd, dstrucd1 As New Data.DataSet
Dim cust_ds104 As New Data.DataSet
Dim dstruc_1 as new Data.DataSet
If (SD_ORDER_HEADER_SE4.Text <>"") Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(1) FROM V_SE_BRANCHES_DETAIL WHERE SE_ID='" & SD_ORDER_HEADER_SE4.TEXT & "' ")=0) Then
SD_ORDER_HEADER_SE4.TEXT = ""
err_message.Text = "Please Enter Valid SE Code4"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (SD_ORDER_HEADER_SE4.Text <>"") Then
Dim dbsqlst1 as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SE_CODE||' - '||SE_NAME||'  /  '||BRANCH_CODE||' - '||BRANCH_NAME FROM GE_SE_BRANCHES WHERE SE_ID='" & SD_ORDER_HEADER_SE4.TEXT & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DISP_SE_CODE4.Text=dbsqlst1.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "Please Enter Valid SE Code1"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
End If 
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_SE_PCT4.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Savep104", "setff1('" & SD_ORDER_HEADER_SE_PCT4.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus104", "setff1('" & SD_ORDER_HEADER_SE_PCT4.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("SE4_Event",ex.Message)
End Try
End Sub
Public Sub fill_header_info()
Try
SD_ORDER_HEADER_ORDER_NO.Text=Trim(SD_ORDER_HEADER_ORDER_NO.Text)
TabPanel0_lbl.Text=SD_ORDER_HEADER_ORDER_NO.Text
dbad.SelectCommand.Connection = Session("db_connection")
call conn.call_before_retrive("SALES_ORDER", session("user_id"),Request.QueryString.Get("mid"),Request.QueryString.Get("sssid"), Session.SessionID,"SD_ORDERS_SEARCH","ORDER_NO",SD_ORDER_HEADER_ORDER_NO.Text)
ORDER_STATUS.TEXT=""
DESCRIPTION.TEXT=""
BL_BAL_QTY.TEXT=""
DISP_SE_CODE1.TEXT=""
DISP_SE_CODE2.TEXT=""
DISP_SE_CODE3.TEXT=""
DISP_SE_CODE4.TEXT=""
DEFAULT_SALES_PRICE_ZERO.TEXT=""
        Dim dsf As New Data.DataSet
   If (SD_ORDER_HEADER_ORDER_NO.Text <>"" ) Then
Dim sender As Object
Dim e As System.EventArgs
            Dim dbpage_acess As New Data.DataSet
            Dim aclevel As Integer
            aclevel = 4
Try
            dbad.SelectCommand.CommandText = "select ACCESS_LEVEL from VS_USER_ACCESS_LEVEL where USER_ID='" & UCase(Session("User_id")) & "' and  MENU_FILE_NAME='SALES_ORDER.ASPX' and ACCESS_LEVEL is not null"
            dbpage_acess.Clear()
            dbad.Fill(dbpage_acess)
            If (dbpage_acess.Tables(0).Rows.Count > 0) Then
                aclevel = dbpage_acess.Tables(0).Rows(0)("ACCESS_LEVEL")
            End If
Catch ex As Exception
End Try
 If (aclevel = 3) Then
Save.Visible=False
End If
Dim dwhere1_1 As String
dwhere1_1 = return_default_where()
      If (dwhere1_1 <> "") Then
	      dbad.SelectCommand.CommandText = "select  ORDER_NO,INPROCESS_MESSAGE,FLS_ORDER_NO,AFFINITY_NO,BUSINESS_UNIT_CODE, to_char(REQUESTED_DATE,'MM/DD/RRRR') REQUESTED_DATE ,ORDER_ENTRY_SALES_CODE, to_char(ORDER_DATE,'MM/DD/RRRR') ORDER_DATE ,CUSTOMER_NO, to_char(DUE_DATE,'MM/DD/RRRR') DUE_DATE ,NAME,BLANKET_ORDER,CUSTOMER_PO_NO, to_char(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE ,CONTACT_NAME,INVOICE_BY,ADVANCE_PERCENTAGE,CONTACT_PHONE,ADVANCE_AMOUNT,CONTACT_EMAIL,DIFFERENT_SHIPPING_ADDRESS,SHIPTO_CODE, to_char(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE ,ORDER_ACK_PREFERENCE,DIFFERENT_BILLING_ADDRESS,ULTIMATE_CONSIGNMENT,HOLD,EXPORT_HOLD,SHIP_COMPLETE,INTERNAL_NOTES,ORDER_NOTES,SHIPPING_INSTRUCTIONS,CUSTOMER_MESSAGE,SHIP_TO_PO_REFERENCE,TERMS_CODE,SHIP_VIA,CARRIER_ACC_NO,FOB,PAYMENT_METHOD,CONVERSION_CURRENCY_CODE,BASE_CURRENCY_CODE,NO_OF_UNITS_OF_BASE_CURRENCY,NO_OF_UNITS_OF_CONVERSION_CURR,STREET,CITY,PHONE,FAX,STATE_CODE,EMAIL,POSTAL_CODE,COUNTRY,FREIGHT_BILLING_CONTACT_NAME,FREIGHT_BILLING_NAME,FREIGHT_BILLING_STREET,FREIGHT_BILLING_CITY,FREIGHT_BILLING_PHONE,FREIGHT_BILLING_FAX,FREIGHT_BILLING_STATE_CODE,FREIGHT_BILLING_EMAIL,FREIGHT_BILLING_POSTAL_CODE,FREIGHT_BILLING_COUNTRY,SHIPPING_CONTACT_NAME,SHIPPING_NAME,SHIPPING_STREET,SHIPPING_CITY,SHIPPING_PHONE,SHIPPING_FAX,SHIPPING_STATE_CODE,SHIPPING_EMAIL,SHIPPING_POSTAL_CODE,SHIPPING_COUNTRY,BILLING_CONTACT_NAME,BILLING_NAME,BILLING_STREET,BILLING_CITY,BILLING_PHONE,BILLING_FAX,BILLING_STATE_CODE,BILLING_EMAIL,BILLING_POSTAL_CODE,BILLING_COUNTRY,ITEM_NO,BLANKET_QTY,ORDERING_UOM,BLANKET_QTY_BUOM,PRICE_FROM_PRICING_INFO,SALES_PRICE,PRICING_UOM, to_char(BLANKET_EFFECTIVE_FROM,'MM/DD/RRRR') BLANKET_EFFECTIVE_FROM , to_char(BLANKET_EFFECTIVE_TILL,'MM/DD/RRRR') BLANKET_EFFECTIVE_TILL ,BLANKET_RELEASE_NO,BALANCE_QTY_LINE,ATEX_HOLD, to_char(EST_EXPORT_CLEARANCE_DATE,'MM/DD/RRRR') EST_EXPORT_CLEARANCE_DATE ,QUOTATION_NO, to_char(CLOSE_DATE,'MM/DD/RRRR') CLOSE_DATE ,FREIGHT_BILL_TYPE, to_char(CANCEL_DATE,'MM/DD/RRRR') CANCEL_DATE ,THIRD_PARTY_ADDRESS,SE1,SE2,SE_PCT1,SE_PCT2,SE3,SE4,SE_PCT3,SE_PCT4,LICENSE_APPLICATION_REF,QUICK_SHIP,AES_HOLD,NONAG,PULL_INVENTORY_FROM_QRC,INCOTERMS_LOCATION,WEB_ORDER_NO,QRC_LOCATION,WEB_ORDER_CREATED_BY,INPROCESS,DO_NOT_SERVICE,SUGGESTED_DATE from SD_ORDER_HEADER where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' And " & dwhere1_1
      Else
	      dbad.SelectCommand.CommandText = "select  ORDER_NO,INPROCESS_MESSAGE,FLS_ORDER_NO,AFFINITY_NO,BUSINESS_UNIT_CODE, to_char(REQUESTED_DATE,'MM/DD/RRRR') REQUESTED_DATE ,ORDER_ENTRY_SALES_CODE, to_char(ORDER_DATE,'MM/DD/RRRR') ORDER_DATE ,CUSTOMER_NO, to_char(DUE_DATE,'MM/DD/RRRR') DUE_DATE ,NAME,BLANKET_ORDER,CUSTOMER_PO_NO, to_char(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE ,CONTACT_NAME,INVOICE_BY,ADVANCE_PERCENTAGE,CONTACT_PHONE,ADVANCE_AMOUNT,CONTACT_EMAIL,DIFFERENT_SHIPPING_ADDRESS,SHIPTO_CODE, to_char(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE ,ORDER_ACK_PREFERENCE,DIFFERENT_BILLING_ADDRESS,ULTIMATE_CONSIGNMENT,HOLD,EXPORT_HOLD,SHIP_COMPLETE,INTERNAL_NOTES,ORDER_NOTES,SHIPPING_INSTRUCTIONS,CUSTOMER_MESSAGE,SHIP_TO_PO_REFERENCE,TERMS_CODE,SHIP_VIA,CARRIER_ACC_NO,FOB,PAYMENT_METHOD,CONVERSION_CURRENCY_CODE,BASE_CURRENCY_CODE,NO_OF_UNITS_OF_BASE_CURRENCY,NO_OF_UNITS_OF_CONVERSION_CURR,STREET,CITY,PHONE,FAX,STATE_CODE,EMAIL,POSTAL_CODE,COUNTRY,FREIGHT_BILLING_CONTACT_NAME,FREIGHT_BILLING_NAME,FREIGHT_BILLING_STREET,FREIGHT_BILLING_CITY,FREIGHT_BILLING_PHONE,FREIGHT_BILLING_FAX,FREIGHT_BILLING_STATE_CODE,FREIGHT_BILLING_EMAIL,FREIGHT_BILLING_POSTAL_CODE,FREIGHT_BILLING_COUNTRY,SHIPPING_CONTACT_NAME,SHIPPING_NAME,SHIPPING_STREET,SHIPPING_CITY,SHIPPING_PHONE,SHIPPING_FAX,SHIPPING_STATE_CODE,SHIPPING_EMAIL,SHIPPING_POSTAL_CODE,SHIPPING_COUNTRY,BILLING_CONTACT_NAME,BILLING_NAME,BILLING_STREET,BILLING_CITY,BILLING_PHONE,BILLING_FAX,BILLING_STATE_CODE,BILLING_EMAIL,BILLING_POSTAL_CODE,BILLING_COUNTRY,ITEM_NO,BLANKET_QTY,ORDERING_UOM,BLANKET_QTY_BUOM,PRICE_FROM_PRICING_INFO,SALES_PRICE,PRICING_UOM, to_char(BLANKET_EFFECTIVE_FROM,'MM/DD/RRRR') BLANKET_EFFECTIVE_FROM , to_char(BLANKET_EFFECTIVE_TILL,'MM/DD/RRRR') BLANKET_EFFECTIVE_TILL ,BLANKET_RELEASE_NO,BALANCE_QTY_LINE,ATEX_HOLD, to_char(EST_EXPORT_CLEARANCE_DATE,'MM/DD/RRRR') EST_EXPORT_CLEARANCE_DATE ,QUOTATION_NO, to_char(CLOSE_DATE,'MM/DD/RRRR') CLOSE_DATE ,FREIGHT_BILL_TYPE, to_char(CANCEL_DATE,'MM/DD/RRRR') CANCEL_DATE ,THIRD_PARTY_ADDRESS,SE1,SE2,SE_PCT1,SE_PCT2,SE3,SE4,SE_PCT3,SE_PCT4,LICENSE_APPLICATION_REF,QUICK_SHIP,AES_HOLD,NONAG,PULL_INVENTORY_FROM_QRC,INCOTERMS_LOCATION,WEB_ORDER_NO,QRC_LOCATION,WEB_ORDER_CREATED_BY,INPROCESS,DO_NOT_SERVICE,SUGGESTED_DATE from SD_ORDER_HEADER where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
      End If
        dsf.Clear()
        dbad.Fill(dsf)
        If (dsf.Tables(0).Rows.Count > 0) Then
session("SALES_ORDER_new_record")="N"
Call Copy1_imp()
            If Not (Equals(dsf.Tables(0).Rows(0)("ORDER_NO"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_ORDER_NO.Text = dsf.Tables(0).Rows(0)("ORDER_NO")
Else
                SD_ORDER_HEADER_ORDER_NO.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("INPROCESS_MESSAGE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_INPROCESS_MESSAGE.Text = dsf.Tables(0).Rows(0)("INPROCESS_MESSAGE")
Else
                SD_ORDER_HEADER_INPROCESS_MESSAGE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FLS_ORDER_NO"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FLS_ORDER_NO.Text = dsf.Tables(0).Rows(0)("FLS_ORDER_NO")
Else
                SD_ORDER_HEADER_FLS_ORDER_NO.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("AFFINITY_NO"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_AFFINITY_NO.Text = dsf.Tables(0).Rows(0)("AFFINITY_NO")
Else
                SD_ORDER_HEADER_AFFINITY_NO.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BUSINESS_UNIT_CODE"), System.DBNull.Value)) Then
              dropdown_list_r1(SD_ORDER_HEADER_BUSINESS_UNIT_CODE, dsf.Tables(0).Rows(0)("BUSINESS_UNIT_CODE"))
Else
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SelectedIndex = -1
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("REQUESTED_DATE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_REQUESTED_DATE.Text = dsf.Tables(0).Rows(0)("REQUESTED_DATE")
Else
                SD_ORDER_HEADER_REQUESTED_DATE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ORDER_ENTRY_SALES_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text = dsf.Tables(0).Rows(0)("ORDER_ENTRY_SALES_CODE")
Else
                SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ORDER_DATE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_ORDER_DATE.Text = dsf.Tables(0).Rows(0)("ORDER_DATE")
Else
                SD_ORDER_HEADER_ORDER_DATE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CUSTOMER_NO"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CUSTOMER_NO.Text = dsf.Tables(0).Rows(0)("CUSTOMER_NO")
Else
                SD_ORDER_HEADER_CUSTOMER_NO.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("DUE_DATE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_DUE_DATE.Text = dsf.Tables(0).Rows(0)("DUE_DATE")
Else
                SD_ORDER_HEADER_DUE_DATE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("NAME"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_NAME.Text = dsf.Tables(0).Rows(0)("NAME")
Else
                SD_ORDER_HEADER_NAME.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BLANKET_ORDER"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_BLANKET_ORDER, dsf.Tables(0).Rows(0)("BLANKET_ORDER"))
Else
SD_ORDER_HEADER_BLANKET_ORDER.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CUSTOMER_PO_NO"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CUSTOMER_PO_NO.Text = dsf.Tables(0).Rows(0)("CUSTOMER_PO_NO")
Else
                SD_ORDER_HEADER_CUSTOMER_PO_NO.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CUSTOMER_PO_DATE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CUSTOMER_PO_DATE.Text = dsf.Tables(0).Rows(0)("CUSTOMER_PO_DATE")
Else
                SD_ORDER_HEADER_CUSTOMER_PO_DATE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CONTACT_NAME"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CONTACT_NAME.Text = dsf.Tables(0).Rows(0)("CONTACT_NAME")
Else
                SD_ORDER_HEADER_CONTACT_NAME.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("INVOICE_BY"), System.DBNull.Value)) Then
              dropdown_list_r1(SD_ORDER_HEADER_INVOICE_BY, dsf.Tables(0).Rows(0)("INVOICE_BY"))
Else
SD_ORDER_HEADER_INVOICE_BY.SelectedIndex = -1
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ADVANCE_PERCENTAGE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("ADVANCE_PERCENTAGE"))
Else
                SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CONTACT_PHONE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CONTACT_PHONE.Text = dsf.Tables(0).Rows(0)("CONTACT_PHONE")
Else
                SD_ORDER_HEADER_CONTACT_PHONE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ADVANCE_AMOUNT"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_ADVANCE_AMOUNT.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("ADVANCE_AMOUNT"))
Else
                SD_ORDER_HEADER_ADVANCE_AMOUNT.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CONTACT_EMAIL"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CONTACT_EMAIL.Text = dsf.Tables(0).Rows(0)("CONTACT_EMAIL")
Else
                SD_ORDER_HEADER_CONTACT_EMAIL.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("DIFFERENT_SHIPPING_ADDRESS"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS, dsf.Tables(0).Rows(0)("DIFFERENT_SHIPPING_ADDRESS"))
Else
SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPTO_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPTO_CODE.Text = dsf.Tables(0).Rows(0)("SHIPTO_CODE")
Else
                SD_ORDER_HEADER_SHIPTO_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("PROMISED_DELIVERY_DATE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Text = dsf.Tables(0).Rows(0)("PROMISED_DELIVERY_DATE")
Else
                SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ORDER_ACK_PREFERENCE"), System.DBNull.Value)) Then
              dropdown_list_r1(SD_ORDER_HEADER_ORDER_ACK_PREFERENCE, dsf.Tables(0).Rows(0)("ORDER_ACK_PREFERENCE"))
Else
SD_ORDER_HEADER_ORDER_ACK_PREFERENCE.SelectedIndex = -1
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("DIFFERENT_BILLING_ADDRESS"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS, dsf.Tables(0).Rows(0)("DIFFERENT_BILLING_ADDRESS"))
Else
SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ULTIMATE_CONSIGNMENT"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.Text = dsf.Tables(0).Rows(0)("ULTIMATE_CONSIGNMENT")
Else
                SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("HOLD"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_HOLD, dsf.Tables(0).Rows(0)("HOLD"))
Else
SD_ORDER_HEADER_HOLD.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("EXPORT_HOLD"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_EXPORT_HOLD, dsf.Tables(0).Rows(0)("EXPORT_HOLD"))
Else
SD_ORDER_HEADER_EXPORT_HOLD.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIP_COMPLETE"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_SHIP_COMPLETE, dsf.Tables(0).Rows(0)("SHIP_COMPLETE"))
Else
SD_ORDER_HEADER_SHIP_COMPLETE.Checked = False
            End If
Call fill_post_query_ddls()
            If Not (Equals(dsf.Tables(0).Rows(0)("INTERNAL_NOTES"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_INTERNAL_NOTES.Text = dsf.Tables(0).Rows(0)("INTERNAL_NOTES")
SD_ORDER_HEADER_INTERNAL_NOTES.height=conn.gettextboxheight( dsf.Tables(0).Rows(0)("INTERNAL_NOTES") ,SD_ORDER_HEADER_INTERNAL_NOTES.width.Tostring())
Else
                SD_ORDER_HEADER_INTERNAL_NOTES.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ORDER_NOTES"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_ORDER_NOTES.Text = dsf.Tables(0).Rows(0)("ORDER_NOTES")
SD_ORDER_HEADER_ORDER_NOTES.height=conn.gettextboxheight( dsf.Tables(0).Rows(0)("ORDER_NOTES") ,SD_ORDER_HEADER_ORDER_NOTES.width.Tostring())
Else
                SD_ORDER_HEADER_ORDER_NOTES.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_INSTRUCTIONS"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text = dsf.Tables(0).Rows(0)("SHIPPING_INSTRUCTIONS")
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.height=conn.gettextboxheight( dsf.Tables(0).Rows(0)("SHIPPING_INSTRUCTIONS") ,SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.width.Tostring())
Else
                SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CUSTOMER_MESSAGE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CUSTOMER_MESSAGE.Text = dsf.Tables(0).Rows(0)("CUSTOMER_MESSAGE")
SD_ORDER_HEADER_CUSTOMER_MESSAGE.height=conn.gettextboxheight( dsf.Tables(0).Rows(0)("CUSTOMER_MESSAGE") ,SD_ORDER_HEADER_CUSTOMER_MESSAGE.width.Tostring())
Else
                SD_ORDER_HEADER_CUSTOMER_MESSAGE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIP_TO_PO_REFERENCE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Text = dsf.Tables(0).Rows(0)("SHIP_TO_PO_REFERENCE")
Else
                SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("TERMS_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_TERMS_CODE.Text = dsf.Tables(0).Rows(0)("TERMS_CODE")
Else
                SD_ORDER_HEADER_TERMS_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIP_VIA"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIP_VIA.Text = dsf.Tables(0).Rows(0)("SHIP_VIA")
Else
                SD_ORDER_HEADER_SHIP_VIA.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CARRIER_ACC_NO"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CARRIER_ACC_NO.Text = dsf.Tables(0).Rows(0)("CARRIER_ACC_NO")
Else
                SD_ORDER_HEADER_CARRIER_ACC_NO.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FOB"), System.DBNull.Value)) Then
              dropdown_list_r1(SD_ORDER_HEADER_FOB, dsf.Tables(0).Rows(0)("FOB"))
Else
SD_ORDER_HEADER_FOB.SelectedIndex = -1
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("PAYMENT_METHOD"), System.DBNull.Value)) Then
              dropdown_list_r1(SD_ORDER_HEADER_PAYMENT_METHOD, dsf.Tables(0).Rows(0)("PAYMENT_METHOD"))
Else
SD_ORDER_HEADER_PAYMENT_METHOD.SelectedIndex = -1
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CONVERSION_CURRENCY_CODE"), System.DBNull.Value)) Then
              dropdown_list_r1(SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE, dsf.Tables(0).Rows(0)("CONVERSION_CURRENCY_CODE"))
Else
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.SelectedIndex = -1
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BASE_CURRENCY_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BASE_CURRENCY_CODE.Text = dsf.Tables(0).Rows(0)("BASE_CURRENCY_CODE")
Else
                SD_ORDER_HEADER_BASE_CURRENCY_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("NO_OF_UNITS_OF_BASE_CURRENCY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("NO_OF_UNITS_OF_BASE_CURRENCY"))
Else
                SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("NO_OF_UNITS_OF_CONVERSION_CURR"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("NO_OF_UNITS_OF_CONVERSION_CURR"))
Else
                SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("STREET"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_STREET.Text = dsf.Tables(0).Rows(0)("STREET")
SD_ORDER_HEADER_STREET.height=conn.gettextboxheight( dsf.Tables(0).Rows(0)("STREET") ,SD_ORDER_HEADER_STREET.width.Tostring())
Else
                SD_ORDER_HEADER_STREET.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CITY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CITY.Text = dsf.Tables(0).Rows(0)("CITY")
Else
                SD_ORDER_HEADER_CITY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("PHONE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_PHONE.Text = dsf.Tables(0).Rows(0)("PHONE")
Else
                SD_ORDER_HEADER_PHONE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FAX"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FAX.Text = dsf.Tables(0).Rows(0)("FAX")
Else
                SD_ORDER_HEADER_FAX.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("STATE_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_STATE_CODE.Text = dsf.Tables(0).Rows(0)("STATE_CODE")
Else
                SD_ORDER_HEADER_STATE_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("EMAIL"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_EMAIL.Text = dsf.Tables(0).Rows(0)("EMAIL")
Else
                SD_ORDER_HEADER_EMAIL.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("POSTAL_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_POSTAL_CODE.Text = dsf.Tables(0).Rows(0)("POSTAL_CODE")
Else
                SD_ORDER_HEADER_POSTAL_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("COUNTRY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_COUNTRY.Text = dsf.Tables(0).Rows(0)("COUNTRY")
Else
                SD_ORDER_HEADER_COUNTRY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_CONTACT_NAME"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FREIGHT_BILLING_CONTACT_NAME.Text = dsf.Tables(0).Rows(0)("FREIGHT_BILLING_CONTACT_NAME")
Else
                SD_ORDER_HEADER_FREIGHT_BILLING_CONTACT_NAME.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_NAME"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FREIGHT_BILLING_NAME.Text = dsf.Tables(0).Rows(0)("FREIGHT_BILLING_NAME")
Else
                SD_ORDER_HEADER_FREIGHT_BILLING_NAME.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_STREET"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FREIGHT_BILLING_STREET.Text = dsf.Tables(0).Rows(0)("FREIGHT_BILLING_STREET")
SD_ORDER_HEADER_FREIGHT_BILLING_STREET.height=conn.gettextboxheight( dsf.Tables(0).Rows(0)("FREIGHT_BILLING_STREET") ,SD_ORDER_HEADER_FREIGHT_BILLING_STREET.width.Tostring())
Else
                SD_ORDER_HEADER_FREIGHT_BILLING_STREET.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_CITY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FREIGHT_BILLING_CITY.Text = dsf.Tables(0).Rows(0)("FREIGHT_BILLING_CITY")
Else
                SD_ORDER_HEADER_FREIGHT_BILLING_CITY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_PHONE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FREIGHT_BILLING_PHONE.Text = dsf.Tables(0).Rows(0)("FREIGHT_BILLING_PHONE")
Else
                SD_ORDER_HEADER_FREIGHT_BILLING_PHONE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_FAX"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FREIGHT_BILLING_FAX.Text = dsf.Tables(0).Rows(0)("FREIGHT_BILLING_FAX")
Else
                SD_ORDER_HEADER_FREIGHT_BILLING_FAX.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_STATE_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.Text = dsf.Tables(0).Rows(0)("FREIGHT_BILLING_STATE_CODE")
Else
                SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_EMAIL"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FREIGHT_BILLING_EMAIL.Text = dsf.Tables(0).Rows(0)("FREIGHT_BILLING_EMAIL")
Else
                SD_ORDER_HEADER_FREIGHT_BILLING_EMAIL.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_POSTAL_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FREIGHT_BILLING_POSTAL_CODE.Text = dsf.Tables(0).Rows(0)("FREIGHT_BILLING_POSTAL_CODE")
Else
                SD_ORDER_HEADER_FREIGHT_BILLING_POSTAL_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_COUNTRY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.Text = dsf.Tables(0).Rows(0)("FREIGHT_BILLING_COUNTRY")
Else
                SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_CONTACT_NAME"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_CONTACT_NAME.Text = dsf.Tables(0).Rows(0)("SHIPPING_CONTACT_NAME")
Else
                SD_ORDER_HEADER_SHIPPING_CONTACT_NAME.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_NAME"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_NAME.Text = dsf.Tables(0).Rows(0)("SHIPPING_NAME")
Else
                SD_ORDER_HEADER_SHIPPING_NAME.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_STREET"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_STREET.Text = dsf.Tables(0).Rows(0)("SHIPPING_STREET")
SD_ORDER_HEADER_SHIPPING_STREET.height=conn.gettextboxheight( dsf.Tables(0).Rows(0)("SHIPPING_STREET") ,SD_ORDER_HEADER_SHIPPING_STREET.width.Tostring())
Else
                SD_ORDER_HEADER_SHIPPING_STREET.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_CITY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_CITY.Text = dsf.Tables(0).Rows(0)("SHIPPING_CITY")
Else
                SD_ORDER_HEADER_SHIPPING_CITY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_PHONE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_PHONE.Text = dsf.Tables(0).Rows(0)("SHIPPING_PHONE")
Else
                SD_ORDER_HEADER_SHIPPING_PHONE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_FAX"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_FAX.Text = dsf.Tables(0).Rows(0)("SHIPPING_FAX")
Else
                SD_ORDER_HEADER_SHIPPING_FAX.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_STATE_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_STATE_CODE.Text = dsf.Tables(0).Rows(0)("SHIPPING_STATE_CODE")
Else
                SD_ORDER_HEADER_SHIPPING_STATE_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_EMAIL"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_EMAIL.Text = dsf.Tables(0).Rows(0)("SHIPPING_EMAIL")
Else
                SD_ORDER_HEADER_SHIPPING_EMAIL.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_POSTAL_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Text = dsf.Tables(0).Rows(0)("SHIPPING_POSTAL_CODE")
Else
                SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_COUNTRY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SHIPPING_COUNTRY.Text = dsf.Tables(0).Rows(0)("SHIPPING_COUNTRY")
Else
                SD_ORDER_HEADER_SHIPPING_COUNTRY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_CONTACT_NAME"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BILLING_CONTACT_NAME.Text = dsf.Tables(0).Rows(0)("BILLING_CONTACT_NAME")
Else
                SD_ORDER_HEADER_BILLING_CONTACT_NAME.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_NAME"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BILLING_NAME.Text = dsf.Tables(0).Rows(0)("BILLING_NAME")
Else
                SD_ORDER_HEADER_BILLING_NAME.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_STREET"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BILLING_STREET.Text = dsf.Tables(0).Rows(0)("BILLING_STREET")
SD_ORDER_HEADER_BILLING_STREET.height=conn.gettextboxheight( dsf.Tables(0).Rows(0)("BILLING_STREET") ,SD_ORDER_HEADER_BILLING_STREET.width.Tostring())
Else
                SD_ORDER_HEADER_BILLING_STREET.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_CITY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BILLING_CITY.Text = dsf.Tables(0).Rows(0)("BILLING_CITY")
Else
                SD_ORDER_HEADER_BILLING_CITY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_PHONE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BILLING_PHONE.Text = dsf.Tables(0).Rows(0)("BILLING_PHONE")
Else
                SD_ORDER_HEADER_BILLING_PHONE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_FAX"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BILLING_FAX.Text = dsf.Tables(0).Rows(0)("BILLING_FAX")
Else
                SD_ORDER_HEADER_BILLING_FAX.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_STATE_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BILLING_STATE_CODE.Text = dsf.Tables(0).Rows(0)("BILLING_STATE_CODE")
Else
                SD_ORDER_HEADER_BILLING_STATE_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_EMAIL"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BILLING_EMAIL.Text = dsf.Tables(0).Rows(0)("BILLING_EMAIL")
Else
                SD_ORDER_HEADER_BILLING_EMAIL.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_POSTAL_CODE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text = dsf.Tables(0).Rows(0)("BILLING_POSTAL_CODE")
Else
                SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_COUNTRY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BILLING_COUNTRY.Text = dsf.Tables(0).Rows(0)("BILLING_COUNTRY")
Else
                SD_ORDER_HEADER_BILLING_COUNTRY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ITEM_NO"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_ITEM_NO.Text = dsf.Tables(0).Rows(0)("ITEM_NO")
Else
                SD_ORDER_HEADER_ITEM_NO.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BLANKET_QTY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BLANKET_QTY.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("BLANKET_QTY"))
Else
                SD_ORDER_HEADER_BLANKET_QTY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ORDERING_UOM"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_ORDERING_UOM.Text = dsf.Tables(0).Rows(0)("ORDERING_UOM")
Else
                SD_ORDER_HEADER_ORDERING_UOM.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BLANKET_QTY_BUOM"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BLANKET_QTY_BUOM.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("BLANKET_QTY_BUOM"))
Else
                SD_ORDER_HEADER_BLANKET_QTY_BUOM.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("PRICE_FROM_PRICING_INFO"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO, dsf.Tables(0).Rows(0)("PRICE_FROM_PRICING_INFO"))
Else
SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SALES_PRICE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SALES_PRICE.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("SALES_PRICE"))
Else
                SD_ORDER_HEADER_SALES_PRICE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("PRICING_UOM"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_PRICING_UOM.Text = dsf.Tables(0).Rows(0)("PRICING_UOM")
Else
                SD_ORDER_HEADER_PRICING_UOM.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BLANKET_EFFECTIVE_FROM"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BLANKET_EFFECTIVE_FROM.Text = dsf.Tables(0).Rows(0)("BLANKET_EFFECTIVE_FROM")
Else
                SD_ORDER_HEADER_BLANKET_EFFECTIVE_FROM.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BLANKET_EFFECTIVE_TILL"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BLANKET_EFFECTIVE_TILL.Text = dsf.Tables(0).Rows(0)("BLANKET_EFFECTIVE_TILL")
Else
                SD_ORDER_HEADER_BLANKET_EFFECTIVE_TILL.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BLANKET_RELEASE_NO"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_BLANKET_RELEASE_NO.Text = dsf.Tables(0).Rows(0)("BLANKET_RELEASE_NO")
Else
                SD_ORDER_HEADER_BLANKET_RELEASE_NO.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BALANCE_QTY_LINE"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_BALANCE_QTY_LINE, dsf.Tables(0).Rows(0)("BALANCE_QTY_LINE"))
Else
SD_ORDER_HEADER_BALANCE_QTY_LINE.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ATEX_HOLD"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_ATEX_HOLD, dsf.Tables(0).Rows(0)("ATEX_HOLD"))
Else
SD_ORDER_HEADER_ATEX_HOLD.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("EST_EXPORT_CLEARANCE_DATE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_EST_EXPORT_CLEARANCE_DATE.Text = dsf.Tables(0).Rows(0)("EST_EXPORT_CLEARANCE_DATE")
Else
                SD_ORDER_HEADER_EST_EXPORT_CLEARANCE_DATE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("QUOTATION_NO"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_QUOTATION_NO.Text = dsf.Tables(0).Rows(0)("QUOTATION_NO")
Else
                SD_ORDER_HEADER_QUOTATION_NO.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CLOSE_DATE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CLOSE_DATE.Text = dsf.Tables(0).Rows(0)("CLOSE_DATE")
Else
                SD_ORDER_HEADER_CLOSE_DATE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILL_TYPE"), System.DBNull.Value)) Then
              dropdown_list_r1(SD_ORDER_HEADER_FREIGHT_BILL_TYPE, dsf.Tables(0).Rows(0)("FREIGHT_BILL_TYPE"))
Else
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex = -1
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CANCEL_DATE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_CANCEL_DATE.Text = dsf.Tables(0).Rows(0)("CANCEL_DATE")
Else
                SD_ORDER_HEADER_CANCEL_DATE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("THIRD_PARTY_ADDRESS"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text = dsf.Tables(0).Rows(0)("THIRD_PARTY_ADDRESS")
Else
                SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE1"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SE1.Text = dsf.Tables(0).Rows(0)("SE1")
Else
                SD_ORDER_HEADER_SE1.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE2"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SE2.Text = dsf.Tables(0).Rows(0)("SE2")
Else
                SD_ORDER_HEADER_SE2.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE_PCT1"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SE_PCT1.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("SE_PCT1"))
Else
                SD_ORDER_HEADER_SE_PCT1.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE_PCT2"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SE_PCT2.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("SE_PCT2"))
Else
                SD_ORDER_HEADER_SE_PCT2.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE3"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SE3.Text = dsf.Tables(0).Rows(0)("SE3")
Else
                SD_ORDER_HEADER_SE3.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE4"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SE4.Text = dsf.Tables(0).Rows(0)("SE4")
Else
                SD_ORDER_HEADER_SE4.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE_PCT3"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SE_PCT3.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("SE_PCT3"))
Else
                SD_ORDER_HEADER_SE_PCT3.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE_PCT4"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SE_PCT4.Text = String.Format("{0:0.00}",dsf.Tables(0).Rows(0)("SE_PCT4"))
Else
                SD_ORDER_HEADER_SE_PCT4.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("LICENSE_APPLICATION_REF"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_LICENSE_APPLICATION_REF.Text = dsf.Tables(0).Rows(0)("LICENSE_APPLICATION_REF")
Else
                SD_ORDER_HEADER_LICENSE_APPLICATION_REF.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("QUICK_SHIP"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_QUICK_SHIP, dsf.Tables(0).Rows(0)("QUICK_SHIP"))
Else
SD_ORDER_HEADER_QUICK_SHIP.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("AES_HOLD"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_AES_HOLD, dsf.Tables(0).Rows(0)("AES_HOLD"))
Else
SD_ORDER_HEADER_AES_HOLD.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("NONAG"), System.DBNull.Value)) Then
              dropdown_list_r1(SD_ORDER_HEADER_NONAG, dsf.Tables(0).Rows(0)("NONAG"))
Else
SD_ORDER_HEADER_NONAG.SelectedIndex = -1
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("PULL_INVENTORY_FROM_QRC"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_PULL_INVENTORY_FROM_QRC, dsf.Tables(0).Rows(0)("PULL_INVENTORY_FROM_QRC"))
Else
SD_ORDER_HEADER_PULL_INVENTORY_FROM_QRC.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("INCOTERMS_LOCATION"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_INCOTERMS_LOCATION.Text = dsf.Tables(0).Rows(0)("INCOTERMS_LOCATION")
Else
                SD_ORDER_HEADER_INCOTERMS_LOCATION.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("WEB_ORDER_NO"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_WEB_ORDER_NO.Text = dsf.Tables(0).Rows(0)("WEB_ORDER_NO")
Else
                SD_ORDER_HEADER_WEB_ORDER_NO.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("QRC_LOCATION"), System.DBNull.Value)) Then
              dropdown_list_r1(SD_ORDER_HEADER_QRC_LOCATION, dsf.Tables(0).Rows(0)("QRC_LOCATION"))
Else
SD_ORDER_HEADER_QRC_LOCATION.SelectedIndex = -1
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("WEB_ORDER_CREATED_BY"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_WEB_ORDER_CREATED_BY.Text = dsf.Tables(0).Rows(0)("WEB_ORDER_CREATED_BY")
Else
                SD_ORDER_HEADER_WEB_ORDER_CREATED_BY.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("INPROCESS"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_INPROCESS, dsf.Tables(0).Rows(0)("INPROCESS"))
Else
SD_ORDER_HEADER_INPROCESS.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("DO_NOT_SERVICE"), System.DBNull.Value)) Then
              check_box_fill(SD_ORDER_HEADER_DO_NOT_SERVICE, dsf.Tables(0).Rows(0)("DO_NOT_SERVICE"))
Else
SD_ORDER_HEADER_DO_NOT_SERVICE.Checked = False
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SUGGESTED_DATE"), System.DBNull.Value)) Then
                SD_ORDER_HEADER_SUGGESTED_DATE.Text = dsf.Tables(0).Rows(0)("SUGGESTED_DATE")
Else
                SD_ORDER_HEADER_SUGGESTED_DATE.Text = ""
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ORDER_NO"), System.DBNull.Value)) Then
Dim dbsqlst2  as new Data.Dataset
dbad.SelectCommand.CommandText ="select Pkg_Status.Sf_Check_Status ('SD_ORDER_HEADER','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL)  from dual"
dbsqlst2.Clear()
dbad.Fill(dbsqlst2)
if (dbsqlst2.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
ORDER_STATUS.Text=dbsqlst2.Tables(0).Rows(0)(0)
End If
End If
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BUSINESS_UNIT_CODE"), System.DBNull.Value)) Then
 If (CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<> "Close") Then
LOVCUSTOMER_LOV1088.Enabled=True
SD_ORDER_HEADER_CUSTOMER_NO.Enabled=True
SD_ORDER_HEADER_CUSTOMER_NO.ReadOnly=False
SD_ORDER_HEADER_INVOICE_BY.Enabled=True
Else
LOVCUSTOMER_LOV1088.Enabled=False
SD_ORDER_HEADER_CUSTOMER_NO.Enabled=True
SD_ORDER_HEADER_CUSTOMER_NO.ReadOnly=True
SD_ORDER_HEADER_INVOICE_BY.Enabled=False
End If
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("REQUESTED_DATE"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ORDER_ENTRY_SALES_CODE"), System.DBNull.Value)) Then
Dim dbsqlst9  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DEFAULT_SALES_PRICE_ZERO FROM SD_CUSTOMERS WHERE ACCOUNT_NO = '" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'"
dbsqlst9.Clear()
dbad.Fill(dbsqlst9)
if (dbsqlst9.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst9.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DEFAULT_SALES_PRICE_ZERO.Text=dbsqlst9.Tables(0).Rows(0)(0)
End If
End If
 If (SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=TRUE) Then
PANEL5BILLING_ADDRESS.Visible=True
Else
PANEL5BILLING_ADDRESS.Visible=False
End If
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ORDER_DATE"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CUSTOMER_NO"), System.DBNull.Value)) Then
Dim dbsqlst12  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DEFAULT_SALES_PRICE_ZERO FROM SD_CUSTOMERS WHERE ACCOUNT_NO = '" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'"
dbsqlst12.Clear()
dbad.Fill(dbsqlst12)
if (dbsqlst12.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst12.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DEFAULT_SALES_PRICE_ZERO.Text=dbsqlst12.Tables(0).Rows(0)(0)
End If
End If
 If (SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=TRUE) Then
PANEL5SHIPPING_ADDRESS.Visible=True
LOVSHIPTO_LOV1152.Visible=True
SD_ORDER_HEADER_SHIPTO_CODE_L.Visible=True
SD_ORDER_HEADER_SHIPTO_CODE.Visible=True
Else
PANEL5SHIPPING_ADDRESS.Visible=False
LOVSHIPTO_LOV1152.Visible=False
SD_ORDER_HEADER_SHIPTO_CODE_L.Visible=False
SD_ORDER_HEADER_SHIPTO_CODE.Visible=False
End If
 If (SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=TRUE) Then
PANEL5BILLING_ADDRESS.Visible=True
Else
PANEL5BILLING_ADDRESS.Visible=False
End If
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("DUE_DATE"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("NAME"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BLANKET_ORDER"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("CONTACT_NAME"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPTO_CODE"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("DIFFERENT_BILLING_ADDRESS"), System.DBNull.Value)) Then
 If (SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=TRUE) Then
PANEL5BILLING_ADDRESS.Visible=True
Else
PANEL5BILLING_ADDRESS.Visible=False
End If
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIP_COMPLETE"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("TERMS_CODE"), System.DBNull.Value)) Then
Dim dbsqlst3  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DESCRIPTION FROM GE_TERMS_CODES WHERE UPPER(TERMS_CODE) = UPPER(TRIM('" & SD_ORDER_HEADER_TERMS_CODE.TEXT & "'))"
dbsqlst3.Clear()
dbad.Fill(dbsqlst3)
if (dbsqlst3.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst3.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DESCRIPTION.Text=dbsqlst3.Tables(0).Rows(0)(0)
End If
End If
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIP_VIA"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("COUNTRY"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("FREIGHT_BILLING_COUNTRY"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SHIPPING_COUNTRY"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BILLING_COUNTRY"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ITEM_NO"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("BLANKET_QTY"), System.DBNull.Value)) Then
Dim dbsqlst3  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_GET_BLANKET_BAL_QTY('SO','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & CHECK_BOX_R(SD_ORDER_HEADER_BLANKET_ORDER) & "') FROM DUAL"
dbsqlst3.Clear()
dbad.Fill(dbsqlst3)
if (dbsqlst3.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst3.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
BL_BAL_QTY.Text=dbsqlst3.Tables(0).Rows(0)(0)
End If
End If
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("ORDERING_UOM"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("PRICING_UOM"), System.DBNull.Value)) Then
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE1"), System.DBNull.Value)) Then
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  SE_CODE|| ' - '||SE_NAME||'  /  '||BRANCH_CODE||' - '||BRANCH_NAME FROM GE_SE_BRANCHES WHERE SE_ID='" & SD_ORDER_HEADER_SE1.TEXT & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DISP_SE_CODE1.Text=dbsqlst1.Tables(0).Rows(0)(0)
End If
End If
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE2"), System.DBNull.Value)) Then
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  SE_CODE||' - '||SE_NAME||'  /  '||BRANCH_CODE||' - '||BRANCH_NAME FROM GE_SE_BRANCHES WHERE SE_ID='" & SD_ORDER_HEADER_SE2.TEXT & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DISP_SE_CODE2.Text=dbsqlst1.Tables(0).Rows(0)(0)
End If
End If
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE3"), System.DBNull.Value)) Then
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  SE_CODE||' - '||SE_NAME||'  /  '||BRANCH_CODE||' - '||BRANCH_NAME FROM GE_SE_BRANCHES WHERE SE_ID='" & SD_ORDER_HEADER_SE3.TEXT & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DISP_SE_CODE3.Text=dbsqlst1.Tables(0).Rows(0)(0)
End If
End If
            End If
            If Not (Equals(dsf.Tables(0).Rows(0)("SE4"), System.DBNull.Value)) Then
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SE_CODE||' - '||SE_NAME||'  /  '||BRANCH_CODE||' - '||BRANCH_NAME FROM GE_SE_BRANCHES WHERE SE_ID='" & SD_ORDER_HEADER_SE4.TEXT & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DISP_SE_CODE4.Text=dbsqlst1.Tables(0).Rows(0)(0)
End If
End If
            End If
dbad.InsertCommand.Connection = Session("db_connection")
dbad.UpdateCommand.Connection = Session("db_connection")
Dim ddlabel As String
  ddlabel = ""
  ddlabel = SD_ORDER_HEADER_NAME.TEXT & " : " & SD_ORDER_HEADER_ORDER_DATE.TEXT
  ddlabel = Replace(ddlabel,"'","''")
 		Dim dsf12 As New Data.DataSet
        	dbad.SelectCommand.CommandText = "select id from SYS_RECENT_TRANSACTIONS where PAGE_ID='SALES_ORDER' and USER_ID='" & session("user_id") & "' and PRIMARY_KEY1='ORDER_NO' and PRIMARY_KEY1_VALUE= '" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
        	dsf12.Clear()
        	dbad.Fill(dsf12)
        	If (dsf12.Tables(0).Rows.Count > 0) Then
                	If (dbad.UpdateCommand.Connection.State = Data.ConnectionState.Closed) Then
                    		dbad.UpdateCommand.Connection.Open()
                	End If
Try
			dbad.UpdateCommand.CommandText = "Update SYS_RECENT_TRANSACTIONS set rowscn=(select ORA_ROWSCN  from SD_ORDER_HEADER WHERE ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'), CREATED_DATE=sysdate,DISPLAY_URL='" & ddlabel & "' where PAGE_ID='SALES_ORDER' and USER_ID='" & session("user_id") & "' and PRIMARY_KEY1='ORDER_NO' and PRIMARY_KEY1_VALUE= '" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
	                dbad.UpdateCommand.ExecuteNonQuery()
 Catch ex As Exception
End Try
            Else
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
Try
                	dbad.InsertCommand.CommandText = "INSERT INTO SYS_RECENT_TRANSACTIONS (ID, PAGE_ID, PAGE_NAME, MENU_ID, MENU_PARENT_LEVEL, USER_ID, PRIMARY_KEY1, PRIMARY_KEY2, PRIMARY_KEY3, PRIMARY_KEY4, PRIMARY_KEY5, PRIMARY_KEY6, PRIMARY_KEY1_VALUE, PRIMARY_KEY2_VALUE, PRIMARY_KEY3_VALUE, PRIMARY_KEY4_VALUE, PRIMARY_KEY5_VALUE, PRIMARY_KEY6_VALUE,  CREATED_BY, CREATED_DATE,DISPLAY_URL,rowscn) VALUES (" & conn.sf_get_Max_plus_one("SYS_RECENT_TRANSACTIONS", "ID", "") & ",'SALES_ORDER','Orders','" & Request.QueryString.Get("mid") & "'," & IIf(Request.QueryString.Get("sssid") <> "", Request.QueryString.Get("sssid"), 1) & ",'" & session("user_id") & "','ORDER_NO','','','','','','" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' , '' ,'','' , '', '' ,'" & session("user_id") & "',sysdate,'" & ddlabel & "',(select ORA_ROWSCN  from SD_ORDER_HEADER WHERE ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'))"
               	dbad.InsertCommand.ExecuteNonQuery()
 Catch ex As Exception
End Try
           End If
    dbad.InsertCommand.Connection.Close()
    dbad.UpdateCommand.Connection.Close()
Dim dbgquery0 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''AR_CASH_RECEIPTS.aspx?RECORD_NO=' ||RECORD_NO ||''') >' ||RECORD_NO || '</a>'  as  ""Record #"",TO_CHAR(TRANSACTION_DATE,'MM/DD/YYYY') As ""Date"", TO_CHAR(ADVANCE_AMOUNT,'999999999.99') as ""Amount"" FROM VL_AR_ADVANCES WHERE ORDER_NO_FILTER='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery0.Clear()
dbad.Fill(dbgquery0)
If (dbgquery0.Tables(0).Rows.Count > 0) Then
dbgADVANCES.Visible=True
dbgADVANCES.DataSource=dbgquery0.Tables(0)
dbgADVANCES.DataBind()
Else
dbgADVANCES.Visible=false
End If
Catch ex as exception
dbgADVANCES.Visible=false
End Try
Dim dbgquery1 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT  '<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''ORDER_DETAILS.aspx?LINE_NO=' || LINE_NO || '&ORDER_NO=' ||ORDER_NO ||''') >' ||LINE_NO || '</a>'   ""LNo"",ITEM_NO ""Item No"",DESCRIPTION ""Description"",TO_CHAR(SHIPED_QTY,'999,999,999.99') ""Qty"", ORDER_UOM ""UOM"", TO_CHAR(SALES_PRICE,'999,999,999.99') ""Sales<br />Price"",PRICING_UOM ""Pricing<br />UOM"", TO_CHAR(((LINE_EXTENDED_AMOUNT*SHIPED_QTY)/ORDER_QTY),'999,999,999.99') ""Extended<br />Amount"",TO_CHAR(((LINE_TOTAL_AMOUNT*SHIPED_QTY)/ORDER_QTY),'999,999,999.99') AS ""Line<br />Total Amount"",TO_CHAR(DUE_DATE,'MM/DD/RRRR') ""Promised<br />Ship date"" FROM V_ORDER_PACKING_SLIP_DETAILS  WHERE  NVL(BLANKET_ORDER,'N')='Y' AND SHIPED_QTY>0 AND ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery1.Clear()
dbad.Fill(dbgquery1)
If (dbgquery1.Tables(0).Rows.Count > 0) Then
dbgBLANKET_LINES.Visible=True
dbgBLANKET_LINES.DataSource=dbgquery1.Tables(0)
dbgBLANKET_LINES.DataBind()
Else
dbgBLANKET_LINES.Visible=false
End If
Catch ex as exception
dbgBLANKET_LINES.Visible=false
End Try
Dim dbgquery2 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a href=''##'' onClick=open_window_doc(''SD_INVOICE.aspx?INVOICE_NO=' ||INVOICE_NO ||''')>' ||INVOICE_NO || '</a>'  as  ""Invoice No #"",billing_stage,TO_CHAR(INVOICE_DATE,'MM/DD/YYYY') As ""INVOICE_DATE"" FROM SD_INVOICE_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery2.Clear()
dbad.Fill(dbgquery2)
If (dbgquery2.Tables(0).Rows.Count > 0) Then
dbgINVOICE_DETAILS.Visible=True
dbgINVOICE_DETAILS.DataSource=dbgquery2.Tables(0)
dbgINVOICE_DETAILS.DataBind()
Else
dbgINVOICE_DETAILS.Visible=false
End If
Catch ex as exception
dbgINVOICE_DETAILS.Visible=false
End Try
Dim dbgquery3 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''PACKING_SLIP.aspx?PACKING_SLIP_NO=' ||PACKING_SLIP_NO ||''') >' ||PACKING_SLIP_NO || '</a>'  as  ""PACKING_SLIP #"",PACKING_SLIP_DATE FROM V_ORDER_PACKING_SLIP WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery3.Clear()
dbad.Fill(dbgquery3)
If (dbgquery3.Tables(0).Rows.Count > 0) Then
dbgPACLING_SLIP.Visible=True
dbgPACLING_SLIP.DataSource=dbgquery3.Tables(0)
dbgPACLING_SLIP.DataBind()
Else
dbgPACLING_SLIP.Visible=false
End If
Catch ex as exception
dbgPACLING_SLIP.Visible=false
End Try
Dim dbgquery4 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''##'' onClick=open_window_doc(''PURCHASE_ORDER.aspx?mid=PURCHASE_ORDER&PO_NO=' ||PO_NO ||''') >' ||PO_NO || '</a>'  as  ""PO #"",TO_CHAR(PO_DATE,'MM/DD/YYYY') AS ""PO Date"",LINE_NO AS ""Line No"",ORDER_LINE_NO AS ""Order Lno""  FROM V_PO_SO_DETAILS  WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' order by 1 desc"
dbgquery4.Clear()
dbad.Fill(dbgquery4)
If (dbgquery4.Tables(0).Rows.Count > 0) Then
dbgPO_DETAILS.Visible=True
dbgPO_DETAILS.DataSource=dbgquery4.Tables(0)
dbgPO_DETAILS.DataBind()
Else
dbgPO_DETAILS.Visible=false
End If
Catch ex as exception
dbgPO_DETAILS.Visible=false
End Try
Dim dbgquery5 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''##'' onClick=open_window_doc(''QUOTATION.aspx?mid=QUOTATION&QUOTATION_NO=' ||QUOTATION_NO ||''') >' ||QUOTATION_NO || '</a>'  as  ""QUOTATION #"",QUOTATION_DATE FROM V_ORDER_QUOTATION_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery5.Clear()
dbad.Fill(dbgquery5)
If (dbgquery5.Tables(0).Rows.Count > 0) Then
dbgQUOTATION_ORDERS.Visible=True
dbgQUOTATION_ORDERS.DataSource=dbgquery5.Tables(0)
dbgQUOTATION_ORDERS.DataBind()
Else
dbgQUOTATION_ORDERS.Visible=false
End If
Catch ex as exception
dbgQUOTATION_ORDERS.Visible=false
End Try
Dim dbgquery6 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''RMA.aspx?RMA_NO=' ||RMA_NO ||''') >' ||RMA_NO || '</a>'  as  ""RMA #"",LINE_NO as ""Line #"",TO_CHAR(RMA_DATE,'MM/DD/YYYY') as ""Date"",ORDER_LINE_NO as ""Order Line #"",'<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''ITEMS.aspx?ITEM_NO=' ||ITEM_NO ||''') >' ||ITEM_NO || '</a>'  as  ""Item #"",DESCRIPTION as ""Description"" FROM V_RMA_REPORT1 WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'"
dbgquery6.Clear()
dbad.Fill(dbgquery6)
If (dbgquery6.Tables(0).Rows.Count > 0) Then
dbgRMA.Visible=True
dbgRMA.DataSource=dbgquery6.Tables(0)
dbgRMA.DataBind()
Else
dbgRMA.Visible=false
End If
Catch ex as exception
dbgRMA.Visible=false
End Try
Dim dbgquery7 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct   '<a class=''lbfont'' href=''#'' Onclick=open_window_doc(''INVENTORY_TRANSFER_BY_ORDER.aspx?RECORD_NO=' ||RECORD_NO ||''') >' ||RECORD_NO || '</a>'  as  ""Transfer #"",TO_CHAR(TRANSFER_DATE,'MM/DD/YYYY') AS ""Transfer Date""  FROM V_INVENTORY_TRANSFER_BY_ORDER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ORDER BY 1"
dbgquery7.Clear()
dbad.Fill(dbgquery7)
If (dbgquery7.Tables(0).Rows.Count > 0) Then
dbgTRANSFER_DETAILS.Visible=True
dbgTRANSFER_DETAILS.DataSource=dbgquery7.Tables(0)
dbgTRANSFER_DETAILS.DataBind()
Else
dbgTRANSFER_DETAILS.Visible=false
End If
Catch ex as exception
dbgTRANSFER_DETAILS.Visible=false
End Try
Dim dbgquery8 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct  '<a class=''lbfont'' href=''##'' onClick=open_window_doc(''WORK_ORDER.aspx?mid=WORK_ORDER&WORK_ORDER_NO=' || WORK_ORDER_NO ||''') >' ||WORK_ORDER_NO || '</a>'  as ""WORK_ORDER #"",WO_DATE,ORDER_LINE_NO AS LINE_NO, ITEM_NO as ITEM_NO,TO_CHAR(QTY) AS QTY, SCHEDULED_START_DATE, SCHEDULED_COMPLETION_DATE, SORT_ORDER S FROM V_SO_WO_ORDERS WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'  and allocation_type='SO_WO' order by line_no, S"
dbgquery8.Clear()
dbad.Fill(dbgquery8)
If (dbgquery8.Tables(0).Rows.Count > 0) Then
dbgWO_ORDERS.Visible=True
dbgWO_ORDERS.DataSource=dbgquery8.Tables(0)
dbgWO_ORDERS.DataBind()
Else
dbgWO_ORDERS.Visible=false
End If
Catch ex as exception
dbgWO_ORDERS.Visible=false
End Try
Dim dbgquery9 as new data.dataset
Try
dbad.SelectCommand.CommandText = "SELECT distinct ORDER_LINE_NO AS ""Order Line #"", '<a class=''lbfont'' href=''##'' onClick=open_window_doc('''||DECODE(WORK_ORDER_TYPE,'REPAIR','WORK_ORDER_SR','WORK_ORDER')||'.aspx?mid=WORK_ORDER&WORK_ORDER_NO=' || WORK_ORDER_NO ||''') >' ||WORK_ORDER_NO || '</a>'  as ""WO #"",Sf_Wrap_Text(sf_Get_order_serial_no(ORDER_NO,ORDER_LINE_NO),30) AS ""Serial #""  FROM V_WORK_ORDER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ORDER BY ORDER_LINE_NO"
dbgquery9.Clear()
dbad.Fill(dbgquery9)
If (dbgquery9.Tables(0).Rows.Count > 0) Then
dbgWO_ORDERS_1.Visible=True
dbgWO_ORDERS_1.DataSource=dbgquery9.Tables(0)
dbgWO_ORDERS_1.DataBind()
Else
dbgWO_ORDERS_1.Visible=false
End If
Catch ex as exception
dbgWO_ORDERS_1.Visible=false
End Try
Dim dsmsgbcount As New Data.DataSet
dbad.SelectCommand.CommandText = "select count(1) from sys_linked_docs where UPPER(PAGE_ID)=UPPER('SALES_ORDER')  AND PRIMAY_KEY1='" & Replace(SD_ORDER_HEADER_ORDER_NO.Text, "'", "''") & "'"
dsmsgbcount.Clear()
dbad.Fill(dsmsgbcount)
If (dsmsgbcount.Tables(0).Rows.Count > 0) Then
If (dsmsgbcount.Tables(0).Rows(0)(0) > 0) Then
doc_msg_label_ctORDERHEADER.Text=dsmsgbcount.Tables(0).Rows(0)(0)
Else
doc_msg_label_ctORDERHEADER.Text=""
End If
Else
doc_msg_label_ctORDERHEADER.Text=""
End If
Dim dsnotebcount As New Data.DataSet
dbad.SelectCommand.CommandText = "select count(1) from SYS_PAGE_NOTES where UPPER(PAGE_ID)=UPPER('SALES_ORDER')  AND PRIMARY_KEY_FIELD1_VALUE='" & Replace(SD_ORDER_HEADER_ORDER_NO.Text, "'", "''") & "'"
dsnotebcount.Clear()
dbad.Fill(dsnotebcount)
If (dsnotebcount.Tables(0).Rows.Count > 0) Then
If (dsnotebcount.Tables(0).Rows(0)(0) > 0) Then
img_notes_lb.Text=dsnotebcount.Tables(0).Rows(0)(0)
Else
img_notes_lb.Text=""
End If
Else
img_notes_lb.Text=""
End If
call Fill_detail_grid()
call fill_Detail_form()
Call Document_related_functions()
SD_ORDER_HEADER_ORDER_NO.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_ORDER_DATE.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_CUSTOMER_NO.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_DUE_DATE.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_NAME.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_CUSTOMER_PO_NO.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_TERMS_CODE.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_SHIP_VIA.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_FOB.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_ORDER_NO.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_NAME.BackColor = Drawing.Color.LightYellow
Else
Dim pp6k_val1_1 as String=""
Dim pp6k_val1_2 as String=""
Dim pp6k_val1_3 as String=""
Dim pp6k_val1_4 as String=""
Dim pp6k_val1_5 as String=""
Dim pp6k_val1_6 as String=""
pp6k_val1_1=SD_ORDER_HEADER_ORDER_NO.Text
Call clear_header()
Call clear_detail_grid()
Call clear_detail_form()
Call Document_related_functions()
SD_ORDER_HEADER_ORDER_NO.Text=pp6k_val1_1
	      End If
 If (SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=TRUE) Then
PANEL5BILLING_ADDRESS.Visible=True
Else
PANEL5BILLING_ADDRESS.Visible=False
End If
 If (SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=TRUE) Then
PANEL5SHIPPING_ADDRESS.Visible=True
Else
PANEL5SHIPPING_ADDRESS.Visible=False
End If
 If (SD_ORDER_HEADER_BASE_CURRENCY_CODE.TEXT<>SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.SELECTEDITEM.VALUE) Then
SD_ORDER_HEADER_BASE_CURRENCY_CODE_L.Visible=True
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY_L.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR_L.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Visible=True
Else
SD_ORDER_HEADER_BASE_CURRENCY_CODE_L.Visible=False
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY_L.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR_L.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Visible=False
End If
 If (SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=TRUE) Then
LOVSHIPTO_LOV1152.Visible=True
SD_ORDER_HEADER_SHIPTO_CODE_L.Visible=True
SD_ORDER_HEADER_SHIPTO_CODE.Visible=True
Else
LOVSHIPTO_LOV1152.Visible=False
SD_ORDER_HEADER_SHIPTO_CODE_L.Visible=False
SD_ORDER_HEADER_SHIPTO_CODE.Visible=False
End If
 If (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE) Then
PANEL5BLANKET_ORDER.Visible=True
PANEL5BLANKET_LINES.Visible=True
Else
PANEL5BLANKET_ORDER.Visible=False
PANEL5BLANKET_LINES.Visible=False
End If
 If ((CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="10146685") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="DAREK") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="BARNAS")) Then
EVENT_BTN_RUN_SCH.Visible=True
Else
EVENT_BTN_RUN_SCH.Visible=False
End If
 If (SD_ORDER_HEADER_SHIP_COMPLETE.CHECKED<>TRUE) Then
EVENT_SHIP_COMPLETE.Visible=True
Else
EVENT_SHIP_COMPLETE.Visible=False
End If
 If ((CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS" ) OR  (CONN.SF_EXECUTE_SQL("SELECT SF_GET_SALES_APPRVAL('" & SESSION("USER_ID") & "')  FROM DUAL")=1) OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT" )) Then
SD_ORDER_HEADER_SUGGESTED_DATE_L.Visible=True
SD_ORDER_HEADER_SUGGESTED_DATE.Visible=True
Else
SD_ORDER_HEADER_SUGGESTED_DATE_L.Visible=False
SD_ORDER_HEADER_SUGGESTED_DATE.Visible=False
End If
 If ((SD_ORDER_HEADER_SUGGESTED_DATE.text<>"" AND (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS") OR  (CONN.SF_EXECUTE_SQL("SELECT SF_GET_SALES_APPRVAL('" & SESSION("USER_ID") & "')  FROM DUAL")=1) OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT"))) Then
EVENT_BTN_UNDO_SUGGEST_DATE.Visible=True
Else
EVENT_BTN_UNDO_SUGGEST_DATE.Visible=False
End If
 If (1=2) Then
COPY1.Visible=True
Else
COPY1.Visible=False
End If
 If ((SD_ORDER_HEADER_SUGGESTED_DATE.text<>"" AND (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS") OR  (CONN.SF_EXECUTE_SQL("SELECT SF_GET_SALES_APPRVAL('" & SESSION("USER_ID") & "') FROM DUAL")=1) OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT"))) Then
EVENT_BTN_SUGGEST_DATE.Visible=True
Else
EVENT_BTN_SUGGEST_DATE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL("SELECT count(*) FROM GE_TERMS_CODES_DETAILS WHERE TERMS_CODE=NVL('" & SD_ORDER_HEADER_TERMS_CODE.TEXT & "' ,'NOTERMS_!@#')")>0) Then
PANEL5BILLING_STAGE.Visible=True
Else
PANEL5BILLING_STAGE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT EDIT_SHIP_DELIVERY_DATE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="D") Then
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE_L.Visible=True
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Visible=True
Else
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE_L.Visible=False
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT EDIT_SHIP_DELIVERY_DATE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="S") Then
SD_ORDER_HEADER_DUE_DATE_L.Visible=True
SD_ORDER_HEADER_DUE_DATE.Visible=True
Else
SD_ORDER_HEADER_DUE_DATE_L.Visible=False
SD_ORDER_HEADER_DUE_DATE.Visible=False
End If
 If (CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<>"Close") Then
SAVE.Visible=True
Else
SAVE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT SF_CHECK_EXPORT_HOLD('" & SESSION("USER_ID") & "') FROM DUAL ")<>"N") Then
SD_ORDER_HEADER_EXPORT_HOLD.Enabled=True
Else
SD_ORDER_HEADER_EXPORT_HOLD.Enabled=False
End If
 If ((SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE AND CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<> "Close") OR (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE AND CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")= "Open") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,'H','" & SESSION("USER_ID") & "')")="Y")) Then
AddGridRowORDERDETAIL.Enabled=True
AddGridRowORDERDETAIL_1.Enabled=True
DELETEGridRowORDERDETAIL.Enabled=True
DELETEGridRowORDERDETAIL_1.Enabled=True
Else
AddGridRowORDERDETAIL.Enabled=False
AddGridRowORDERDETAIL_1.Enabled=False
DELETEGridRowORDERDETAIL.Enabled=False
DELETEGridRowORDERDETAIL_1.Enabled=False
End If
 If (CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<> "Close") Then
SD_ORDER_HEADER_REQUESTED_DATE.Enabled=True
SD_ORDER_HEADER_ORDER_DATE.Enabled=True
Else
SD_ORDER_HEADER_REQUESTED_DATE.Enabled=False
SD_ORDER_HEADER_ORDER_DATE.Enabled=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT SF_CHECK_AES_HOLD('" & SESSION("USER_ID") & "') FROM DUAL ")<>"N") Then
SD_ORDER_HEADER_AES_HOLD.Enabled=True
Else
SD_ORDER_HEADER_AES_HOLD.Enabled=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT SF_CHECK_ATEX_HOLD('" & SESSION("USER_ID") & "') FROM DUAL ")<>"N") Then
SD_ORDER_HEADER_ATEX_HOLD.Enabled=True
Else
SD_ORDER_HEADER_ATEX_HOLD.Enabled=False
End If
 If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM SD_INVOICE_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ")=0) Then
SD_ORDER_HEADER_TERMS_CODE.Enabled=True
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Enabled=True
SD_ORDER_HEADER_SHIP_VIA.Enabled=True
SD_ORDER_HEADER_PAYMENT_METHOD.Enabled=True
SD_ORDER_HEADER_FOB.Enabled=True
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Enabled=True
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Enabled=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Enabled=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Enabled=True
Else
SD_ORDER_HEADER_TERMS_CODE.Enabled=False
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Enabled=False
SD_ORDER_HEADER_SHIP_VIA.Enabled=False
SD_ORDER_HEADER_PAYMENT_METHOD.Enabled=False
SD_ORDER_HEADER_FOB.Enabled=False
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Enabled=False
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Enabled=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Enabled=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Enabled=False
End If
Else
Call clear_header()
Call clear_detail_grid()
Call clear_detail_form()
   End If
dbad.SelectCommand.Connection.Close()
call conn.call_after_retrive("SALES_ORDER", session("user_id"),Request.QueryString.Get("mid"),Request.QueryString.Get("sssid"), Session.SessionID,"SD_ORDERS_SEARCH","ORDER_NO",SD_ORDER_HEADER_ORDER_NO.Text)
Catch ex As Exception
call insert_sys_log("Retrieving Details",ex.Message)
End Try
End Sub
Public Function verify_new_record_in_recent() As String
Try
dbad.SelectCommand.Connection = Session("db_connection")
 		Dim dsf12 As New Data.DataSet
        	dbad.SelectCommand.CommandText = "select id from SYS_RECENT_TRANSACTIONS where PAGE_ID='SALES_ORDER' and USER_ID='" & session("user_id") & "' and PRIMARY_KEY1='ORDER_NO' and PRIMARY_KEY1_VALUE= '" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
        	dsf12.Clear()
        	dbad.Fill(dsf12)
        	If (dsf12.Tables(0).Rows.Count > 0) Then
 return "N"
Else
 return "Y"
End If
dbad.SelectCommand.Connection.close()
Catch ex as exception
 return "N"
End Try
End Function
Public Function return_recent_rowscn() As String
Try
dbad.SelectCommand.Connection = Session("db_connection")
 		Dim dsf12 As New Data.DataSet
        	dbad.SelectCommand.CommandText = "select rowscn from SYS_RECENT_TRANSACTIONS where PAGE_ID='SALES_ORDER' and USER_ID='" & session("user_id") & "' and PRIMARY_KEY1='ORDER_NO' and PRIMARY_KEY1_VALUE= '" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and rowscn is not null "
        	dsf12.Clear()
        	dbad.Fill(dsf12)
        	If (dsf12.Tables(0).Rows.Count > 0) Then
 return dsf12.Tables(0).Rows(0)(0)
Else
 return ""
End If
dbad.SelectCommand.Connection.close()
Catch ex as exception
 return "N"
End Try
End Function
 Public Sub clear_header()
Try
SD_ORDER_HEADER_ORDER_NO.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_ORDER_DATE.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_CUSTOMER_NO.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_DUE_DATE.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_NAME.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_CUSTOMER_PO_NO.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_TERMS_CODE.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_SHIP_VIA.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_FOB.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_ORDER_NO.BackColor = Drawing.Color.LightYellow
SD_ORDER_HEADER_NAME.BackColor = Drawing.Color.LightYellow
Dim sender As Object
Dim e As System.EventArgs
SD_ORDER_HEADER_ORDER_NO.Text =""
SD_ORDER_HEADER_INPROCESS_MESSAGE.Text =""
SD_ORDER_HEADER_FLS_ORDER_NO.Text =""
SD_ORDER_HEADER_AFFINITY_NO.Text =""
dropdown_list_r1(SD_ORDER_HEADER_BUSINESS_UNIT_CODE,CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_DEFAULT_BUC"))
SD_ORDER_HEADER_REQUESTED_DATE.Text =NOW.DATE()
SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text =""
SD_ORDER_HEADER_ORDER_DATE.Text =NOW.DATE()
SD_ORDER_HEADER_CUSTOMER_NO.Text =Session("linkedcustomerno")
SD_ORDER_HEADER_DUE_DATE.Text =""
SD_ORDER_HEADER_NAME.Text =""
SD_ORDER_HEADER_BLANKET_ORDER.Checked = False
SD_ORDER_HEADER_CUSTOMER_PO_NO.Text =""
SD_ORDER_HEADER_CUSTOMER_PO_DATE.Text =""
SD_ORDER_HEADER_CONTACT_NAME.Text =""
              dropdown_list_r1(SD_ORDER_HEADER_INVOICE_BY,"PACKINGSLIP")
SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Text =""
SD_ORDER_HEADER_CONTACT_PHONE.Text =""
SD_ORDER_HEADER_ADVANCE_AMOUNT.Text =""
SD_ORDER_HEADER_CONTACT_EMAIL.Text =""
SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.Checked = True
SD_ORDER_HEADER_SHIPTO_CODE.Text =""
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Text =""
              dropdown_list_r1(SD_ORDER_HEADER_ORDER_ACK_PREFERENCE,"N")
SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.Checked = False
SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.Text =""
SD_ORDER_HEADER_HOLD.Checked = False
SD_ORDER_HEADER_EXPORT_HOLD.Checked = False
SD_ORDER_HEADER_SHIP_COMPLETE.Checked = True
SD_ORDER_HEADER_INTERNAL_NOTES.Text =""
SD_ORDER_HEADER_ORDER_NOTES.Text =""
SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text =""
SD_ORDER_HEADER_CUSTOMER_MESSAGE.Text ="The employees of Innovative Mag-Drive sincerely appreciate your order. If this acknowledgement is not correct in any way, please notify the Sales department immediately so that corrective action can be taken." & vbCrLf & vbCrLf & "      Very truly yours," & vbCrLf & vbCrLf & "               INNOMAG"
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Text =""
SD_ORDER_HEADER_TERMS_CODE.Text =""
SD_ORDER_HEADER_SHIP_VIA.Text =""
SD_ORDER_HEADER_CARRIER_ACC_NO.Text =""
SD_ORDER_HEADER_FOB.SelectedIndex = -1
SD_ORDER_HEADER_PAYMENT_METHOD.SelectedIndex = -1
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.SelectedIndex = -1
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Text =""
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Text =""
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Text =""
SD_ORDER_HEADER_STREET.Text =""
SD_ORDER_HEADER_CITY.Text =""
SD_ORDER_HEADER_PHONE.Text =""
SD_ORDER_HEADER_FAX.Text =""
SD_ORDER_HEADER_STATE_CODE.Text =""
SD_ORDER_HEADER_EMAIL.Text =""
SD_ORDER_HEADER_POSTAL_CODE.Text =""
SD_ORDER_HEADER_COUNTRY.Text =""
SD_ORDER_HEADER_FREIGHT_BILLING_CONTACT_NAME.Text =""
SD_ORDER_HEADER_FREIGHT_BILLING_NAME.Text =""
SD_ORDER_HEADER_FREIGHT_BILLING_STREET.Text =""
SD_ORDER_HEADER_FREIGHT_BILLING_CITY.Text =""
SD_ORDER_HEADER_FREIGHT_BILLING_PHONE.Text =""
SD_ORDER_HEADER_FREIGHT_BILLING_FAX.Text =""
SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.Text =""
SD_ORDER_HEADER_FREIGHT_BILLING_EMAIL.Text =""
SD_ORDER_HEADER_FREIGHT_BILLING_POSTAL_CODE.Text =""
SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.Text =""
SD_ORDER_HEADER_SHIPPING_CONTACT_NAME.Text =""
SD_ORDER_HEADER_SHIPPING_NAME.Text =""
SD_ORDER_HEADER_SHIPPING_STREET.Text =""
SD_ORDER_HEADER_SHIPPING_CITY.Text =""
SD_ORDER_HEADER_SHIPPING_PHONE.Text =""
SD_ORDER_HEADER_SHIPPING_FAX.Text =""
SD_ORDER_HEADER_SHIPPING_STATE_CODE.Text =""
SD_ORDER_HEADER_SHIPPING_EMAIL.Text =""
SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Text =""
SD_ORDER_HEADER_SHIPPING_COUNTRY.Text =""
SD_ORDER_HEADER_BILLING_CONTACT_NAME.Text =""
SD_ORDER_HEADER_BILLING_NAME.Text =""
SD_ORDER_HEADER_BILLING_STREET.Text =""
SD_ORDER_HEADER_BILLING_CITY.Text =""
SD_ORDER_HEADER_BILLING_PHONE.Text =""
SD_ORDER_HEADER_BILLING_FAX.Text =""
SD_ORDER_HEADER_BILLING_STATE_CODE.Text =""
SD_ORDER_HEADER_BILLING_EMAIL.Text =""
SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text =""
SD_ORDER_HEADER_BILLING_COUNTRY.Text =""
SD_ORDER_HEADER_ITEM_NO.Text =""
SD_ORDER_HEADER_BLANKET_QTY.Text =""
SD_ORDER_HEADER_ORDERING_UOM.Text =""
SD_ORDER_HEADER_BLANKET_QTY_BUOM.Text =""
SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO.Checked = False
SD_ORDER_HEADER_SALES_PRICE.Text =""
SD_ORDER_HEADER_PRICING_UOM.Text ="EA"
SD_ORDER_HEADER_BLANKET_EFFECTIVE_FROM.Text =""
SD_ORDER_HEADER_BLANKET_EFFECTIVE_TILL.Text =""
SD_ORDER_HEADER_BLANKET_RELEASE_NO.Text =""
SD_ORDER_HEADER_BALANCE_QTY_LINE.Checked = False
SD_ORDER_HEADER_ATEX_HOLD.Checked = False
SD_ORDER_HEADER_EST_EXPORT_CLEARANCE_DATE.Text =""
SD_ORDER_HEADER_QUOTATION_NO.Text =""
SD_ORDER_HEADER_CLOSE_DATE.Text =""
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex = -1
SD_ORDER_HEADER_CANCEL_DATE.Text =""
SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text =""
SD_ORDER_HEADER_SE1.Text =""
SD_ORDER_HEADER_SE2.Text =""
SD_ORDER_HEADER_SE_PCT1.Text =""
SD_ORDER_HEADER_SE_PCT2.Text =""
SD_ORDER_HEADER_SE3.Text =""
SD_ORDER_HEADER_SE4.Text =""
SD_ORDER_HEADER_SE_PCT3.Text =""
SD_ORDER_HEADER_SE_PCT4.Text =""
SD_ORDER_HEADER_LICENSE_APPLICATION_REF.Text =""
SD_ORDER_HEADER_QUICK_SHIP.Checked = False
SD_ORDER_HEADER_AES_HOLD.Checked = False
SD_ORDER_HEADER_NONAG.SelectedIndex = -1
SD_ORDER_HEADER_PULL_INVENTORY_FROM_QRC.Checked = False
SD_ORDER_HEADER_INCOTERMS_LOCATION.Text =""
SD_ORDER_HEADER_WEB_ORDER_NO.Text =""
SD_ORDER_HEADER_QRC_LOCATION.SelectedIndex = -1
SD_ORDER_HEADER_WEB_ORDER_CREATED_BY.Text =""
SD_ORDER_HEADER_INPROCESS.Checked = False
SD_ORDER_HEADER_DO_NOT_SERVICE.Checked = False
SD_ORDER_HEADER_SUGGESTED_DATE.Text =""
ORDER_STATUS.TEXT=""
DESCRIPTION.TEXT=""
BL_BAL_QTY.TEXT=""
DISP_SE_CODE1.TEXT=""
DISP_SE_CODE2.TEXT=""
DISP_SE_CODE3.TEXT=""
DISP_SE_CODE4.TEXT=""
DEFAULT_SALES_PRICE_ZERO.TEXT=""
TabPanel0_lbl.Text=SD_ORDER_HEADER_ORDER_NO.Text
Catch ex As Exception
call insert_sys_log("Clear Header",ex.Message)
End Try
End Sub
 Public Sub call_clear_methods(ByVal sender As Object, ByVal e As System.EventArgs)
Try
Call page_rules_every_time()
Try

Catch ex As Exception
 End Try
Try
call SD_ORDER_HEADER_BUSINESS_UNIT_CODE_SelectedIndexChanged(sender, e)
Catch ex As Exception
 End Try
Try
call SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE_TextChanged(sender, e)
Catch ex As Exception
 End Try
Try
call SD_ORDER_HEADER_CUSTOMER_NO_TextChanged(sender, e)
Catch ex As Exception
 End Try
Try
call SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS_CheckedChanged(sender, e)
Catch ex As Exception
 End Try
Call fill_post_query_ddls()
call Copy1_imp
Catch ex As Exception
call insert_sys_log("call Clear metnods",ex.Message)
End Try
End Sub
	Protected Sub Clear_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Clear.Click
Try
session("SALES_ORDER_new_record")="Y"
doc_msg_label_ctORDERHEADER.Text=""
dbgADVANCES.Visible=false
dbgBLANKET_LINES.Visible=false
dbgINVOICE_DETAILS.Visible=false
dbgPACLING_SLIP.Visible=false
dbgPO_DETAILS.Visible=false
dbgQUOTATION_ORDERS.Visible=false
dbgRMA.Visible=false
dbgTRANSFER_DETAILS.Visible=false
dbgWO_ORDERS.Visible=false
dbgWO_ORDERS_1.Visible=false
            Dim dbpage_acess As New Data.DataSet
            Dim aclevel As Integer
            aclevel = 4
Try
            dbad.SelectCommand.CommandText = "select ACCESS_LEVEL from VS_USER_ACCESS_LEVEL where USER_ID='" & UCase(Session("User_id")) & "' and  MENU_FILE_NAME='SALES_ORDER.ASPX' and ACCESS_LEVEL is not null"
            dbpage_acess.Clear()
            dbad.Fill(dbpage_acess)
            If (dbpage_acess.Tables(0).Rows.Count > 0) Then
                aclevel = dbpage_acess.Tables(0).Rows(0)("ACCESS_LEVEL")
            End If
Catch ex As Exception
End Try
 If (aclevel = 3) Then
Save.Visible=True
End If
call clear_header()
 Call Document_related_functions()
 If (SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=TRUE) Then
PANEL5BILLING_ADDRESS.Visible=True
Else
PANEL5BILLING_ADDRESS.Visible=False
End If
 If (SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=TRUE) Then
PANEL5SHIPPING_ADDRESS.Visible=True
Else
PANEL5SHIPPING_ADDRESS.Visible=False
End If
 If (SD_ORDER_HEADER_BASE_CURRENCY_CODE.TEXT<>SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.SELECTEDITEM.VALUE) Then
SD_ORDER_HEADER_BASE_CURRENCY_CODE_L.Visible=True
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY_L.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR_L.Visible=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Visible=True
Else
SD_ORDER_HEADER_BASE_CURRENCY_CODE_L.Visible=False
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY_L.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR_L.Visible=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Visible=False
End If
 If (SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=TRUE) Then
LOVSHIPTO_LOV1152.Visible=True
SD_ORDER_HEADER_SHIPTO_CODE_L.Visible=True
SD_ORDER_HEADER_SHIPTO_CODE.Visible=True
Else
LOVSHIPTO_LOV1152.Visible=False
SD_ORDER_HEADER_SHIPTO_CODE_L.Visible=False
SD_ORDER_HEADER_SHIPTO_CODE.Visible=False
End If
 If (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE) Then
PANEL5BLANKET_ORDER.Visible=True
PANEL5BLANKET_LINES.Visible=True
Else
PANEL5BLANKET_ORDER.Visible=False
PANEL5BLANKET_LINES.Visible=False
End If
 If ((CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="10146685") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="DAREK") OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="BARNAS")) Then
EVENT_BTN_RUN_SCH.Visible=True
Else
EVENT_BTN_RUN_SCH.Visible=False
End If
 If (SD_ORDER_HEADER_SHIP_COMPLETE.CHECKED<>TRUE) Then
EVENT_SHIP_COMPLETE.Visible=True
Else
EVENT_SHIP_COMPLETE.Visible=False
End If
 If ((CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS" ) OR  (CONN.SF_EXECUTE_SQL("SELECT SF_GET_SALES_APPRVAL('" & SESSION("USER_ID") & "')  FROM DUAL")=1) OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT" )) Then
SD_ORDER_HEADER_SUGGESTED_DATE_L.Visible=True
SD_ORDER_HEADER_SUGGESTED_DATE.Visible=True
Else
SD_ORDER_HEADER_SUGGESTED_DATE_L.Visible=False
SD_ORDER_HEADER_SUGGESTED_DATE.Visible=False
End If
 If ((SD_ORDER_HEADER_SUGGESTED_DATE.text<>"" AND (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS") OR  (CONN.SF_EXECUTE_SQL("SELECT SF_GET_SALES_APPRVAL('" & SESSION("USER_ID") & "')  FROM DUAL")=1) OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT"))) Then
EVENT_BTN_UNDO_SUGGEST_DATE.Visible=True
Else
EVENT_BTN_UNDO_SUGGEST_DATE.Visible=False
End If
 If (1=2) Then
COPY1.Visible=True
Else
COPY1.Visible=False
End If
 If ((SD_ORDER_HEADER_SUGGESTED_DATE.text<>"" AND (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="NRENTZELOS") OR  (CONN.SF_EXECUTE_SQL("SELECT SF_GET_SALES_APPRVAL('" & SESSION("USER_ID") & "') FROM DUAL")=1) OR (CONN.SF_EXECUTE_SQL("SELECT '" & SESSION("USER_ID") & "' FROM DUAL")="OCT"))) Then
EVENT_BTN_SUGGEST_DATE.Visible=True
Else
EVENT_BTN_SUGGEST_DATE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL("SELECT count(*) FROM GE_TERMS_CODES_DETAILS WHERE TERMS_CODE=NVL('" & SD_ORDER_HEADER_TERMS_CODE.TEXT & "' ,'NOTERMS_!@#')")>0) Then
PANEL5BILLING_STAGE.Visible=True
Else
PANEL5BILLING_STAGE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT EDIT_SHIP_DELIVERY_DATE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="D") Then
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE_L.Visible=True
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Visible=True
Else
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE_L.Visible=False
SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT EDIT_SHIP_DELIVERY_DATE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="S") Then
SD_ORDER_HEADER_DUE_DATE_L.Visible=True
SD_ORDER_HEADER_DUE_DATE.Visible=True
Else
SD_ORDER_HEADER_DUE_DATE_L.Visible=False
SD_ORDER_HEADER_DUE_DATE.Visible=False
End If
 If (CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<>"Close") Then
SAVE.Visible=True
Else
SAVE.Visible=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT SF_CHECK_EXPORT_HOLD('" & SESSION("USER_ID") & "') FROM DUAL ")<>"N") Then
SD_ORDER_HEADER_EXPORT_HOLD.Enabled=True
Else
SD_ORDER_HEADER_EXPORT_HOLD.Enabled=False
End If
 If ((SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE AND CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<> "Close") OR (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE AND CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")= "Open") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,'H','" & SESSION("USER_ID") & "')")="Y")) Then
AddGridRowORDERDETAIL.Enabled=True
AddGridRowORDERDETAIL_1.Enabled=True
DELETEGridRowORDERDETAIL.Enabled=True
DELETEGridRowORDERDETAIL_1.Enabled=True
Else
AddGridRowORDERDETAIL.Enabled=False
AddGridRowORDERDETAIL_1.Enabled=False
DELETEGridRowORDERDETAIL.Enabled=False
DELETEGridRowORDERDETAIL_1.Enabled=False
End If
 If (CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<> "Close") Then
SD_ORDER_HEADER_REQUESTED_DATE.Enabled=True
SD_ORDER_HEADER_ORDER_DATE.Enabled=True
Else
SD_ORDER_HEADER_REQUESTED_DATE.Enabled=False
SD_ORDER_HEADER_ORDER_DATE.Enabled=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT SF_CHECK_AES_HOLD('" & SESSION("USER_ID") & "') FROM DUAL ")<>"N") Then
SD_ORDER_HEADER_AES_HOLD.Enabled=True
Else
SD_ORDER_HEADER_AES_HOLD.Enabled=False
End If
 If (CONN.SF_EXECUTE_SQL ("SELECT SF_CHECK_ATEX_HOLD('" & SESSION("USER_ID") & "') FROM DUAL ")<>"N") Then
SD_ORDER_HEADER_ATEX_HOLD.Enabled=True
Else
SD_ORDER_HEADER_ATEX_HOLD.Enabled=False
End If
 If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM SD_INVOICE_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ")=0) Then
SD_ORDER_HEADER_TERMS_CODE.Enabled=True
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Enabled=True
SD_ORDER_HEADER_SHIP_VIA.Enabled=True
SD_ORDER_HEADER_PAYMENT_METHOD.Enabled=True
SD_ORDER_HEADER_FOB.Enabled=True
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Enabled=True
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Enabled=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Enabled=True
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Enabled=True
Else
SD_ORDER_HEADER_TERMS_CODE.Enabled=False
SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Enabled=False
SD_ORDER_HEADER_SHIP_VIA.Enabled=False
SD_ORDER_HEADER_PAYMENT_METHOD.Enabled=False
SD_ORDER_HEADER_FOB.Enabled=False
SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE.Enabled=False
SD_ORDER_HEADER_BASE_CURRENCY_CODE.Enabled=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Enabled=False
SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Enabled=False
End If
call clear_detail_grid()
call clear_detail_form()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_HEADER_BALANCE_QTY_LINE.Focus()
Else
    ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_HEADER_BALANCE_QTY_LINE.ClientID & "');", True)
    ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_HEADER_BALANCE_QTY_LINE.ClientID & "');", True)
End If
Catch ex As Exception
call insert_sys_log("New Button",ex.Message)
End Try
        End Sub
Public Function delete_verification_setup_header() As String
Try
dbad.SelectCommand.Connection = Session("db_connection")
 Dim f1 As Integer
 Dim stsetup As String
Dim dvsetup0 As New Data.DataSet
stsetup=""
dbad.SelectCommand.CommandText ="SELECT  WORK_ORDER_NO FROM  MFG_WO_SALES_ORDERS WHERE  SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' AND ROWNUM<6"
dvsetup0 .Clear()
dbad.Fill(dvsetup0 )
 If (dvsetup0 .Tables(0).Rows.Count > 0) Then
  For f1 = 0 To dvsetup0 .Tables(0).Rows.Count - 1
 If Not (Equals(dvsetup0.Tables(0).Rows(f1)(0), System.DBNull.Value)) Then
stsetup=stsetup & dvsetup0.Tables(0).Rows(f1)(0) & ","
End If
Next
stsetup="Cannot perform delete operation as it is used in Work Order Nos : " & stsetup 
        Return stsetup
End If
Dim dvsetup1 As New Data.DataSet
stsetup=""
dbad.SelectCommand.CommandText ="SELECT  PACKING_SLIP_NO FROM  SD_PACKING_SLIP_DETAIL WHERE  ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' AND ROWNUM<6"
dvsetup1 .Clear()
dbad.Fill(dvsetup1 )
 If (dvsetup1 .Tables(0).Rows.Count > 0) Then
  For f1 = 0 To dvsetup1 .Tables(0).Rows.Count - 1
 If Not (Equals(dvsetup1.Tables(0).Rows(f1)(0), System.DBNull.Value)) Then
stsetup=stsetup & dvsetup1.Tables(0).Rows(f1)(0) & ","
End If
Next
stsetup="Cannot perform delete operation as it is used in Packing Slip Nos : " & stsetup 
        Return stsetup
End If
Dim dvsetup2 As New Data.DataSet
stsetup=""
dbad.SelectCommand.CommandText ="SELECT  INVOICE_NO FROM  SD_INVOICE_DETAIL WHERE  ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' AND ROWNUM<6"
dvsetup2 .Clear()
dbad.Fill(dvsetup2 )
 If (dvsetup2 .Tables(0).Rows.Count > 0) Then
  For f1 = 0 To dvsetup2 .Tables(0).Rows.Count - 1
 If Not (Equals(dvsetup2.Tables(0).Rows(f1)(0), System.DBNull.Value)) Then
stsetup=stsetup & dvsetup2.Tables(0).Rows(f1)(0) & ","
End If
Next
stsetup="Cannot perform delete operation as it is used in Invoice Nos :" & stsetup 
        Return stsetup
End If
dbad.SelectCommand.Connection.Close()
Catch ex As Exception
call insert_sys_log("Delete Verification",ex.Message)
End Try
        Return "Y"
    End Function
 Protected Sub Delete_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Delete.Click
Try
call conn.call_before_delete("SALES_ORDER", session("user_id"),Request.QueryString.Get("mid"),Request.QueryString.Get("sssid"), Session.SessionID,"SD_ORDERS_SEARCH","ORDER_NO",SD_ORDER_HEADER_ORDER_NO.Text)
        If (SD_ORDER_HEADER_ORDER_NO.Text <>"" ) Then
Dim delete_verify_flag As String
delete_verify_flag="Y"
delete_verify_flag=delete_verification_setup_header()
If (delete_verify_flag="Y") Then
dbad.DeleteCommand.Connection = Session("db_connection")
       Call delete_details()
       Call delete_details_form()
            If (dbad.DeleteCommand.Connection.State = Data.ConnectionState.Closed) Then
                dbad.DeleteCommand.Connection.Open()
            End If
            dbad.DeleteCommand.CommandText = "delete from SD_ORDER_HEADER where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
            dbad.DeleteCommand.ExecuteNonQuery()
        dbad.DeleteCommand.CommandText = "DELETE FROM SD_ORDER_DETAIL_EXTRA_CHARGES  where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
	                If (dbad.DeleteCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.DeleteCommand.Connection.Open()
                	End If
        dbad.DeleteCommand.ExecuteNonQuery()
dbad.SelectCommand.Connection = Session("db_connection")
 		Dim dsf12 As New Data.DataSet
        	dbad.SelectCommand.CommandText = "select id from SYS_RECENT_TRANSACTIONS where PAGE_ID='SALES_ORDER' and USER_ID='" & session("user_id") & "' and PRIMARY_KEY1='ORDER_NO' and PRIMARY_KEY1_VALUE= '" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
        	dsf12.Clear()
        	dbad.Fill(dsf12)
        	If (dsf12.Tables(0).Rows.Count > 0) Then
            If (dbad.DeleteCommand.Connection.State = Data.ConnectionState.Closed) Then
                dbad.DeleteCommand.Connection.Open()
            End If
			dbad.DeleteCommand.CommandText = "Delete from SYS_RECENT_TRANSACTIONS where PAGE_ID='SALES_ORDER' and USER_ID='" & session("user_id") & "' and PRIMARY_KEY1='ORDER_NO' and PRIMARY_KEY1_VALUE= '" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
	                dbad.DeleteCommand.ExecuteNonQuery()
           End If
dbad.SelectCommand.Connection.Close()
Try
dbad.DeleteCommand.CommandText ="DELETE FROM SYS_LINKED_DOC_TAGS WHERE REC_ID IN (SELECT REC_ID FROM SYS_LINKED_DOCS WHERE PAGE_ID=UPPER('SALES_ORDER') AND PRIMAY_KEY1='" & SD_ORDER_HEADER_ORDER_NO.Text & "') "
            If (dbad.DeleteCommand.Connection.State = Data.ConnectionState.Closed) Then
                dbad.DeleteCommand.Connection.Open()
            End If
	                dbad.DeleteCommand.ExecuteNonQuery()
dbad.DeleteCommand.CommandText ="DELETE FROM SYS_LINKED_DOCS WHERE PAGE_ID=UPPER('SALES_ORDER') AND PRIMAY_KEY1='" & SD_ORDER_HEADER_ORDER_NO.Text & "' "
            If (dbad.DeleteCommand.Connection.State = Data.ConnectionState.Closed) Then
                dbad.DeleteCommand.Connection.Open()
            End If
	                dbad.DeleteCommand.ExecuteNonQuery()
Catch ex As Exception
call insert_sys_log("Delete linked Docs",ex.Message)
End Try
dbad.DeleteCommand.CommandText ="DELETE FROM SYS_APPROVAL_DOCUMENTS WHERE PAGE_ID=UPPER('SALES_ORDER') AND DOCUMENT_REFERENCE1='" & SD_ORDER_HEADER_ORDER_NO.Text & "' "
            If (dbad.DeleteCommand.Connection.State = Data.ConnectionState.Closed) Then
                dbad.DeleteCommand.Connection.Open()
            End If
	                dbad.DeleteCommand.ExecuteNonQuery()
 dbad.DeleteCommand.Connection.Close()
Try
                        dbad.InsertCommand.Connection = Session("db_connection")

                        dbad.InsertCommand.CommandText = "INSERT INTO SYS_DELETE_LOG (ID, DOC_TYPE, DOC_NO, DELETED_BY, DELETED_DATE) VALUES((SELECT NVL(MAX(ID),0)+1 FROM SYS_DELETE_LOG),'SALES_ORDER','" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "','" & Session("USER_ID") & "',SYSDATE)"
                        If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
                            dbad.InsertCommand.Connection.Open()
                        End If
                        dbad.InsertCommand.ExecuteNonQuery()
                        dbad.InsertCommand.Connection.Close()
                    Catch ex As Exception
                        Call insert_sys_log("Delete insert", ex.Message)
                    End Try
Call clear_header()
Call clear_detail_grid()
call clear_detail_form()
 Call MOVE_LAST_Click(sender,e)
Else
If (delete_verify_flag="N") Then
exception_message.Text="Can't Perform Delete Operation, As This Document Is Used In Another Place"
Else
exception_message.Text=delete_verify_flag
        End If
err_message.Visible=False
exception_message.visible=True
mpanel.Visible = True
        End If
        End If
call conn.call_after_delete("SALES_ORDER", session("user_id"),Request.QueryString.Get("mid"),Request.QueryString.Get("sssid"), Session.SessionID,"SD_ORDERS_SEARCH","ORDER_NO",SD_ORDER_HEADER_ORDER_NO.Text)
Catch ex As Exception
call insert_sys_log("Delete Button",ex.Message)
End Try
 End Sub
Protected Sub PageContainer_ActiveTabChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles PageContainer.ActiveTabChanged
 End Sub
 Public Function replace_c(ByVal p As String) As String
        p = Replace(p, "'", "''")
        Return p
    End Function
Public Function replace_c4(ByVal p As String) As String
        If (Len(p) > 3997) Then
            p = Mid(p, 1, 3997)
        End If
        p = Replace(p, "'", "''")
        Return p
    End Function
Public Function replace_c1(ByVal p As String) As String
        If (p <> "") Then
            If (IsNumeric(p)) Then
                Return p
            Else
                p = "null"
            End If
        Else
            p = "null"
        End If
        Return p
    End Function
 Public Sub execute_storeProcedure(ByVal fname As String, ByVal plist As String, ByVal plist1 As String,ByVal plist2 as String)
        Dim s As String
        s = ""
        Dim pu1, pu2, pu3
        Dim rct, pp As Integer
        If (plist <> "") Then
            pu1 = Split(plist, "#")
            pu2 = Split(plist1, "#")
   pu3 = Split(plist2, "#")
            If (UBound(pu1) > 0) Then
                rct = UBound(pu1)
            Else
                rct = 0
            End If
        Else
            rct = -1
        End If
        Dim rvalue As String
        dbad.SelectCommand.Connection = Session("db_connection")
        dbad.SelectCommand.Parameters.Clear()
        dbad.SelectCommand.CommandType = Data.CommandType.Text
        If (rct = -1) Then
            dbad.SelectCommand.CommandText = ("{call " & fname & "()}")
        Else
            If (rct = 0) Then
                dbad.SelectCommand.CommandText = ("{call " & fname & "(?)}")
            Else
                Dim rrr As String
                rrr = ""
                For pp = 0 To rct
                    rrr = rrr & "?" & ","
                Next
                rrr = Mid(rrr, 1, Len(rrr) - 1)
                dbad.SelectCommand.CommandText = ("{call " & fname & "(" & rrr & ")}")
            End If
        End If
        If (rct >= 0) Then
            If (rct = 0) Then
 If (UCase(plist2) = "N") Then
dbad.SelectCommand.Parameters.Add(New Data.OleDb.OleDbParameter( plist1 , System.Data.OleDb.OleDbType.Double, 20, System.Data.ParameterDirection.Input, False, CType(0, Byte), CType(0, Byte), "", Data.DataRowVersion.Current, plist))
Else
dbad.SelectCommand.Parameters.Add(New Data.OleDb.OleDbParameter( plist1 , System.Data.OleDb.OleDbType.VarChar, 2000, System.Data.ParameterDirection.Input, False, CType(0, Byte), CType(0, Byte), "", Data.DataRowVersion.Current, plist))
End If
            Else
                For pp = 0 To rct
 If (UCase(pu3(pp)) = "N") Then
dbad.SelectCommand.Parameters.Add(New Data.OleDb.OleDbParameter(  pu2(pp) , System.Data.OleDb.OleDbType.Double, 20, System.Data.ParameterDirection.Input, False, CType(0, Byte), CType(0, Byte), "", Data.DataRowVersion.Current,  pu1(pp)))
Else
dbad.SelectCommand.Parameters.Add(New Data.OleDb.OleDbParameter(  pu2(pp) , System.Data.OleDb.OleDbType.VarChar, 2000, System.Data.ParameterDirection.Input, False, CType(0, Byte), CType(0, Byte), "", Data.DataRowVersion.Current,  pu1(pp)))
End If
                Next
            End If
        End If
        If (dbad.SelectCommand.Connection.State = Data.ConnectionState.Closed) Then
            dbad.SelectCommand.Connection.Open()
        End If
        Try
            dbad.SelectCommand.ExecuteNonQuery()
        Catch exException As Exception
            dbad.SelectCommand.Connection.Close()
        End Try
        dbad.SelectCommand.Connection.Close()
    End Sub
Public Function validate_date(ByVal p As String) As String
        Dim s As String
        s = ""
        Dim s1, s2, s3, s4 As String
        If (p <> "") Then
            If (IsDate(p)) Then
                Return p
            End If
            s1 = Replace(p, "/", "")
            s1 = Replace(s1, "-", "")
            If (Len(s1) = 8 Or Len(s1) = 6) Then
                s2 = Mid(s1, 1, 2)
                s3 = Mid(s1, 3, 2)
                s1 = Mid(s1, 5, Len(s1))
                s2 = Replace(s2, "0", "")
                s3 = Replace(s3, "0", "")
                If (Len(s1) = 2) Then
                    s4 = Mid(Now.Year.ToString(), 1, 2)
                    s1 = s4 & s1
                End If
                s = s2 & "/" & s3 & "/" & s1
                If (IsDate(s)) Then
                    Return s
                Else
                    err_message.Text = "Date should be either mm/dd/yy or mm/dd/yyyy format"
err_message.Visible=True
exception_message.Visible = False
                    mpanel.Visible = True
                    Return p
                End If
            Else
                err_message.Text = "Date should be either mm/dd/yy or mm/dd/yyyy format"
err_message.Visible=True
exception_message.Visible = False
                mpanel.Visible = True
                Return p
            End If
        End If
        Return s
    End Function
Public Function retrive_format(ByVal fname As String, ByVal plist As String) As String
        Dim s As String
        s = ""
        Dim pu1
        Dim rct, pp As Integer
        If (plist <> "") Then
            pu1 = Split(plist, ",")
            If (UBound(pu1) > 0) Then
                rct = UBound(pu1)
            Else
                rct = 1
            End If
        Else
            rct = 0
        End If
        Dim rvalue As String
        dbad.SelectCommand.Connection = Session("db_connection")
        dbad.SelectCommand.Parameters.Clear()
        dbad.SelectCommand.CommandType = Data.CommandType.Text
        If (rct = 0) Then
            dbad.SelectCommand.CommandText = ("{?=call " & fname & "()}")
        Else
            If (rct = 1) Then
                dbad.SelectCommand.CommandText = ("{?=call " & fname & "(?)}")
            Else
                Dim rrr As String
                rrr = ""
                For pp = 1 To rct
                    rrr = rrr & "?" & ","
                Next
                rrr = Mid(rrr, 1, Len(rrr) - 1)
                dbad.SelectCommand.CommandText = ("{?=call " & fname & "(" & rrr & ")}")
            End If
        End If
        dbad.SelectCommand.Parameters.Add(New System.Data.OleDb.OleDbParameter("p_return1", System.Data.OleDb.OleDbType.VarChar, 2000))
        dbad.SelectCommand.Parameters(0).Direction = Data.ParameterDirection.ReturnValue
        If (rct > 0) Then
            If (rct = 1) Then
                dbad.SelectCommand.Parameters.Add(New Data.OleDb.OleDbParameter("p_parem1", System.Data.OleDb.OleDbType.VarChar, 20, System.Data.ParameterDirection.Input, False, CType(0, Byte), CType(0, Byte), "", Data.DataRowVersion.Current, plist))
            Else
                For pp = 0 To rct
                    dbad.SelectCommand.Parameters.Add(New Data.OleDb.OleDbParameter("p_parem" & pp + 1, System.Data.OleDb.OleDbType.VarChar, 20, System.Data.ParameterDirection.Input, False, CType(0, Byte), CType(0, Byte), "", Data.DataRowVersion.Current, pu1(pp)))

                Next
            End If
        End If
        If (dbad.SelectCommand.Connection.State = Data.ConnectionState.Closed) Then
            dbad.SelectCommand.Connection.Open()
        End If
        Try
            dbad.SelectCommand.ExecuteNonQuery()
            If Not (Equals(dbad.SelectCommand.Parameters(0).Value, System.DBNull.Value)) Then
                rvalue = dbad.SelectCommand.Parameters(0).Value
            Else
                rvalue = ""
            End If
            s = rvalue
        Catch exException As Exception
            dbad.SelectCommand.Connection.Close()
        End Try
        dbad.SelectCommand.Connection.Close()
        Return s
    End Function
	Public Function replace_format(ByVal p As String) As String
        Dim s As String
        Dim rvalue As String
        dbad.SelectCommand.Connection = Session("db_connection")
        dbad.SelectCommand.Parameters.Clear()
        dbad.SelectCommand.CommandType = Data.CommandType.Text
        dbad.SelectCommand.CommandText = "{?=call SF_REMOVE_FORMAT_WEB(?)}"
        dbad.SelectCommand.Parameters.Add(New System.Data.OleDb.OleDbParameter("p_return1", System.Data.OleDb.OleDbType.VarChar, 2000))
        dbad.SelectCommand.Parameters(0).Direction = Data.ParameterDirection.ReturnValue
        dbad.SelectCommand.Parameters.Add(New Data.OleDb.OleDbParameter("p_parem1", System.Data.OleDb.OleDbType.VarChar, 20, System.Data.ParameterDirection.Input, False, CType(0, Byte), CType(0, Byte), "", Data.DataRowVersion.Current, p))
        If (dbad.SelectCommand.Connection.State = Data.ConnectionState.Closed) Then
            dbad.SelectCommand.Connection.Open()
        End If
        Try
            dbad.SelectCommand.ExecuteNonQuery()
            If Not (Equals(dbad.SelectCommand.Parameters(0).Value, System.DBNull.Value)) Then
                rvalue = dbad.SelectCommand.Parameters(0).Value
            Else
                rvalue = ""
            End If
            s = rvalue
        Catch exException As Exception
            dbad.SelectCommand.Connection.Close()
        End Try
        dbad.SelectCommand.Connection.Close()
        Return s
    End Function
    Public Function dropdown_list(ByVal opv1 As DropDownList) As String
        Dim s As String
        If (opv1.SelectedIndex > 0) Then
            s = opv1.SelectedItem.Text
        Else
            s = ""
        End If
        Return s
    End Function
    Public Function dropdown_list1(ByVal opv1 As DropDownList) As String
        Dim s As String
        If (opv1.SelectedIndex > 0) Then
            s = opv1.SelectedItem.Value & "{_}" & opv1.SelectedItem.Text
        Else
            s = ""
        End If
        Return s
    End Function
    Public Function dropdown_list2(ByVal opv1 As DropDownList) As String
        Dim s As String
        If (opv1.SelectedIndex > 0) Then
            s = opv1.SelectedItem.Value
        Else
            s = ""
        End If
        Return s
    End Function
    Public Sub dropdown_list_r(ByVal opv3 As DropDownList, ByVal s As String)
        Dim ddd As Integer
        For ddd = 0 To opv3.Items.Count - 1
            If (Trim(UCase(opv3.Items(ddd).Text)) = Trim(UCase(s))) Then
                opv3.SelectedIndex = ddd
            End If
        Next
    End Sub
    Public Sub dropdown_list_r1(ByVal opv3 As DropDownList, ByVal s As String)
        Dim ddd As Integer
        For ddd = 0 To opv3.Items.Count - 1
            If (Trim(UCase(opv3.Items(ddd).Value)) = Trim(UCase(s))) Then
                opv3.SelectedIndex = ddd
            End If
        Next
    End Sub
    Public Function check_box_r(ByVal ck As CheckBox) As String
        Dim s As String
        If (ck.Checked = True) Then
            s = "Y"
        Else
            s = "N"
        End If
        Return s
    End Function
    Public Sub check_box_fill(ByVal ck As CheckBox, ByVal s As String)
        If (s = "Y") Then
            ck.Checked = True
        Else
            ck.Checked = False
        End If
    End Sub
    Public Function radio_box_r(ByVal ck As RadioButton) As String
        Dim s As String
        If (ck.Checked = True) Then
            s = "Y"
        Else
            s = "N"
        End If
        Return s
    End Function
    Public Sub radio_box_fill(ByVal ck As RadioButton, ByVal s As String)
        If (s = "Y") Then
            ck.Checked = True
        Else
            ck.Checked = False
        End If
    End Sub
    Public Function radiobutton_list(ByVal opv2 As RadioButtonList) As String
        Dim s As String
        If (opv2.SelectedIndex >= 0) Then
            s = opv2.SelectedItem.value
        Else
            s = ""
        End If
        Return s
    End Function
    Public Function checkbox_list(ByVal opv3 As CheckBoxList) As String
        Dim s As String
        Dim ddd As Integer
        s = ""
        For ddd = 0 To opv3.Items.Count - 1
            If (opv3.Items(ddd).Selected = True) Then
                s = s & opv3.Items(ddd).value & "{_}"
            End If
        Next
        If (s <> "") Then
            s = Mid(s, 1, Len(s) - 3)
        Else
            s = ""
        End If
        Return s
    End Function
    Public Sub checkbox_list_r(ByVal opv3 As CheckBoxList, ByVal s As String)
        Dim p
        Dim ddd, ddd1 As Integer
        p = Split(s, "{_}")
        For ddd1 = 0 To UBound(p)
            For ddd = 0 To opv3.Items.Count - 1
                If (opv3.Items(ddd).value = p(ddd1)) Then
                    opv3.Items(ddd).Selected = True
                End If
            Next
        Next
    End Sub
    Public Sub radiobutton_list_r(ByVal opv3 As RadioButtonList, ByVal s As String)
        Dim ddd As Integer
        For ddd = 0 To opv3.Items.Count - 1
            If (opv3.Items(ddd).value = s) Then
                opv3.Items(ddd).Selected = True
Else
opv3.Items(ddd).Selected = False
            End If
        Next
    End Sub
 Public Sub checkbox_list_C(ByVal opv3 As CheckBoxList)
        Dim ddd As Integer
        For ddd = 0 To opv3.Items.Count - 1
            opv3.Items(ddd).Selected = False
        Next
    End Sub
    Public Sub radiobutton_list_C(ByVal opv3 As RadioButtonList)
        Dim ddd As Integer
        For ddd = 0 To opv3.Items.Count - 1
            opv3.Items(ddd).Selected = False
        Next
    End Sub
Protected Sub Imag12ORDERHEADER_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Imag12ORDERHEADER.Click
if save.visible=True Then
  Call save_Click(sender, e)
End If
if not(mpanel.Visible=True and exception_message.Visible=True) Then
Dim strFile As String = "Doc"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y" ) Then
 strCmd= String.Format("window.open('SYS_DOCUMENT_MANAGEMNET.aspx?page_id=SALES_ORDER&Header_flag=Y');", strFile)
Else
strCmd = String.Format("window.showModalDialog('SYS_DOCUMENT_MANAGEMNET.aspx?page_id=SALES_ORDER&Header_flag=Y',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN6", strCmd, True)
End If
    End Sub
Protected Sub E_Mail123_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles E_Mail123.Click
dbad.SelectCommand.Connection = Session("db_connection")
Dim dbprintsave  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT VALUE FROM SYS_TOOL_SETTINGS WHERE KEY='SAVE_BEFORE_PRINT' AND NVL(VALUE,'N')='Y'"
dbprintsave.Clear()
dbad.Fill(dbprintsave)
if (dbprintsave.Tables(0).Rows.Count>0) Then
 If (Save.Enabled = True And Save.Visible = True) Then
  Call save_Click(sender, e)
If (save_sucess_flag<>"Y") Then
    Exit Sub
End If
End If
End if
dbad.SelectCommand.Connection.close()
Dim strFile As String = "Report"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd = String.Format("window.open('Email_Inbox2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EMAIL&apifields=ORDER_NO[_]&rptnm=Order_Printing.repx,SalesRules.repx&vwnm=SALES_ORDER_REPORT_E&toemail=" & SD_ORDER_HEADER_CONTACT_EMAIL.Text & "&sf=yes&actiontypes=VARCHAR2[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=ORDER_EMAIL&rptcopies=1');", strFile)
Else
strCmd = String.Format("window.showModalDialog('Email_Inbox2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EMAIL&apifields=ORDER_NO[_]&rptnm=Order_Printing.repx,SalesRules.repx&vwnm=SALES_ORDER_REPORT_E&toemail=" & SD_ORDER_HEADER_CONTACT_EMAIL.Text & "&sf=yes&actiontypes=VARCHAR2[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=ORDER_EMAIL&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Public Shared Function FindControlRecursive(ByVal Root As Control, ByVal Id As String) As Control
        If Root.ID = Id Then
            Return Root
        End If

        For Each Ctl As Control In Root.Controls
            Dim FoundCtl As Control = FindControlRecursive(Ctl, Id)
            If FoundCtl IsNot Nothing Then
                Return FoundCtl
            End If
        Next
        Return Nothing
    End Function
    Protected Sub RRel_11_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_11.Click
dbad.SelectCommand.Connection = Session("db_connection")
Dim dbprintsave  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT VALUE FROM SYS_TOOL_SETTINGS WHERE KEY='SAVE_BEFORE_PRINT' AND NVL(VALUE,'N')='Y'"
dbprintsave.Clear()
dbad.Fill(dbprintsave)
if (dbprintsave.Tables(0).Rows.Count>0) Then
 If (Save.Enabled = True And Save.Visible = True) Then
  Call save_Click(sender, e)
If (save_sucess_flag<>"Y") Then
    Exit Sub
End If
End If
End if
dbad.SelectCommand.Connection.close()
If (SD_ORDER_HEADER_BLANKET_ORDER.checked=True) Then
Dim strFile10 As String = "Report"
Dim strCmd10 As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd10 = String.Format("window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Blanket_Order_Printing.repx&vwnm=SALES_ORDER_REPORT_E&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=11&rptcopies=1');", strFile10)
Else
strCmd10 = String.Format("window.showModalDialog('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Blanket_Order_Printing.repx&vwnm=SALES_ORDER_REPORT_E&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=11&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile10)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN19", strCmd10, True)
Exit sub
End if
Dim strFile As String = "Report"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd = String.Format("window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Order_Printing.repx,SalesRules.repx&vwnm=SALES_ORDER_REPORT_E&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=11&rptcopies=1');", strFile)
Else
strCmd = String.Format("window.showModalDialog('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Order_Printing.repx,SalesRules.repx&vwnm=SALES_ORDER_REPORT_E&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=11&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_PROFORMA_INVOICE_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_PROFORMA_INVOICE.Click
dbad.SelectCommand.Connection = Session("db_connection")
Dim dbprintsave  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT VALUE FROM SYS_TOOL_SETTINGS WHERE KEY='SAVE_BEFORE_PRINT' AND NVL(VALUE,'N')='Y'"
dbprintsave.Clear()
dbad.Fill(dbprintsave)
if (dbprintsave.Tables(0).Rows.Count>0) Then
 If (Save.Enabled = True And Save.Visible = True) Then
  Call save_Click(sender, e)
If (save_sucess_flag<>"Y") Then
    Exit Sub
End If
End If
End if
dbad.SelectCommand.Connection.close()
Dim strFile As String = "Report"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd = String.Format("window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Proforma_Invoice.repx&vwnm=&toemail=&sf=yes&actiontypes=C[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=PROFORMA_INVOICE&rptcopies=1');", strFile)
Else
strCmd = String.Format("window.showModalDialog('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Proforma_Invoice.repx&vwnm=&toemail=&sf=yes&actiontypes=C[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=PROFORMA_INVOICE&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_SALES_ORDER_BOM_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_SALES_ORDER_BOM.Click
dbad.SelectCommand.Connection = Session("db_connection")
Dim dbprintsave  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT VALUE FROM SYS_TOOL_SETTINGS WHERE KEY='SAVE_BEFORE_PRINT' AND NVL(VALUE,'N')='Y'"
dbprintsave.Clear()
dbad.Fill(dbprintsave)
if (dbprintsave.Tables(0).Rows.Count>0) Then
 If (Save.Enabled = True And Save.Visible = True) Then
  Call save_Click(sender, e)
If (save_sucess_flag<>"Y") Then
    Exit Sub
End If
End If
End if
dbad.SelectCommand.Connection.close()
Dim strFile As String = "Report"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd = String.Format("window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Order_Printing_subassembly.repx&vwnm=SALES_ORDER_REPORT_G&toemail=&sf=no&actiontypes=&rptprint=N&rptpreview=Y&RELATED_LINK_ID=SALES_ORDER_BOM&rptcopies=1');", strFile)
Else
strCmd = String.Format("window.showModalDialog('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Order_Printing_subassembly.repx&vwnm=SALES_ORDER_REPORT_G&toemail=&sf=no&actiontypes=&rptprint=N&rptpreview=Y&RELATED_LINK_ID=SALES_ORDER_BOM&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_SALES_ITEM_LABEL_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_SALES_ITEM_LABEL.Click
dbad.SelectCommand.Connection = Session("db_connection")
Dim dbprintsave  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT VALUE FROM SYS_TOOL_SETTINGS WHERE KEY='SAVE_BEFORE_PRINT' AND NVL(VALUE,'N')='Y'"
dbprintsave.Clear()
dbad.Fill(dbprintsave)
if (dbprintsave.Tables(0).Rows.Count>0) Then
 If (Save.Enabled = True And Save.Visible = True) Then
  Call save_Click(sender, e)
If (save_sucess_flag<>"Y") Then
    Exit Sub
End If
End If
End if
dbad.SelectCommand.Connection.close()
Dim strFile As String = "Report"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd = String.Format("window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Sales_Order_Item_Label.repx&vwnm=SALES_ORDER_REPORT_G&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=SALES_ITEM_LABEL&rptcopies=1');", strFile)
Else
strCmd = String.Format("window.showModalDialog('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Sales_Order_Item_Label.repx&vwnm=SALES_ORDER_REPORT_G&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=SALES_ITEM_LABEL&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_PUMP_CODE_SERIAL_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_PUMP_CODE_SERIAL.Click
dbad.SelectCommand.Connection = Session("db_connection")
Dim dbprintsave  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT VALUE FROM SYS_TOOL_SETTINGS WHERE KEY='SAVE_BEFORE_PRINT' AND NVL(VALUE,'N')='Y'"
dbprintsave.Clear()
dbad.Fill(dbprintsave)
if (dbprintsave.Tables(0).Rows.Count>0) Then
 If (Save.Enabled = True And Save.Visible = True) Then
  Call save_Click(sender, e)
If (save_sucess_flag<>"Y") Then
    Exit Sub
End If
End If
End if
dbad.SelectCommand.Connection.close()
Dim strFile As String = "Report"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd = String.Format("window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Pump_Code_Label.repx&vwnm=SALES_ORDER_REPORT_G&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=PUMP_CODE_SERIAL&rptcopies=1');", strFile)
Else
strCmd = String.Format("window.showModalDialog('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Pump_Code_Label.repx&vwnm=SALES_ORDER_REPORT_G&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=PUMP_CODE_SERIAL&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_15_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_15.Click
dbad.SelectCommand.Connection = Session("db_connection")
Dim dbprintsave  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT VALUE FROM SYS_TOOL_SETTINGS WHERE KEY='SAVE_BEFORE_PRINT' AND NVL(VALUE,'N')='Y'"
dbprintsave.Clear()
dbad.Fill(dbprintsave)
if (dbprintsave.Tables(0).Rows.Count>0) Then
 If (Save.Enabled = True And Save.Visible = True) Then
  Call save_Click(sender, e)
If (save_sucess_flag<>"Y") Then
    Exit Sub
End If
End If
End if
dbad.SelectCommand.Connection.close()
Dim strFile As String = "Report"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd = String.Format("window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Declaration_Of_Conformity.Repx&vwnm=&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=15&rptcopies=1');", strFile)
Else
strCmd = String.Format("window.showModalDialog('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Declaration_Of_Conformity.Repx&vwnm=&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=15&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_DECLARATION_ATEX_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_DECLARATION_ATEX.Click
dbad.SelectCommand.Connection = Session("db_connection")
Dim dbprintsave  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT VALUE FROM SYS_TOOL_SETTINGS WHERE KEY='SAVE_BEFORE_PRINT' AND NVL(VALUE,'N')='Y'"
dbprintsave.Clear()
dbad.Fill(dbprintsave)
if (dbprintsave.Tables(0).Rows.Count>0) Then
 If (Save.Enabled = True And Save.Visible = True) Then
  Call save_Click(sender, e)
If (save_sucess_flag<>"Y") Then
    Exit Sub
End If
End If
End if
dbad.SelectCommand.Connection.close()
Dim strFile As String = "Report"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd = String.Format("window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Declaration_Of_Conformity_Atexunckeck.Repx&vwnm=&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=DECLARATION_ATEX&rptcopies=1');", strFile)
Else
strCmd = String.Format("window.showModalDialog('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Declaration_Of_Conformity_Atexunckeck.Repx&vwnm=&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=DECLARATION_ATEX&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_ORDERS_BY_CUSTOMER_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_ORDERS_BY_CUSTOMER.Click
Dim strFile As String = "Report"
Dim strCmd As String = String.Format("dsprddlk=window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_CUSTOMER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_CUSTOMER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EXTERNAL_URL&apifields=CUSTOMER_NO[_]&rptnm=REP_CUSTOMER_ORDER_HISTORY.ASPX&vwnm=&toemail=&sf=no&actiontypes=VARCHAR2[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=ORDERS_BY_CUSTOMER&rptcopies=1','_blank');dsprddlk.focus();", strFile)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_SALES_ORDER_STATUS_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_SALES_ORDER_STATUS.Click
Dim strFile As String = "Report"
Dim strCmd As String = String.Format("dsprddlk=window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EXTERNAL_URL&apifields=ORDER_NO[_]&rptnm=REP_ORDERS_BACKLOG_STATUS.ASPX&vwnm=&toemail=&sf=no&actiontypes=VARCHAR2[_]&rptprint=N&rptpreview=Y&RELATED_LINK_ID=SALES_ORDER_STATUS&rptcopies=1','_blank');dsprddlk.focus();", strFile)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_WORK_ORDER_ORDER_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_WORK_ORDER_ORDER.Click
Dim strFile As String = "Report"
Dim strCmd As String = String.Format("dsprddlk=window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EXTERNAL_URL&apifields=ORDER_NO[_]&rptnm=REP_ORDER_WORK_ORDER_STATUS.ASPX&vwnm=&toemail=&sf=yes&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=WORK_ORDER_ORDER&rptcopies=1','_blank');dsprddlk.focus();", strFile)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_INVOICE_CREDIT_MEMO_ORDER_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_INVOICE_CREDIT_MEMO_ORDER.Click
Dim strFile As String = "Report"
Dim strCmd As String = String.Format("dsprddlk=window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EXTERNAL_URL&apifields=ORDER_NO[_]&rptnm=REP_ORDERS_INV_CREDIT_MEMO.ASPX&vwnm=&toemail=&sf=yes&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=INVOICE_CREDIT_MEMO_ORDER&rptcopies=1','_blank');dsprddlk.focus();", strFile)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_SHIPMENT_RETURN_ORDER_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_SHIPMENT_RETURN_ORDER.Click
Dim strFile As String = "Report"
Dim strCmd As String = String.Format("dsprddlk=window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EXTERNAL_URL&apifields=ORDER_NO[_]&rptnm=REP_ORDERS_SHIPMENT_RETURN.ASPX&vwnm=&toemail=&sf=yes&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=SHIPMENT_RETURN_ORDER&rptcopies=1','_blank');dsprddlk.focus();", strFile)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_CASH_RECEIPTS_ORDER_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_CASH_RECEIPTS_ORDER.Click
Dim strFile As String = "Report"
Dim strCmd As String = String.Format("dsprddlk=window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EXTERNAL_URL&apifields=ORDER_NO[_]&rptnm=REP_ORDER_CASH_RECEIPT.ASPX&vwnm=&toemail=&sf=yes&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=CASH_RECEIPTS_ORDER&rptcopies=1','_blank');dsprddlk.focus();", strFile)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_QUOTATION_ORDER_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_QUOTATION_ORDER.Click
Dim strFile As String = "Report"
Dim strCmd As String = String.Format("dsprddlk=window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EXTERNAL_URL&apifields=ORDER_NO[_]&rptnm=REP_ORDERS_QUOTATION_STATUS.ASPX&vwnm=&toemail=&sf=yes&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=QUOTATION_ORDER&rptcopies=1','_blank');dsprddlk.focus();", strFile)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_ADVANCE_ORDER_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_ADVANCE_ORDER.Click
Dim strFile As String = "Report"
Dim strCmd As String = String.Format("dsprddlk=window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EXTERNAL_URL&apifields=ORDER_NO[_]&rptnm=REP_ORDER_ADVANCE_STATUS.ASPX&vwnm=&toemail=&sf=yes&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=ADVANCE_ORDER&rptcopies=1','_blank');dsprddlk.focus();", strFile)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub RRel_RMA_REP_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles RRel_RMA_REP.Click
Dim strFile As String = "Report"
Dim strCmd As String = String.Format("dsprddlk=window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=EXTERNAL_URL&apifields=ORDER_NO[_]&rptnm=RMA_REP.ASPX&vwnm=&toemail=&sf=yes&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=RMA_REP&rptcopies=1','_blank');dsprddlk.focus();", strFile)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub MERGE_TEMP_DISPLAY_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles MERGE_TEMP_DISPLAY.Click
Dim pkvalue as string
pkvalue= SD_ORDER_HEADER_ORDER_NO.Text
                Dim strFile As String = "More"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
      strCmd = String.Format("window.open('MERGE_TEMP_DISPLAY.aspx?PAGE_ID=SALES_ORDER&PKVALUE=" & Replace(Replace(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "');", strFile)
Else
      strCmd = String.Format("window.showModalDialog('MERGE_TEMP_DISPLAY.aspx?PAGE_ID=SALES_ORDER&PKVALUE=" & Replace(Replace(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
                ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN8", strCmd, True)
    End Sub
    Protected Sub Print_log_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Print_log.Click
Dim pkvalue as string
pkvalue= SD_ORDER_HEADER_ORDER_NO.Text
                Dim strFile As String = "More"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
                strCmd = String.Format("window.open('SYS_DISPLAY_PRINTLOG.ASPX?PID=SALES_ORDER&PKVALUE=" & Replace(Replace(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "');", strFile)
Else
                strCmd = String.Format("window.showModalDialog('SYS_DISPLAY_PRINTLOG.ASPX?PID=SALES_ORDER&PKVALUE=" & Replace(Replace(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
                ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN9", strCmd, True)
    End Sub
    Protected Sub EMAIL_log_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles EMAIL_log.Click
Dim pkvalue as string
pkvalue= SD_ORDER_HEADER_ORDER_NO.Text
                Dim strFile As String = "More"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
               strCmd = String.Format("window.open('Email_log.ASPX?PAGE_ID=SALES_ORDER&PKVALUE=" & Replace(Replace(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "');", strFile)
Else
               strCmd = String.Format("window.showModalDialog('Email_log.ASPX?PAGE_ID=SALES_ORDER&PKVALUE=" & Replace(Replace(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
                ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN11", strCmd, True)
    End Sub
     Protected Sub Approval_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Approval.Click
Dim pkvalue as string
pkvalue= SD_ORDER_HEADER_ORDER_NO.Text
                Dim strFile As String = "More"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
               strCmd = String.Format("window.open('DOCUMENT_APPROVAL_LIST.aspx?PAGE_ID=SALES_ORDER&PKVALUE=" & Replace(REPLACE(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "');", strFile)
Else
               strCmd = String.Format("window.showModalDialog('DOCUMENT_APPROVAL_LIST.aspx?PAGE_ID=SALES_ORDER&PKVALUE=" & Replace(REPLACE(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
                ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN13", strCmd, True)
    End Sub
    Protected Sub Change_log_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Change_log.Click
Dim pkvalue as string
pkvalue= SD_ORDER_HEADER_ORDER_NO.Text
                Dim strFile As String = "More"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
                strCmd = String.Format("window.open('CHANGE_LOG_HISTORY.aspx?PAGE_ID=SALES_ORDER&PKVALUE=" & Replace(Replace(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "');", strFile)
Else
                strCmd = String.Format("window.showModalDialog('CHANGE_LOG_HISTORY.aspx?PAGE_ID=SALES_ORDER&PKVALUE=" & Replace(Replace(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
                ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN14", strCmd, True)
    End Sub
    Protected Sub Print123_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Print123.Click
dbad.SelectCommand.Connection = Session("db_connection")
Dim dbprintsave  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT VALUE FROM SYS_TOOL_SETTINGS WHERE KEY='SAVE_BEFORE_PRINT' AND NVL(VALUE,'N')='Y'"
dbprintsave.Clear()
dbad.Fill(dbprintsave)
if (dbprintsave.Tables(0).Rows.Count>0) Then
If (Save.Enabled = True And Save.Visible = True) Then
call SAVE_CLICK(sender,e)
If (save_sucess_flag<>"Y") Then
    Exit Sub
End If
End if
End if
dbad.SelectCommand.Connection.close()
If (SD_ORDER_HEADER_BLANKET_ORDER.checked=True) Then
Dim strFile10 As String = "Report"
Dim strCmd10 As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd10 = String.Format("window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Blanket_Order_Printing.repx&vwnm=SALES_ORDER_REPORT_E&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=11&rptcopies=1');", strFile10)
Else
strCmd10 = String.Format("window.showModalDialog('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Blanket_Order_Printing.repx&vwnm=SALES_ORDER_REPORT_E&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=11&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile10)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN19", strCmd10, True)
Exit sub
End if
Dim strFile As String = "Report"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd = String.Format("window.open('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Order_Printing.repx,SalesRules.repx&vwnm=SALES_ORDER_REPORT_E&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=11&rptcopies=1');", strFile)
Else
strCmd = String.Format("window.showModalDialog('related_links_report2.aspx?pid=SALES_ORDER&pmifields=SD_ORDER_HEADER_ORDER_NO[_]&pmifieldvalues=" & Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "&", "%26"),"#","%23") & "[_]&mtype=REPX-REPORT&apifields=ORDER_NO[_]&rptnm=Order_Printing.repx,SalesRules.repx&vwnm=SALES_ORDER_REPORT_E&toemail=&sf=no&actiontypes=C[_]&rptprint=N&rptpreview=N&RELATED_LINK_ID=11&rptcopies=1',null,'status:no;dialogWidth:1000px;dialogHeight:800px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN20", strCmd, True)
    End Sub
    Protected Sub img_notes_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles img_notes.Click
Dim pkvalue,pkfield as string
pkvalue= SD_ORDER_HEADER_ORDER_NO.Text
                Dim strFile As String = "More"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
                strCmd = String.Format("window.open('SYS_PAGE_NOTES_DISPLAY.aspx?PAGE_ID=SALES_ORDER&PKVALUE=" & Replace(Replace(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "');", strFile)
Else
                strCmd = String.Format("window.showModalDialog('SYS_PAGE_NOTES_DISPLAY.aspx?PAGE_ID=SALES_ORDER&PKVALUE=" & Replace(Replace(Replace(pkvalue,"## ","PP1G1G1"),"&","%26"),"#","%23") & "',null,'status:no;dialogWidth:800px;dialogHeight:600px;dialogHide:true;help:no;scroll:yes');", strFile)
End If
                ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN16", strCmd, True)
    End Sub
    Protected Sub save_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles save.Click
Try
SD_ORDER_HEADER_ORDER_NO.Text=Trim(SD_ORDER_HEADER_ORDER_NO.Text)
save_sucess_flag="N"
 		Dim dsf_pk_check As Integer
 		Dim dsf_pk_check_str As String
dsf_pk_check=0
 if (SD_ORDER_HEADER_ORDER_NO.Text ="" ) Then
                SD_ORDER_HEADER_ORDER_NO.Text = CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_SEQUENCE_ORDER_NO")
END If
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" and SD_ORDER_HEADER_ORDER_NO.Text <>"" and SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SelectedIndex>0 And SD_ORDER_HEADER_ORDER_DATE.Text <>"" and SD_ORDER_HEADER_CUSTOMER_NO.Text <>"" and SD_ORDER_HEADER_DUE_DATE.Text <>"" and SD_ORDER_HEADER_NAME.Text <>"" and SD_ORDER_HEADER_NAME.Text <>"" and SD_ORDER_HEADER_CUSTOMER_PO_NO.Text <>"" and SD_ORDER_HEADER_TERMS_CODE.Text <>"" and SD_ORDER_HEADER_SHIP_VIA.Text <>"" and SD_ORDER_HEADER_FOB.SelectedIndex>0 And SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex>0 ) Then
If(session("SALES_ORDER_new_record")="Y") Then
dbad.SelectCommand.Connection = Session("db_connection")
 		Dim dsf As New Data.DataSet
        	dbad.SelectCommand.CommandText = "select  ORDER_NO from SD_ORDER_HEADER where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
        	dsf.Clear()
        	dbad.Fill(dsf)
dbad.SelectCommand.Connection.close
        	If (dsf.Tables(0).Rows.Count > 0) Then
If(session("SALES_ORDER_new_record")="Y") Then
If(verify_new_record_in_recent()="Y") Then
                SD_ORDER_HEADER_ORDER_NO.Text = CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_SEQUENCE_ORDER_NO")
dsf_pk_check_str="ORDER_NO"
dsf_pk_check=1
END IF
END IF
END IF
END IF
If not(CONN.SF_EXECUTE_SQL("SELECT SF_COMPARE_DATES('" & SD_ORDER_HEADER_ORDER_DATE.Text & "','" & SD_ORDER_HEADER_DUE_DATE.Text & "') FROM DUAL")="Y") Then
exception_message.Text="Promised Ship Date should be later than or equal to Order Date."
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not((SD_ORDER_HEADER_ITEM_NO.TEXT<>"" AND SD_ORDER_HEADER_BLANKET_EFFECTIVE_TILL.TEXT<>"")  OR SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE OR (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE AND SD_ORDER_HEADER_ITEM_NO.TEXT="")) Then
exception_message.Text="Please fill the Blanket Effective Till Date."
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not(((CONN.SF_EXECUTE_SQL(" SELECT COUNT(*) FROM SD_PACKING_SLIP_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ")>0) AND (CONN.SF_EXECUTE_SQL("SELECT CUSTOMER_NO FROM SD_PACKING_SLIP_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'")=SD_ORDER_HEADER_CUSTOMER_NO.TEXT)) OR (CONN.SF_EXECUTE_SQL(" SELECT COUNT(*) FROM SD_PACKING_SLIP_HEADER WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ")=0) ) Then
exception_message.Text="Customer No. cannot be changed as Order is used in Packing Slip."
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not(CDBL(CONN.SF_EXECUTE_SQL("SELECT NVL('" & SD_ORDER_HEADER_SE_PCT1.TEXT & "',0)+NVL('" & SD_ORDER_HEADER_SE_PCT2.TEXT & "',0) +NVL('" & SD_ORDER_HEADER_SE_PCT3.TEXT & "',0) +NVL('" & SD_ORDER_HEADER_SE_PCT4.TEXT & "',0) FROM DUAL"))<=100) Then
exception_message.Text="Total SE% can't exceed 100%"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not(SD_ORDER_HEADER_COUNTRY.TEXT<>"") Then
exception_message.Text="Please Enter Country"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not((SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=TRUE AND SD_ORDER_HEADER_BILLING_COUNTRY.TEXT<>"" ) OR  SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS.CHECKED=FALSE) Then
exception_message.Text="Please Enter Billing Country"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not((SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=TRUE AND SD_ORDER_HEADER_SHIPPING_COUNTRY.TEXT<>"" ) OR  SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=FALSE) Then
exception_message.Text="Please Enter Shipping Country"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not(CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM SD_ORDER_HEADER WHERE CUSTOMER_PO_NO=LTRIM(RTRIM('" & SD_ORDER_HEADER_CUSTOMER_PO_NO.TEXT & "'  )) AND CUSTOMER_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'  AND ORDER_NO<>'" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ")=0) Then
exception_message.Text="Customer PO No Is Duplicate."
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not((SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedItem.Value="3RD_PARTY" AND SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.TEXT<>"") OR  SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedItem.Value="SHIPPER" OR SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedItem.Value="RECEIVER") Then
exception_message.Text="Please Enter Third Party Address"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not(CONN.SF_EXECUTE_SQL("SELECT ORA_CUSTOMER_NO FROM SD_CUSTOMERS WHERE ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'")<>"") Then
exception_message.Text="Please fill Oracle Customer No in customer master"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not((SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=TRUE AND (SD_ORDER_HEADER_SHIPPING_NAME.TEXT<>"" AND SD_ORDER_HEADER_SHIPPING_CITY.TEXT<>""  AND  SD_ORDER_HEADER_SHIPPING_STATE_CODE.TEXT<>""  AND  SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.TEXT<>""   ) ) OR  SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS.CHECKED=FALSE) Then
exception_message.Text="Please Enter Shipping Address"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
If not(CONN.SF_EXECUTE_SQL("SELECT SF_VALIDATE_TXN_CONCURRENCY('SALES_ORDER','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SESSION("USER_ID") & "') FROM DUAL") ="Y") Then
exception_message.Text="Transaction has been updated by " & CONN.SF_EXECUTE_DB_FUNCTION(" SF_VALIDATE_TXN_CONCURRENCY('SALES_ORDER','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SESSION("USER_ID") & "','Y')") & "  , Please click on retrieve and then do chanes again and click on Apply changes."
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
call conn.call_before_save("SALES_ORDER", session("user_id"),Request.QueryString.Get("mid"),Request.QueryString.Get("sssid"), Session.SessionID,"SD_ORDERS_SEARCH","ORDER_NO",SD_ORDER_HEADER_ORDER_NO.Text)
  	  Dim dgItemORDERDETAIL10 As DataGridItem
   For Each dgItemORDERDETAIL10 In dbgORDERDETAIL.Items
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL10.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL10.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL10.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
If ( SD_ORDER_DETAIL_DUE_DATE.Text = "") Then
SD_ORDER_DETAIL_DUE_DATE.Text=SD_ORDER_HEADER_DUE_DATE.TEXT
End If
Next
Try
  	  Dim dgItemBILLING_STAGE As DataGridItem
  	  Dim SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_sum As Double
SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_sum =0
   For Each dgItemBILLING_STAGE In dbgBILLING_STAGE.Items
Dim CheckBox0 As CheckBox = CType(dgItemBILLING_STAGE.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDERS_BILLING_STAGE_LINE_NO As Label = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_LINE_NO"), Label)
Dim SD_ORDERS_BILLING_STAGE_STAGE As TextBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_STAGE"), TextBox)
Dim SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE As TextBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE"), TextBox)
Dim SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE As TextBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE"), TextBox)
Dim SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE As CheckBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE"), CheckBox)
If (SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE.Text<>"" AND CheckBox0.Checked=False ) Then
SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_sum =SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_sum + cdbl(SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE.Text)
End If
Next
 If (SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_SUM  > 100  ) Then
exception_message.Text="Total Billing percentage exceeds 100"
err_message.Visible=false
exception_message.visible=True
mpanel.Visible = True
Dim findex As Integer
findex = dbgBILLING_STAGE.Controls(0).Controls.Count - 1
Dim SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_FOOTER As Label = CType(dbgBILLING_STAGE.Controls(0).Controls(findex).FindControl("SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_FOOTER"), Label)
 If Not Equals(SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_FOOTER, Nothing) Then
SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_FOOTER.Text = SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_sum
End If
Exit sub
End If
Catch ex As Exception
End Try
  	  Dim dgItemORDERDETAIL14 As DataGridItem
   For Each dgItemORDERDETAIL14 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL14.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL14.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL14.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL14.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( CONN.SF_EXECUTE_SQL("SELECT SF_COMPARE_DATES('" & SD_ORDER_HEADER_ORDER_DATE.Text & "','" & SD_ORDER_DETAIL_DUE_DATE.Text & "') FROM DUAL")="Y" OR SD_ORDER_DETAIL_ITEM_NO.TEXT="" ) Then 
exception_message.Text="Promised Ship Date should be later than or equal to Order Date in line # " & SD_ORDER_DETAIL_LINE_NO.TEXT & "."
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL15 As DataGridItem
   For Each dgItemORDERDETAIL15 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL15.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL15.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL15.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL15.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( CONN.SF_EXECUTE_SQL("SELECT nvl('" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "',0) FROM dual ") >=0 OR SD_ORDER_DETAIL_ITEM_NO.TEXT="" ) Then 
exception_message.Text="<b> Please fill valid sales price for Line #  " & SD_ORDER_DETAIL_LINE_NO.TEXT  &  "</b>"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL17 As DataGridItem
   For Each dgItemORDERDETAIL17 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL17.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL17.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL17.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL17.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( CONN.SF_EXECUTE_SQL("SELECT nvl('" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "',0) FROM dual ") >0 OR SD_ORDER_DETAIL_ITEM_NO.TEXT="" OR CONN.SF_EXECUTE_SQL("SELECT  nvl(DEFAULT_SALES_PRICE_ZERO,'N') FROM SD_CUSTOMERS WHERE ACCOUNT_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'") ="Y" ) Then 
exception_message.Text="<b>Order qty should be more than zero for Line #  " & SD_ORDER_DETAIL_LINE_NO.TEXT  &  "</b>"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL24 As DataGridItem
   For Each dgItemORDERDETAIL24 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL24.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL24.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL24.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL24.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( SD_ORDER_DETAIL_LICENSE_NO.TEXT="" OR  CONN.SF_EXECUTE_SQL("SELECT SF_GET_LICENSE_QTY_OPEN_ORDER('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "') FROM DUAL")="Y" ) Then 
exception_message.Text="Total Qty Exceeding For License in Line '" & SD_ORDER_dETAIL_LINE_NO.TEXT & "'"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL28 As DataGridItem
   For Each dgItemORDERDETAIL28 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL28.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL28.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL28.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL28.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM SD_ORDER_DETAIL WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'")<>0) OR (SD_ORDER_DETAIL_LINE_NO.TEXT="1" AND SD_ORDER_DETAIL_ITEM_NO.TEXT<>"") or (SD_ORDER_DETAIL_LINE_NO.TEXT<>"1") OR SD_ORDER_dETAIL_ORDER_DOC_TYPE.TEXT="WE" OR SD_ORDER_dETAIL_ORDER_DOC_TYPE.TEXT="CP" ) Then 
exception_message.Text="Order should have atleast One Line in detail"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL44 As DataGridItem
   For Each dgItemORDERDETAIL44 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL44.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL44.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL44.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL44.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If ( SD_ORDER_DETAIL_ITEM_NO.TEXT<>"" ) Then 
If (SD_ORDER_DETAIL_ORDER_QTY.Text = "") Then
exception_message.Text="Enter the Qty  for Line " & SD_ORDER_DETAIL_LINE_NO.TEXT  &  ""
err_message.Visible=false
exception_message.visible=True
mpanel.Visible = True
Exit sub
End If
End If
End If
Next
  	  Dim dgItemORDERDETAIL45 As DataGridItem
   For Each dgItemORDERDETAIL45 In dbgORDERDETAIL.Items
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL45.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL45.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL45.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
If ( SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE.Text = "") Then
SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE.Text=SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.TEXT
End If
Next
  	  Dim dgItemORDERDETAIL47 As DataGridItem
   For Each dgItemORDERDETAIL47 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL47.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL47.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL47.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL47.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If ( SD_ORDER_DETAIL_ITEM_NO.TEXT<>"" AND CONN.SF_EXECUTE_SQL ("SELECT EDIT_SHIP_DELIVERY_DATE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="D" AND SD_ORDER_DETAIL_LINE_NO.TEXT<>0 ) Then 
If (SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE.Text = "") Then
exception_message.Text="Enter the  Promised Delivery date for Line " & SD_ORDER_DETAIL_LINE_NO.TEXT  &  ""
err_message.Visible=false
exception_message.visible=True
mpanel.Visible = True
Exit sub
End If
End If
End If
Next
  	  Dim dgItemORDERDETAIL48 As DataGridItem
   For Each dgItemORDERDETAIL48 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL48.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL48.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL48.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL48.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If ( SD_ORDER_DETAIL_ITEM_NO.TEXT<>"" AND CONN.SF_EXECUTE_SQL ("SELECT EDIT_SHIP_DELIVERY_DATE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="S" AND SD_ORDER_DETAIL_LINE_NO.TEXT<>0 ) Then 
If (SD_ORDER_DETAIL_DUE_DATE.Text = "") Then
exception_message.Text="Enter the  Promised ship date for Line " & SD_ORDER_DETAIL_LINE_NO.TEXT  &  ""
err_message.Visible=false
exception_message.visible=True
mpanel.Visible = True
Exit sub
End If
End If
End If
Next
  	  Dim dgItemORDERDETAIL51 As DataGridItem
   For Each dgItemORDERDETAIL51 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL51.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL51.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL51.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL51.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If ( SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT<>"" ) Then 
If ( dropdown_list2(SD_ORDER_DETAIL_ORDER_LINE_TYPE) = "") Then
exception_message.Text="Enter the order Line Type for Line " & SD_ORDER_DETAIL_LINE_NO.TEXT  &  ""
err_message.Visible=false
exception_message.visible=True
mpanel.Visible = True
Exit sub
End If
End If
End If
Next
  	  Dim dgItemORDERDETAIL52 As DataGridItem
   For Each dgItemORDERDETAIL52 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL52.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL52.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL52.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL52.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If ( (CONN.SF_EXECUTE_SQL ("SELECT  SF_GET_TRIM_MANDATORY(' " & SD_ORDER_DETAIL_ITEM_NO.TEXT & " ') FROM DUAL")="Y") ) Then 
If (SD_ORDER_DETAIL_TRIM_SIZE.Text = "") Then
exception_message.Text="Please enter the Trim Size  for Line " & SD_ORDER_DETAIL_LINE_NO.TEXT  &  ""
err_message.Visible=false
exception_message.visible=True
mpanel.Visible = True
Exit sub
End If
End If
End If
Next
  	  Dim dgItemORDERDETAIL54 As DataGridItem
   For Each dgItemORDERDETAIL54 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL54.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL54.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL54.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL54.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE<>"" and SD_ORDER_DETAIL_ITEM_NO.TEXT<>"" or ( SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="" and SD_ORDER_DETAIL_ITEM_NO.TEXT="") or  ( SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE<>"" and SD_ORDER_DETAIL_ITEM_NO.TEXT="") ) Then 
exception_message.Text="Select Order Doc Type For Line '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "'"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL56 As DataGridItem
   For Each dgItemORDERDETAIL56 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL56.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL56.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL56.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL56.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( SD_ORDER_DETAIL_CREATE_WORK_ORDER.CHECKED=FALSE OR CONN.SF_EXECUTE_SQL("SELECT SF_GET_ITEM_NOT_EXIST('" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT & "','" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & CHECK_BOX_R(SD_ORDER_DETAIL_CREATE_WORK_ORDER) & "') FROM DUAL")="Y" ) Then 
exception_message.Text="BOM Doesn't Exist For Line '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "'"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL57 As DataGridItem
   For Each dgItemORDERDETAIL57 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL57.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL57.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL57.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL57.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If ( SD_ORDER_DETAIL_LICENSE_NO.TEXT<>"" AND SD_ORDER_DETAIL_LICENSE_NO.TEXT<>"NLR" and SD_ORDER_DETAIL_LICENSE_NO.TEXT<>"RPL" ) Then 
If (SD_ORDER_DETAIL_END_USER_CODE.Text = "") Then
exception_message.Text="Fill End User Code If License No Is Filled"
err_message.Visible=false
exception_message.visible=True
mpanel.Visible = True
Exit sub
End If
End If
End If
Next
  	  Dim dgItemBILLING_STAGE61 As DataGridItem
   For Each dgItemBILLING_STAGE61 In dbgBILLING_STAGE.Items
Dim CheckBox0 As CheckBox = CType(dgItemBILLING_STAGE61.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDERS_BILLING_STAGE_LINE_NO As Label = CType(dgItemBILLING_STAGE61.FindControl("SD_ORDERS_BILLING_STAGE_LINE_NO"), Label)
Dim SD_ORDERS_BILLING_STAGE_STAGE As TextBox = CType(dgItemBILLING_STAGE61.FindControl("SD_ORDERS_BILLING_STAGE_STAGE"), TextBox)
Dim SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE As TextBox = CType(dgItemBILLING_STAGE61.FindControl("SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE"), TextBox)
Dim SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE As TextBox = CType(dgItemBILLING_STAGE61.FindControl("SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE"), TextBox)
Dim SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE As CheckBox = CType(dgItemBILLING_STAGE61.FindControl("SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE"), CheckBox)
 If (CheckBox0.Checked = False) Then
 If ( SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE.CHECKED=TRUE ) Then 
If (SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE.Text = "") Then
exception_message.Text="Please fill Ready for Invoice Date in Billing stages"
err_message.Visible=false
exception_message.visible=True
mpanel.Visible = True
Exit sub
End If
End If
End If
Next
  	  Dim dgItemORDERDETAIL63 As DataGridItem
   For Each dgItemORDERDETAIL63 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL63.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL63.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL63.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL63.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( CONN.SF_EXECUTE_SQL("SELECT SF_VALIDATE_LICENSE_DATE('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_DUE_DATE.TEXT & "')  FROM DUAL")>0 ) Then 
exception_message.Text="Promised Ship Date should be less than the License Expiry Date  in line # " & SD_ORDER_DETAIL_LINE_NO.TEXT & "."
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL67 As DataGridItem
   For Each dgItemORDERDETAIL67 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL67.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL67.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL67.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL67.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( SD_ORDER_DETAIL_LINE_NO.TEXT="0" OR SD_ORDER_DETAIL_ITEM_NO.TEXT="" OR (SD_ORDER_DETAIL_ITEM_NO.TEXT<>"" AND CONN.SF_EXECUTE_SQL("SELECT SF_VALIDATE_SO_SHIP_QTY('" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "') FROM DUAL")="Y") ) Then 
exception_message.Text="Qty cannot be less than work order qty in line # " & SD_ORDER_DETAIL_LINE_NO.TEXT & ""
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL68 As DataGridItem
   For Each dgItemORDERDETAIL68 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL68.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL68.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL68.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL68.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If ( SD_ORDER_DETAIL_ITEM_NO.TEXT<>"" AND SD_ORDER_DETAIL_SALES_PRICE.TEXT="" AND SD_ORDER_DETAIL_LINE_NO.TEXT<>0 ) Then 
If (SD_ORDER_DETAIL_SALES_PRICE.Text = "") Then
exception_message.Text="Enter the  Sales Price for Line " & SD_ORDER_DETAIL_LINE_NO.TEXT  &  ""
err_message.Visible=false
exception_message.visible=True
mpanel.Visible = True
Exit sub
End If
End If
End If
Next
  	  Dim dgItemORDERDETAIL73 As DataGridItem
   For Each dgItemORDERDETAIL73 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL73.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL73.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL73.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL73.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( SD_ORDER_DETAIL_REQUESTED_SHIP_DATE.TEXT="" OR (CONN.SF_EXECUTE_SQL("SELECT SF_VALIDATE_REQ_SHIP_DATE('" & SD_ORDER_DETAIL_REQUESTED_SHIP_DATE.TEXT & "')  FROM DUAL")=0) ) Then 
exception_message.Text="Please enter valid Requested Ship Date for  line #  " & SD_ORDER_DETAIL_LINE_NO.TEXT  & ""
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL74 As DataGridItem
   For Each dgItemORDERDETAIL74 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL74.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL74.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL74.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL74.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( SD_ORDER_DETAIL_DUE_DATE.TEXT="" OR  SD_ORDER_DETAIL_LICENSE_NO.TEXT="" OR (SD_ORDER_DETAIL_LICENSE_NO.TEXT<>"" AND CONN.SF_EXECUTE_SQL("SELECT SF_VALIDATE_LICENSE_DATE('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_DUE_DATE.TEXT & "')  FROM DUAL")<>0) ) Then 
exception_message.Text="Promised Ship Date should be less than the License Expiry Date  for  line #  " & SD_ORDER_DETAIL_LINE_NO.TEXT  & ""
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL75 As DataGridItem
   For Each dgItemORDERDETAIL75 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL75.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL75.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL75.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL75.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( SD_ORDER_DETAIL_DUE_DATE.TEXT="" OR (CONN.SF_EXECUTE_SQL("SELECT SF_VALIDATE_REQ_SHIP_DATE('" & SD_ORDER_DETAIL_DUE_DATE.TEXT & "')  FROM DUAL")=0) ) Then 
exception_message.Text="Please enter valid Promised Ship Date for  line # " & SD_ORDER_DETAIL_LINE_NO.TEXT & ""
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
  	  Dim dgItemORDERDETAIL76 As DataGridItem
   For Each dgItemORDERDETAIL76 In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox = CType(dgItemORDERDETAIL76.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItemORDERDETAIL76.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItemORDERDETAIL76.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL76.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
 If (CheckBox0.Checked = False) Then
 If NOT ( SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE OR (SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE AND SD_ORDER_HEADER_ITEM_NO.TEXT=SD_ORDER_DETAIL_ITEM_NO.TEXT) OR SD_ORDER_DETAIL_ITEM_NO.TEXT="" ) Then 
exception_message.Text="Invalid Item No selected for Line '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "'"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
exit sub
End If
End If
Next
        Call save_header()
dbad.SelectCommand.Connection = Session("db_connection")
 		Dim dsf_d As New Data.DataSet
        	dbad.SelectCommand.CommandText = "select  ORDER_NO from SD_ORDER_HEADER where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
        	dsf_d.Clear()
        	dbad.Fill(dsf_d)
dbad.SelectCommand.Connection.close
        	If (dsf_d.Tables(0).Rows.Count > 0) Then
       Call save_details()
call save_Detail_form()
End If
Call conn.sf_execute_db_function("Pkg_Approval.Sf_CHECK_APPROVAL('SALES_ORDER','" & Replace(SD_ORDER_HEADER_ORDER_NO.Text,"'","''") & "',NULL,NULL,NULL,NULL,NULL)")
call execute_storeProcedure("SP_CREATE_ORDERS_WORK_ORDER",SD_ORDER_HEADER_ORDER_NO.TEXT & "#" & SESSION("USER_ID"),"P_ORDER_NO#P_USER_ID","C#C")
call execute_storeProcedure("SP_INSERT_BLANKET_LINE","SO" & "#" & SD_ORDER_HEADER_ORDER_NO.TEXT & "#" & CHECK_BOX_R(SD_ORDER_HEADER_BLANKET_ORDER) & "#" & CHECK_BOX_R(SD_ORDER_HEADER_BALANCE_QTY_LINE),"P_DOC_TYPE#P_ORDER_NO#P_BLANKET_ORDER#P_INSERT_LINE","C#C#C#C")
call execute_storeProcedure("SP_UPDATE_ORDER_ADVANCE",SD_ORDER_HEADER_ORDER_NO.TEXT & "#" & SD_ORDER_HEADER_ADVANCE_PERCENTAGE.TEXT,"P_ORDER_NO#P_ADVANCE_PERCENTAGE","C#N")
call execute_storeProcedure("SP_UPDATE_BILLING_STAGE",SD_ORDER_HEADER_ORDER_NO.TEXT,"P_ORDER_NO","C")
call execute_storeProcedure("SP_UPDATE_DEFAULT_SALES_PRICE",SD_ORDER_HEADER_ORDER_NO.TEXT & "#" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT,"P_ORDER_NO#P_CUSTOMER_NO","C#C")
call execute_storeProcedure("SP_CONVERT_TO_BLANKET_ORDER",SD_ORDER_HEADER_ORDER_NO.TEXT & "#" & CHECK_BOX_R(SD_ORDER_HEADER_BLANKET_ORDER),"P_ORDER_NO#P_BLANKET_ORDER","C#C")
call execute_storeProcedure("PKG_SURCHARGE.SP_FILL_SURCHARGE_SO",SD_ORDER_HEADER_ORDER_NO.TEXT & "#" & SESSION("USER_ID"),"P_ORDER_NO#P_USER","C#C")
call execute_storeProcedure("SP_UPD_LICNESE_TIE_UP",SD_ORDER_HEADER_ORDER_NO.TEXT,"P_ORDER_NO","C")
call execute_storeProcedure("SP_UPDATE_SHIP_DELIVERY_DATE",SD_ORDER_HEADER_ORDER_NO.TEXT & "#" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "#" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT,"P_ORDER_NO#P_CUSTOMER_NO#P_BUSINESS_UNIT_CODE","C#C#C")
call execute_storeProcedure("SP_UPD_PO_LINE_NO",SD_ORDER_HEADER_ORDER_NO.TEXT,"P_ORDER_NO","C")
call fill_header_info()
if (dsf_pk_check=1) Then
err_message.Text="Existing " & dsf_pk_check_str & " is already used by another user, so incremented to next available number and Inserted Details Successfully"
dsf_pk_check=0
Else
err_message.Text="Saved/Updated Details Successfully"
End If
exception_message.visible=false
err_message.visible=True
mpanel.Visible = True
save_sucess_flag="Y"
Else
call check_mandatory_color()
exception_message.Text="Please fill Required Fields"
exception_message.Visible=True
mpanel.Visible = True
err_message.Visible=false
        End If
call conn.call_after_save("SALES_ORDER", session("user_id"),Request.QueryString.Get("mid"),Request.QueryString.Get("sssid"), Session.SessionID,"SD_ORDERS_SEARCH","ORDER_NO",SD_ORDER_HEADER_ORDER_NO.Text)
Catch ex As Exception
call insert_sys_log("ApplyChanges Button",ex.Message)
End Try
    End Sub
	Public Sub check_mandatory_color()
If Not(SD_ORDER_HEADER_ORDER_NO.Text<>"") Then
SD_ORDER_HEADER_ORDER_NO.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_ORDER_NO.BackColor = Drawing.Color.LightYellow
End If
If Not( dropdown_list2(SD_ORDER_HEADER_BUSINESS_UNIT_CODE)<>"") Then
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_BUSINESS_UNIT_CODE.BackColor = Drawing.Color.LightYellow
End If
If Not(SD_ORDER_HEADER_ORDER_DATE.Text<>"") Then
SD_ORDER_HEADER_ORDER_DATE.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_ORDER_DATE.BackColor = Drawing.Color.LightYellow
End If
If Not(SD_ORDER_HEADER_CUSTOMER_NO.Text<>"") Then
SD_ORDER_HEADER_CUSTOMER_NO.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_CUSTOMER_NO.BackColor = Drawing.Color.LightYellow
End If
If Not(SD_ORDER_HEADER_DUE_DATE.Text<>"") Then
SD_ORDER_HEADER_DUE_DATE.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_DUE_DATE.BackColor = Drawing.Color.LightYellow
End If
If Not(SD_ORDER_HEADER_NAME.Text<>"") Then
SD_ORDER_HEADER_NAME.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_NAME.BackColor = Drawing.Color.LightYellow
End If
If Not(SD_ORDER_HEADER_CUSTOMER_PO_NO.Text<>"") Then
SD_ORDER_HEADER_CUSTOMER_PO_NO.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_CUSTOMER_PO_NO.BackColor = Drawing.Color.LightYellow
End If
If Not(SD_ORDER_HEADER_TERMS_CODE.Text<>"") Then
SD_ORDER_HEADER_TERMS_CODE.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_TERMS_CODE.BackColor = Drawing.Color.LightYellow
End If
If Not(SD_ORDER_HEADER_SHIP_VIA.Text<>"") Then
SD_ORDER_HEADER_SHIP_VIA.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_SHIP_VIA.BackColor = Drawing.Color.LightYellow
End If
If Not( dropdown_list2(SD_ORDER_HEADER_FOB)<>"") Then
SD_ORDER_HEADER_FOB.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_FOB.BackColor = Drawing.Color.LightYellow
End If
If Not( dropdown_list2(SD_ORDER_HEADER_FREIGHT_BILL_TYPE)<>"") Then
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_FREIGHT_BILL_TYPE.BackColor = Drawing.Color.LightYellow
End If
If Not(SD_ORDER_HEADER_ORDER_NO.Text<>"") Then
SD_ORDER_HEADER_ORDER_NO.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_ORDER_NO.BackColor = Drawing.Color.LightYellow
End If
If Not(SD_ORDER_HEADER_NAME.Text<>"") Then
SD_ORDER_HEADER_NAME.BackColor = Drawing.Color.LightPink
Else
SD_ORDER_HEADER_NAME.BackColor = Drawing.Color.LightYellow
End If
    End Sub
	Public Sub save_header()
Try
dbad.SelectCommand.Connection = Session("db_connection")
dbad.InsertCommand.Connection = Session("db_connection")
dbad.UpdateCommand.Connection = Session("db_connection")
 		Dim dsf As New Data.DataSet
        	dbad.SelectCommand.CommandText = "select  ORDER_NO from SD_ORDER_HEADER where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
        	dsf.Clear()
        	dbad.Fill(dsf)
        	If (dsf.Tables(0).Rows.Count > 0) Then
                	If (dbad.UpdateCommand.Connection.State = Data.ConnectionState.Closed) Then
                    		dbad.UpdateCommand.Connection.Open()
                	End If
			dbad.UpdateCommand.CommandText = "update SD_ORDER_HEADER set ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "',BUSINESS_UNIT_CODE='" & replace_c(dropdown_list2(SD_ORDER_HEADER_BUSINESS_UNIT_CODE)) & "',ORDER_DATE=NVL(to_date('" & replace_c(SD_ORDER_HEADER_ORDER_DATE.Text) & "','MM/DD/RRRR'),NULL),CUSTOMER_NO='" & replace_c(SD_ORDER_HEADER_CUSTOMER_NO.Text) & "',NAME='" & replace_c(SD_ORDER_HEADER_NAME.Text) & "',STREET='" & replace_c(SD_ORDER_HEADER_STREET.Text) & "',CITY='" & replace_c(SD_ORDER_HEADER_CITY.Text) & "',STATE_CODE='" & replace_c(SD_ORDER_HEADER_STATE_CODE.Text) & "',POSTAL_CODE='" & replace_c(SD_ORDER_HEADER_POSTAL_CODE.Text) & "',COUNTRY='" & replace_c(SD_ORDER_HEADER_COUNTRY.Text) & "',PHONE='" & replace_c(SD_ORDER_HEADER_PHONE.Text) & "',PROMISED_DELIVERY_DATE=NVL(to_date('" & replace_c(SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Text) & "','MM/DD/RRRR'),NULL),FAX='" & replace_c(SD_ORDER_HEADER_FAX.Text) & "',EMAIL='" & replace_c(SD_ORDER_HEADER_EMAIL.Text) & "',CONTACT_NAME='" & replace_c(SD_ORDER_HEADER_CONTACT_NAME.Text) & "',DIFFERENT_BILLING_ADDRESS='" & check_box_r(SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS) & "',BILLING_NAME='" & replace_c(SD_ORDER_HEADER_BILLING_NAME.Text) & "',BILLING_STREET='" & replace_c(SD_ORDER_HEADER_BILLING_STREET.Text) & "',BILLING_CITY='" & replace_c(SD_ORDER_HEADER_BILLING_CITY.Text) & "',BILLING_STATE_CODE='" & replace_c(SD_ORDER_HEADER_BILLING_STATE_CODE.Text) & "',BILLING_POSTAL_CODE='" & replace_c(SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text) & "',BILLING_COUNTRY='" & replace_c(SD_ORDER_HEADER_BILLING_COUNTRY.Text) & "',BILLING_PHONE='" & replace_c(SD_ORDER_HEADER_BILLING_PHONE.Text) & "',BILLING_FAX='" & replace_c(SD_ORDER_HEADER_BILLING_FAX.Text) & "',BILLING_EMAIL='" & replace_c(SD_ORDER_HEADER_BILLING_EMAIL.Text) & "',BILLING_CONTACT_NAME='" & replace_c(SD_ORDER_HEADER_BILLING_CONTACT_NAME.Text) & "',DIFFERENT_SHIPPING_ADDRESS='" & check_box_r(SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS) & "',SHIPPING_NAME='" & replace_c(SD_ORDER_HEADER_SHIPPING_NAME.Text) & "',SHIPPING_STREET='" & replace_c(SD_ORDER_HEADER_SHIPPING_STREET.Text) & "',SHIPPING_CITY='" & replace_c(SD_ORDER_HEADER_SHIPPING_CITY.Text) & "',SHIPPING_STATE_CODE='" & replace_c(SD_ORDER_HEADER_SHIPPING_STATE_CODE.Text) & "',SHIPPING_POSTAL_CODE='" & replace_c(SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Text) & "',SHIPPING_COUNTRY='" & replace_c(SD_ORDER_HEADER_SHIPPING_COUNTRY.Text) & "',SHIPPING_PHONE='" & replace_c(SD_ORDER_HEADER_SHIPPING_PHONE.Text) & "',SHIPPING_FAX='" & replace_c(SD_ORDER_HEADER_SHIPPING_FAX.Text) & "',SHIPPING_EMAIL='" & replace_c(SD_ORDER_HEADER_SHIPPING_EMAIL.Text) & "',SHIPPING_CONTACT_NAME='" & replace_c(SD_ORDER_HEADER_SHIPPING_CONTACT_NAME.Text) & "',FREIGHT_BILLING_NAME='" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_NAME.Text) & "',FREIGHT_BILLING_STREET='" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_STREET.Text) & "',FREIGHT_BILLING_CITY='" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_CITY.Text) & "',FREIGHT_BILLING_STATE_CODE='" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.Text) & "',FREIGHT_BILLING_POSTAL_CODE='" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_POSTAL_CODE.Text) & "',FREIGHT_BILLING_COUNTRY='" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.Text) & "',FREIGHT_BILLING_PHONE='" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_PHONE.Text) & "',FREIGHT_BILLING_FAX='" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_FAX.Text) & "',FREIGHT_BILLING_EMAIL='" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_EMAIL.Text) & "',FREIGHT_BILLING_CONTACT_NAME='" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_CONTACT_NAME.Text) & "',TERMS_CODE='" & replace_c(SD_ORDER_HEADER_TERMS_CODE.Text) & "',SHIP_VIA='" & replace_c(SD_ORDER_HEADER_SHIP_VIA.Text) & "',FOB='" & replace_c(dropdown_list2(SD_ORDER_HEADER_FOB)) & "',PAYMENT_METHOD='" & replace_c(dropdown_list2(SD_ORDER_HEADER_PAYMENT_METHOD)) & "',CUSTOMER_PO_NO='" & replace_c(SD_ORDER_HEADER_CUSTOMER_PO_NO.Text) & "',SHIP_TO_PO_REFERENCE='" & replace_c(SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Text) & "',REQUESTED_DATE=NVL(to_date('" & replace_c(SD_ORDER_HEADER_REQUESTED_DATE.Text) & "','MM/DD/RRRR'),NULL),DUE_DATE=NVL(to_date('" & replace_c(SD_ORDER_HEADER_DUE_DATE.Text) & "','MM/DD/RRRR'),NULL),INTERNAL_NOTES='" & replace_c(SD_ORDER_HEADER_INTERNAL_NOTES.Text) & "',ORDER_NOTES='" & replace_c(SD_ORDER_HEADER_ORDER_NOTES.Text) & "',SHIPPING_INSTRUCTIONS='" & replace_c(SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text) & "',BLANKET_ORDER='" & check_box_r(SD_ORDER_HEADER_BLANKET_ORDER) & "',ITEM_NO='" & replace_c(SD_ORDER_HEADER_ITEM_NO.Text) & "',BLANKET_QTY=" & replace_c1(SD_ORDER_HEADER_BLANKET_QTY.Text) & ",ORDERING_UOM='" & replace_c(SD_ORDER_HEADER_ORDERING_UOM.Text) & "',SALES_PRICE=" & replace_c1(SD_ORDER_HEADER_SALES_PRICE.Text) & ",PRICING_UOM='" & replace_c(SD_ORDER_HEADER_PRICING_UOM.Text) & "',BLANKET_EFFECTIVE_FROM=NVL(to_date('" & replace_c(SD_ORDER_HEADER_BLANKET_EFFECTIVE_FROM.Text) & "','MM/DD/RRRR'),NULL),BLANKET_EFFECTIVE_TILL=NVL(to_date('" & replace_c(SD_ORDER_HEADER_BLANKET_EFFECTIVE_TILL.Text) & "','MM/DD/RRRR'),NULL),BLANKET_RELEASE_NO='" & replace_c(SD_ORDER_HEADER_BLANKET_RELEASE_NO.Text) & "',CUSTOMER_MESSAGE='" & replace_c(SD_ORDER_HEADER_CUSTOMER_MESSAGE.Text) & "',SHIPTO_CODE='" & replace_c(SD_ORDER_HEADER_SHIPTO_CODE.Text) & "',INVOICE_BY='" & replace_c(dropdown_list2(SD_ORDER_HEADER_INVOICE_BY)) & "',QUOTATION_NO='" & replace_c(SD_ORDER_HEADER_QUOTATION_NO.Text) & "',BLANKET_QTY_BUOM=" & replace_c1(SD_ORDER_HEADER_BLANKET_QTY_BUOM.Text) & ",CUSTOMER_PO_DATE=NVL(to_date('" & replace_c(SD_ORDER_HEADER_CUSTOMER_PO_DATE.Text) & "','MM/DD/RRRR'),NULL),CANCEL_DATE=NVL(to_date('" & replace_c(SD_ORDER_HEADER_CANCEL_DATE.Text) & "','MM/DD/RRRR'),NULL),CLOSE_DATE=NVL(to_date('" & replace_c(SD_ORDER_HEADER_CLOSE_DATE.Text) & "','MM/DD/RRRR'),NULL),HOLD='" & check_box_r(SD_ORDER_HEADER_HOLD) & "',ULTIMATE_CONSIGNMENT='" & replace_c(SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.Text) & "',SHIP_COMPLETE='" & check_box_r(SD_ORDER_HEADER_SHIP_COMPLETE) & "',SE1='" & replace_c(SD_ORDER_HEADER_SE1.Text) & "',SE_PCT1=" & replace_c1(SD_ORDER_HEADER_SE_PCT1.Text) & ",SE4='" & replace_c(SD_ORDER_HEADER_SE4.Text) & "',SE3='" & replace_c(SD_ORDER_HEADER_SE3.Text) & "',SE2='" & replace_c(SD_ORDER_HEADER_SE2.Text) & "',SE_PCT2=" & replace_c1(SD_ORDER_HEADER_SE_PCT2.Text) & ",SE_PCT3=" & replace_c1(SD_ORDER_HEADER_SE_PCT3.Text) & ",SE_PCT4=" & replace_c1(SD_ORDER_HEADER_SE_PCT4.Text) & ",FLS_ORDER_NO='" & replace_c(SD_ORDER_HEADER_FLS_ORDER_NO.Text) & "',EXPORT_HOLD='" & check_box_r(SD_ORDER_HEADER_EXPORT_HOLD) & "',FREIGHT_BILL_TYPE='" & replace_c(dropdown_list2(SD_ORDER_HEADER_FREIGHT_BILL_TYPE)) & "',CARRIER_ACC_NO='" & replace_c(SD_ORDER_HEADER_CARRIER_ACC_NO.Text) & "',THIRD_PARTY_ADDRESS='" & replace_c(SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text) & "',EST_EXPORT_CLEARANCE_DATE=NVL(to_date('" & replace_c(SD_ORDER_HEADER_EST_EXPORT_CLEARANCE_DATE.Text) & "','MM/DD/RRRR'),NULL),LICENSE_APPLICATION_REF='" & replace_c(SD_ORDER_HEADER_LICENSE_APPLICATION_REF.Text) & "',QUICK_SHIP='" & check_box_r(SD_ORDER_HEADER_QUICK_SHIP) & "',NONAG='" & replace_c(dropdown_list2(SD_ORDER_HEADER_NONAG)) & "',ATEX_HOLD='" & check_box_r(SD_ORDER_HEADER_ATEX_HOLD) & "',AES_HOLD='" & check_box_r(SD_ORDER_HEADER_AES_HOLD) & "',INCOTERMS_LOCATION='" & replace_c(SD_ORDER_HEADER_INCOTERMS_LOCATION.Text) & "',PULL_INVENTORY_FROM_QRC='" & check_box_r(SD_ORDER_HEADER_PULL_INVENTORY_FROM_QRC) & "',ORDER_ENTRY_SALES_CODE='" & replace_c(SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text) & "',QRC_LOCATION='" & replace_c(dropdown_list2(SD_ORDER_HEADER_QRC_LOCATION)) & "',WEB_ORDER_NO='" & replace_c(SD_ORDER_HEADER_WEB_ORDER_NO.Text) & "',INPROCESS='" & check_box_r(SD_ORDER_HEADER_INPROCESS) & "',INPROCESS_MESSAGE='" & replace_c(SD_ORDER_HEADER_INPROCESS_MESSAGE.Text) & "',WEB_ORDER_CREATED_BY='" & replace_c(SD_ORDER_HEADER_WEB_ORDER_CREATED_BY.Text) & "',SUGGESTED_DATE='" & replace_c(SD_ORDER_HEADER_SUGGESTED_DATE.Text) & "',AFFINITY_NO='" & replace_c(SD_ORDER_HEADER_AFFINITY_NO.Text) & "',DO_NOT_SERVICE='" & check_box_r(SD_ORDER_HEADER_DO_NOT_SERVICE) & "',BASE_CURRENCY_CODE='" & replace_c(SD_ORDER_HEADER_BASE_CURRENCY_CODE.Text) & "',CONVERSION_CURRENCY_CODE='" & replace_c(dropdown_list2(SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE)) & "',NO_OF_UNITS_OF_BASE_CURRENCY=" & replace_c1(SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Text) & ",NO_OF_UNITS_OF_CONVERSION_CURR=" & replace_c1(SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Text) & ",PRICE_FROM_PRICING_INFO='" & check_box_r(SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO) & "',BALANCE_QTY_LINE='" & check_box_r(SD_ORDER_HEADER_BALANCE_QTY_LINE) & "',CONTACT_PHONE='" & replace_c(SD_ORDER_HEADER_CONTACT_PHONE.Text) & "',CONTACT_EMAIL='" & replace_c(SD_ORDER_HEADER_CONTACT_EMAIL.Text) & "',ADVANCE_PERCENTAGE=" & replace_c1(SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Text) & ",ADVANCE_AMOUNT=" & replace_c1(SD_ORDER_HEADER_ADVANCE_AMOUNT.Text) & ",ORDER_ACK_PREFERENCE='" & replace_c(dropdown_list2(SD_ORDER_HEADER_ORDER_ACK_PREFERENCE)) & "',Changed_by='" & Session("User_id") & "',changed_date=sysdate  where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
	                dbad.UpdateCommand.ExecuteNonQuery()
            Else
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
                	dbad.InsertCommand.CommandText = "Insert into SD_ORDER_HEADER ( ORDER_NO,BUSINESS_UNIT_CODE,ORDER_DATE,CUSTOMER_NO,NAME,STREET,CITY,STATE_CODE,POSTAL_CODE,COUNTRY,PHONE,PROMISED_DELIVERY_DATE,FAX,EMAIL,CONTACT_NAME,DIFFERENT_BILLING_ADDRESS,BILLING_NAME,BILLING_STREET,BILLING_CITY,BILLING_STATE_CODE,BILLING_POSTAL_CODE,BILLING_COUNTRY,BILLING_PHONE,BILLING_FAX,BILLING_EMAIL,BILLING_CONTACT_NAME,DIFFERENT_SHIPPING_ADDRESS,SHIPPING_NAME,SHIPPING_STREET,SHIPPING_CITY,SHIPPING_STATE_CODE,SHIPPING_POSTAL_CODE,SHIPPING_COUNTRY,SHIPPING_PHONE,SHIPPING_FAX,SHIPPING_EMAIL,SHIPPING_CONTACT_NAME,FREIGHT_BILLING_NAME,FREIGHT_BILLING_STREET,FREIGHT_BILLING_CITY,FREIGHT_BILLING_STATE_CODE,FREIGHT_BILLING_POSTAL_CODE,FREIGHT_BILLING_COUNTRY,FREIGHT_BILLING_PHONE,FREIGHT_BILLING_FAX,FREIGHT_BILLING_EMAIL,FREIGHT_BILLING_CONTACT_NAME,TERMS_CODE,SHIP_VIA,FOB,PAYMENT_METHOD,CUSTOMER_PO_NO,SHIP_TO_PO_REFERENCE,REQUESTED_DATE,DUE_DATE,INTERNAL_NOTES,ORDER_NOTES,SHIPPING_INSTRUCTIONS,BLANKET_ORDER,ITEM_NO,BLANKET_QTY,ORDERING_UOM,SALES_PRICE,PRICING_UOM,BLANKET_EFFECTIVE_FROM,BLANKET_EFFECTIVE_TILL,BLANKET_RELEASE_NO,CUSTOMER_MESSAGE,SHIPTO_CODE,INVOICE_BY,QUOTATION_NO,BLANKET_QTY_BUOM,CUSTOMER_PO_DATE,CANCEL_DATE,CLOSE_DATE,HOLD,ULTIMATE_CONSIGNMENT,SHIP_COMPLETE,SE1,SE_PCT1,SE4,SE3,SE2,SE_PCT2,SE_PCT3,SE_PCT4,FLS_ORDER_NO,EXPORT_HOLD,FREIGHT_BILL_TYPE,CARRIER_ACC_NO,THIRD_PARTY_ADDRESS,EST_EXPORT_CLEARANCE_DATE,LICENSE_APPLICATION_REF,QUICK_SHIP,NONAG,ATEX_HOLD,AES_HOLD,INCOTERMS_LOCATION,PULL_INVENTORY_FROM_QRC,ORDER_ENTRY_SALES_CODE,QRC_LOCATION,WEB_ORDER_NO,INPROCESS,INPROCESS_MESSAGE,WEB_ORDER_CREATED_BY,SUGGESTED_DATE,AFFINITY_NO,DO_NOT_SERVICE,BASE_CURRENCY_CODE,CONVERSION_CURRENCY_CODE,NO_OF_UNITS_OF_BASE_CURRENCY,NO_OF_UNITS_OF_CONVERSION_CURR,PRICE_FROM_PRICING_INFO,BALANCE_QTY_LINE,CONTACT_PHONE,CONTACT_EMAIL,ADVANCE_PERCENTAGE,ADVANCE_AMOUNT,ORDER_ACK_PREFERENCE,created_by,created_date)  values ('" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "','" & replace_c(dropdown_list2(SD_ORDER_HEADER_BUSINESS_UNIT_CODE)) & "',NVL(to_date('" & replace_c(SD_ORDER_HEADER_ORDER_DATE.Text) & "','MM/DD/RRRR'),NULL),'" & replace_c(SD_ORDER_HEADER_CUSTOMER_NO.Text) & "','" & replace_c(SD_ORDER_HEADER_NAME.Text) & "','" & replace_c(SD_ORDER_HEADER_STREET.Text) & "','" & replace_c(SD_ORDER_HEADER_CITY.Text) & "','" & replace_c(SD_ORDER_HEADER_STATE_CODE.Text) & "','" & replace_c(SD_ORDER_HEADER_POSTAL_CODE.Text) & "','" & replace_c(SD_ORDER_HEADER_COUNTRY.Text) & "','" & replace_c(SD_ORDER_HEADER_PHONE.Text) & "',NVL(to_date('" & replace_c(SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.Text) & "','MM/DD/RRRR'),NULL),'" & replace_c(SD_ORDER_HEADER_FAX.Text) & "','" & replace_c(SD_ORDER_HEADER_EMAIL.Text) & "','" & replace_c(SD_ORDER_HEADER_CONTACT_NAME.Text) & "','" & check_box_r(SD_ORDER_HEADER_DIFFERENT_BILLING_ADDRESS) & "','" & replace_c(SD_ORDER_HEADER_BILLING_NAME.Text) & "','" & replace_c(SD_ORDER_HEADER_BILLING_STREET.Text) & "','" & replace_c(SD_ORDER_HEADER_BILLING_CITY.Text) & "','" & replace_c(SD_ORDER_HEADER_BILLING_STATE_CODE.Text) & "','" & replace_c(SD_ORDER_HEADER_BILLING_POSTAL_CODE.Text) & "','" & replace_c(SD_ORDER_HEADER_BILLING_COUNTRY.Text) & "','" & replace_c(SD_ORDER_HEADER_BILLING_PHONE.Text) & "','" & replace_c(SD_ORDER_HEADER_BILLING_FAX.Text) & "','" & replace_c(SD_ORDER_HEADER_BILLING_EMAIL.Text) & "','" & replace_c(SD_ORDER_HEADER_BILLING_CONTACT_NAME.Text) & "','" & check_box_r(SD_ORDER_HEADER_DIFFERENT_SHIPPING_ADDRESS) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_NAME.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_STREET.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_CITY.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_STATE_CODE.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_POSTAL_CODE.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_COUNTRY.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_PHONE.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_FAX.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_EMAIL.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_CONTACT_NAME.Text) & "','" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_NAME.Text) & "','" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_STREET.Text) & "','" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_CITY.Text) & "','" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_STATE_CODE.Text) & "','" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_POSTAL_CODE.Text) & "','" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_COUNTRY.Text) & "','" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_PHONE.Text) & "','" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_FAX.Text) & "','" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_EMAIL.Text) & "','" & replace_c(SD_ORDER_HEADER_FREIGHT_BILLING_CONTACT_NAME.Text) & "','" & replace_c(SD_ORDER_HEADER_TERMS_CODE.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIP_VIA.Text) & "','" & replace_c(dropdown_list2(SD_ORDER_HEADER_FOB)) & "','" & replace_c(dropdown_list2(SD_ORDER_HEADER_PAYMENT_METHOD)) & "','" & replace_c(SD_ORDER_HEADER_CUSTOMER_PO_NO.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIP_TO_PO_REFERENCE.Text) & "',NVL(to_date('" & replace_c(SD_ORDER_HEADER_REQUESTED_DATE.Text) & "','MM/DD/RRRR'),NULL),NVL(to_date('" & replace_c(SD_ORDER_HEADER_DUE_DATE.Text) & "','MM/DD/RRRR'),NULL),'" & replace_c(SD_ORDER_HEADER_INTERNAL_NOTES.Text) & "','" & replace_c(SD_ORDER_HEADER_ORDER_NOTES.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPPING_INSTRUCTIONS.Text) & "','" & check_box_r(SD_ORDER_HEADER_BLANKET_ORDER) & "','" & replace_c(SD_ORDER_HEADER_ITEM_NO.Text) & "'," & replace_c1(SD_ORDER_HEADER_BLANKET_QTY.Text) & ",'" & replace_c(SD_ORDER_HEADER_ORDERING_UOM.Text) & "'," & replace_c1(SD_ORDER_HEADER_SALES_PRICE.Text) & ",'" & replace_c(SD_ORDER_HEADER_PRICING_UOM.Text) & "',NVL(to_date('" & replace_c(SD_ORDER_HEADER_BLANKET_EFFECTIVE_FROM.Text) & "','MM/DD/RRRR'),NULL),NVL(to_date('" & replace_c(SD_ORDER_HEADER_BLANKET_EFFECTIVE_TILL.Text) & "','MM/DD/RRRR'),NULL),'" & replace_c(SD_ORDER_HEADER_BLANKET_RELEASE_NO.Text) & "','" & replace_c(SD_ORDER_HEADER_CUSTOMER_MESSAGE.Text) & "','" & replace_c(SD_ORDER_HEADER_SHIPTO_CODE.Text) & "','" & replace_c(dropdown_list2(SD_ORDER_HEADER_INVOICE_BY)) & "','" & replace_c(SD_ORDER_HEADER_QUOTATION_NO.Text) & "'," & replace_c1(SD_ORDER_HEADER_BLANKET_QTY_BUOM.Text) & ",NVL(to_date('" & replace_c(SD_ORDER_HEADER_CUSTOMER_PO_DATE.Text) & "','MM/DD/RRRR'),NULL),NVL(to_date('" & replace_c(SD_ORDER_HEADER_CANCEL_DATE.Text) & "','MM/DD/RRRR'),NULL),NVL(to_date('" & replace_c(SD_ORDER_HEADER_CLOSE_DATE.Text) & "','MM/DD/RRRR'),NULL),'" & check_box_r(SD_ORDER_HEADER_HOLD) & "','" & replace_c(SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.Text) & "','" & check_box_r(SD_ORDER_HEADER_SHIP_COMPLETE) & "','" & replace_c(SD_ORDER_HEADER_SE1.Text) & "'," & replace_c1(SD_ORDER_HEADER_SE_PCT1.Text) & ",'" & replace_c(SD_ORDER_HEADER_SE4.Text) & "','" & replace_c(SD_ORDER_HEADER_SE3.Text) & "','" & replace_c(SD_ORDER_HEADER_SE2.Text) & "'," & replace_c1(SD_ORDER_HEADER_SE_PCT2.Text) & "," & replace_c1(SD_ORDER_HEADER_SE_PCT3.Text) & "," & replace_c1(SD_ORDER_HEADER_SE_PCT4.Text) & ",'" & replace_c(SD_ORDER_HEADER_FLS_ORDER_NO.Text) & "','" & check_box_r(SD_ORDER_HEADER_EXPORT_HOLD) & "','" & replace_c(dropdown_list2(SD_ORDER_HEADER_FREIGHT_BILL_TYPE)) & "','" & replace_c(SD_ORDER_HEADER_CARRIER_ACC_NO.Text) & "','" & replace_c(SD_ORDER_HEADER_THIRD_PARTY_ADDRESS.Text) & "',NVL(to_date('" & replace_c(SD_ORDER_HEADER_EST_EXPORT_CLEARANCE_DATE.Text) & "','MM/DD/RRRR'),NULL),'" & replace_c(SD_ORDER_HEADER_LICENSE_APPLICATION_REF.Text) & "','" & check_box_r(SD_ORDER_HEADER_QUICK_SHIP) & "','" & replace_c(dropdown_list2(SD_ORDER_HEADER_NONAG)) & "','" & check_box_r(SD_ORDER_HEADER_ATEX_HOLD) & "','" & check_box_r(SD_ORDER_HEADER_AES_HOLD) & "','" & replace_c(SD_ORDER_HEADER_INCOTERMS_LOCATION.Text) & "','" & check_box_r(SD_ORDER_HEADER_PULL_INVENTORY_FROM_QRC) & "','" & replace_c(SD_ORDER_HEADER_ORDER_ENTRY_SALES_CODE.Text) & "','" & replace_c(dropdown_list2(SD_ORDER_HEADER_QRC_LOCATION)) & "','" & replace_c(SD_ORDER_HEADER_WEB_ORDER_NO.Text) & "','" & check_box_r(SD_ORDER_HEADER_INPROCESS) & "','" & replace_c(SD_ORDER_HEADER_INPROCESS_MESSAGE.Text) & "','" & replace_c(SD_ORDER_HEADER_WEB_ORDER_CREATED_BY.Text) & "','" & replace_c(SD_ORDER_HEADER_SUGGESTED_DATE.Text) & "','" & replace_c(SD_ORDER_HEADER_AFFINITY_NO.Text) & "','" & check_box_r(SD_ORDER_HEADER_DO_NOT_SERVICE) & "','" & replace_c(SD_ORDER_HEADER_BASE_CURRENCY_CODE.Text) & "','" & replace_c(dropdown_list2(SD_ORDER_HEADER_CONVERSION_CURRENCY_CODE)) & "'," & replace_c1(SD_ORDER_HEADER_NO_OF_UNITS_OF_BASE_CURRENCY.Text) & "," & replace_c1(SD_ORDER_HEADER_NO_OF_UNITS_OF_CONVERSION_CURR.Text) & ",'" & check_box_r(SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO) & "','" & check_box_r(SD_ORDER_HEADER_BALANCE_QTY_LINE) & "','" & replace_c(SD_ORDER_HEADER_CONTACT_PHONE.Text) & "','" & replace_c(SD_ORDER_HEADER_CONTACT_EMAIL.Text) & "'," & replace_c1(SD_ORDER_HEADER_ADVANCE_PERCENTAGE.Text) & "," & replace_c1(SD_ORDER_HEADER_ADVANCE_AMOUNT.Text) & ",'" & replace_c(dropdown_list2(SD_ORDER_HEADER_ORDER_ACK_PREFERENCE)) & "','" & Session("User_id") & "',sysdate )"
               	dbad.InsertCommand.ExecuteNonQuery()
           End If
    dbad.SelectCommand.Connection.Close()
    dbad.InsertCommand.Connection.Close()
    dbad.UpdateCommand.Connection.Close()
dbad.SelectCommand.Connection = Session("db_connection")
dbad.InsertCommand.Connection = Session("db_connection")
dbad.UpdateCommand.Connection = Session("db_connection")
Dim ddlabel As String
  ddlabel = ""
  ddlabel = SD_ORDER_HEADER_NAME.TEXT & " : " & SD_ORDER_HEADER_ORDER_DATE.TEXT
  ddlabel = Replace(ddlabel,"'","''")
 		Dim dsf12 As New Data.DataSet
        	dbad.SelectCommand.CommandText = "select id from SYS_RECENT_TRANSACTIONS where PAGE_ID='SALES_ORDER' and USER_ID='" & session("user_id") & "' and PRIMARY_KEY1='ORDER_NO' and PRIMARY_KEY1_VALUE= '" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
        	dsf12.Clear()
        	dbad.Fill(dsf12)
        	If (dsf12.Tables(0).Rows.Count > 0) Then
                	If (dbad.UpdateCommand.Connection.State = Data.ConnectionState.Closed) Then
                    		dbad.UpdateCommand.Connection.Open()
                	End If
			dbad.UpdateCommand.CommandText = "Update SYS_RECENT_TRANSACTIONS set CREATED_DATE=sysdate,DISPLAY_URL='" & ddlabel & "' where PAGE_ID='SALES_ORDER' and USER_ID='" & session("user_id") & "' and PRIMARY_KEY1='ORDER_NO' and PRIMARY_KEY1_VALUE= '" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
	                dbad.UpdateCommand.ExecuteNonQuery()
            Else
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
                	dbad.InsertCommand.CommandText = "INSERT INTO SYS_RECENT_TRANSACTIONS (ID, PAGE_ID, PAGE_NAME, MENU_ID, MENU_PARENT_LEVEL, USER_ID, PRIMARY_KEY1, PRIMARY_KEY2, PRIMARY_KEY3, PRIMARY_KEY4, PRIMARY_KEY5, PRIMARY_KEY6, PRIMARY_KEY1_VALUE, PRIMARY_KEY2_VALUE, PRIMARY_KEY3_VALUE, PRIMARY_KEY4_VALUE, PRIMARY_KEY5_VALUE, PRIMARY_KEY6_VALUE,  CREATED_BY, CREATED_DATE,DISPLAY_URL) VALUES (" & conn.sf_get_Max_plus_one("SYS_RECENT_TRANSACTIONS", "ID", "") & ",'SALES_ORDER','Orders','" & Request.QueryString.Get("mid") & "'," & IIf(Request.QueryString.Get("sssid") <> "", Request.QueryString.Get("sssid"), 1) & ",'" & session("user_id") & "','ORDER_NO','','','','','','" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' , '' ,'','' , '', '' ,'" & session("user_id") & "',sysdate,'" & ddlabel & "')"
               	dbad.InsertCommand.ExecuteNonQuery()
           End If
    dbad.SelectCommand.Connection.Close()
    dbad.InsertCommand.Connection.Close()
    dbad.UpdateCommand.Connection.Close()
Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
    dbad.InsertCommand.Connection.Close()
    dbad.UpdateCommand.Connection.Close()
call insert_sys_log("Save Header Info",ex.Message)
End Try
    End Sub
     Public Sub save_details()
 Try
dbad.SelectCommand.Connection = Session("db_connection")
dbad.InsertCommand.Connection = Session("db_connection")
dbad.UpdateCommand.Connection = Session("db_connection")
dbad.DeleteCommand.Connection = Session("db_connection")
TRY
  	  Dim dgItemBILLING_STAGE As DataGridItem
        Dim ddxBILLING_STAGE As New Data.DataSet
        Dim pBILLING_STAGE
        Dim line_no1BILLING_STAGE, item_no1BILLING_STAGE, item_descrip1BILLING_STAGE As String
   For Each dgItemBILLING_STAGE In dbgBILLING_STAGE.Items
Dim CheckBox0 As CheckBox =CType(dgItemBILLING_STAGE.FindControl("CheckBox0"), CheckBox)
Dim LINE_NO As Label = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_LINE_NO"), Label)
Dim STAGE As TextBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_STAGE"), TextBox)
Dim BILLING_PERCENTAGE As TextBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE"), TextBox)
Dim READY_FOR_INOVICE_DATE As TextBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE"), TextBox)
Dim APPROVED_FOR_INOVICE As CheckBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE"), CheckBox)
If ( LINE_NO.Text <>"" and STAGE.Text <>"" ) Then
        Dim dsfBILLING_STAGE As New Data.DataSet
	      dbad.SelectCommand.CommandText = "select  ORDER_NO,STAGE from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and STAGE='" & replace_c(STAGE.Text) & "' "
        dsfBILLING_STAGE.Clear()
        dbad.Fill(dsfBILLING_STAGE)
        If (dsfBILLING_STAGE.Tables(0).Rows.Count > 0) Then
 	      If CheckBox0.Checked = False Then
                	If (dbad.UpdateCommand.Connection.State = Data.ConnectionState.Closed) Then
                    		dbad.UpdateCommand.Connection.Open()
                	End If
			dbad.UpdateCommand.CommandText = "update SD_ORDERS_BILLING_STAGE set ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' ,LINE_NO='" & replace_c(LINE_NO.Text) & "' ,STAGE='" & replace_c(STAGE.Text) & "' ,BILLING_PERCENTAGE='" & replace_c(BILLING_PERCENTAGE.Text) & "' ,READY_FOR_INOVICE_DATE=NVL(TO_DATE('" & READY_FOR_INOVICE_DATE.Text & "','MM/DD/RRRR'),NULL) ,APPROVED_FOR_INOVICE='" & check_box_r(APPROVED_FOR_INOVICE) & "' ,Changed_by='" & Session("User_id") & "',changed_date=sysdate  where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and STAGE='" & replace_c(STAGE.Text) & "' "
	                dbad.UpdateCommand.ExecuteNonQuery()
 End If
            Else
 	      If CheckBox0.Checked = False Then
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
                	dbad.InsertCommand.CommandText = "insert into SD_ORDERS_BILLING_STAGE (ORDER_NO,LINE_NO,STAGE,BILLING_PERCENTAGE,READY_FOR_INOVICE_DATE,APPROVED_FOR_INOVICE,created_by,created_date)  Values ('" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' ,'" & replace_c(LINE_NO.Text) & "' ,'" & replace_c(STAGE.Text) & "' ,'" & replace_c(BILLING_PERCENTAGE.Text) & "' ,NVL(TO_DATE('" & READY_FOR_INOVICE_DATE.Text & "','MM/DD/RRRR'),NULL)  ,'" & check_box_r(APPROVED_FOR_INOVICE) & "' ,'" & Session("User_id") & "',sysdate)"
               	dbad.InsertCommand.ExecuteNonQuery()
          End If
          End If
End If 
   Next
Catch ex As Exception
call insert_sys_log("BILLING_STAGE_ Update",ex.Message)
End Try
TRY
  	  Dim dgItemORDERDETAIL As DataGridItem
        Dim ddxORDERDETAIL As New Data.DataSet
        Dim pORDERDETAIL
        Dim line_no1ORDERDETAIL, item_no1ORDERDETAIL, item_descrip1ORDERDETAIL As String
   For Each dgItemORDERDETAIL In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox =CType(dgItemORDERDETAIL.FindControl("CheckBox0"), CheckBox)
Dim LINE_NO As Label = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim ITEM_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim LOT_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SERIAL_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim DESCRIPTION As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim ORDER_QTY As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim ORDER_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim MULTIPLIER As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim PRICING_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SALES_PRICE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim EXPEDITE As CheckBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim TAX_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim BASE_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim PROJECT_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim DUE_DATE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim DRAWING_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim LICENSE_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim END_USER_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim AM_CODE As DropDownList = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SPIF As CheckBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim CE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim ATEX As CheckBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim ATEX_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim REASON_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim REASON_NOTES As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim INVOICE_BY As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim TRIM_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
If ( LINE_NO.Text <>"" and ORDER_DOC_TYPE.SelectedIndex>0 And ORDER_QTY.Text <>"" and ORDER_QTY.Text <>"" ) Then
        Dim dsfORDERDETAIL As New Data.DataSet
	      dbad.SelectCommand.CommandText = "select  ORDER_NO,LINE_NO from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and LINE_NO='" & replace_c(LINE_NO.Text) & "' "
        dsfORDERDETAIL.Clear()
        dbad.Fill(dsfORDERDETAIL)
        If (dsfORDERDETAIL.Tables(0).Rows.Count > 0) Then
 	      If CheckBox0.Checked = False Then
                	If (dbad.UpdateCommand.Connection.State = Data.ConnectionState.Closed) Then
                    		dbad.UpdateCommand.Connection.Open()
                	End If
			dbad.UpdateCommand.CommandText = "update SD_ORDER_DETAIL set ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' ,LINE_NO='" & replace_c(LINE_NO.Text) & "' ,ORDER_DOC_TYPE='" & dropdown_list2(ORDER_DOC_TYPE) & "' ,ORDER_LINE_TYPE='" & dropdown_list2(ORDER_LINE_TYPE) & "' ,ITEM_NO='" & replace_c(ITEM_NO.Text) & "' ,LICENSE_TIED_UP_LINE='" & replace_c(LICENSE_TIED_UP_LINE.Text) & "' ,LOT_NO='" & replace_c(LOT_NO.Text) & "' ,SERIAL_NO='" & replace_c(SERIAL_NO.Text) & "' ,CREATE_WORK_ORDER='" & check_box_r(CREATE_WORK_ORDER) & "' ,CUSTOMER_ITEM_NO='" & replace_c(CUSTOMER_ITEM_NO.Text) & "' ,ITEM_REVISION_NO='" & replace_c(ITEM_REVISION_NO.Text) & "' ,DESCRIPTION='" & replace_c(DESCRIPTION.Text) & "' ,AES_DESCRIPTION='" & replace_c(AES_DESCRIPTION.Text) & "' ,ORDER_QTY='" & replace_c(ORDER_QTY.Text) & "' ,TRIM_SIZE='" & replace_c(TRIM_SIZE.Text) & "' ,SALES_QTY_ZERO_PRICE='" & replace_c(SALES_QTY_ZERO_PRICE.Text) & "' ,ORDER_UOM='" & replace_c(ORDER_UOM.Text) & "' ,MULTIPLIER='" & replace_c(MULTIPLIER.Text) & "' ,MSRP_SALES_PRICE='" & replace_c(MSRP_SALES_PRICE.Text) & "' ,PRICING_UOM='" & replace_c(PRICING_UOM.Text) & "' ,SALES_PRICE='" & replace_c(SALES_PRICE.Text) & "' ,EXPEDITE='" & check_box_r(EXPEDITE) & "' ,EXPEDIATE_VALUE='" & replace_c(EXPEDIATE_VALUE.Text) & "' ,LINE_EXTENDED_AMOUNT='" & replace_c(LINE_EXTENDED_AMOUNT.Text) & "' ,TAX_CODE='" & replace_c(TAX_CODE.Text) & "' ,TAX_AMOUNT='" & replace_c(TAX_AMOUNT.Text) & "' ,EXTRA_CHARGE_AMOUNT='" & replace_c(EXTRA_CHARGE_AMOUNT.Text) & "' ,LINE_TOTAL_AMOUNT='" & replace_c(LINE_TOTAL_AMOUNT.Text) & "' ,BASE_UOM='" & replace_c(BASE_UOM.Text) & "' ,PROJECT_NO='" & replace_c(PROJECT_NO.Text) & "' ,ORDER_QTY_BASE_UOM='" & replace_c(ORDER_QTY_BASE_UOM.Text) & "' ,DUE_DATE=NVL(TO_DATE('" & DUE_DATE.Text & "','MM/DD/RRRR'),NULL) ,PROMISED_DELIVERY_DATE=NVL(TO_DATE('" & PROMISED_DELIVERY_DATE.Text & "','MM/DD/RRRR'),NULL) ,REQUESTED_SHIP_DATE=NVL(TO_DATE('" & REQUESTED_SHIP_DATE.Text & "','MM/DD/RRRR'),NULL) ,ORDER_PRIORITY_CODE='" & replace_c(ORDER_PRIORITY_CODE.Text) & "' ,TIME_AND_MATERIAL='" & replace_c(TIME_AND_MATERIAL.Text) & "' ,DRAWING_NO='" & replace_c(DRAWING_NO.Text) & "' ,LICENSE_NO='" & replace_c(LICENSE_NO.Text) & "' ,END_USER_CODE='" & replace_c(END_USER_CODE.Text) & "' ,AM_CODE='" & dropdown_list2(AM_CODE) & "' ,SPIF='" & check_box_r(SPIF) & "' ,CE='" & replace_c(CE.Text) & "' ,ATEX='" & check_box_r(ATEX) & "' ,ATEX_CODE='" & replace_c(ATEX_CODE.Text) & "' ,PO_LINE_NO='" & replace_c(PO_LINE_NO.Text) & "' ,CANCELED_QTY='" & replace_c(CANCELED_QTY.Text) & "' ,CANCELED_QTY_BASE_UOM='" & replace_c(CANCELED_QTY_BASE_UOM.Text) & "' ,PRODUCTION_STATUS='" & replace_c(PRODUCTION_STATUS.Text) & "' ,REASON_CODE='" & replace_c(REASON_CODE.Text) & "' ,REASON_NOTES='" & replace_c(REASON_NOTES.Text) & "' ,BLANKET_RELEASE_NO='" & replace_c(BLANKET_RELEASE_NO.Text) & "' ,WORK_ORDER_NO='" & replace_c(WORK_ORDER_NO.Text) & "' ,LINE_SHIP_TO_CODE='" & replace_c(LINE_SHIP_TO_CODE.Text) & "' ,LINE_SHIPPING_ADDRESS='" & replace_c(LINE_SHIPPING_ADDRESS.Text) & "' ,LINE_SHIP_VIA='" & replace_c(LINE_SHIP_VIA.Text) & "' ,INVOICE_BY='" & replace_c(INVOICE_BY.Text) & "' ,CUSTOMER_PO_NO='" & replace_c(CUSTOMER_PO_NO.Text) & "' ,CUSTOMER_PO_DATE=NVL(TO_DATE('" & CUSTOMER_PO_DATE.Text & "','MM/DD/RRRR'),NULL) ,CONFIGURATOR_ID='" & replace_c(CONFIGURATOR_ID.Text) & "' ,TRIM_UOM='" & replace_c(TRIM_UOM.Text) & "' ,STOCK_DUTY_POINT='" & replace_c(STOCK_DUTY_POINT.Text) & "' ,HEAD_UNITS='" & replace_c(HEAD_UNITS.Text) & "' ,FLOW_UNITS='" & replace_c(FLOW_UNITS.Text) & "' ,LICENSE_TIED_IP_LINE='" & replace_c(LICENSE_TIED_IP_LINE.Text) & "' ,Changed_by='" & Session("User_id") & "',changed_date=sysdate  where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and LINE_NO='" & replace_c(LINE_NO.Text) & "' "
	                dbad.UpdateCommand.ExecuteNonQuery()
 End If
            Else
 	      If CheckBox0.Checked = False Then
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
                	dbad.InsertCommand.CommandText = "insert into SD_ORDER_DETAIL (ORDER_NO,LINE_NO,ORDER_DOC_TYPE,ORDER_LINE_TYPE,ITEM_NO,LICENSE_TIED_UP_LINE,LOT_NO,SERIAL_NO,CREATE_WORK_ORDER,CUSTOMER_ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,AES_DESCRIPTION,ORDER_QTY,TRIM_SIZE,SALES_QTY_ZERO_PRICE,ORDER_UOM,MULTIPLIER,MSRP_SALES_PRICE,PRICING_UOM,SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,BASE_UOM,PROJECT_NO,ORDER_QTY_BASE_UOM,DUE_DATE,PROMISED_DELIVERY_DATE,REQUESTED_SHIP_DATE,ORDER_PRIORITY_CODE,TIME_AND_MATERIAL,DRAWING_NO,LICENSE_NO,END_USER_CODE,AM_CODE,SPIF,CE,ATEX,ATEX_CODE,PO_LINE_NO,CANCELED_QTY,CANCELED_QTY_BASE_UOM,PRODUCTION_STATUS,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,INVOICE_BY,CUSTOMER_PO_NO,CUSTOMER_PO_DATE,CONFIGURATOR_ID,TRIM_UOM,STOCK_DUTY_POINT,HEAD_UNITS,FLOW_UNITS,LICENSE_TIED_IP_LINE,created_by,created_date)  Values ('" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' ,'" & replace_c(LINE_NO.Text) & "' ,'" & replace_c(dropdown_list2(ORDER_DOC_TYPE)) & "' ,'" & replace_c(dropdown_list2(ORDER_LINE_TYPE)) & "' ,'" & replace_c(ITEM_NO.Text) & "' ,'" & replace_c(LICENSE_TIED_UP_LINE.Text) & "' ,'" & replace_c(LOT_NO.Text) & "' ,'" & replace_c(SERIAL_NO.Text) & "' ,'" & check_box_r(CREATE_WORK_ORDER) & "' ,'" & replace_c(CUSTOMER_ITEM_NO.Text) & "' ,'" & replace_c(ITEM_REVISION_NO.Text) & "' ,'" & replace_c(DESCRIPTION.Text) & "' ,'" & replace_c(AES_DESCRIPTION.Text) & "' ,'" & replace_c(ORDER_QTY.Text) & "' ,'" & replace_c(TRIM_SIZE.Text) & "' ,'" & replace_c(SALES_QTY_ZERO_PRICE.Text) & "' ,'" & replace_c(ORDER_UOM.Text) & "' ,'" & replace_c(MULTIPLIER.Text) & "' ,'" & replace_c(MSRP_SALES_PRICE.Text) & "' ,'" & replace_c(PRICING_UOM.Text) & "' ,'" & replace_c(SALES_PRICE.Text) & "' ,'" & check_box_r(EXPEDITE) & "' ,'" & replace_c(EXPEDIATE_VALUE.Text) & "' ,'" & replace_c(LINE_EXTENDED_AMOUNT.Text) & "' ,'" & replace_c(TAX_CODE.Text) & "' ,'" & replace_c(TAX_AMOUNT.Text) & "' ,'" & replace_c(EXTRA_CHARGE_AMOUNT.Text) & "' ,'" & replace_c(LINE_TOTAL_AMOUNT.Text) & "' ,'" & replace_c(BASE_UOM.Text) & "' ,'" & replace_c(PROJECT_NO.Text) & "' ,'" & replace_c(ORDER_QTY_BASE_UOM.Text) & "' ,NVL(TO_DATE('" & DUE_DATE.Text & "','MM/DD/RRRR'),NULL)  ,NVL(TO_DATE('" & PROMISED_DELIVERY_DATE.Text & "','MM/DD/RRRR'),NULL)  ,NVL(TO_DATE('" & REQUESTED_SHIP_DATE.Text & "','MM/DD/RRRR'),NULL)  ,'" & replace_c(ORDER_PRIORITY_CODE.Text) & "' ,'" & replace_c(TIME_AND_MATERIAL.Text) & "' ,'" & replace_c(DRAWING_NO.Text) & "' ,'" & replace_c(LICENSE_NO.Text) & "' ,'" & replace_c(END_USER_CODE.Text) & "' ,'" & replace_c(dropdown_list2(AM_CODE)) & "' ,'" & check_box_r(SPIF) & "' ,'" & replace_c(CE.Text) & "' ,'" & check_box_r(ATEX) & "' ,'" & replace_c(ATEX_CODE.Text) & "' ,'" & replace_c(PO_LINE_NO.Text) & "' ,'" & replace_c(CANCELED_QTY.Text) & "' ,'" & replace_c(CANCELED_QTY_BASE_UOM.Text) & "' ,'" & replace_c(PRODUCTION_STATUS.Text) & "' ,'" & replace_c(REASON_CODE.Text) & "' ,'" & replace_c(REASON_NOTES.Text) & "' ,'" & replace_c(BLANKET_RELEASE_NO.Text) & "' ,'" & replace_c(WORK_ORDER_NO.Text) & "' ,'" & replace_c(LINE_SHIP_TO_CODE.Text) & "' ,'" & replace_c(LINE_SHIPPING_ADDRESS.Text) & "' ,'" & replace_c(LINE_SHIP_VIA.Text) & "' ,'" & replace_c(INVOICE_BY.Text) & "' ,'" & replace_c(CUSTOMER_PO_NO.Text) & "' ,NVL(TO_DATE('" & CUSTOMER_PO_DATE.Text & "','MM/DD/RRRR'),NULL)  ,'" & replace_c(CONFIGURATOR_ID.Text) & "' ,'" & replace_c(TRIM_UOM.Text) & "' ,'" & replace_c(STOCK_DUTY_POINT.Text) & "' ,'" & replace_c(HEAD_UNITS.Text) & "' ,'" & replace_c(FLOW_UNITS.Text) & "' ,'" & replace_c(LICENSE_TIED_IP_LINE.Text) & "' ,'" & Session("User_id") & "',sysdate)"
               	dbad.InsertCommand.ExecuteNonQuery()
          End If
          End If
End If 
   Next
Catch ex As Exception
call insert_sys_log("ORDERDETAIL_ Update",ex.Message)
End Try
TRY
  	  Dim dgItemSALESREPBYSALESORDER As DataGridItem
        Dim ddxSALESREPBYSALESORDER As New Data.DataSet
        Dim pSALESREPBYSALESORDER
        Dim line_no1SALESREPBYSALESORDER, item_no1SALESREPBYSALESORDER, item_descrip1SALESREPBYSALESORDER As String
   For Each dgItemSALESREPBYSALESORDER In dbgSALESREPBYSALESORDER.Items
Dim CheckBox0 As CheckBox =CType(dgItemSALESREPBYSALESORDER.FindControl("CheckBox0"), CheckBox)
Dim LINE_NO As Label = CType(dgItemSALESREPBYSALESORDER.FindControl("SD_SALES_REP_BY_SALES_ORDER_LINE_NO"), Label)
Dim SALES_REP_NO As TextBox = CType(dgItemSALESREPBYSALESORDER.FindControl("SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO"), TextBox)
Dim EFFECTIVE_FROM As TextBox = CType(dgItemSALESREPBYSALESORDER.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM"), TextBox)
Dim EFFECTIVE_TILL As TextBox = CType(dgItemSALESREPBYSALESORDER.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL"), TextBox)
Dim COMMISSION_RATE As TextBox = CType(dgItemSALESREPBYSALESORDER.FindControl("SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE"), TextBox)
If ( LINE_NO.Text <>"" and SALES_REP_NO.Text <>"" ) Then
        Dim dsfSALESREPBYSALESORDER As New Data.DataSet
	      dbad.SelectCommand.CommandText = "select  SALES_ORDER_NO,LINE_NO from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and LINE_NO='" & replace_c(LINE_NO.Text) & "' "
        dsfSALESREPBYSALESORDER.Clear()
        dbad.Fill(dsfSALESREPBYSALESORDER)
        If (dsfSALESREPBYSALESORDER.Tables(0).Rows.Count > 0) Then
 	      If CheckBox0.Checked = False Then
                	If (dbad.UpdateCommand.Connection.State = Data.ConnectionState.Closed) Then
                    		dbad.UpdateCommand.Connection.Open()
                	End If
			dbad.UpdateCommand.CommandText = "update SD_SALES_REP_BY_SALES_ORDER set SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' ,LINE_NO='" & replace_c(LINE_NO.Text) & "' ,SALES_REP_NO='" & replace_c(SALES_REP_NO.Text) & "' ,EFFECTIVE_FROM=NVL(TO_DATE('" & EFFECTIVE_FROM.Text & "','MM/DD/RRRR'),NULL) ,EFFECTIVE_TILL=NVL(TO_DATE('" & EFFECTIVE_TILL.Text & "','MM/DD/RRRR'),NULL) ,COMMISSION_RATE='" & replace_c(COMMISSION_RATE.Text) & "' ,Changed_by='" & Session("User_id") & "',changed_date=sysdate  where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and LINE_NO='" & replace_c(LINE_NO.Text) & "' "
	                dbad.UpdateCommand.ExecuteNonQuery()
 End If
            Else
 	      If CheckBox0.Checked = False Then
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
                	dbad.InsertCommand.CommandText = "insert into SD_SALES_REP_BY_SALES_ORDER (SALES_ORDER_NO,LINE_NO,SALES_REP_NO,EFFECTIVE_FROM,EFFECTIVE_TILL,COMMISSION_RATE,created_by,created_date)  Values ('" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' ,'" & replace_c(LINE_NO.Text) & "' ,'" & replace_c(SALES_REP_NO.Text) & "' ,NVL(TO_DATE('" & EFFECTIVE_FROM.Text & "','MM/DD/RRRR'),NULL)  ,NVL(TO_DATE('" & EFFECTIVE_TILL.Text & "','MM/DD/RRRR'),NULL)  ,'" & replace_c(COMMISSION_RATE.Text) & "' ,'" & Session("User_id") & "',sysdate)"
               	dbad.InsertCommand.ExecuteNonQuery()
          End If
          End If
End If 
   Next
Catch ex As Exception
call insert_sys_log("SALESREPBYSALESORDER_ Update",ex.Message)
End Try
    dbad.SelectCommand.Connection.Close()
    dbad.InsertCommand.Connection.Close()
    dbad.UpdateCommand.Connection.Close()
    dbad.DeleteCommand.Connection.Close()
Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
    dbad.InsertCommand.Connection.Close()
    dbad.UpdateCommand.Connection.Close()
    dbad.DeleteCommand.Connection.Close()
call insert_sys_log("Save Details",ex.Message)
End Try
    End Sub
 Public Sub delete_details()
Try
            If (dbad.DeleteCommand.Connection.State = Data.ConnectionState.Closed) Then
                dbad.DeleteCommand.Connection.Open()
            End If
            dbad.DeleteCommand.CommandText = "delete from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
            dbad.DeleteCommand.ExecuteNonQuery()
            dbad.DeleteCommand.CommandText = "delete from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
            dbad.DeleteCommand.ExecuteNonQuery()
            dbad.DeleteCommand.CommandText = "delete from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
            dbad.DeleteCommand.ExecuteNonQuery()
Catch ex As Exception
call insert_sys_log("Delete Details",ex.Message)
End Try
    End Sub
    Public Sub Fill_detail_grid_dbgBILLING_STAGE()
 Try
 Dim ds1, ds2,ds3_l  As New Data.DataSet()
 Dim lno As Integer
dbad.SelectCommand.Connection = Session("db_connection")
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" ) Then
  Session("dgItem1BILLING_STAGE") = ""
  Session("dgItem2BILLING_STAGE") = ""
dbad.SelectCommand.CommandText = "select max(LINE_NO)  from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                   ds3_l.Clear()
                    dbad.Fill(ds3_l)
                    If (ds3_l.Tables(0).Rows.Count > 0) Then
 			If Not (Equals(ds3_l.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
                		lno = ds3_l.Tables(0).Rows(0)(0)
            		Else
               			lno = 0
            		End If
			else 
               			lno = 0
                    End If
		          dbad.SelectCommand.CommandText = "select LINE_NO,STAGE,BILLING_PERCENTAGE, to_char(READY_FOR_INOVICE_DATE,'MM/DD/RRRR') READY_FOR_INOVICE_DATE,APPROVED_FOR_INOVICE from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by LINE_NO"
                ds2.Clear()
                dbad.Fill(ds2)
                If (ds2.Tables(0).Rows.Count > 0) Then
                    dbad.SelectCommand.CommandText = "select LINE_NO,STAGE,BILLING_PERCENTAGE, to_char(READY_FOR_INOVICE_DATE,'MM/DD/RRRR') READY_FOR_INOVICE_DATE,APPROVED_FOR_INOVICE from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by LINE_NO"
                    ds1.Clear()
                    dbad.Fill(ds1)
                Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' STAGE, NULL BILLING_PERCENTAGE,'' READY_FOR_INOVICE_DATE,'' APPROVED_FOR_INOVICE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
                End If
Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' STAGE, NULL BILLING_PERCENTAGE,'' READY_FOR_INOVICE_DATE,'' APPROVED_FOR_INOVICE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
        End If
      dbgBILLING_STAGE.DataSource = ds1.Tables(0)
      dbgBILLING_STAGE.DataBind()
 Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
call insert_sys_log("dbgBILLING_STAGE_grid",ex.Message)
 End Try
    End Sub
    Public Sub Fill_detail_grid_dbgORDERDETAIL()
 Try
 Dim ds1, ds2,ds3_l  As New Data.DataSet()
 Dim lno As Integer
dbad.SelectCommand.Connection = Session("db_connection")
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" ) Then
  Session("dgItem1ORDERDETAIL") = ""
  Session("dgItem2ORDERDETAIL") = ""
dbad.SelectCommand.CommandText = "select max(LINE_NO)  from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                   ds3_l.Clear()
                    dbad.Fill(ds3_l)
                    If (ds3_l.Tables(0).Rows.Count > 0) Then
 			If Not (Equals(ds3_l.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
                		lno = ds3_l.Tables(0).Rows(0)(0)
            		Else
               			lno = 0
            		End If
			else 
               			lno = 0
                    End If
		          dbad.SelectCommand.CommandText = "select LINE_NO,ORDER_DOC_TYPE,ORDER_LINE_TYPE,ITEM_NO,LICENSE_TIED_UP_LINE,LOT_NO,SERIAL_NO,CREATE_WORK_ORDER,CUSTOMER_ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,AES_DESCRIPTION,ORDER_QTY,TRIM_SIZE,SALES_QTY_ZERO_PRICE,ORDER_UOM,MULTIPLIER,MSRP_SALES_PRICE,PRICING_UOM,SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,BASE_UOM,PROJECT_NO,ORDER_QTY_BASE_UOM, to_char(DUE_DATE,'MM/DD/RRRR') DUE_DATE, to_char(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE, to_char(REQUESTED_SHIP_DATE,'MM/DD/RRRR') REQUESTED_SHIP_DATE,ORDER_PRIORITY_CODE,TIME_AND_MATERIAL,DRAWING_NO,LICENSE_NO,END_USER_CODE,AM_CODE,SPIF,CE,ATEX,ATEX_CODE,PO_LINE_NO,CANCELED_QTY,CANCELED_QTY_BASE_UOM,PRODUCTION_STATUS,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,INVOICE_BY,CUSTOMER_PO_NO, to_char(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE,CONFIGURATOR_ID,TRIM_UOM,STOCK_DUTY_POINT,HEAD_UNITS,FLOW_UNITS,LICENSE_TIED_IP_LINE from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by PO_LINE_NO,LINE_NO"
                ds2.Clear()
                dbad.Fill(ds2)
                If (ds2.Tables(0).Rows.Count > 0) Then
                    dbad.SelectCommand.CommandText = "select LINE_NO,ORDER_DOC_TYPE,ORDER_LINE_TYPE,ITEM_NO,LICENSE_TIED_UP_LINE,LOT_NO,SERIAL_NO,CREATE_WORK_ORDER,CUSTOMER_ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,AES_DESCRIPTION,ORDER_QTY,TRIM_SIZE,SALES_QTY_ZERO_PRICE,ORDER_UOM,MULTIPLIER,MSRP_SALES_PRICE,PRICING_UOM,SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,BASE_UOM,PROJECT_NO,ORDER_QTY_BASE_UOM, to_char(DUE_DATE,'MM/DD/RRRR') DUE_DATE, to_char(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE, to_char(REQUESTED_SHIP_DATE,'MM/DD/RRRR') REQUESTED_SHIP_DATE,ORDER_PRIORITY_CODE,TIME_AND_MATERIAL,DRAWING_NO,LICENSE_NO,END_USER_CODE,AM_CODE,SPIF,CE,ATEX,ATEX_CODE,PO_LINE_NO,CANCELED_QTY,CANCELED_QTY_BASE_UOM,PRODUCTION_STATUS,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,INVOICE_BY,CUSTOMER_PO_NO, to_char(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE,CONFIGURATOR_ID,TRIM_UOM,STOCK_DUTY_POINT,HEAD_UNITS,FLOW_UNITS,LICENSE_TIED_IP_LINE from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by PO_LINE_NO,LINE_NO"
                    ds1.Clear()
                    dbad.Fill(ds1)
                Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' ORDER_DOC_TYPE,'' ORDER_LINE_TYPE,'' ITEM_NO, NULL LICENSE_TIED_UP_LINE,'' LOT_NO,'' SERIAL_NO,'' CREATE_WORK_ORDER,'' CUSTOMER_ITEM_NO,'' ITEM_REVISION_NO,'' DESCRIPTION,'' AES_DESCRIPTION, 1 ORDER_QTY, NULL TRIM_SIZE, 1 SALES_QTY_ZERO_PRICE,'EA' ORDER_UOM, NULL MULTIPLIER, NULL MSRP_SALES_PRICE,'EA' PRICING_UOM, NULL SALES_PRICE,'' EXPEDITE, NULL EXPEDIATE_VALUE, NULL LINE_EXTENDED_AMOUNT,'' TAX_CODE, 0 TAX_AMOUNT, 0 EXTRA_CHARGE_AMOUNT, NULL LINE_TOTAL_AMOUNT,'' BASE_UOM,'' PROJECT_NO, NULL ORDER_QTY_BASE_UOM,'' DUE_DATE,'' PROMISED_DELIVERY_DATE,'' REQUESTED_SHIP_DATE, 100 ORDER_PRIORITY_CODE,'' TIME_AND_MATERIAL,'' DRAWING_NO,'' LICENSE_NO,'' END_USER_CODE,'' AM_CODE,'' SPIF,'' CE,'' ATEX,'' ATEX_CODE, NULL PO_LINE_NO, NULL CANCELED_QTY, NULL CANCELED_QTY_BASE_UOM,'' PRODUCTION_STATUS,'' REASON_CODE,'' REASON_NOTES,'' BLANKET_RELEASE_NO,'' WORK_ORDER_NO,'' LINE_SHIP_TO_CODE,'' LINE_SHIPPING_ADDRESS,'' LINE_SHIP_VIA,'' INVOICE_BY,'' CUSTOMER_PO_NO,'' CUSTOMER_PO_DATE,'' CONFIGURATOR_ID,'IN' TRIM_UOM,'STOCK' STOCK_DUTY_POINT,'FT' HEAD_UNITS,'GPM' FLOW_UNITS, NULL LICENSE_TIED_IP_LINE from SYS_TOOL_DUAL  WHERE ROWNUM<=5"
                    ds1.Clear()
                    dbad.Fill(ds1)
                End If
Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' ORDER_DOC_TYPE,'' ORDER_LINE_TYPE,'' ITEM_NO, NULL LICENSE_TIED_UP_LINE,'' LOT_NO,'' SERIAL_NO,'' CREATE_WORK_ORDER,'' CUSTOMER_ITEM_NO,'' ITEM_REVISION_NO,'' DESCRIPTION,'' AES_DESCRIPTION, 1 ORDER_QTY, NULL TRIM_SIZE, 1 SALES_QTY_ZERO_PRICE,'EA' ORDER_UOM, NULL MULTIPLIER, NULL MSRP_SALES_PRICE,'EA' PRICING_UOM, NULL SALES_PRICE,'' EXPEDITE, NULL EXPEDIATE_VALUE, NULL LINE_EXTENDED_AMOUNT,'' TAX_CODE, 0 TAX_AMOUNT, 0 EXTRA_CHARGE_AMOUNT, NULL LINE_TOTAL_AMOUNT,'' BASE_UOM,'' PROJECT_NO, NULL ORDER_QTY_BASE_UOM,'' DUE_DATE,'' PROMISED_DELIVERY_DATE,'' REQUESTED_SHIP_DATE, 100 ORDER_PRIORITY_CODE,'' TIME_AND_MATERIAL,'' DRAWING_NO,'' LICENSE_NO,'' END_USER_CODE,'' AM_CODE,'' SPIF,'' CE,'' ATEX,'' ATEX_CODE, NULL PO_LINE_NO, NULL CANCELED_QTY, NULL CANCELED_QTY_BASE_UOM,'' PRODUCTION_STATUS,'' REASON_CODE,'' REASON_NOTES,'' BLANKET_RELEASE_NO,'' WORK_ORDER_NO,'' LINE_SHIP_TO_CODE,'' LINE_SHIPPING_ADDRESS,'' LINE_SHIP_VIA,'' INVOICE_BY,'' CUSTOMER_PO_NO,'' CUSTOMER_PO_DATE,'' CONFIGURATOR_ID,'IN' TRIM_UOM,'STOCK' STOCK_DUTY_POINT,'FT' HEAD_UNITS,'GPM' FLOW_UNITS, NULL LICENSE_TIED_IP_LINE from SYS_TOOL_DUAL  WHERE ROWNUM<=5"
                    ds1.Clear()
                    dbad.Fill(ds1)
        End If
      dbgORDERDETAIL.DataSource = ds1.Tables(0)
      dbgORDERDETAIL.DataBind()
 Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
call insert_sys_log("dbgORDERDETAIL_grid",ex.Message)
 End Try
    End Sub
    Public Sub Fill_detail_grid_dbgSALESREPBYSALESORDER()
 Try
 Dim ds1, ds2,ds3_l  As New Data.DataSet()
 Dim lno As Integer
dbad.SelectCommand.Connection = Session("db_connection")
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" ) Then
  Session("dgItem1SALESREPBYSALESORDER") = ""
  Session("dgItem2SALESREPBYSALESORDER") = ""
dbad.SelectCommand.CommandText = "select max(LINE_NO)  from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                   ds3_l.Clear()
                    dbad.Fill(ds3_l)
                    If (ds3_l.Tables(0).Rows.Count > 0) Then
 			If Not (Equals(ds3_l.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
                		lno = ds3_l.Tables(0).Rows(0)(0)
            		Else
               			lno = 0
            		End If
			else 
               			lno = 0
                    End If
		          dbad.SelectCommand.CommandText = "select LINE_NO,SALES_REP_NO, to_char(EFFECTIVE_FROM,'MM/DD/RRRR') EFFECTIVE_FROM, to_char(EFFECTIVE_TILL,'MM/DD/RRRR') EFFECTIVE_TILL,COMMISSION_RATE from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                ds2.Clear()
                dbad.Fill(ds2)
                If (ds2.Tables(0).Rows.Count > 0) Then
                    dbad.SelectCommand.CommandText = "select LINE_NO,SALES_REP_NO, to_char(EFFECTIVE_FROM,'MM/DD/RRRR') EFFECTIVE_FROM, to_char(EFFECTIVE_TILL,'MM/DD/RRRR') EFFECTIVE_TILL,COMMISSION_RATE from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                    ds1.Clear()
                    dbad.Fill(ds1)
                Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' SALES_REP_NO,'" & "01/01/2001" & "' EFFECTIVE_FROM,'" & now.date() & "' EFFECTIVE_TILL, NULL COMMISSION_RATE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
                End If
Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' SALES_REP_NO,'" & "01/01/2001" & "' EFFECTIVE_FROM,'" & now.date() & "' EFFECTIVE_TILL, NULL COMMISSION_RATE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
        End If
      dbgSALESREPBYSALESORDER.DataSource = ds1.Tables(0)
      dbgSALESREPBYSALESORDER.DataBind()
 Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
call insert_sys_log("dbgSALESREPBYSALESORDER_grid",ex.Message)
 End Try
    End Sub
    Public Sub Fill_detail_grid()
 Dim ds1, ds2,ds3_l  As New Data.DataSet()
 Dim lno As Integer
 Dim dverf As Integer=0
 Try
 Try
dbad.SelectCommand.Connection = Session("db_connection")
mytotal9703=0
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" ) Then
  Session("dgItem1BILLING_STAGE") = ""
  Session("dgItem2BILLING_STAGE") = ""
dbad.SelectCommand.CommandText = "select max(LINE_NO)  from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                   ds3_l.Clear()
                    dbad.Fill(ds3_l)
                    If (ds3_l.Tables(0).Rows.Count > 0) Then
 			If Not (Equals(ds3_l.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
                		lno = ds3_l.Tables(0).Rows(0)(0)
            		Else
               			lno = 0
            		End If
			else 
               			lno = 0
                    End If
		          dbad.SelectCommand.CommandText = "select LINE_NO,STAGE,BILLING_PERCENTAGE, to_char(READY_FOR_INOVICE_DATE,'MM/DD/RRRR') READY_FOR_INOVICE_DATE,APPROVED_FOR_INOVICE from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by LINE_NO"
                ds2.Clear()
                dbad.Fill(ds2)
                If (ds2.Tables(0).Rows.Count > 0) Then
dverf=1
                    dbad.SelectCommand.CommandText = "select LINE_NO,STAGE,BILLING_PERCENTAGE, to_char(READY_FOR_INOVICE_DATE,'MM/DD/RRRR') READY_FOR_INOVICE_DATE,APPROVED_FOR_INOVICE from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by LINE_NO"
                    ds1.Clear()
                    dbad.Fill(ds1)
                Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' STAGE, NULL BILLING_PERCENTAGE,'' READY_FOR_INOVICE_DATE,'' APPROVED_FOR_INOVICE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
                End If
Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' STAGE, NULL BILLING_PERCENTAGE,'' READY_FOR_INOVICE_DATE,'' APPROVED_FOR_INOVICE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
        End If
      dbgBILLING_STAGE.DataSource = ds1.Tables(0)
      dbgBILLING_STAGE.DataBind()
 Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
call insert_sys_log("dbgBILLING_STAGE_Grid Fill",ex.Message)
 End Try
 Try
mytotal1174=0
mytotal1214=0
mytotal1705=0
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" ) Then
  Session("dgItem1ORDERDETAIL") = ""
  Session("dgItem2ORDERDETAIL") = ""
dbad.SelectCommand.CommandText = "select max(LINE_NO)  from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                   ds3_l.Clear()
                    dbad.Fill(ds3_l)
                    If (ds3_l.Tables(0).Rows.Count > 0) Then
 			If Not (Equals(ds3_l.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
                		lno = ds3_l.Tables(0).Rows(0)(0)
            		Else
               			lno = 0
            		End If
			else 
               			lno = 0
                    End If
		          dbad.SelectCommand.CommandText = "select LINE_NO,ORDER_DOC_TYPE,ORDER_LINE_TYPE,ITEM_NO,LICENSE_TIED_UP_LINE,LOT_NO,SERIAL_NO,CREATE_WORK_ORDER,CUSTOMER_ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,AES_DESCRIPTION,ORDER_QTY,TRIM_SIZE,SALES_QTY_ZERO_PRICE,ORDER_UOM,MULTIPLIER,MSRP_SALES_PRICE,PRICING_UOM,SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,BASE_UOM,PROJECT_NO,ORDER_QTY_BASE_UOM, to_char(DUE_DATE,'MM/DD/RRRR') DUE_DATE, to_char(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE, to_char(REQUESTED_SHIP_DATE,'MM/DD/RRRR') REQUESTED_SHIP_DATE,ORDER_PRIORITY_CODE,TIME_AND_MATERIAL,DRAWING_NO,LICENSE_NO,END_USER_CODE,AM_CODE,SPIF,CE,ATEX,ATEX_CODE,PO_LINE_NO,CANCELED_QTY,CANCELED_QTY_BASE_UOM,PRODUCTION_STATUS,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,INVOICE_BY,CUSTOMER_PO_NO, to_char(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE,CONFIGURATOR_ID,TRIM_UOM,STOCK_DUTY_POINT,HEAD_UNITS,FLOW_UNITS,LICENSE_TIED_IP_LINE from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by PO_LINE_NO,LINE_NO"
                ds2.Clear()
                dbad.Fill(ds2)
                If (ds2.Tables(0).Rows.Count > 0) Then
dverf=1
                    dbad.SelectCommand.CommandText = "select LINE_NO,ORDER_DOC_TYPE,ORDER_LINE_TYPE,ITEM_NO,LICENSE_TIED_UP_LINE,LOT_NO,SERIAL_NO,CREATE_WORK_ORDER,CUSTOMER_ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,AES_DESCRIPTION,ORDER_QTY,TRIM_SIZE,SALES_QTY_ZERO_PRICE,ORDER_UOM,MULTIPLIER,MSRP_SALES_PRICE,PRICING_UOM,SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,BASE_UOM,PROJECT_NO,ORDER_QTY_BASE_UOM, to_char(DUE_DATE,'MM/DD/RRRR') DUE_DATE, to_char(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE, to_char(REQUESTED_SHIP_DATE,'MM/DD/RRRR') REQUESTED_SHIP_DATE,ORDER_PRIORITY_CODE,TIME_AND_MATERIAL,DRAWING_NO,LICENSE_NO,END_USER_CODE,AM_CODE,SPIF,CE,ATEX,ATEX_CODE,PO_LINE_NO,CANCELED_QTY,CANCELED_QTY_BASE_UOM,PRODUCTION_STATUS,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,INVOICE_BY,CUSTOMER_PO_NO, to_char(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE,CONFIGURATOR_ID,TRIM_UOM,STOCK_DUTY_POINT,HEAD_UNITS,FLOW_UNITS,LICENSE_TIED_IP_LINE from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by PO_LINE_NO,LINE_NO"
                    ds1.Clear()
                    dbad.Fill(ds1)
                Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' ORDER_DOC_TYPE,'' ORDER_LINE_TYPE,'' ITEM_NO, NULL LICENSE_TIED_UP_LINE,'' LOT_NO,'' SERIAL_NO,'' CREATE_WORK_ORDER,'' CUSTOMER_ITEM_NO,'' ITEM_REVISION_NO,'' DESCRIPTION,'' AES_DESCRIPTION, 1 ORDER_QTY, NULL TRIM_SIZE, 1 SALES_QTY_ZERO_PRICE,'EA' ORDER_UOM, NULL MULTIPLIER, NULL MSRP_SALES_PRICE,'EA' PRICING_UOM, NULL SALES_PRICE,'' EXPEDITE, NULL EXPEDIATE_VALUE, NULL LINE_EXTENDED_AMOUNT,'' TAX_CODE, 0 TAX_AMOUNT, 0 EXTRA_CHARGE_AMOUNT, NULL LINE_TOTAL_AMOUNT,'' BASE_UOM,'' PROJECT_NO, NULL ORDER_QTY_BASE_UOM,'' DUE_DATE,'' PROMISED_DELIVERY_DATE,'' REQUESTED_SHIP_DATE, 100 ORDER_PRIORITY_CODE,'' TIME_AND_MATERIAL,'' DRAWING_NO,'' LICENSE_NO,'' END_USER_CODE,'' AM_CODE,'' SPIF,'' CE,'' ATEX,'' ATEX_CODE, NULL PO_LINE_NO, NULL CANCELED_QTY, NULL CANCELED_QTY_BASE_UOM,'' PRODUCTION_STATUS,'' REASON_CODE,'' REASON_NOTES,'' BLANKET_RELEASE_NO,'' WORK_ORDER_NO,'' LINE_SHIP_TO_CODE,'' LINE_SHIPPING_ADDRESS,'' LINE_SHIP_VIA,'' INVOICE_BY,'' CUSTOMER_PO_NO,'' CUSTOMER_PO_DATE,'' CONFIGURATOR_ID,'IN' TRIM_UOM,'STOCK' STOCK_DUTY_POINT,'FT' HEAD_UNITS,'GPM' FLOW_UNITS, NULL LICENSE_TIED_IP_LINE from SYS_TOOL_DUAL  WHERE ROWNUM<=5"
                    ds1.Clear()
                    dbad.Fill(ds1)
                End If
Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' ORDER_DOC_TYPE,'' ORDER_LINE_TYPE,'' ITEM_NO, NULL LICENSE_TIED_UP_LINE,'' LOT_NO,'' SERIAL_NO,'' CREATE_WORK_ORDER,'' CUSTOMER_ITEM_NO,'' ITEM_REVISION_NO,'' DESCRIPTION,'' AES_DESCRIPTION, 1 ORDER_QTY, NULL TRIM_SIZE, 1 SALES_QTY_ZERO_PRICE,'EA' ORDER_UOM, NULL MULTIPLIER, NULL MSRP_SALES_PRICE,'EA' PRICING_UOM, NULL SALES_PRICE,'' EXPEDITE, NULL EXPEDIATE_VALUE, NULL LINE_EXTENDED_AMOUNT,'' TAX_CODE, 0 TAX_AMOUNT, 0 EXTRA_CHARGE_AMOUNT, NULL LINE_TOTAL_AMOUNT,'' BASE_UOM,'' PROJECT_NO, NULL ORDER_QTY_BASE_UOM,'' DUE_DATE,'' PROMISED_DELIVERY_DATE,'' REQUESTED_SHIP_DATE, 100 ORDER_PRIORITY_CODE,'' TIME_AND_MATERIAL,'' DRAWING_NO,'' LICENSE_NO,'' END_USER_CODE,'' AM_CODE,'' SPIF,'' CE,'' ATEX,'' ATEX_CODE, NULL PO_LINE_NO, NULL CANCELED_QTY, NULL CANCELED_QTY_BASE_UOM,'' PRODUCTION_STATUS,'' REASON_CODE,'' REASON_NOTES,'' BLANKET_RELEASE_NO,'' WORK_ORDER_NO,'' LINE_SHIP_TO_CODE,'' LINE_SHIPPING_ADDRESS,'' LINE_SHIP_VIA,'' INVOICE_BY,'' CUSTOMER_PO_NO,'' CUSTOMER_PO_DATE,'' CONFIGURATOR_ID,'IN' TRIM_UOM,'STOCK' STOCK_DUTY_POINT,'FT' HEAD_UNITS,'GPM' FLOW_UNITS, NULL LICENSE_TIED_IP_LINE from SYS_TOOL_DUAL  WHERE ROWNUM<=5"
                    ds1.Clear()
                    dbad.Fill(ds1)
        End If
      dbgORDERDETAIL.DataSource = ds1.Tables(0)
      dbgORDERDETAIL.DataBind()
 Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
call insert_sys_log("dbgORDERDETAIL_Grid Fill",ex.Message)
 End Try
 Try
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" ) Then
  Session("dgItem1SALESREPBYSALESORDER") = ""
  Session("dgItem2SALESREPBYSALESORDER") = ""
dbad.SelectCommand.CommandText = "select max(LINE_NO)  from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                   ds3_l.Clear()
                    dbad.Fill(ds3_l)
                    If (ds3_l.Tables(0).Rows.Count > 0) Then
 			If Not (Equals(ds3_l.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
                		lno = ds3_l.Tables(0).Rows(0)(0)
            		Else
               			lno = 0
            		End If
			else 
               			lno = 0
                    End If
		          dbad.SelectCommand.CommandText = "select LINE_NO,SALES_REP_NO, to_char(EFFECTIVE_FROM,'MM/DD/RRRR') EFFECTIVE_FROM, to_char(EFFECTIVE_TILL,'MM/DD/RRRR') EFFECTIVE_TILL,COMMISSION_RATE from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                ds2.Clear()
                dbad.Fill(ds2)
                If (ds2.Tables(0).Rows.Count > 0) Then
dverf=1
                    dbad.SelectCommand.CommandText = "select LINE_NO,SALES_REP_NO, to_char(EFFECTIVE_FROM,'MM/DD/RRRR') EFFECTIVE_FROM, to_char(EFFECTIVE_TILL,'MM/DD/RRRR') EFFECTIVE_TILL,COMMISSION_RATE from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                    ds1.Clear()
                    dbad.Fill(ds1)
                Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' SALES_REP_NO,'" & "01/01/2001" & "' EFFECTIVE_FROM,'" & now.date() & "' EFFECTIVE_TILL, NULL COMMISSION_RATE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
                End If
Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' SALES_REP_NO,'" & "01/01/2001" & "' EFFECTIVE_FROM,'" & now.date() & "' EFFECTIVE_TILL, NULL COMMISSION_RATE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
        End If
      dbgSALESREPBYSALESORDER.DataSource = ds1.Tables(0)
      dbgSALESREPBYSALESORDER.DataBind()
 Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
call insert_sys_log("dbgSALESREPBYSALESORDER_Grid Fill",ex.Message)
 End Try
    dbad.SelectCommand.Connection.Close()
 Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
call insert_sys_log("Fill Detail Grid",ex.Message)
 End Try
    End Sub
Protected Sub AddGridRowORDERDETAIL_1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles AddGridRowORDERDETAIL_1.Click
Try
Call AddGridRowORDERDETAIL_Click(sender,e)
Catch ex As Exception
call insert_sys_log("Add New Row_1 dbgBILLING_STAGE",ex.Message)
End Try
    End Sub
Protected Sub DELETEGridRowORDERDETAIL_1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles DELETEGridRowORDERDETAIL_1.Click
Try
Call DELETEGridRowORDERDETAIL_Click(sender,e)
Catch ex As Exception
call insert_sys_log("Add New Row_1 dbgBILLING_STAGE",ex.Message)
End Try
    End Sub
Protected Sub AddGridRowORDERDETAIL_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles AddGridRowORDERDETAIL.Click
Try
if save.visible=True Then
  Call save_Click(sender, e)
End If
If (save_sucess_flag<>"Y") Then
                Exit Sub
            End If
mytotal1174=0
mytotal1214=0
mytotal1705=0
Dim addlin1 As Integer = dbgORDERDETAIL.Items.Count
dbad.SelectCommand.Connection = Session("db_connection")
 Dim ds1, ds2,ds3_l,ds3  As New Data.DataSet()
 Dim lno As Integer
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" and SD_ORDER_HEADER_ORDER_NO.Text <>"" and SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SelectedIndex>0 And SD_ORDER_HEADER_ORDER_DATE.Text <>"" and SD_ORDER_HEADER_CUSTOMER_NO.Text <>"" and SD_ORDER_HEADER_DUE_DATE.Text <>"" and SD_ORDER_HEADER_NAME.Text <>"" and SD_ORDER_HEADER_NAME.Text <>"" and SD_ORDER_HEADER_CUSTOMER_PO_NO.Text <>"" and SD_ORDER_HEADER_TERMS_CODE.Text <>"" and SD_ORDER_HEADER_SHIP_VIA.Text <>"" and SD_ORDER_HEADER_FOB.SelectedIndex>0 And SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex>0 ) Then
dbad.SelectCommand.CommandText = "select max(LINE_NO)  from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                   ds3_l.Clear()
                    dbad.Fill(ds3_l)
                    If (ds3_l.Tables(0).Rows.Count > 0) Then
 			If Not (Equals(ds3_l.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
                		lno = ds3_l.Tables(0).Rows(0)(0)
            		Else
               			lno = 0
            		End If
			else 
               			lno = 0
                    End If
		          dbad.SelectCommand.CommandText = "select LINE_NO,ORDER_DOC_TYPE,ORDER_LINE_TYPE,ITEM_NO,LICENSE_TIED_UP_LINE,LOT_NO,SERIAL_NO,CREATE_WORK_ORDER,CUSTOMER_ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,AES_DESCRIPTION,ORDER_QTY,TRIM_SIZE,SALES_QTY_ZERO_PRICE,ORDER_UOM,MULTIPLIER,MSRP_SALES_PRICE,PRICING_UOM,SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,BASE_UOM,PROJECT_NO,ORDER_QTY_BASE_UOM, to_char(DUE_DATE,'MM/DD/RRRR') DUE_DATE, to_char(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE, to_char(REQUESTED_SHIP_DATE,'MM/DD/RRRR') REQUESTED_SHIP_DATE,ORDER_PRIORITY_CODE,TIME_AND_MATERIAL,DRAWING_NO,LICENSE_NO,END_USER_CODE,AM_CODE,SPIF,CE,ATEX,ATEX_CODE,PO_LINE_NO,CANCELED_QTY,CANCELED_QTY_BASE_UOM,PRODUCTION_STATUS,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,INVOICE_BY,CUSTOMER_PO_NO, to_char(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE,CONFIGURATOR_ID,TRIM_UOM,STOCK_DUTY_POINT,HEAD_UNITS,FLOW_UNITS,LICENSE_TIED_IP_LINE from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by PO_LINE_NO,LINE_NO"
                ds2.Clear()
                dbad.Fill(ds2)
                If (ds2.Tables(0).Rows.Count > 0) Then
                    dbad.SelectCommand.CommandText = "Select * from ( select LINE_NO,ORDER_DOC_TYPE,ORDER_LINE_TYPE,ITEM_NO,LICENSE_TIED_UP_LINE,LOT_NO,SERIAL_NO,CREATE_WORK_ORDER,CUSTOMER_ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,AES_DESCRIPTION,ORDER_QTY,TRIM_SIZE,SALES_QTY_ZERO_PRICE,ORDER_UOM,MULTIPLIER,MSRP_SALES_PRICE,PRICING_UOM,SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,BASE_UOM,PROJECT_NO,ORDER_QTY_BASE_UOM, to_char(DUE_DATE,'MM/DD/RRRR') DUE_DATE, to_char(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE, to_char(REQUESTED_SHIP_DATE,'MM/DD/RRRR') REQUESTED_SHIP_DATE,ORDER_PRIORITY_CODE,TIME_AND_MATERIAL,DRAWING_NO,LICENSE_NO,END_USER_CODE,AM_CODE,SPIF,CE,ATEX,ATEX_CODE,PO_LINE_NO,CANCELED_QTY,CANCELED_QTY_BASE_UOM,PRODUCTION_STATUS,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,INVOICE_BY,CUSTOMER_PO_NO, to_char(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE,CONFIGURATOR_ID,TRIM_UOM,STOCK_DUTY_POINT,HEAD_UNITS,FLOW_UNITS,LICENSE_TIED_IP_LINE from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  union all select  " & lno & "+(rownum *1) LINE_NO,'' ORDER_DOC_TYPE,'' ORDER_LINE_TYPE,'' ITEM_NO, NULL LICENSE_TIED_UP_LINE,'' LOT_NO,'' SERIAL_NO,'' CREATE_WORK_ORDER,'' CUSTOMER_ITEM_NO,'' ITEM_REVISION_NO,'' DESCRIPTION,'' AES_DESCRIPTION, 1 ORDER_QTY, NULL TRIM_SIZE, 1 SALES_QTY_ZERO_PRICE,'EA' ORDER_UOM, NULL MULTIPLIER, NULL MSRP_SALES_PRICE,'EA' PRICING_UOM, NULL SALES_PRICE,'' EXPEDITE, NULL EXPEDIATE_VALUE, NULL LINE_EXTENDED_AMOUNT,'' TAX_CODE, 0 TAX_AMOUNT, 0 EXTRA_CHARGE_AMOUNT, NULL LINE_TOTAL_AMOUNT,'' BASE_UOM,'' PROJECT_NO, NULL ORDER_QTY_BASE_UOM,'' DUE_DATE,'' PROMISED_DELIVERY_DATE,'' REQUESTED_SHIP_DATE, 100 ORDER_PRIORITY_CODE,'' TIME_AND_MATERIAL,'' DRAWING_NO,'' LICENSE_NO,'' END_USER_CODE,'' AM_CODE,'' SPIF,'' CE,'' ATEX,'' ATEX_CODE, NULL PO_LINE_NO, NULL CANCELED_QTY, NULL CANCELED_QTY_BASE_UOM,'' PRODUCTION_STATUS,'' REASON_CODE,'' REASON_NOTES,'' BLANKET_RELEASE_NO,'' WORK_ORDER_NO,'' LINE_SHIP_TO_CODE,'' LINE_SHIPPING_ADDRESS,'' LINE_SHIP_VIA,'' INVOICE_BY,'' CUSTOMER_PO_NO,'' CUSTOMER_PO_DATE,'' CONFIGURATOR_ID,'IN' TRIM_UOM,'STOCK' STOCK_DUTY_POINT,'FT' HEAD_UNITS,'GPM' FLOW_UNITS, NULL LICENSE_TIED_IP_LINE from SYS_TOOL_DUAL  WHERE ROWNUM<=5)  Order by PO_LINE_NO,LINE_NO"
                    ds1.Clear()
                    dbad.Fill(ds1)
                Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' ORDER_DOC_TYPE,'' ORDER_LINE_TYPE,'' ITEM_NO, NULL LICENSE_TIED_UP_LINE,'' LOT_NO,'' SERIAL_NO,'' CREATE_WORK_ORDER,'' CUSTOMER_ITEM_NO,'' ITEM_REVISION_NO,'' DESCRIPTION,'' AES_DESCRIPTION, 1 ORDER_QTY, NULL TRIM_SIZE, 1 SALES_QTY_ZERO_PRICE,'EA' ORDER_UOM, NULL MULTIPLIER, NULL MSRP_SALES_PRICE,'EA' PRICING_UOM, NULL SALES_PRICE,'' EXPEDITE, NULL EXPEDIATE_VALUE, NULL LINE_EXTENDED_AMOUNT,'' TAX_CODE, 0 TAX_AMOUNT, 0 EXTRA_CHARGE_AMOUNT, NULL LINE_TOTAL_AMOUNT,'' BASE_UOM,'' PROJECT_NO, NULL ORDER_QTY_BASE_UOM,'' DUE_DATE,'' PROMISED_DELIVERY_DATE,'' REQUESTED_SHIP_DATE, 100 ORDER_PRIORITY_CODE,'' TIME_AND_MATERIAL,'' DRAWING_NO,'' LICENSE_NO,'' END_USER_CODE,'' AM_CODE,'' SPIF,'' CE,'' ATEX,'' ATEX_CODE, NULL PO_LINE_NO, NULL CANCELED_QTY, NULL CANCELED_QTY_BASE_UOM,'' PRODUCTION_STATUS,'' REASON_CODE,'' REASON_NOTES,'' BLANKET_RELEASE_NO,'' WORK_ORDER_NO,'' LINE_SHIP_TO_CODE,'' LINE_SHIPPING_ADDRESS,'' LINE_SHIP_VIA,'' INVOICE_BY,'' CUSTOMER_PO_NO,'' CUSTOMER_PO_DATE,'' CONFIGURATOR_ID,'IN' TRIM_UOM,'STOCK' STOCK_DUTY_POINT,'FT' HEAD_UNITS,'GPM' FLOW_UNITS, NULL LICENSE_TIED_IP_LINE from SYS_TOOL_DUAL  WHERE ROWNUM<=5"
                    ds1.Clear()
                    dbad.Fill(ds1)
                End If
Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' ORDER_DOC_TYPE,'' ORDER_LINE_TYPE,'' ITEM_NO, NULL LICENSE_TIED_UP_LINE,'' LOT_NO,'' SERIAL_NO,'' CREATE_WORK_ORDER,'' CUSTOMER_ITEM_NO,'' ITEM_REVISION_NO,'' DESCRIPTION,'' AES_DESCRIPTION, 1 ORDER_QTY, NULL TRIM_SIZE, 1 SALES_QTY_ZERO_PRICE,'EA' ORDER_UOM, NULL MULTIPLIER, NULL MSRP_SALES_PRICE,'EA' PRICING_UOM, NULL SALES_PRICE,'' EXPEDITE, NULL EXPEDIATE_VALUE, NULL LINE_EXTENDED_AMOUNT,'' TAX_CODE, 0 TAX_AMOUNT, 0 EXTRA_CHARGE_AMOUNT, NULL LINE_TOTAL_AMOUNT,'' BASE_UOM,'' PROJECT_NO, NULL ORDER_QTY_BASE_UOM,'' DUE_DATE,'' PROMISED_DELIVERY_DATE,'' REQUESTED_SHIP_DATE, 100 ORDER_PRIORITY_CODE,'' TIME_AND_MATERIAL,'' DRAWING_NO,'' LICENSE_NO,'' END_USER_CODE,'' AM_CODE,'' SPIF,'' CE,'' ATEX,'' ATEX_CODE, NULL PO_LINE_NO, NULL CANCELED_QTY, NULL CANCELED_QTY_BASE_UOM,'' PRODUCTION_STATUS,'' REASON_CODE,'' REASON_NOTES,'' BLANKET_RELEASE_NO,'' WORK_ORDER_NO,'' LINE_SHIP_TO_CODE,'' LINE_SHIPPING_ADDRESS,'' LINE_SHIP_VIA,'' INVOICE_BY,'' CUSTOMER_PO_NO,'' CUSTOMER_PO_DATE,'' CONFIGURATOR_ID,'IN' TRIM_UOM,'STOCK' STOCK_DUTY_POINT,'FT' HEAD_UNITS,'GPM' FLOW_UNITS, NULL LICENSE_TIED_IP_LINE from SYS_TOOL_DUAL  WHERE ROWNUM<=5"
                    ds1.Clear()
                    dbad.Fill(ds1)
        End If
      dbgORDERDETAIL.DataSource = ds1.Tables(0)
      dbgORDERDETAIL.DataBind()
Dim dgitem1 As DataGridItem
For Each dgitem1 In dbgORDERDETAIL.Items
    If (dgitem1.ItemIndex = addlin1) Then
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE  as DropDownList=CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_ORDER_DOC_TYPE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.ClientID & "');", True)
End If
    End If
Next
Catch ex As Exception
call insert_sys_log("Add New Row dbgORDERDETAIL",ex.Message)
End Try
    End Sub
Protected Sub AddGridRowSALESREPBYSALESORDER_1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles AddGridRowSALESREPBYSALESORDER_1.Click
Try
Call AddGridRowSALESREPBYSALESORDER_Click(sender,e)
Catch ex As Exception
call insert_sys_log("Add New Row_1 dbgORDERDETAIL",ex.Message)
End Try
    End Sub
Protected Sub DELETEGridRowSALESREPBYSALESORDER_1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles DELETEGridRowSALESREPBYSALESORDER_1.Click
Try
Call DELETEGridRowSALESREPBYSALESORDER_Click(sender,e)
Catch ex As Exception
call insert_sys_log("Add New Row_1 dbgORDERDETAIL",ex.Message)
End Try
    End Sub
Protected Sub AddGridRowSALESREPBYSALESORDER_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles AddGridRowSALESREPBYSALESORDER.Click
Try
if save.visible=True Then
  Call save_Click(sender, e)
End If
If (save_sucess_flag<>"Y") Then
                Exit Sub
            End If
Dim addlin1 As Integer = dbgSALESREPBYSALESORDER.Items.Count
dbad.SelectCommand.Connection = Session("db_connection")
 Dim ds1, ds2,ds3_l,ds3  As New Data.DataSet()
 Dim lno As Integer
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" and SD_ORDER_HEADER_ORDER_NO.Text <>"" and SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SelectedIndex>0 And SD_ORDER_HEADER_ORDER_DATE.Text <>"" and SD_ORDER_HEADER_CUSTOMER_NO.Text <>"" and SD_ORDER_HEADER_DUE_DATE.Text <>"" and SD_ORDER_HEADER_NAME.Text <>"" and SD_ORDER_HEADER_NAME.Text <>"" and SD_ORDER_HEADER_CUSTOMER_PO_NO.Text <>"" and SD_ORDER_HEADER_TERMS_CODE.Text <>"" and SD_ORDER_HEADER_SHIP_VIA.Text <>"" and SD_ORDER_HEADER_FOB.SelectedIndex>0 And SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex>0 ) Then
dbad.SelectCommand.CommandText = "select max(LINE_NO)  from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                   ds3_l.Clear()
                    dbad.Fill(ds3_l)
                    If (ds3_l.Tables(0).Rows.Count > 0) Then
 			If Not (Equals(ds3_l.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
                		lno = ds3_l.Tables(0).Rows(0)(0)
            		Else
               			lno = 0
            		End If
			else 
               			lno = 0
                    End If
		          dbad.SelectCommand.CommandText = "select LINE_NO,SALES_REP_NO, to_char(EFFECTIVE_FROM,'MM/DD/RRRR') EFFECTIVE_FROM, to_char(EFFECTIVE_TILL,'MM/DD/RRRR') EFFECTIVE_TILL,COMMISSION_RATE from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                ds2.Clear()
                dbad.Fill(ds2)
                If (ds2.Tables(0).Rows.Count > 0) Then
                    dbad.SelectCommand.CommandText = "Select * from ( select LINE_NO,SALES_REP_NO, to_char(EFFECTIVE_FROM,'MM/DD/RRRR') EFFECTIVE_FROM, to_char(EFFECTIVE_TILL,'MM/DD/RRRR') EFFECTIVE_TILL,COMMISSION_RATE from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  union all select  " & lno & "+(rownum *1) LINE_NO,'' SALES_REP_NO,'" & "01/01/2001" & "' EFFECTIVE_FROM,'" & now.date() & "' EFFECTIVE_TILL, NULL COMMISSION_RATE from SYS_TOOL_DUAL  WHERE ROWNUM<=5) "
                    ds1.Clear()
                    dbad.Fill(ds1)
                Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' SALES_REP_NO,'" & "01/01/2001" & "' EFFECTIVE_FROM,'" & now.date() & "' EFFECTIVE_TILL, NULL COMMISSION_RATE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
                End If
Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' SALES_REP_NO,'" & "01/01/2001" & "' EFFECTIVE_FROM,'" & now.date() & "' EFFECTIVE_TILL, NULL COMMISSION_RATE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
        End If
      dbgSALESREPBYSALESORDER.DataSource = ds1.Tables(0)
      dbgSALESREPBYSALESORDER.DataBind()
Dim dgitem1 As DataGridItem
For Each dgitem1 In dbgSALESREPBYSALESORDER.Items
    If (dgitem1.ItemIndex = addlin1) Then
Dim SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO as TextBox=CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO"), TextBox)
If (Request.Browser.Browser = "IE") Then
SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ClientID & "');", True)
End If
    End If
Next
Catch ex As Exception
call insert_sys_log("Add New Row dbgSALESREPBYSALESORDER",ex.Message)
End Try
    End Sub
Protected Sub AddGridRowBILLING_STAGE_1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles AddGridRowBILLING_STAGE_1.Click
Try
Call AddGridRowBILLING_STAGE_Click(sender,e)
Catch ex As Exception
call insert_sys_log("Add New Row_1 dbgSALESREPBYSALESORDER",ex.Message)
End Try
    End Sub
Protected Sub DELETEGridRowBILLING_STAGE_1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles DELETEGridRowBILLING_STAGE_1.Click
Try
Call DELETEGridRowBILLING_STAGE_Click(sender,e)
Catch ex As Exception
call insert_sys_log("Add New Row_1 dbgSALESREPBYSALESORDER",ex.Message)
End Try
    End Sub
Protected Sub AddGridRowBILLING_STAGE_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles AddGridRowBILLING_STAGE.Click
Try
if save.visible=True Then
  Call save_Click(sender, e)
End If
If (save_sucess_flag<>"Y") Then
                Exit Sub
            End If
mytotal9703=0
Dim addlin1 As Integer = dbgBILLING_STAGE.Items.Count
dbad.SelectCommand.Connection = Session("db_connection")
 Dim ds1, ds2,ds3_l,ds3  As New Data.DataSet()
 Dim lno As Integer
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" and SD_ORDER_HEADER_ORDER_NO.Text <>"" and SD_ORDER_HEADER_BUSINESS_UNIT_CODE.SelectedIndex>0 And SD_ORDER_HEADER_ORDER_DATE.Text <>"" and SD_ORDER_HEADER_CUSTOMER_NO.Text <>"" and SD_ORDER_HEADER_DUE_DATE.Text <>"" and SD_ORDER_HEADER_NAME.Text <>"" and SD_ORDER_HEADER_NAME.Text <>"" and SD_ORDER_HEADER_CUSTOMER_PO_NO.Text <>"" and SD_ORDER_HEADER_TERMS_CODE.Text <>"" and SD_ORDER_HEADER_SHIP_VIA.Text <>"" and SD_ORDER_HEADER_FOB.SelectedIndex>0 And SD_ORDER_HEADER_FREIGHT_BILL_TYPE.SelectedIndex>0 ) Then
dbad.SelectCommand.CommandText = "select max(LINE_NO)  from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                   ds3_l.Clear()
                    dbad.Fill(ds3_l)
                    If (ds3_l.Tables(0).Rows.Count > 0) Then
 			If Not (Equals(ds3_l.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
                		lno = ds3_l.Tables(0).Rows(0)(0)
            		Else
               			lno = 0
            		End If
			else 
               			lno = 0
                    End If
		          dbad.SelectCommand.CommandText = "select LINE_NO,STAGE,BILLING_PERCENTAGE, to_char(READY_FOR_INOVICE_DATE,'MM/DD/RRRR') READY_FOR_INOVICE_DATE,APPROVED_FOR_INOVICE from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by LINE_NO"
                ds2.Clear()
                dbad.Fill(ds2)
                If (ds2.Tables(0).Rows.Count > 0) Then
                    dbad.SelectCommand.CommandText = "Select * from ( select LINE_NO,STAGE,BILLING_PERCENTAGE, to_char(READY_FOR_INOVICE_DATE,'MM/DD/RRRR') READY_FOR_INOVICE_DATE,APPROVED_FOR_INOVICE from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  union all select  " & lno & "+(rownum *1) LINE_NO,'' STAGE, NULL BILLING_PERCENTAGE,'' READY_FOR_INOVICE_DATE,'' APPROVED_FOR_INOVICE from SYS_TOOL_DUAL  WHERE ROWNUM<=5)  Order by LINE_NO"
                    ds1.Clear()
                    dbad.Fill(ds1)
                Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' STAGE, NULL BILLING_PERCENTAGE,'' READY_FOR_INOVICE_DATE,'' APPROVED_FOR_INOVICE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
                End If
Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' STAGE, NULL BILLING_PERCENTAGE,'' READY_FOR_INOVICE_DATE,'' APPROVED_FOR_INOVICE from SYS_TOOL_DUAL  WHERE ROWNUM<=10"
                    ds1.Clear()
                    dbad.Fill(ds1)
        End If
      dbgBILLING_STAGE.DataSource = ds1.Tables(0)
      dbgBILLING_STAGE.DataBind()
Dim dgitem1 As DataGridItem
For Each dgitem1 In dbgBILLING_STAGE.Items
    If (dgitem1.ItemIndex = addlin1) Then
Dim SD_ORDERS_BILLING_STAGE_STAGE as TextBox=CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_STAGE"), TextBox)
If (Request.Browser.Browser = "IE") Then
SD_ORDERS_BILLING_STAGE_STAGE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDERS_BILLING_STAGE_STAGE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDERS_BILLING_STAGE_STAGE.ClientID & "');", True)
End If
    End If
Next
Catch ex As Exception
call insert_sys_log("Add New Row dbgBILLING_STAGE",ex.Message)
End Try
    End Sub
Public Sub SD_ORDER_DETAIL_DUE_DATE_sort(ByVal sender As Object, ByVal e As EventArgs)
Try
dbad.SelectCommand.Connection = Session("db_connection")
 Dim ds1, ds2,ds3_l  As New Data.DataSet()
 Dim lno As Integer
     if ( SD_ORDER_HEADER_ORDER_NO.Text <>"" ) Then
mytotal1174=0
mytotal1214=0
mytotal1705=0
dbad.SelectCommand.CommandText = "select max(LINE_NO)  from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
                   ds3_l.Clear()
                    dbad.Fill(ds3_l)
                    If (ds3_l.Tables(0).Rows.Count > 0) Then
 			If Not (Equals(ds3_l.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
                		lno = ds3_l.Tables(0).Rows(0)(0)
            		Else
               			lno = 0
            		End If
			else 
               			lno = 0
                    End If
		          dbad.SelectCommand.CommandText = "select LINE_NO,ORDER_DOC_TYPE,ORDER_LINE_TYPE,ITEM_NO,LICENSE_TIED_UP_LINE,LOT_NO,SERIAL_NO,CREATE_WORK_ORDER,CUSTOMER_ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,AES_DESCRIPTION,ORDER_QTY,TRIM_SIZE,SALES_QTY_ZERO_PRICE,ORDER_UOM,MULTIPLIER,MSRP_SALES_PRICE,PRICING_UOM,SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,BASE_UOM,PROJECT_NO,ORDER_QTY_BASE_UOM, to_char(DUE_DATE,'MM/DD/RRRR') DUE_DATE, to_char(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE, to_char(REQUESTED_SHIP_DATE,'MM/DD/RRRR') REQUESTED_SHIP_DATE,ORDER_PRIORITY_CODE,TIME_AND_MATERIAL,DRAWING_NO,LICENSE_NO,END_USER_CODE,AM_CODE,SPIF,CE,ATEX,ATEX_CODE,PO_LINE_NO,CANCELED_QTY,CANCELED_QTY_BASE_UOM,PRODUCTION_STATUS,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,INVOICE_BY,CUSTOMER_PO_NO, to_char(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE,CONFIGURATOR_ID,TRIM_UOM,STOCK_DUTY_POINT,HEAD_UNITS,FLOW_UNITS,LICENSE_TIED_IP_LINE from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'  Order by PO_LINE_NO,LINE_NO"
                ds2.Clear()
                dbad.Fill(ds2)
                If (ds2.Tables(0).Rows.Count > 0) Then
 If (Session("SD_ORDER_DETAIL_DUE_DATE_sort") = "0") Then
                    dbad.SelectCommand.CommandText = "SELECT LINE_NO,ORDER_DOC_TYPE,ORDER_LINE_TYPE,ITEM_NO,LICENSE_TIED_UP_LINE,LOT_NO,SERIAL_NO,CREATE_WORK_ORDER,CUSTOMER_ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,AES_DESCRIPTION,ORDER_QTY,TRIM_SIZE,SALES_QTY_ZERO_PRICE,ORDER_UOM,MULTIPLIER,MSRP_SALES_PRICE,PRICING_UOM,SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,BASE_UOM,PROJECT_NO,ORDER_QTY_BASE_UOM, TO_CHAR(DUE_DATE,'MM/DD/RRRR') DUE_DATE, TO_CHAR(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE, TO_CHAR(REQUESTED_SHIP_DATE,'MM/DD/RRRR') REQUESTED_SHIP_DATE,ORDER_PRIORITY_CODE,TIME_AND_MATERIAL,DRAWING_NO,LICENSE_NO,END_USER_CODE,AM_CODE,SPIF,CE,ATEX,ATEX_CODE,PO_LINE_NO,CANCELED_QTY,CANCELED_QTY_BASE_UOM,PRODUCTION_STATUS,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,INVOICE_BY,CUSTOMER_PO_NO, TO_CHAR(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE,CONFIGURATOR_ID,TRIM_UOM,STOCK_DUTY_POINT,HEAD_UNITS,FLOW_UNITS,LICENSE_TIED_IP_LINE FROM SD_ORDER_DETAIL WHERE ORDER_NO='" & REPLACE_C(SD_ORDER_HEADER_ORDER_NO.TEXT) & "'   order by DUE_DATE"
Else
                    dbad.SelectCommand.CommandText = "SELECT LINE_NO,ORDER_DOC_TYPE,ORDER_LINE_TYPE,ITEM_NO,LICENSE_TIED_UP_LINE,LOT_NO,SERIAL_NO,CREATE_WORK_ORDER,CUSTOMER_ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,AES_DESCRIPTION,ORDER_QTY,TRIM_SIZE,SALES_QTY_ZERO_PRICE,ORDER_UOM,MULTIPLIER,MSRP_SALES_PRICE,PRICING_UOM,SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,BASE_UOM,PROJECT_NO,ORDER_QTY_BASE_UOM, TO_CHAR(DUE_DATE,'MM/DD/RRRR') DUE_DATE, TO_CHAR(PROMISED_DELIVERY_DATE,'MM/DD/RRRR') PROMISED_DELIVERY_DATE, TO_CHAR(REQUESTED_SHIP_DATE,'MM/DD/RRRR') REQUESTED_SHIP_DATE,ORDER_PRIORITY_CODE,TIME_AND_MATERIAL,DRAWING_NO,LICENSE_NO,END_USER_CODE,AM_CODE,SPIF,CE,ATEX,ATEX_CODE,PO_LINE_NO,CANCELED_QTY,CANCELED_QTY_BASE_UOM,PRODUCTION_STATUS,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,INVOICE_BY,CUSTOMER_PO_NO, TO_CHAR(CUSTOMER_PO_DATE,'MM/DD/RRRR') CUSTOMER_PO_DATE,CONFIGURATOR_ID,TRIM_UOM,STOCK_DUTY_POINT,HEAD_UNITS,FLOW_UNITS,LICENSE_TIED_IP_LINE FROM SD_ORDER_DETAIL WHERE ORDER_NO='" & REPLACE_C(SD_ORDER_HEADER_ORDER_NO.TEXT) & "'   order by DUE_DATE desc "
End If
                    ds1.Clear()
                    dbad.Fill(ds1)
                Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' ORDER_DOC_TYPE,'' ORDER_LINE_TYPE,'' ITEM_NO, NULL LICENSE_TIED_UP_LINE,'' LOT_NO,'' SERIAL_NO,'' CREATE_WORK_ORDER,'' CUSTOMER_ITEM_NO,'' ITEM_REVISION_NO,'' DESCRIPTION,'' AES_DESCRIPTION, 1 ORDER_QTY, NULL TRIM_SIZE, 1 SALES_QTY_ZERO_PRICE,'EA' ORDER_UOM, NULL MULTIPLIER, NULL MSRP_SALES_PRICE,'EA' PRICING_UOM, NULL SALES_PRICE,'' EXPEDITE, NULL EXPEDIATE_VALUE, NULL LINE_EXTENDED_AMOUNT,'' TAX_CODE, 0 TAX_AMOUNT, 0 EXTRA_CHARGE_AMOUNT, NULL LINE_TOTAL_AMOUNT,'' BASE_UOM,'' PROJECT_NO, NULL ORDER_QTY_BASE_UOM,'' DUE_DATE,'' PROMISED_DELIVERY_DATE,'' REQUESTED_SHIP_DATE, 100 ORDER_PRIORITY_CODE,'' TIME_AND_MATERIAL,'' DRAWING_NO,'' LICENSE_NO,'' END_USER_CODE,'' AM_CODE,'' SPIF,'' CE,'' ATEX,'' ATEX_CODE, NULL PO_LINE_NO, NULL CANCELED_QTY, NULL CANCELED_QTY_BASE_UOM,'' PRODUCTION_STATUS,'' REASON_CODE,'' REASON_NOTES,'' BLANKET_RELEASE_NO,'' WORK_ORDER_NO,'' LINE_SHIP_TO_CODE,'' LINE_SHIPPING_ADDRESS,'' LINE_SHIP_VIA,'' INVOICE_BY,'' CUSTOMER_PO_NO,'' CUSTOMER_PO_DATE,'' CONFIGURATOR_ID,'IN' TRIM_UOM,'STOCK' STOCK_DUTY_POINT,'FT' HEAD_UNITS,'GPM' FLOW_UNITS, NULL LICENSE_TIED_IP_LINE from SYS_TOOL_DUAL  WHERE ROWNUM<=5"
                    ds1.Clear()
                    dbad.Fill(ds1)
                End If
Else
                    dbad.SelectCommand.CommandText = "select  " & lno & "+(rownum *1) LINE_NO,'' ORDER_DOC_TYPE,'' ORDER_LINE_TYPE,'' ITEM_NO, NULL LICENSE_TIED_UP_LINE,'' LOT_NO,'' SERIAL_NO,'' CREATE_WORK_ORDER,'' CUSTOMER_ITEM_NO,'' ITEM_REVISION_NO,'' DESCRIPTION,'' AES_DESCRIPTION, 1 ORDER_QTY, NULL TRIM_SIZE, 1 SALES_QTY_ZERO_PRICE,'EA' ORDER_UOM, NULL MULTIPLIER, NULL MSRP_SALES_PRICE,'EA' PRICING_UOM, NULL SALES_PRICE,'' EXPEDITE, NULL EXPEDIATE_VALUE, NULL LINE_EXTENDED_AMOUNT,'' TAX_CODE, 0 TAX_AMOUNT, 0 EXTRA_CHARGE_AMOUNT, NULL LINE_TOTAL_AMOUNT,'' BASE_UOM,'' PROJECT_NO, NULL ORDER_QTY_BASE_UOM,'' DUE_DATE,'' PROMISED_DELIVERY_DATE,'' REQUESTED_SHIP_DATE, 100 ORDER_PRIORITY_CODE,'' TIME_AND_MATERIAL,'' DRAWING_NO,'' LICENSE_NO,'' END_USER_CODE,'' AM_CODE,'' SPIF,'' CE,'' ATEX,'' ATEX_CODE, NULL PO_LINE_NO, NULL CANCELED_QTY, NULL CANCELED_QTY_BASE_UOM,'' PRODUCTION_STATUS,'' REASON_CODE,'' REASON_NOTES,'' BLANKET_RELEASE_NO,'' WORK_ORDER_NO,'' LINE_SHIP_TO_CODE,'' LINE_SHIPPING_ADDRESS,'' LINE_SHIP_VIA,'' INVOICE_BY,'' CUSTOMER_PO_NO,'' CUSTOMER_PO_DATE,'' CONFIGURATOR_ID,'IN' TRIM_UOM,'STOCK' STOCK_DUTY_POINT,'FT' HEAD_UNITS,'GPM' FLOW_UNITS, NULL LICENSE_TIED_IP_LINE from SYS_TOOL_DUAL  WHERE ROWNUM<=5"
                    ds1.Clear()
                    dbad.Fill(ds1)
        End If
      dbgORDERDETAIL.DataSource = ds1.Tables(0)
      dbgORDERDETAIL.DataBind()
If (Session("SD_ORDER_DETAIL_DUE_DATE_sort") = "1") Then
Session("SD_ORDER_DETAIL_DUE_DATE_sort") = "0"
Else
Session("SD_ORDER_DETAIL_DUE_DATE_sort") = "1"
End If
    dbad.SelectCommand.Connection.Close()
Catch ex As Exception
call insert_sys_log("DUE_DATE_sort",ex.Message)
End Try
End Sub
    Public Sub clear_detail_grid()
Try
call Fill_detail_grid()
Dim sender As Object
Dim e As System.EventArgs
Call call_clear_methods(sender,e)
Catch ex As Exception
call insert_sys_log("Clear Grid",ex.Message)
End Try
    End Sub
Protected Sub Retrive_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Retrive.Click
Try
        Call fill_header_info()
Catch ex As Exception
call insert_sys_log("Retrive Button",ex.Message)
End Try
    End Sub
Public Sub SD_ORDERS_BILLING_STAGE_STAGE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgBILLING_STAGE.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds2 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDERS_BILLING_STAGE_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_LINE_NO"), Label)
Dim SD_ORDERS_BILLING_STAGE_STAGE As TextBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_STAGE"), TextBox)
Dim SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE As TextBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE"), TextBox)
Dim SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE"), TextBox)
Dim SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE As CheckBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE"), CheckBox)
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("STAGE_SD_ORDERS_BILLING_STAGE_event",ex.Message)
 End Try
End Sub
Public sub DETAIL_DOC_MANAGEMENT_ORDERDETAIL(ByVal sender As Object, ByVal e As System.EventArgs)
Try
if save.visible=True Then
  Call save_Click(sender, e)
End If
if (mpanel.Visible=True and exception_message.Visible=True) Then
Exit Sub
End If
 	      Dim oprp As New ImageButton
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        oprp = CType(sender, ImageButton)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Session("SALES_ORDER_primay_field_list1") = "ORDER_NO,LINE_NO"
Session("SALES_ORDER_primay_field_value1") =SD_ORDER_HEADER_ORDER_NO.Text & "{-}" & SD_ORDER_DETAIL_LINE_NO.Text
Session("SALES_ORDER_primay_field_labels1") ="Order No{-}LNo"
Session("SALES_ORDER_tag_field_list1") = "ORDER_NO,CUSTOMER_NO,NAME,LINE_NO,ITEM_NO,DESCRIPTION"
Session("SALES_ORDER_tag_field_value1") =SD_ORDER_HEADER_ORDER_NO.Text & "{-}" & SD_ORDER_HEADER_CUSTOMER_NO.Text & "{-}" & SD_ORDER_HEADER_NAME.Text & "{-}" & SD_ORDER_DETAIL_LINE_NO.Text & "{-}" & SD_ORDER_DETAIL_ITEM_NO.Text & "{-}" & SD_ORDER_DETAIL_DESCRIPTION.Text 
Session("SALES_ORDER_tag_field_labels1") = "Order No{-}Customer No{-}Name{-}LNo{-}Item No{-}Description"
Dim strFile1 As String = "Show Files1"
Dim strCmd1 As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
strCmd1 = String.Format("window.open('SYS_DOCUMENT_MANAGEMNET.aspx?page_id=SALES_ORDER&Header_flag=N');", strFile1)
Else
strCmd1 = String.Format("window.showModalDialog('SYS_DOCUMENT_MANAGEMNET.aspx?page_id=SALES_ORDER&Header_flag=N',null,'status:no;dialogWidth:700px;dialogHeight:700px;dialogHide:true;help:no;scroll:yes');", strFile1)
End If
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN24", strCmd1, True)
Catch ex As Exception
call insert_sys_log("Doc related function",ex.Message)
End Try
    End Sub
Public Sub SD_ORDER_DETAIL_ORDER_DOC_TYPE_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp1 As New DropDownList
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp1 = CType(sender, DropDownList)
 	      Dim oprp As New TextBox
 	     if (oprp1.SelectedIndex>0) Then
 	      oprp.Text=oprp1.SelectedItem.Text
End If
        cell4 = CType(oprp1.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds2 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (oprp.Text <> "") Then
If ((SD_ORDER_DETAIL_ORDER_DOC_TYPE.selecteditem.value="P" OR  SD_ORDER_DETAIL_ORDER_DOC_TYPE.selecteditem.value="E") AND CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0) Then
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
Else
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
End If
End If
Dim dbsqlst0  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DECODE('" &SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE & "','WE' ,1,'CP',1) ,DECODE('" & CHECK_BOX_R(SD_ORDER_HEADER_PULL_INVENTORY_FROM_QRC) & "' ,'Y','PULL_QRC_STOCK',DECODE('" &SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE & "','P','PULL_STOCK')) ,DECODE('" &SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE & "','CP','OE','AMMRO') FROM DUAL"
dbsqlst0.Clear()
dbad.Fill(dbsqlst0)
if (dbsqlst0.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst0.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ORDER_QTY.Text=String.Format("{0:0.00}",dbsqlst0.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_ORDER_QTY.Text=""
End If
If Not (Equals(dbsqlst0.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_DETAIL_ORDER_LINE_TYPE,dbsqlst0.Tables(0).Rows(0)(1))
Else
SD_ORDER_DETAIL_ORDER_LINE_TYPE.SelectedIndex=-1
End If
If Not (Equals(dbsqlst0.Tables(0).Rows(0)(2), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_DETAIL_AM_CODE,dbsqlst0.Tables(0).Rows(0)(2))
Else
SD_ORDER_DETAIL_AM_CODE.SelectedIndex=-1
End If
ELSE
if (dbsqlst0.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_ORDER_QTY.Text=""
SD_ORDER_DETAIL_ORDER_LINE_TYPE.SelectedIndex=-1
SD_ORDER_DETAIL_AM_CODE.SelectedIndex=-1
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_GET_PROMISED_SHIP_DATE('" & SD_ORDER_HEADER_ORDER_DATE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT & "') FROM DUAL"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_DUE_DATE.Text=dbsqlst1.Tables(0).Rows(0)(0)
Else
SD_ORDER_DETAIL_DUE_DATE.Text=""
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_DUE_DATE.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="CP") Then
SD_ORDER_DETAIL_SPIF.Visible=True
Else
SD_ORDER_DETAIL_SPIF.Visible=False
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="CP") Then
SD_ORDER_DETAIL_CE.Visible=True
Else
SD_ORDER_DETAIL_CE.Visible=False
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="CP") Then
SD_ORDER_DETAIL_ATEX.Visible=True
Else
SD_ORDER_DETAIL_ATEX.Visible=False
End If
End If
Dim dbsqlst5  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DECODE(NVL('" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE & "','P'),'CP','Y') ,'" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' FROM DUAL"
dbsqlst5.Clear()
dbad.Fill(dbsqlst5)
if (dbsqlst5.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst5.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_CE.Text=dbsqlst5.Tables(0).Rows(0)(0)
Else
SD_ORDER_DETAIL_CE.Text=""
End If
If Not (Equals(dbsqlst5.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.Text=dbsqlst5.Tables(0).Rows(0)(1)
Else
SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.Text=""
End If
ELSE
if (dbsqlst5.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_CE.Text=""
SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="CP" OR SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="WE") Then
EVENT_ORDER_CONFIG.Visible=True
Else
EVENT_ORDER_CONFIG.Visible=False
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_ORDER_LINE_TYPE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_ORDER_LINE_TYPE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_ORDER_LINE_TYPE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("ORDER_DOC_TYPE_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_ORDER_LINE_TYPE_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp1 As New DropDownList
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp1 = CType(sender, DropDownList)
 	      Dim oprp As New TextBox
 	     if (oprp1.SelectedIndex>0) Then
 	      oprp.Text=oprp1.SelectedItem.Text
End If
        cell4 = CType(oprp1.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds3 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_ORDER_LINE_TYPE.selecteditem.value<>"PULL_QRC_STOCK") Then
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
Else
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_ORDER_LINE_TYPE.SELECTEDITEM.VALUE="CREATE_WO") Then
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=True
Else
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=False
End If
End If
Dim dbsqlst2  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DECODE('" & SD_ORDER_DETAIL_ORDER_LINE_TYPE.TEXT & "','PULL_STOCK','N',NULL) FROM DUAL"
dbsqlst2.Clear()
dbad.Fill(dbsqlst2)
if (dbsqlst2.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
check_box_fill(SD_ORDER_DETAIL_CREATE_WORK_ORDER,dbsqlst2.Tables(0).Rows(0)(0))
End If
ELSE
if (dbsqlst2.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_ORDER_LINE_TYPE.SELECTEDITEM.VALUE="PULL_QRC_STOCK") Then
LOVLOT_ITEM_SNO_CUSTLOC19156.Visible=True
SD_ORDER_DETAIL_LOT_NO.Visible=True
SD_ORDER_DETAIL_SERIAL_NO.Visible=True
Else
LOVLOT_ITEM_SNO_CUSTLOC19156.Visible=False
SD_ORDER_DETAIL_LOT_NO.Visible=False
SD_ORDER_DETAIL_SERIAL_NO.Visible=False
End If
End If
If (oprp.Text <> "") Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_CLOSED_ORDER( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SESSION("USER_ID") & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "')")="Y")) Then
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=True
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
SD_ORDER_DETAIL_ORDER_QTY.Enabled=True
SD_ORDER_DETAIL_ORDER_QTY.ReadOnly=False
EVENT_ORDER_CONFIG.Enabled=True
Else
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=False
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
SD_ORDER_DETAIL_ORDER_QTY.Enabled=True
SD_ORDER_DETAIL_ORDER_QTY.ReadOnly=True
EVENT_ORDER_CONFIG.Enabled=False
End If
End If
If (oprp.Text <> "") Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM SD_PACKING_SLIP_DETAIL WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y")) Then
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
Else
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_ITEM_NO.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_ITEM_NO.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_ITEM_NO.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("ORDER_LINE_TYPE_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_ITEM_NO_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds4 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (oprp.Text <> "") Then
 IF (SD_ORDER_DETAIL_DUE_DATE.Text="") Then
SD_ORDER_DETAIL_DUE_DATE.Text=SD_ORDER_HEADER_DUE_DATE.Text
End If
 IF (SD_ORDER_DETAIL_INVOICE_BY.Text="") Then
SD_ORDER_DETAIL_INVOICE_BY.Text=SD_ORDER_HEADER_INVOICE_BY.Selecteditem.Value
End If
 IF (SD_ORDER_DETAIL_ORDER_UOM.Text="") Then
SD_ORDER_DETAIL_ORDER_UOM.Text=SD_ORDER_HEADER_ORDERING_UOM.TEXT
End If
 IF (SD_ORDER_DETAIL_SALES_PRICE.Text="") Then
SD_ORDER_DETAIL_SALES_PRICE.Text=SD_ORDER_HEADER_SALES_PRICE.TEXT
End If
 IF (SD_ORDER_DETAIL_PRICING_UOM.Text="") Then
SD_ORDER_DETAIL_PRICING_UOM.Text=SD_ORDER_HEADER_PRICING_UOM.TEXT
End If
 IF (SD_ORDER_DETAIL_CUSTOMER_PO_NO.Text="") Then
SD_ORDER_DETAIL_CUSTOMER_PO_NO.Text=SD_ORDER_HEADER_CUSTOMER_PO_NO.TEXT
End If
 IF (SD_ORDER_DETAIL_CUSTOMER_PO_DATE.Text="") Then
SD_ORDER_DETAIL_CUSTOMER_PO_DATE.Text=SD_ORDER_HEADER_CUSTOMER_PO_DATE.TEXT
End If
 IF (SD_ORDER_DETAIL_BLANKET_RELEASE_NO.Text="") Then
SD_ORDER_DETAIL_BLANKET_RELEASE_NO.Text=SD_ORDER_HEADER_BLANKET_RELEASE_NO.TEXT
End If
End If 
If (oprp.Text <> "") Then
If (1=2) Then
SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE.Visible=True
Else
SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE.Visible=False
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_GET_TAX_CODE('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "') dbfr_12 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr_12"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_TAX_CODE.Text=dstruc_1.Tables(0).Rows(0)("dbfr_12")
Else
SD_ORDER_DETAIL_TAX_CODE.Text=""
End If
End If
End If
If (oprp.Text <> "") Then
If (CONN.SF_EXECUTE_SQL ("SELECT EDIT_SHIP_DELIVERY_DATE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="S") Then
SD_ORDER_DETAIL_DUE_DATE.Enabled=True
Else
SD_ORDER_DETAIL_DUE_DATE.Enabled=False
End If
End If
If (oprp.Text <> "") Then
If ((SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="WE" OR SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="CP") AND (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0)) Then
EVENT_ORDER_CONFIG.Visible=True
Else
EVENT_ORDER_CONFIG.Visible=False
End If
End If
If (oprp.Text <> "") Then
If ((CONN.SF_EXECUTE_SQL("SELECT COUNT(1) FROM SD_PRODUCT_CONFIGURATOR WHERE ORDER_NO ='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'  AND ORDER_LINE_NO = '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "'")="0") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y")) Then
SD_ORDER_DETAIL_ORDER_DOC_TYPE.Enabled=True
Else
SD_ORDER_DETAIL_ORDER_DOC_TYPE.Enabled=False
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_HEADER_SHIP_COMPLETE.CHECKED=FALSE) Then
SD_ORDER_DETAIL_DUE_DATE.Enabled=True
Else
SD_ORDER_DETAIL_DUE_DATE.Enabled=False
End If
End If
oprp.Text=Ucase(oprp.Text)
If (oprp.Text <> "") Then
 If ( SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE ) Then
dbad.SelectCommand.CommandText = "Select ITEM_DESCRIPTION,ORDERING_UOM,BASE_UOM,SALES_PRICE,SALES_PRICE_UOM,CURRENT_REVISION_NO,DRAWING_NO,DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL),DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL),DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL),DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL),SALES_PRICE from IM_ITEMS where ITEM_NO='" & SD_ORDER_DETAIL_ITEM_NO.text & "'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
Dim DESCRIPTION_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION"), System.DBNull.Value)) Then
DESCRIPTION_str1.Text=dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION")
Else
DESCRIPTION_str1.Text=""
End If
Dim ORDER_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("ORDERING_UOM"), System.DBNull.Value)) Then
ORDER_UOM_str1.Text=dstruc.Tables(0).Rows(0)("ORDERING_UOM")
Else
ORDER_UOM_str1.Text=""
End If
Dim BASE_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("BASE_UOM"), System.DBNull.Value)) Then
BASE_UOM_str1.Text=dstruc.Tables(0).Rows(0)("BASE_UOM")
Else
BASE_UOM_str1.Text=""
End If
Dim SALES_PRICE_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE"), System.DBNull.Value)) Then
SALES_PRICE_str1.Text=dstruc.Tables(0).Rows(0)("SALES_PRICE")
Else
SALES_PRICE_str1.Text=""
End If
Dim PRICING_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE_UOM"), System.DBNull.Value)) Then
PRICING_UOM_str1.Text=dstruc.Tables(0).Rows(0)("SALES_PRICE_UOM")
Else
PRICING_UOM_str1.Text=""
End If
Dim ITEM_REVISION_NO_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO"), System.DBNull.Value)) Then
ITEM_REVISION_NO_str1.Text=dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO")
Else
ITEM_REVISION_NO_str1.Text=""
End If
Dim DRAWING_NO_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DRAWING_NO"), System.DBNull.Value)) Then
DRAWING_NO_str1.Text=dstruc.Tables(0).Rows(0)("DRAWING_NO")
Else
DRAWING_NO_str1.Text=""
End If
Dim ORDER_QTY_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)"), System.DBNull.Value)) Then
ORDER_QTY_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)")
Else
ORDER_QTY_str1.Text=""
End If
Dim ORDER_QTY_BASE_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)"), System.DBNull.Value)) Then
ORDER_QTY_BASE_UOM_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)")
Else
ORDER_QTY_BASE_UOM_str1.Text=""
End If
Dim LINE_EXTENDED_AMOUNT_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)"), System.DBNull.Value)) Then
LINE_EXTENDED_AMOUNT_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)")
Else
LINE_EXTENDED_AMOUNT_str1.Text=""
End If
Dim LINE_TOTAL_AMOUNT_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)"), System.DBNull.Value)) Then
LINE_TOTAL_AMOUNT_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)")
Else
LINE_TOTAL_AMOUNT_str1.Text=""
End If
Dim MSRP_SALES_PRICE_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE"), System.DBNull.Value)) Then
MSRP_SALES_PRICE_str1.Text=dstruc.Tables(0).Rows(0)("SALES_PRICE")
Else
MSRP_SALES_PRICE_str1.Text=""
End If
End If
        End If
        End If
Dim dbsqlst2  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DECODE(NVL('" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE & "','P'),'P',1,'E',1) , DECODE(NVL('" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE & "','P'),'P',1,'E',1) FROM DUAL"
dbsqlst2.Clear()
dbad.Fill(dbsqlst2)
if (dbsqlst2.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ORDER_QTY.Text=String.Format("{0:0.00}",dbsqlst2.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_ORDER_QTY.Text=""
End If
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=String.Format("{0:0.00}",dbsqlst2.Tables(0).Rows(0)(1))
Else
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=""
End If
ELSE
if (dbsqlst2.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_ORDER_QTY.Text=""
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst3  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT DECODE(NVL('" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE & "','P'),'P',1,'E',1) , DECODE(NVL('" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE & "','P'),'P',1,'E',1) FROM DUAL"
dbsqlst3.Clear()
dbad.Fill(dbsqlst3)
if (dbsqlst3.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst3.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ORDER_QTY.Text=String.Format("{0:0.00}",dbsqlst3.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_ORDER_QTY.Text=""
End If
If Not (Equals(dbsqlst3.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=String.Format("{0:0.00}",dbsqlst3.Tables(0).Rows(0)(1))
Else
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=""
End If
ELSE
if (dbsqlst3.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_ORDER_QTY.Text=""
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
 If ( SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE ) Then
dbad.SelectCommand.CommandText = "Select ITEM_DESCRIPTION,BASE_UOM,CURRENT_REVISION_NO from IM_ITEMS where ITEM_NO='" & SD_ORDER_DETAIL_ITEM_NO.text & "'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
Dim DESCRIPTION_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION"), System.DBNull.Value)) Then
DESCRIPTION_str1.Text=dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION")
Else
DESCRIPTION_str1.Text=""
End If
Dim BASE_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("BASE_UOM"), System.DBNull.Value)) Then
BASE_UOM_str1.Text=dstruc.Tables(0).Rows(0)("BASE_UOM")
Else
BASE_UOM_str1.Text=""
End If
Dim ITEM_REVISION_NO_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO"), System.DBNull.Value)) Then
ITEM_REVISION_NO_str1.Text=dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO")
Else
ITEM_REVISION_NO_str1.Text=""
End If
End If
        End If
        End If
If (oprp.Text <> "") Then
If (CONN.SF_EXECUTE_SQL("SELECT Sf_Get_Order_Doc_Type('" & SD_ORDER_DETAIL_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT & "')FROM DUAL")="N") Then
SD_ORDER_DETAIL_ITEM_NO.TEXT=""
err_message.Text = "For Order Doc Type Part Can't Enter New Item for line '" & SD_ORDER_dETAIL_LINE_NO.TEXT & "'"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
If ((SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE) AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_CLOSED_ORDER( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SESSION("USER_ID") & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "')")="Y")) Then
LOVUOM_CONVERSION_LOV1175.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.ReadOnly=False
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=False
LOVUOM_CONVERSION_LOV1178.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.ReadOnly=False
Else
LOVUOM_CONVERSION_LOV1175.Enabled=False
SD_ORDER_DETAIL_ORDER_UOM.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.ReadOnly=True
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=True
LOVUOM_CONVERSION_LOV1178.Enabled=False
SD_ORDER_DETAIL_PRICING_UOM.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.ReadOnly=True
End If
End If
If (oprp.Text <> "") Then
If (CONN.SF_EXECUTE_SQL("SELECT A.PLAN_STRATEGY FROM IM_ITEMS A, IM_ITEM_TYPES B WHERE A.ITEM_TYPE =B.ITEM_TYPE AND ITEM_NO ='" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "'")="L") Then
SD_ORDER_DETAIL_CREATE_WORK_ORDER.CHECKED=TRUE
End If
End If
SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE.Text=SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.TEXT
Dim dbsqlst9  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT CUSTOMER_ITEM_NO FROM V_CUSTOMER_ITEM_NO WHERE ITEM_NO='" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "' AND (SF_GET_APP_SETTINGS('CUSTOMER_ITEM_NO_REQUIRED ',SF_GET_DEFAULT_BUC))='Y' AND CUSTOMER_NO ='" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "'"
dbsqlst9.Clear()
dbad.Fill(dbsqlst9)
if (dbsqlst9.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst9.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.Text=dbsqlst9.Tables(0).Rows(0)(0)
Else
SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.Text=""
End If
ELSE
if (dbsqlst9.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst10  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_GET_MULTIPLIER('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "') ,'" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' FROM DUAL"
dbsqlst10.Clear()
dbad.Fill(dbsqlst10)
if (dbsqlst10.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst10.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_MULTIPLIER.Text=String.Format("{0:0.00}",dbsqlst10.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_MULTIPLIER.Text=""
End If
If Not (Equals(dbsqlst10.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.Text=dbsqlst10.Tables(0).Rows(0)(1)
Else
SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.Text=""
End If
ELSE
if (dbsqlst10.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_MULTIPLIER.Text=""
SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst11  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT NVL((('" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "'* '" & SD_ORDER_DETAIL_Multiplier.TEXT & "')/100),'" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "') FROM DUAL"
dbsqlst11.Clear()
dbad.Fill(dbsqlst11)
if (dbsqlst11.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst11.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_SALES_PRICE.Text=String.Format("{0:0.00}",dbsqlst11.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_SALES_PRICE.Text=""
End If
ELSE
if (dbsqlst11.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_SALES_PRICE.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_EXTENDED_PRICE('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_PRICING_UOM.TEXT & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "' ) dbfr12 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr12"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr12")
Else
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=""
End If
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("ITEM_NO_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds5 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (oprp.Text <> "") Then
If (CONN.SF_EXECUTE_SQL("SELECT SF_GET_VALIDATE_ORDER_TIE_UP('" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' ,'" & SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.TEXT & "') FROM DUAL")="N") Then
SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.TEXT="" 
err_message.Text = "Please enter valid Tie up Line no"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  SF_GET_LICENSE_TIEUP_LINE('" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.TEXT & "','LE') ,SF_GET_LICENSE_TIEUP_LINE('" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.TEXT & "','EU')FROM DUAL"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LICENSE_NO.Text=dbsqlst1.Tables(0).Rows(0)(0)
Else
SD_ORDER_DETAIL_LICENSE_NO.Text=""
End If
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_ORDER_DETAIL_END_USER_CODE.Text=dbsqlst1.Tables(0).Rows(0)(1)
Else
SD_ORDER_DETAIL_END_USER_CODE.Text=""
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_LICENSE_NO.Text=""
SD_ORDER_DETAIL_END_USER_CODE.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_LICENSE_NO.TEXT<>"" AND  CONN.SF_EXECUTE_SQL("SELECT SF_GET_LICENSE_BALANCE('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT.TEXT & "','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_NO.TEXT & "') FROM DUAL")="N") Then
SD_ORDER_DETAIL_LICENSE_NO.TEXT=""
err_message.Text = "License Total Amount Is Less Than Line Total Amount"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_LICENSE_NO.TEXT<>"" AND CONN.SF_EXECUTE_SQL("SELECT SF_VALIDATE_LICENSE_DATE('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_DUE_DATE.TEXT & "')  FROM DUAL")=0) Then
err_message.Text = "Promised Ship Date should be less than the License Expiry Date "
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst4  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  CASE     when LICENSE_EXPIRY_DATE-TRUNC(SYSDATE) between 0 and 60    THEN '<FONT COLOR=RED>License Expire in <60 Days'     ELSE      NULL   END  FROM sd_license WHERE LICENSE_NO='" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "'"
dbsqlst4.Clear()
dbad.Fill(dbsqlst4)
if (dbsqlst4.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst4.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
MSG_LICENSE.Text=dbsqlst4.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst4.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_LOT_NO.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_LOT_NO.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_LOT_NO.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("LICENSE_TIED_UP_LINE_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_LOT_NO_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds6 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
oprp.Text=Ucase(oprp.Text)
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT ITEM_NO,SERIAL_NO,order_doc_type FROM V_ITEM_QTY_CUSTLOC WHERE LOT_NO='" & SD_ORDER_DETAIL_LOT_NO.TEXT & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ITEM_NO.Text=dbsqlst1.Tables(0).Rows(0)(0)
Else
SD_ORDER_DETAIL_ITEM_NO.Text=""
End If
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_ORDER_DETAIL_SERIAL_NO.Text=dbsqlst1.Tables(0).Rows(0)(1)
Else
SD_ORDER_DETAIL_SERIAL_NO.Text=""
End If
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(2), System.DBNull.Value)) Then
dropdown_list_r1(SD_ORDER_DETAIL_ORDER_DOC_TYPE,dbsqlst1.Tables(0).Rows(0)(2))
Else
SD_ORDER_DETAIL_ORDER_DOC_TYPE.SelectedIndex=-1
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_ITEM_NO.Text=""
SD_ORDER_DETAIL_SERIAL_NO.Text=""
SD_ORDER_DETAIL_ORDER_DOC_TYPE.SelectedIndex=-1
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
 If ( SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE ) Then
dbad.SelectCommand.CommandText = "Select ITEM_DESCRIPTION,ORDERING_UOM,BASE_UOM,SALES_PRICE,SALES_PRICE_UOM,CURRENT_REVISION_NO,DRAWING_NO,DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL),DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL),DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL),DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL),SALES_PRICE from IM_ITEMS where ITEM_NO='" & SD_ORDER_DETAIL_ITEM_NO.text & "'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
Dim DESCRIPTION_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION"), System.DBNull.Value)) Then
DESCRIPTION_str1.Text=dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION")
Else
DESCRIPTION_str1.Text=""
End If
Dim ORDER_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("ORDERING_UOM"), System.DBNull.Value)) Then
ORDER_UOM_str1.Text=dstruc.Tables(0).Rows(0)("ORDERING_UOM")
Else
ORDER_UOM_str1.Text=""
End If
Dim BASE_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("BASE_UOM"), System.DBNull.Value)) Then
BASE_UOM_str1.Text=dstruc.Tables(0).Rows(0)("BASE_UOM")
Else
BASE_UOM_str1.Text=""
End If
Dim SALES_PRICE_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE"), System.DBNull.Value)) Then
SALES_PRICE_str1.Text=dstruc.Tables(0).Rows(0)("SALES_PRICE")
Else
SALES_PRICE_str1.Text=""
End If
Dim PRICING_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE_UOM"), System.DBNull.Value)) Then
PRICING_UOM_str1.Text=dstruc.Tables(0).Rows(0)("SALES_PRICE_UOM")
Else
PRICING_UOM_str1.Text=""
End If
Dim ITEM_REVISION_NO_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO"), System.DBNull.Value)) Then
ITEM_REVISION_NO_str1.Text=dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO")
Else
ITEM_REVISION_NO_str1.Text=""
End If
Dim DRAWING_NO_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DRAWING_NO"), System.DBNull.Value)) Then
DRAWING_NO_str1.Text=dstruc.Tables(0).Rows(0)("DRAWING_NO")
Else
DRAWING_NO_str1.Text=""
End If
Dim ORDER_QTY_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)"), System.DBNull.Value)) Then
ORDER_QTY_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)")
Else
ORDER_QTY_str1.Text=""
End If
Dim ORDER_QTY_BASE_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)"), System.DBNull.Value)) Then
ORDER_QTY_BASE_UOM_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)")
Else
ORDER_QTY_BASE_UOM_str1.Text=""
End If
Dim LINE_EXTENDED_AMOUNT_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)"), System.DBNull.Value)) Then
LINE_EXTENDED_AMOUNT_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)")
Else
LINE_EXTENDED_AMOUNT_str1.Text=""
End If
Dim LINE_TOTAL_AMOUNT_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)"), System.DBNull.Value)) Then
LINE_TOTAL_AMOUNT_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)")
Else
LINE_TOTAL_AMOUNT_str1.Text=""
End If
Dim MSRP_SALES_PRICE_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE"), System.DBNull.Value)) Then
MSRP_SALES_PRICE_str1.Text=dstruc.Tables(0).Rows(0)("SALES_PRICE")
Else
MSRP_SALES_PRICE_str1.Text=""
End If
End If
        End If
        End If
Dim dbsqlst3  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT 1,1 FROM DUAL"
dbsqlst3.Clear()
dbad.Fill(dbsqlst3)
if (dbsqlst3.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst3.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ORDER_QTY.Text=String.Format("{0:0.00}",dbsqlst3.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_ORDER_QTY.Text=""
End If
If Not (Equals(dbsqlst3.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=String.Format("{0:0.00}",dbsqlst3.Tables(0).Rows(0)(1))
Else
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=""
End If
ELSE
if (dbsqlst3.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_ORDER_QTY.Text=""
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE.Text=SD_ORDER_HEADER_PROMISED_DELIVERY_DATE.TEXT
Dim dbsqlst5  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT CONFIG_PRICE,CONFIG_PRICE, DESCRIPTION FROM V_SALES_CONFIG_PRICE WHERE SERIAL_NO='" & SD_ORDER_DETAIL_SERIAL_NO.TEXT & "'"
dbsqlst5.Clear()
dbad.Fill(dbsqlst5)
if (dbsqlst5.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst5.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_SALES_PRICE.Text=String.Format("{0:0.00}",dbsqlst5.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_SALES_PRICE.Text=""
End If
If Not (Equals(dbsqlst5.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_ORDER_DETAIL_MSRP_SALES_PRICE.Text=String.Format("{0:0.00}",dbsqlst5.Tables(0).Rows(0)(1))
Else
SD_ORDER_DETAIL_MSRP_SALES_PRICE.Text=""
End If
If Not (Equals(dbsqlst5.Tables(0).Rows(0)(2), System.DBNull.Value)) Then
SD_ORDER_DETAIL_DESCRIPTION.Text=dbsqlst5.Tables(0).Rows(0)(2)
Else
SD_ORDER_DETAIL_DESCRIPTION.Text=""
End If
ELSE
if (dbsqlst5.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_SALES_PRICE.Text=""
SD_ORDER_DETAIL_MSRP_SALES_PRICE.Text=""
SD_ORDER_DETAIL_DESCRIPTION.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_EXTENDED_PRICE('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_PRICING_UOM.TEXT & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "' ) dbfr6 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr6"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr6")
Else
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=""
End If
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_CREATE_WORK_ORDER.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_CREATE_WORK_ORDER.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("LOT_NO_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_CUSTOMER_ITEM_NO_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds11 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
oprp.Text=Ucase(oprp.Text)
If oprp.Text<>"" Then
  dbad.SelectCommand.CommandText="Select CUSTOMER_ITEM_NO from V_CUSTOMER_ITEM_NO Where  CUSTOMER_NO='" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "' And upper(CUSTOMER_ITEM_NO)=upper('" & oprp.Text & "')"
Cust_ds11.Clear()
dbad.Fill(cust_ds11)
If Not(cust_ds11.Tables(0).rows.Count>0)Then
oprp.Text=""
err_message.Text = "Please select valid customer Item No"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
Exit Sub
End If
End If
Dim dbsqlst2  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT ITEM_NO FROM V_CUSTOMER_ITEM_NO WHERE CUSTOMER_ITEM_NO='" & SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.TEXT & "'"
dbsqlst2.Clear()
dbad.Fill(dbsqlst2)
if (dbsqlst2.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ITEM_NO.Text=dbsqlst2.Tables(0).Rows(0)(0)
Else
SD_ORDER_DETAIL_ITEM_NO.Text=""
End If
ELSE
if (dbsqlst2.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_ITEM_NO.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
 If ( SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE ) Then
dbad.SelectCommand.CommandText = "Select ITEM_DESCRIPTION,ORDERING_UOM,BASE_UOM,SALES_PRICE,SALES_PRICE_UOM,CURRENT_REVISION_NO,DRAWING_NO,DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL),DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL),DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL),DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL),SALES_PRICE from IM_ITEMS where ITEM_NO='" & SD_ORDER_DETAIL_ITEM_NO.text & "'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
Dim DESCRIPTION_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION"), System.DBNull.Value)) Then
DESCRIPTION_str1.Text=dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION")
Else
DESCRIPTION_str1.Text=""
End If
Dim ORDER_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("ORDERING_UOM"), System.DBNull.Value)) Then
ORDER_UOM_str1.Text=dstruc.Tables(0).Rows(0)("ORDERING_UOM")
Else
ORDER_UOM_str1.Text=""
End If
Dim BASE_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("BASE_UOM"), System.DBNull.Value)) Then
BASE_UOM_str1.Text=dstruc.Tables(0).Rows(0)("BASE_UOM")
Else
BASE_UOM_str1.Text=""
End If
Dim SALES_PRICE_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE"), System.DBNull.Value)) Then
SALES_PRICE_str1.Text=dstruc.Tables(0).Rows(0)("SALES_PRICE")
Else
SALES_PRICE_str1.Text=""
End If
Dim PRICING_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE_UOM"), System.DBNull.Value)) Then
PRICING_UOM_str1.Text=dstruc.Tables(0).Rows(0)("SALES_PRICE_UOM")
Else
PRICING_UOM_str1.Text=""
End If
Dim ITEM_REVISION_NO_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO"), System.DBNull.Value)) Then
ITEM_REVISION_NO_str1.Text=dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO")
Else
ITEM_REVISION_NO_str1.Text=""
End If
Dim DRAWING_NO_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DRAWING_NO"), System.DBNull.Value)) Then
DRAWING_NO_str1.Text=dstruc.Tables(0).Rows(0)("DRAWING_NO")
Else
DRAWING_NO_str1.Text=""
End If
Dim ORDER_QTY_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)"), System.DBNull.Value)) Then
ORDER_QTY_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)")
Else
ORDER_QTY_str1.Text=""
End If
Dim ORDER_QTY_BASE_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)"), System.DBNull.Value)) Then
ORDER_QTY_BASE_UOM_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',1,NULL)")
Else
ORDER_QTY_BASE_UOM_str1.Text=""
End If
Dim LINE_EXTENDED_AMOUNT_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)"), System.DBNull.Value)) Then
LINE_EXTENDED_AMOUNT_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)")
Else
LINE_EXTENDED_AMOUNT_str1.Text=""
End If
Dim LINE_TOTAL_AMOUNT_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)"), System.DBNull.Value)) Then
LINE_TOTAL_AMOUNT_str1.Text=dstruc.Tables(0).Rows(0)("DECODE(ITEM_TYPE,'EXTRA_CHARGE',SF_CALC_EXTENDED_PRICE(ITEM_NO,BASE_UOM,SALES_PRICE_UOM,SALES_PRICE,1),NULL)")
Else
LINE_TOTAL_AMOUNT_str1.Text=""
End If
Dim MSRP_SALES_PRICE_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("SALES_PRICE"), System.DBNull.Value)) Then
MSRP_SALES_PRICE_str1.Text=dstruc.Tables(0).Rows(0)("SALES_PRICE")
Else
MSRP_SALES_PRICE_str1.Text=""
End If
End If
        End If
        End If
If (oprp.Text <> "") Then
 If ( SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE ) Then
dbad.SelectCommand.CommandText = "Select ITEM_DESCRIPTION,BASE_UOM,CURRENT_REVISION_NO from IM_ITEMS where ITEM_NO='" & SD_ORDER_DETAIL_ITEM_NO.text & "'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
Dim DESCRIPTION_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION"), System.DBNull.Value)) Then
DESCRIPTION_str1.Text=dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION")
Else
DESCRIPTION_str1.Text=""
End If
Dim BASE_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("BASE_UOM"), System.DBNull.Value)) Then
BASE_UOM_str1.Text=dstruc.Tables(0).Rows(0)("BASE_UOM")
Else
BASE_UOM_str1.Text=""
End If
Dim ITEM_REVISION_NO_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO"), System.DBNull.Value)) Then
ITEM_REVISION_NO_str1.Text=dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO")
Else
ITEM_REVISION_NO_str1.Text=""
End If
End If
        End If
        End If
If (oprp.Text <> "") Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_CLOSED_ORDER( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SESSION("USER_ID") & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "')")="Y")) Then
LOVUOM_CONVERSION_LOV1175.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.ReadOnly=False
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=False
LOVUOM_CONVERSION_LOV1178.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.ReadOnly=False
Else
LOVUOM_CONVERSION_LOV1175.Enabled=False
SD_ORDER_DETAIL_ORDER_UOM.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.ReadOnly=True
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=True
LOVUOM_CONVERSION_LOV1178.Enabled=False
SD_ORDER_DETAIL_PRICING_UOM.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.ReadOnly=True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_DESCRIPTION.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_DESCRIPTION.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_DESCRIPTION.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("CUSTOMER_ITEM_NO_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_ITEM_REVISION_NO_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds12 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If oprp.Text<>"" Then
  dbad.SelectCommand.CommandText="Select ITEM_REVISION_NO from V_ITEM_REV_NO_LOV Where  ITEM_NO=NVL('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "',ITEM_NO) And upper(ITEM_REVISION_NO)=upper('" & oprp.Text & "')"
Cust_ds12.Clear()
dbad.Fill(cust_ds12)
If Not(cust_ds12.Tables(0).rows.Count>0)Then
oprp.Text=""
err_message.Text = "<b>Please select valid Item Revision No</b>"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
Exit Sub
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_DESCRIPTION.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_DESCRIPTION.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_DESCRIPTION.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("ITEM_REVISION_NO_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_ORDER_QTY_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds15 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (oprp.Text <> "") Then
 IF (SD_ORDER_DETAIL_ITEM_NO.Text="") Then
SD_ORDER_DETAIL_ITEM_NO.Text=SD_ORDER_HEADER_ITEM_NO.TEXT
End If
 IF (SD_ORDER_DETAIL_DUE_DATE.Text="") Then
SD_ORDER_DETAIL_DUE_DATE.Text=SD_ORDER_HEADER_DUE_DATE.Text
End If
 IF (SD_ORDER_DETAIL_INVOICE_BY.Text="") Then
SD_ORDER_DETAIL_INVOICE_BY.Text=SD_ORDER_HEADER_INVOICE_BY.Selecteditem.Value
End If
 IF (SD_ORDER_DETAIL_ORDER_UOM.Text="") Then
SD_ORDER_DETAIL_ORDER_UOM.Text=SD_ORDER_HEADER_ORDERING_UOM.TEXT
End If
 IF (SD_ORDER_DETAIL_SALES_PRICE.Text="") Then
SD_ORDER_DETAIL_SALES_PRICE.Text=SD_ORDER_HEADER_SALES_PRICE.TEXT
End If
 IF (SD_ORDER_DETAIL_PRICING_UOM.Text="") Then
SD_ORDER_DETAIL_PRICING_UOM.Text=SD_ORDER_HEADER_PRICING_UOM.TEXT
End If
 IF (SD_ORDER_DETAIL_CUSTOMER_PO_NO.Text="") Then
SD_ORDER_DETAIL_CUSTOMER_PO_NO.Text=SD_ORDER_HEADER_CUSTOMER_PO_NO.TEXT
End If
 IF (SD_ORDER_DETAIL_CUSTOMER_PO_DATE.Text="") Then
SD_ORDER_DETAIL_CUSTOMER_PO_DATE.Text=SD_ORDER_HEADER_CUSTOMER_PO_DATE.TEXT
End If
 IF (SD_ORDER_DETAIL_BLANKET_RELEASE_NO.Text="") Then
SD_ORDER_DETAIL_BLANKET_RELEASE_NO.Text=SD_ORDER_HEADER_BLANKET_RELEASE_NO.TEXT
End If
End If 
If (oprp.Text <> "") Then
If (CONN.SF_EXECUTE_SQL("SELECT SF_VALIDATE_SO_SHIP_QTY('" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "') FROM DUAL")="N") Then
SD_ORDER_DETAIL_ORDER_QTY.TEXT=0
err_message.Text = "Qty cannot be less than shipped qty or work order qty in line # " & SD_ORDER_DETAIL_LINE_NO.TEXT & ""
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst2  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_CALC_SHIPPING_CHARGES('" & CHECK_BOX_R(SD_ORDER_DETAIL_EXPEDITE)& "','" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT & "','" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.TEXT & "','" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "'), '" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "' FROM DUAL"
dbsqlst2.Clear()
dbad.Fill(dbsqlst2)
if (dbsqlst2.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=String.Format("{0:0.00}",dbsqlst2.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
End If
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE.Text=String.Format("{0:0.00}",dbsqlst2.Tables(0).Rows(0)(1))
Else
SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE.Text=""
End If
ELSE
if (dbsqlst2.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_QTY_BASE_UOM('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_ORDER_UOM.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "') dbfr3 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr3"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=dstruc_1.Tables(0).Rows(0)("dbfr3")
Else
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=""
End If
End If
End If
If (oprp.Text <> "") Then
 If ( SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=TRUE ) Then
dbad.SelectCommand.CommandText = "Select ITEM_DESCRIPTION,BASE_UOM,CURRENT_REVISION_NO from IM_ITEMS where ITEM_NO='" & SD_ORDER_DETAIL_ITEM_NO.text & "'"
dstruc.Clear()
dbad.Fill(dstruc)
If (dstruc.Tables(0).Rows.Count > 0) Then
Dim DESCRIPTION_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION"), System.DBNull.Value)) Then
DESCRIPTION_str1.Text=dstruc.Tables(0).Rows(0)("ITEM_DESCRIPTION")
Else
DESCRIPTION_str1.Text=""
End If
Dim BASE_UOM_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("BASE_UOM"), System.DBNull.Value)) Then
BASE_UOM_str1.Text=dstruc.Tables(0).Rows(0)("BASE_UOM")
Else
BASE_UOM_str1.Text=""
End If
Dim ITEM_REVISION_NO_str1 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
If Not (Equals(dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO"), System.DBNull.Value)) Then
ITEM_REVISION_NO_str1.Text=dstruc.Tables(0).Rows(0)("CURRENT_REVISION_NO")
Else
ITEM_REVISION_NO_str1.Text=""
End If
End If
        End If
        End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_GET_SALES_PRICE_UOM('" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "','" & CHECK_BOX_R(SD_ORDER_HEADER_BLANKET_ORDER) & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "',TO_DATE('" & SD_ORDER_HEADER_ORDER_DATE.TEXT & "','MM/DD/YYYY'),'UOM','" & CHECK_BOX_R(SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO) & "','" & SD_ORDER_DETAIL_CONFIGURATOR_ID.TEXT & "') dbfr5 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr5"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_PRICING_UOM.Text=dstruc_1.Tables(0).Rows(0)("dbfr5")
Else
SD_ORDER_DETAIL_PRICING_UOM.Text=""
End If
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_EXTENDED_PRICE('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_PRICING_UOM.TEXT & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "' ) dbfr6 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr6"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr6")
Else
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=""
End If
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_GET_TAX_AMOUNT('" & SD_ORDER_DETAIL_TAX_CODE.TEXT & "','" & SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.TEXT & "') dbfr7 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr7"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_TAX_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr7")
Else
SD_ORDER_DETAIL_TAX_AMOUNT.Text=""
End If
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_LICENSE_NO.TEXT<>"" AND  CONN.SF_EXECUTE_SQL("SELECT SF_GET_LICENSE_BALANCE_QTY('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','" & SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.TEXT & "') FROM DUAL")="N") Then
SD_ORDER_DETAIL_ORDER_QTY.TEXT=""
err_message.Text = "License Total Qty Is Less Than Line Qty"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_LICENSE_NO.TEXT<>"" AND CONN.SF_EXECUTE_SQL("SELECT SF_GET_LICENSE_BALANCE('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT.TEXT & "','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_NO.TEXT & "') FROM DUAL")="N") Then
SD_ORDER_DETAIL_ORDER_QTY.TEXT=""
err_message.Text = "License Total Amount Is Less Than Line Total Amount"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_TRIM_SIZE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_TRIM_SIZE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_TRIM_SIZE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("ORDER_QTY_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_TRIM_SIZE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds16 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
Dim dbsqlst0  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT (CASE WHEN '" & SD_ORDER_DETAIL_TRIM_SIZE.TEXT & "' > 40 THEN  'MM' WHEN '" & SD_ORDER_DETAIL_TRIM_SIZE.TEXT & "' <= 40 THEN 'IN' END) AS TRIM_UOM FROM DUAL"
dbsqlst0.Clear()
dbad.Fill(dbsqlst0)
if (dbsqlst0.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst0.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_TRIM_UOM.Text=dbsqlst0.Tables(0).Rows(0)(0)
Else
SD_ORDER_DETAIL_TRIM_UOM.Text=""
End If
ELSE
if (dbsqlst0.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_TRIM_UOM.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_ORDER_UOM.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_ORDER_UOM.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_ORDER_UOM.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("TRIM_SIZE_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_ORDER_UOM_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds19 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
oprp.Text=Ucase(oprp.Text)
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_QTY_BASE_UOM('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_ORDER_UOM.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "') dbfr1 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr1"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=dstruc_1.Tables(0).Rows(0)("dbfr1")
Else
SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.Text=""
End If
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_GET_SALES_PRICE_UOM('" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "','" & CHECK_BOX_R(SD_ORDER_HEADER_BLANKET_ORDER) & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "',TO_DATE('" & SD_ORDER_HEADER_ORDER_DATE.TEXT & "','MM/DD/YYYY'),'PRICE','" & CHECK_BOX_R(SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO) & "','" & SD_ORDER_DETAIL_CONFIGURATOR_ID.TEXT & "') dbfr2 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr2"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_SALES_PRICE.Text=dstruc_1.Tables(0).Rows(0)("dbfr2")
Else
SD_ORDER_DETAIL_SALES_PRICE.Text=""
End If
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_GET_SALES_PRICE_UOM('" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "','" & CHECK_BOX_R(SD_ORDER_HEADER_BLANKET_ORDER) & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "',TO_DATE('" & SD_ORDER_HEADER_ORDER_DATE.TEXT & "','MM/DD/YYYY'),'UOM','" & CHECK_BOX_R(SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO) & "','" & SD_ORDER_DETAIL_CONFIGURATOR_ID.TEXT & "') dbfr3 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr3"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_PRICING_UOM.Text=dstruc_1.Tables(0).Rows(0)("dbfr3")
Else
SD_ORDER_DETAIL_PRICING_UOM.Text=""
End If
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_EXTENDED_PRICE('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_PRICING_UOM.TEXT & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "' ) dbfr4 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr4"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr4")
Else
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=""
End If
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_GET_TAX_AMOUNT('" & SD_ORDER_DETAIL_TAX_CODE.TEXT & "','" & SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.TEXT & "') dbfr5 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr5"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_TAX_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr5")
Else
SD_ORDER_DETAIL_TAX_AMOUNT.Text=""
End If
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
If oprp.Text<>"" Then
  dbad.SelectCommand.CommandText="Select CONV_UOM from V_UOM_CONVERTION Where  ((item_no = '" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "') OR (ITEM_NO IS NULL AND 0=(SELECT COUNT(*) FROM IM_ITEMS WHERE ITEM_NO='" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "'))) AND BASE_UOM = NVL('" & SD_ORDER_DETAIL_base_uom.TEXT & "',BASE_UOM)  And upper(CONV_UOM)=upper('" & oprp.Text & "')"
Cust_ds19.Clear()
dbad.Fill(cust_ds19)
If Not(cust_ds19.Tables(0).rows.Count>0)Then
oprp.Text=""
err_message.Text = "Please Select valid UOM"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
Exit Sub
End If
End If
If oprp.Text<>"" Then
  dbad.SelectCommand.CommandText="Select CONV_UOM from V_UOM_CONVERTION Where  ((item_no = '" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "') OR (ITEM_NO IS NULL AND 0=(SELECT COUNT(*) FROM IM_ITEMS WHERE ITEM_NO='" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "'))) AND BASE_UOM = NVL('" & SD_ORDER_DETAIL_base_uom.TEXT & "',BASE_UOM)  And upper(CONV_UOM)=upper('" & oprp.Text & "')"
Cust_ds19.Clear()
dbad.Fill(cust_ds19)
If Not(cust_ds19.Tables(0).rows.Count>0)Then
oprp.Text=""
err_message.Text = "Please Select valid UOM"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
Exit Sub
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_MULTIPLIER.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_MULTIPLIER.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_MULTIPLIER.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("ORDER_UOM_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_MULTIPLIER_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds20 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
Dim dbsqlst0  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT NVL((('" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "'* '" & SD_ORDER_DETAIL_Multiplier.TEXT & "')/100),'" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "') FROM DUAL"
dbsqlst0.Clear()
dbad.Fill(dbsqlst0)
if (dbsqlst0.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst0.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_SALES_PRICE.Text=String.Format("{0:0.00}",dbsqlst0.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_SALES_PRICE.Text=""
End If
ELSE
if (dbsqlst0.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_SALES_PRICE.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT NVL(SF_CALC_SHIPPING_CHARGES('" & CHECK_BOX_R(SD_ORDER_DETAIL_EXPEDITE)& "','" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT & "','" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.TEXT & "','" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "'),0) FROM DUAL"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=String.Format("{0:0.00}",dbsqlst1.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_EXTENDED_PRICE('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_PRICING_UOM.TEXT & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "' ) dbfr2 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr2"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr2")
Else
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=""
End If
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_GET_TAX_AMOUNT('" & SD_ORDER_DETAIL_TAX_CODE.TEXT & "','" & SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.TEXT & "') dbfr3 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr3"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_TAX_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr3")
Else
SD_ORDER_DETAIL_TAX_AMOUNT.Text=""
End If
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_MSRP_SALES_PRICE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("MULTIPLIER_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_MSRP_SALES_PRICE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds21 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
Dim dbsqlst0  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT NVL((('" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "'* '" & SD_ORDER_DETAIL_Multiplier.TEXT & "')/100),'" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "') FROM DUAL"
dbsqlst0.Clear()
dbad.Fill(dbsqlst0)
if (dbsqlst0.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst0.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_SALES_PRICE.Text=String.Format("{0:0.00}",dbsqlst0.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_SALES_PRICE.Text=""
End If
ELSE
if (dbsqlst0.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_SALES_PRICE.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_CALC_SHIPPING_CHARGES('" & CHECK_BOX_R(SD_ORDER_DETAIL_EXPEDITE)& "','" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT & "','" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.TEXT & "','" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "') FROM DUAL"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=String.Format("{0:0.00}",dbsqlst1.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_EXTENDED_PRICE('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_PRICING_UOM.TEXT & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "' ) dbfr2 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr2"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr2")
Else
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=""
End If
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_LICENSE_NO.TEXT<>"" AND CONN.SF_EXECUTE_SQL("SELECT SF_GET_LICENSE_BALANCE('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT.TEXT & "','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_NO.TEXT & "') FROM DUAL")="N") Then
err_message.Text = "License Total Amount Is Less Than Line Total Amount"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_SALES_PRICE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_SALES_PRICE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_SALES_PRICE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("MSRP_SALES_PRICE_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_PRICING_UOM_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds22 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
oprp.Text=Ucase(oprp.Text)
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_EXTENDED_PRICE('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_PRICING_UOM.TEXT & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "' ) dbfr1 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr1"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr1")
Else
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=""
End If
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_GET_TAX_AMOUNT('" & SD_ORDER_DETAIL_TAX_CODE.TEXT & "','" & SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.TEXT & "') dbfr2 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr2"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_TAX_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr2")
Else
SD_ORDER_DETAIL_TAX_AMOUNT.Text=""
End If
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
If oprp.Text<>"" Then
  dbad.SelectCommand.CommandText="Select CONV_UOM from V_UOM_CONVERTION Where  ((item_no = '" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "') OR (ITEM_NO IS NULL AND 0=(SELECT COUNT(*) FROM IM_ITEMS WHERE ITEM_NO='" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "'))) AND BASE_UOM = NVL('" & SD_ORDER_DETAIL_base_uom.TEXT & "',BASE_UOM)  And upper(CONV_UOM)=upper('" & oprp.Text & "')"
Cust_ds22.Clear()
dbad.Fill(cust_ds22)
If Not(cust_ds22.Tables(0).rows.Count>0)Then
oprp.Text=""
err_message.Text = "Please Select valid UOM"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
Exit Sub
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_EXPEDITE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_EXPEDITE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_EXPEDITE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("PRICING_UOM_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_SALES_PRICE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds23 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (oprp.Text <> "") Then
If (CONN.SF_EXECUTE_DB_FUNCTION(" ISNUMBER('" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "')")=0) Then
SD_ORDER_DETAIL_SALES_PRICE.TEXT=""
err_message.Text = "<B>Please fill valid number.<B>"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_EXTENDED_PRICE('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_PRICING_UOM.TEXT & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "' ) dbfr1 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr1"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr1")
Else
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=""
End If
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_EXTENDED_PRICE('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_PRICING_UOM.TEXT & "','" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "' ) dbfr2 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr2"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr2")
Else
SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.Text=""
End If
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_GET_TAX_AMOUNT('" & SD_ORDER_DETAIL_TAX_CODE.TEXT & "','" & SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.TEXT & "') dbfr3 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr3"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_TAX_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr3")
Else
SD_ORDER_DETAIL_TAX_AMOUNT.Text=""
End If
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
Dim dbsqlst5  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT (('" & SD_ORDER_DETAIL_SALES_PRICE.TEXT & "'* 100)/'" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "') FROM DUAL"
dbsqlst5.Clear()
dbad.Fill(dbsqlst5)
if (dbsqlst5.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst5.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_MULTIPLIER.Text=String.Format("{0:0.00}",dbsqlst5.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_MULTIPLIER.Text=""
End If
ELSE
if (dbsqlst5.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_MULTIPLIER.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_EXPEDITE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_EXPEDITE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_EXPEDITE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("SALES_PRICE_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_EXPEDITE_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp1 As New CheckBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp1 = CType(sender, CheckBox)
 	      Dim oprp As New TextBox
 	     if (oprp1.Checked=True) Then
 	      oprp.Text="Y"
Else
 	      oprp.Text="N"
End If
        cell4 = CType(oprp1.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds24 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_EXPEDITE.CHECKED="TRUE") Then
LOVEXPEDITE_LOV18034.Visible=True
SD_ORDER_DETAIL_EXPEDIATE_VALUE.Visible=True
Else
LOVEXPEDITE_LOV18034.Visible=False
SD_ORDER_DETAIL_EXPEDIATE_VALUE.Visible=False
End If
End If
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_CALC_SHIPPING_CHARGES('" & CHECK_BOX_R(SD_ORDER_DETAIL_EXPEDITE)& "','" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT & "','" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.TEXT & "','" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "') FROM DUAL"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=String.Format("{0:0.00}",dbsqlst1.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_EXPEDIATE_VALUE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("EXPEDITE_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_EXPEDIATE_VALUE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds25 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
Dim dbsqlst0  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_CALC_SHIPPING_CHARGES('" & CHECK_BOX_R(SD_ORDER_DETAIL_EXPEDITE)& "','" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT & "','" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.TEXT & "','" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "') FROM DUAL"
dbsqlst0.Clear()
dbad.Fill(dbsqlst0)
if (dbsqlst0.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst0.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=String.Format("{0:0.00}",dbsqlst0.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
End If
ELSE
if (dbsqlst0.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_CALC_SHIPPING_CHARGES('" & CHECK_BOX_R(SD_ORDER_DETAIL_EXPEDITE)& "','" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT & "','" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.TEXT & "','" & SD_ORDER_DETAIL_MSRP_SALES_PRICE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY.TEXT & "') FROM DUAL"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=String.Format("{0:0.00}",dbsqlst1.Tables(0).Rows(0)(0))
Else
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst2  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT SF_CALC_EXP_SHIP_DATE('"& CHECK_BOX_R(SD_ORDER_DETAIL_EXPEDITE)& "','" & SD_ORDER_HEADER_ORDER_DATE.TEXT & "','" & SD_ORDER_DETAIL_ORDER_DOC_TYPE.TEXT & "','" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.TEXT & "') FROM DUAL"
dbsqlst2.Clear()
dbad.Fill(dbsqlst2)
if (dbsqlst2.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst2.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_DETAIL_DUE_DATE.Text=dbsqlst2.Tables(0).Rows(0)(0)
Else
SD_ORDER_DETAIL_DUE_DATE.Text=""
End If
ELSE
if (dbsqlst2.Tables(0).Rows.Count=0) Then
SD_ORDER_DETAIL_DUE_DATE.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("EXPEDIATE_VALUE_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_TAX_CODE_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds27 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_GET_TAX_AMOUNT('" & SD_ORDER_DETAIL_TAX_CODE.TEXT & "','" & SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT.TEXT & "') dbfr0 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr0"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_TAX_AMOUNT.Text=dstruc_1.Tables(0).Rows(0)("dbfr0")
Else
SD_ORDER_DETAIL_TAX_AMOUNT.Text=""
End If
End If
End If
If oprp.Text<>"" Then
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0 As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
LINE_TOTAL_AMOUNT.Text=cdbl(SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT0.Text)+cdbl(SD_ORDER_DETAIL_TAX_AMOUNT0.Text)+CDBL(SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT0.Text)
End IF
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("TAX_CODE_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds30 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_DUE_DATE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_DUE_DATE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_DUE_DATE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("LINE_TOTAL_AMOUNT_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_LICENSE_NO_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds40 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_LICENSE_NO.TEXT="" OR CONN.SF_EXECUTE_SQL("SELECT SF_GET_LICENSE_BALANCE('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT.TEXT & "','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_NO.TEXT & "') FROM DUAL")="N") Then
SD_ORDER_DETAIL_LICENSE_NO.TEXT=""
err_message.Text = "License Total Amount Is Less Than Line Total Amount"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_LICENSE_NO.TEXT="" OR CONN.SF_EXECUTE_SQL("SELECT SF_GET_LICENSE_BALANCE_QTY('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM.TEXT & "','" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','" & SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.TEXT & "') FROM DUAL")="N") Then
SD_ORDER_DETAIL_LICENSE_NO.TEXT=""
err_message.Text = "License Total Qty Is Less Than Line Qty"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_LICENSE_NO.TEXT<>"" AND CONN.SF_EXECUTE_SQL("SELECT SF_VALIDATE_LICENSE_DATE('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "','" & SD_ORDER_DETAIL_DUE_DATE.TEXT & "')  FROM DUAL")=0) Then
SD_ORDER_DETAIL_LICENSE_NO.TEXT=""
err_message.Text = "Promised Ship Date should be less than the License Expiry Date "
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
Dim dbsqlst3  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  CASE     when LICENSE_EXPIRY_DATE-TRUNC(SYSDATE) between 0 and 60    THEN '<FONT COLOR=RED>License Expire in <60 Days'     ELSE      NULL   END  FROM sd_license WHERE LICENSE_NO='" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "'"
dbsqlst3.Clear()
dbad.Fill(dbsqlst3)
if (dbsqlst3.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst3.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
MSG_LICENSE.Text=dbsqlst3.Tables(0).Rows(0)(0)
End If
ELSE
if (dbsqlst3.Tables(0).Rows.Count=0) Then
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
If oprp.Text<>"" Then
  dbad.SelectCommand.CommandText="Select LICENSE_NO from V_LICENSE Where  LICENSE_NO=NVL('" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "',LICENSE_NO) AND (LICENSE_EXPIRY_DATE IS NULL OR TRUNC(LICENSE_EXPIRY_DATE) >= TRUNC(SYSDATE)) And upper(LICENSE_NO)=upper('" & oprp.Text & "')"
Cust_ds40.Clear()
dbad.Fill(cust_ds40)
If Not(cust_ds40.Tables(0).rows.Count>0)Then
oprp.Text=""
err_message.Text = "Select Valid License No"
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
Exit Sub
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_END_USER_CODE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_END_USER_CODE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_END_USER_CODE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("LICENSE_NO_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_ATEX_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp1 As New CheckBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp1 = CType(sender, CheckBox)
 	      Dim oprp As New TextBox
 	     if (oprp1.Checked=True) Then
 	      oprp.Text="Y"
Else
 	      oprp.Text="N"
End If
        cell4 = CType(oprp1.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds45 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (oprp.Text <> "") Then
If (SD_ORDER_DETAIL_ATEX.CHECKED=FALSE) Then
SD_ORDER_DETAIL_ATEX_CODE.TEXT=""
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_PO_LINE_NO.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_PO_LINE_NO.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_PO_LINE_NO.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("ATEX_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_ORDER_DETAIL_CANCELED_QTY_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgORDERDETAIL.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds50 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (oprp.Text <> "") Then
If (CONN.SF_EXECUTE_DB_FUNCTION("SF_CHECK_ORDER_CANCELLED_QTY ('" & SD_ORDER_DETAIL_ORDER_NO.Text & "','" & SD_ORDER_DETAIL_LINE_NO.Text & "', '" & SD_ORDER_DETAIL_CANCELED_QTY.TEXT & "')")="Y") Then
SD_ORDER_DETAIL_CANCELED_QTY.TEXT=""
err_message.Text = "Canceled Qty exceeds the Order Qty."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    if (oprp.Text <> "") Then
dbad.SelectCommand.CommandText = "Select SF_CALC_QTY_BASE_UOM('" & SD_ORDER_DETAIL_ITEM_NO.TEXT & "','" & SD_ORDER_DETAIL_BASE_UOM.TEXT & "','" & SD_ORDER_DETAIL_ORDER_UOM.TEXT & "','" & SD_ORDER_DETAIL_CANCELED_QTY.TEXT & "') dbfr1 from dual "
dstruc_1.Clear()
dbad.Fill(dstruc_1)
If (dstruc_1.Tables(0).Rows.Count > 0) Then
If Not (Equals(dstruc_1.Tables(0).Rows(0)("dbfr1"), System.DBNull.Value)) Then
SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM.Text=dstruc_1.Tables(0).Rows(0)("dbfr1")
Else
SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM.Text=""
End If
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_ORDER_DETAIL_CANCELED_QTY.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_ORDER_DETAIL_CANCELED_QTY.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_ORDER_DETAIL_CANCELED_QTY.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("CANCELED_QTY_SD_ORDER_DETAIL_event",ex.Message)
 End Try
End Sub
Public Sub SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgSALESREPBYSALESORDER.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds2 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_SALES_REP_BY_SALES_ORDER_LINE_NO As Label = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_LINE_NO"), Label)
Dim SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO"), TextBox)
Dim SALESREP_NAME As TextBox = CType(dgItem1.FindControl("SALESREP_NAME"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE"), TextBox)
Dim LOVSALES_REPS_LOV6969 As ImageButton=CType(dgItem1.FindControl("LOVSALES_REPS_LOV6969"), ImageButton)
Dim dbsqlst1  as new Data.Dataset
dbad.SelectCommand.CommandText ="select name,commission_rate from Sd_Sales_Reps where sales_rep_no='" & SD_SALES_REP_BY_SALES_ORDER_sales_rep_no.text & "'"
dbsqlst1.Clear()
dbad.Fill(dbsqlst1)
if (dbsqlst1.Tables(0).Rows.Count=1) Then
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SALESREP_NAME.Text=dbsqlst1.Tables(0).Rows(0)(0)
End If
If Not (Equals(dbsqlst1.Tables(0).Rows(0)(1), System.DBNull.Value)) Then
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.Text=String.Format("{0:0.00}",dbsqlst1.Tables(0).Rows(0)(1))
Else
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.Text=""
End If
ELSE
if (dbsqlst1.Tables(0).Rows.Count=0) Then
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.Text=""
ELSE
err_message.Text = "More records exist."
err_message.Visible=True
exception_message.Visible = False
mpanel.Visible = True
End If
End If
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("SALES_REP_NO_SD_SALES_REP_BY_SALES_ORDER_event",ex.Message)
 End Try
End Sub
Public Sub SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgSALESREPBYSALESORDER.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds4 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_SALES_REP_BY_SALES_ORDER_LINE_NO As Label = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_LINE_NO"), Label)
Dim SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO"), TextBox)
Dim SALESREP_NAME As TextBox = CType(dgItem1.FindControl("SALESREP_NAME"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE"), TextBox)
Dim LOVSALES_REPS_LOV6969 As ImageButton=CType(dgItem1.FindControl("LOVSALES_REPS_LOV6969"), ImageButton)
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("EFFECTIVE_FROM_SD_SALES_REP_BY_SALES_ORDER_event",ex.Message)
 End Try
End Sub
Public Sub SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
dbad.SelectCommand.Connection = Session("db_connection")
Try
 	      Dim oprp As New TextBox
        Dim dgItem1 As DataGridItem
        Dim cell4 As TableCell
        Dim i1, i2, i3, i4, i5, i6 As Integer
        Dim s As String
        Dim dr As DataGridColumnCollection = dbgSALESREPBYSALESORDER.Columns()
        i3 = 0
        oprp = CType(sender, TextBox)
        cell4 = CType(oprp.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
        i1 = dgItem1.ItemIndex
Dim dstruc_1 as new Data.DataSet
Dim cust_ds5 As New Data.DataSet
Dim dstruc, dstruc1 As New Data.DataSet
Dim SD_SALES_REP_BY_SALES_ORDER_LINE_NO As Label = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_LINE_NO"), Label)
Dim SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO"), TextBox)
Dim SALESREP_NAME As TextBox = CType(dgItem1.FindControl("SALESREP_NAME"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE"), TextBox)
Dim LOVSALES_REPS_LOV6969 As ImageButton=CType(dgItem1.FindControl("LOVSALES_REPS_LOV6969"), ImageButton)
    dbad.SelectCommand.Connection.Close()
If (Request.Browser.Browser = "IE") Then
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.Focus()
Else
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focusg", "setff1('" & SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.ClientID & "');", True)
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "focus", "setff1('" & SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.ClientID & "');", True)
End If
Catch ex As Exception
dbad.SelectCommand.Connection.Close()
call insert_sys_log("EFFECTIVE_TILL_SD_SALES_REP_BY_SALES_ORDER_event",ex.Message)
 End Try
End Sub
Dim mytotal9703 as double
  Protected Sub dbgBILLING_STAGE_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.DataGridItemEventArgs) Handles dbgBILLING_STAGE.ItemDataBound
Try
dbad.SelectCommand.Connection = Session("db_connection")
        Dim dgItem1 As DataGridItem
Dim ddli As Integer
  If (e.Item.ItemIndex = 0) Then
Try
 If (CONN.SF_EXECUTE_SQL ("SELECT NVL(ORDER_TYPE_VISIBLE,'N') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="N") Then
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Order Doc Type*")) Then
dcols(rii).Visible = False
End If
Next
Else
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Order Doc Type*")) Then
dcols(rii).Visible = True
End If
Next
End If
Catch ex As Exception
call insert_sys_log("BILLING_STAGE_ItemDataBound",ex.Message)
End Try
End If
  If (e.Item.ItemIndex = 0) Then
Try
 If (CONN.SF_EXECUTE_SQL(" SELECT NVL(CUSTOMER_ITEM_NO_REQUIRED,'N') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "' ")<>"Y") Then
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Customer Item No")) Then
dcols(rii).Visible = False
dcols(rii+1).Visible = False
End If
Next
Else
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Customer Item No")) Then
dcols(rii).Visible = True
dcols(rii+1).Visible = True
End If
Next
End If
Catch ex As Exception
call insert_sys_log("BILLING_STAGE_ItemDataBound",ex.Message)
End Try
End If
Dim dbkl1 As Integer
dbkl1 = 0
If (e.Item.ItemType = ListItemType.Item Or e.Item.ItemType = ListItemType.AlternatingItem Or e.Item.ItemType = ListItemType.EditItem) Then
    dgItem1 = e.Item
Dim CheckBox0 As CheckBox = CType(dgItem1.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDERS_BILLING_STAGE_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_LINE_NO"), Label)
Dim SD_ORDERS_BILLING_STAGE_STAGE As TextBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_STAGE"), TextBox)
SD_ORDERS_BILLING_STAGE_STAGE.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDERS_BILLING_STAGE_STAGE.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
SD_ORDERS_BILLING_STAGE_STAGE.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE As TextBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE"), TextBox)
SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE"), TextBox)
Dim SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE As CheckBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE"), CheckBox)
SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE.Attributes.Add("OnCheckedChanged", "setDirty();")
 Dim LINE_NO_right_justify as Label = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_LINE_NO"),Label)
LINE_NO_right_justify.Style("text-align") = "right"
 Dim STAGE_maxlength as TextBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_STAGE"),TextBox)
STAGE_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & STAGE_maxlength.ClientID & "',499 );")
 Dim BILLING_PERCENTAGE_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE"),TextBox)
BILLING_PERCENTAGE_right_justify.Style("text-align") = "right"
Dim BILLING_PERCENTAGE_ft As TextBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE"), TextBox)
IF (BILLING_PERCENTAGE_ft.Text<>""  And dbkl1 = 0) Then
mytotal9703+= CDbl(BILLING_PERCENTAGE_ft.Text)
End If
 Dim APPROVED_FOR_INOVICE_ck as CheckBox = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE"),CheckBox)
 Dim APPROVED_FOR_INOVICE_lbl as Label = CType(dgItem1.FindControl("SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE_lbl"),Label)
If (APPROVED_FOR_INOVICE_lbl .Text="Y") Then
APPROVED_FOR_INOVICE_ck.Checked=True
End If
End If
If (e.Item.ItemType = ListItemType.Footer) Then
dim Footer_txt as string
Footer_txt=""
Dim BILLING_PERCENTAGE_footer As Label = CType(e.Item.FindControl("SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE_footer"), Label)
BILLING_PERCENTAGE_footer.Text=Footer_txt & mytotal9703
BILLING_PERCENTAGE_footer.Style("text-align") = "right"
Footer_txt=""
 End If
    dbad.SelectCommand.Connection.Close()
Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
call insert_sys_log("BILLING_STAGE_ItemDataBound",ex.Message)
End Try
    End Sub
Dim mytotal1174 as double
Dim mytotal1214 as double
Dim mytotal1705 as double
  Protected Sub dbgORDERDETAIL_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.DataGridItemEventArgs) Handles dbgORDERDETAIL.ItemDataBound
Try
dbad.SelectCommand.Connection = Session("db_connection")
        Dim dgItem1 As DataGridItem
Dim ddli As Integer
  If (e.Item.ItemIndex = 0) Then
Try
 If (CONN.SF_EXECUTE_SQL ("SELECT NVL(ORDER_TYPE_VISIBLE,'N') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="N") Then
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Order Doc Type*")) Then
dcols(rii).Visible = False
End If
Next
Else
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Order Doc Type*")) Then
dcols(rii).Visible = True
End If
Next
End If
Catch ex As Exception
call insert_sys_log("ORDERDETAIL_ItemDataBound",ex.Message)
End Try
End If
  If (e.Item.ItemIndex = 0) Then
Try
 If (CONN.SF_EXECUTE_SQL(" SELECT NVL(CUSTOMER_ITEM_NO_REQUIRED,'N') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "' ")<>"Y") Then
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Customer Item No")) Then
dcols(rii).Visible = False
dcols(rii+1).Visible = False
End If
Next
Else
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Customer Item No")) Then
dcols(rii).Visible = True
dcols(rii+1).Visible = True
End If
Next
End If
Catch ex As Exception
call insert_sys_log("ORDERDETAIL_ItemDataBound",ex.Message)
End Try
End If
Dim dbkl1 As Integer
dbkl1 = 0
If (e.Item.ItemType = ListItemType.Item Or e.Item.ItemType = ListItemType.AlternatingItem Or e.Item.ItemType = ListItemType.EditItem) Then
    dgItem1 = e.Item
Dim CheckBox0 As CheckBox = CType(dgItem1.FindControl("CheckBox0"), CheckBox)
Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
SD_ORDER_DETAIL_ORDER_DOC_TYPE.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
SD_ORDER_DETAIL_ORDER_LINE_TYPE.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
SD_ORDER_DETAIL_ITEM_NO.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
SD_ORDER_DETAIL_LOT_NO.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim Event_ORDER_CONFIG As Button = CType(dgItem1.FindControl("Event_ORDER_CONFIG"), Button)
Dim Event_ORDER_DETAILS As Button = CType(dgItem1.FindControl("Event_ORDER_DETAILS"), Button)
Event_ORDER_DETAILS.Attributes.Add("onclick", "isDirty = 0;")
Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Attributes.Add("OnCheckedChanged", "setDirty();")
Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
SD_ORDER_DETAIL_DESCRIPTION.Attributes.Add("ondblclick", "getTextValue('" + SD_ORDER_DETAIL_DESCRIPTION.ClientID + "','" + mline_text1.ClientID + "','" + Panel1_mline_test1.ClientID + "','" + mtest_mpext123.ClientID + "','" + mline_label1.ClientID + "');")
SD_ORDER_DETAIL_DESCRIPTION.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
SD_ORDER_DETAIL_ORDER_QTY.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
SD_ORDER_DETAIL_TRIM_SIZE.Attributes.Add("onchange", "setDirty();")
Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
SD_ORDER_DETAIL_ORDER_UOM.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
SD_ORDER_DETAIL_MULTIPLIER.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
SD_ORDER_DETAIL_MSRP_SALES_PRICE.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
SD_ORDER_DETAIL_PRICING_UOM.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
SD_ORDER_DETAIL_SALES_PRICE.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_EXPEDITE As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
SD_ORDER_DETAIL_EXPEDITE.Attributes.Add("OnCheckedChanged", "setDirty();")
Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
SD_ORDER_DETAIL_EXPEDIATE_VALUE.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
SD_ORDER_DETAIL_DRAWING_NO.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
SD_ORDER_DETAIL_LICENSE_NO.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
SD_ORDER_DETAIL_END_USER_CODE.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
SD_ORDER_DETAIL_AM_CODE.Attributes.Add("onchange", "setDirty();")
Dim SD_ORDER_DETAIL_SPIF As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
SD_ORDER_DETAIL_SPIF.Attributes.Add("OnCheckedChanged", "setDirty();")
Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim SD_ORDER_DETAIL_ATEX As CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
SD_ORDER_DETAIL_ATEX.Attributes.Add("OnCheckedChanged", "setDirty();")
Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
SD_ORDER_DETAIL_PO_LINE_NO.Attributes.Add("onchange", "setDirty();")
Dim Event_ORDER_ATP As Button = CType(dgItem1.FindControl("Event_ORDER_ATP"), Button)
Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" ) Then
SD_ORDER_DETAIL_ITEM_NO.Attributes.Add("ontouchmove", "open_window_drdl('ITEMS.aspx?ITEM_NO=','" & SD_ORDER_DETAIL_ITEM_NO.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_DETAIL_ITEM_NO.Attributes.Add("ondblclick", "open_window_drdlbd('ITEMS.aspx?ITEM_NO=','" & SD_ORDER_DETAIL_ITEM_NO.ClientID & "');")
Else
SD_ORDER_DETAIL_ITEM_NO.Attributes.Add("ondblclick", "open_window_drdl('ITEMS.aspx?ITEM_NO=','" & SD_ORDER_DETAIL_ITEM_NO.ClientID & "');")
End If
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" ) Then
SD_ORDER_DETAIL_LOT_NO.Attributes.Add("ontouchmove", "open_window_drdl('INVENTORY_LOT_STATUS.aspx?LOT_NO=','" & SD_ORDER_DETAIL_LOT_NO.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_DETAIL_LOT_NO.Attributes.Add("ondblclick", "open_window_drdlbd('INVENTORY_LOT_STATUS.aspx?LOT_NO=','" & SD_ORDER_DETAIL_LOT_NO.ClientID & "');")
Else
SD_ORDER_DETAIL_LOT_NO.Attributes.Add("ondblclick", "open_window_drdl('INVENTORY_LOT_STATUS.aspx?LOT_NO=','" & SD_ORDER_DETAIL_LOT_NO.ClientID & "');")
End If
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" ) Then
SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.Attributes.Add("ontouchmove", "open_window_drdl('ITEMS.aspx?ITEM_NO='+ document.getElementById('" & SD_ORDER_DETAIL_ITEM_NO.CLIENTID & "').value+'&CUSTOMER_ITEM_NO=','" & SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.Attributes.Add("ondblclick", "open_window_drdlbd('ITEMS.aspx?ITEM_NO='+ document.getElementById('" & SD_ORDER_DETAIL_ITEM_NO.CLIENTID & "').value+'&CUSTOMER_ITEM_NO=','" & SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.ClientID & "');")
Else
SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.Attributes.Add("ondblclick", "open_window_drdl('ITEMS.aspx?ITEM_NO='+ document.getElementById('" & SD_ORDER_DETAIL_ITEM_NO.CLIENTID & "').value+'&CUSTOMER_ITEM_NO=','" & SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.ClientID & "');")
End If
End If
if (Session("HIDE_MENU_OPTIONS") = "Y" ) Then
SD_ORDER_DETAIL_LICENSE_NO.Attributes.Add("ontouchmove", "open_window_drdl('LICENSE.aspx?LICENSE_no=','" & SD_ORDER_DETAIL_LICENSE_NO.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_ORDER_DETAIL_LICENSE_NO.Attributes.Add("ondblclick", "open_window_drdlbd('LICENSE.aspx?LICENSE_no=','" & SD_ORDER_DETAIL_LICENSE_NO.ClientID & "');")
Else
SD_ORDER_DETAIL_LICENSE_NO.Attributes.Add("ondblclick", "open_window_drdl('LICENSE.aspx?LICENSE_no=','" & SD_ORDER_DETAIL_LICENSE_NO.ClientID & "');")
End If
End If
Dim LOVORDER_ITEMS_LOV1171 As ImageButton=CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1175 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
Dim LOVUOM_CONVERSION_LOV1178 As ImageButton=CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
Dim LOVCUSTOMER_ITEM_NO15997 As ImageButton=CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
Dim LOVLOV_MULTIPLIER18023 As ImageButton=CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
Dim LOVEXPEDITE_LOV18034 As ImageButton=CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
Dim LOVLICENSE_NO_LOV18551 As ImageButton=CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
Dim LOVEND_USER_CODE_LOV18556 As ImageButton=CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
Dim LOVLOT_ITEM_SNO_CUSTLOC19156 As ImageButton=CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
If (SD_ORDER_DETAIL_DESCRIPTION.Text<>"") Then
SD_ORDER_DETAIL_DESCRIPTION.height=conn.gettextboxheight( SD_ORDER_DETAIL_DESCRIPTION.Text,SD_ORDER_DETAIL_DESCRIPTION.width.Tostring())
End If
SD_ORDER_DETAIL_ITEM_NO.Attributes.Add("onblur", "this.value = this.value.toUpperCase()")
SD_ORDER_DETAIL_ORDER_UOM.Attributes.Add("onblur", "this.value = this.value.toUpperCase()")
SD_ORDER_DETAIL_PRICING_UOM.Attributes.Add("onblur", "this.value = this.value.toUpperCase()")
SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.Attributes.Add("onblur", "this.value = this.value.toUpperCase()")
SD_ORDER_DETAIL_LOT_NO.Attributes.Add("onblur", "this.value = this.value.toUpperCase()")
 Dim LINE_NO_right_justify as Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"),Label)
LINE_NO_right_justify.Style("text-align") = "right"
If ((CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 ) AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y")) Then
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=True
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
SD_ORDER_DETAIL_ORDER_QTY.Enabled=True
SD_ORDER_DETAIL_ORDER_QTY.ReadOnly=False
Else
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=False
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
SD_ORDER_DETAIL_ORDER_QTY.Enabled=True
SD_ORDER_DETAIL_ORDER_QTY.ReadOnly=True
End If
If ((CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y")) Then
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=True
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
SD_ORDER_DETAIL_ORDER_QTY.Enabled=True
SD_ORDER_DETAIL_ORDER_QTY.ReadOnly=False
SD_ORDER_DETAIL_DESCRIPTION.Enabled=True
SD_ORDER_DETAIL_DESCRIPTION.ReadOnly=False
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=False
EVENT_ORDER_DETAILS.Enabled=True
SD_ORDER_DETAIL_DUE_DATE.Enabled=True
SD_ORDER_DETAIL_REQUESTED_SHIP_DATE.Enabled=True
SD_ORDER_DETAIL_ORDER_DOC_TYPE.Enabled=True
LOVUOM_CONVERSION_LOV1175.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.ReadOnly=False
LOVUOM_CONVERSION_LOV1178.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.ReadOnly=False
SD_ORDER_DETAIL_SPIF.Enabled=True
SD_ORDER_DETAIL_CE.Enabled=True
SD_ORDER_DETAIL_ATEX.Enabled=True
SD_ORDER_DETAIL_ORDER_LINE_TYPE.Enabled=True
Else
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=False
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
SD_ORDER_DETAIL_ORDER_QTY.Enabled=True
SD_ORDER_DETAIL_ORDER_QTY.ReadOnly=True
SD_ORDER_DETAIL_DESCRIPTION.Enabled=True
SD_ORDER_DETAIL_DESCRIPTION.ReadOnly=True
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=True
EVENT_ORDER_DETAILS.Enabled=False
SD_ORDER_DETAIL_DUE_DATE.Enabled=False
SD_ORDER_DETAIL_REQUESTED_SHIP_DATE.Enabled=False
SD_ORDER_DETAIL_ORDER_DOC_TYPE.Enabled=False
LOVUOM_CONVERSION_LOV1175.Enabled=False
SD_ORDER_DETAIL_ORDER_UOM.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.ReadOnly=True
LOVUOM_CONVERSION_LOV1178.Enabled=False
SD_ORDER_DETAIL_PRICING_UOM.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.ReadOnly=True
SD_ORDER_DETAIL_SPIF.Enabled=False
SD_ORDER_DETAIL_CE.Enabled=False
SD_ORDER_DETAIL_ATEX.Enabled=False
SD_ORDER_DETAIL_ORDER_LINE_TYPE.Enabled=False
End If
 Dim LINE_NO_Frules as Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"),Label)
 if LINE_NO_Frules.Text <> "" Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y")) Then
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=True
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
SD_ORDER_DETAIL_ORDER_QTY.Enabled=True
SD_ORDER_DETAIL_ORDER_QTY.ReadOnly=False
SD_ORDER_DETAIL_ORDER_LINE_TYPE.Enabled=True
Else
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=False
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
SD_ORDER_DETAIL_ORDER_QTY.Enabled=True
SD_ORDER_DETAIL_ORDER_QTY.ReadOnly=True
SD_ORDER_DETAIL_ORDER_LINE_TYPE.Enabled=False
End If
If (CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" & SD_ORDER_DETAIL_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<> "Close") Then
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=False
Else
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=True
End If
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM SD_PACKING_SLIP_DETAIL WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y")) Then
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
Else
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
End If
 if (SD_ORDER_DETAIL_LINE_NO.Text <> "") Then
Dim dbsqlst15  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  SHIPED_QTY FROM V_ORDER_SHIPED_QTY WHERE ORDER_NO = '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'  AND ORDER_LINE_NO = '" & SD_ORDER_DETAIL_LINE_NO.TEXT & " '"
dbsqlst15.Clear()
dbad.Fill(dbsqlst15)
if (dbsqlst15.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst15.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
DISP_SHIP_QTY.Text=dbsqlst15.Tables(0).Rows(0)(0)
Else
DISP_SHIP_QTY.Text=""
End If
End If
End If
End If
 Dim ORDER_DOC_TYPE_ddl as DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"),DropDownList)
 Dim ORDER_DOC_TYPE_lbl as Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE_lbl"),Label)
ORDER_DOC_TYPE_ddl.Items.clear()
ORDER_DOC_TYPE_ddl.Items.Add("")
ORDER_DOC_TYPE_ddl.Items.Add("")
ORDER_DOC_TYPE_ddl.Items(1).Text="Part"
ORDER_DOC_TYPE_ddl.Items(1).Value="P"
ORDER_DOC_TYPE_ddl.Items.Add("")
ORDER_DOC_TYPE_ddl.Items(2).Text="Extra Charge"
ORDER_DOC_TYPE_ddl.Items(2).Value="E"
ORDER_DOC_TYPE_ddl.Items.Add("")
ORDER_DOC_TYPE_ddl.Items(3).Text="Wet End"
ORDER_DOC_TYPE_ddl.Items(3).Value="WE"
ORDER_DOC_TYPE_ddl.Items.Add("")
ORDER_DOC_TYPE_ddl.Items(4).Text="Complete Pump"
ORDER_DOC_TYPE_ddl.Items(4).Value="CP"
For ddli = 0 To ORDER_DOC_TYPE_ddl.Items.Count-1
    If (ORDER_DOC_TYPE_lbl.Text<>"") Then
    If (ORDER_DOC_TYPE_ddl.Items(ddli).Value = ORDER_DOC_TYPE_lbl.Text) Then
ORDER_DOC_TYPE_ddl.SelectedIndex = ddli
        Exit For
    End If
    End If
Next
If ((SD_ORDER_DETAIL_ORDER_DOC_TYPE.selecteditem.value="P" OR  SD_ORDER_DETAIL_ORDER_DOC_TYPE.selecteditem.value="E") AND CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0) Then
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
Else
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
End If
 if (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SelectedIndex >=0) Then
End If
 if (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SelectedIndex >=0) Then
End If
 Dim ORDER_DOC_TYPE_Frules as DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"),DropDownList)
 if ORDER_DOC_TYPE_Frules.SelectedIndex >=0 Then
If (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="CP") Then
SD_ORDER_DETAIL_SPIF.Visible=True
Else
SD_ORDER_DETAIL_SPIF.Visible=False
End If
If (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="CP") Then
SD_ORDER_DETAIL_CE.Visible=True
Else
SD_ORDER_DETAIL_CE.Visible=False
End If
If (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="CP") Then
SD_ORDER_DETAIL_ATEX.Visible=True
Else
SD_ORDER_DETAIL_ATEX.Visible=False
End If
 if (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SelectedIndex >=0) Then
End If
If (SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="CP" OR SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="WE") Then
EVENT_ORDER_CONFIG.Visible=True
Else
EVENT_ORDER_CONFIG.Visible=False
End If
End If
 Dim ORDER_LINE_TYPE_ddl as DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"),DropDownList)
 Dim ORDER_LINE_TYPE_lbl as Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE_lbl"),Label)
ORDER_LINE_TYPE_ddl.Items.clear()
ORDER_LINE_TYPE_ddl.Items.Add("")
ORDER_LINE_TYPE_ddl.Items.Add("")
ORDER_LINE_TYPE_ddl.Items(1).Text="Create Work order"
ORDER_LINE_TYPE_ddl.Items(1).Value="CREATE_WO"
ORDER_LINE_TYPE_ddl.Items.Add("")
ORDER_LINE_TYPE_ddl.Items(2).Text="Pull from Stock"
ORDER_LINE_TYPE_ddl.Items(2).Value="PULL_STOCK"
ORDER_LINE_TYPE_ddl.Items.Add("")
ORDER_LINE_TYPE_ddl.Items(3).Text="Pull From QRC Stock"
ORDER_LINE_TYPE_ddl.Items(3).Value="PULL_QRC_STOCK"
For ddli = 0 To ORDER_LINE_TYPE_ddl.Items.Count-1
    If (ORDER_LINE_TYPE_lbl.Text<>"") Then
    If (ORDER_LINE_TYPE_ddl.Items(ddli).Value = ORDER_LINE_TYPE_lbl.Text) Then
ORDER_LINE_TYPE_ddl.SelectedIndex = ddli
        Exit For
    End If
    End If
Next
 Dim ORDER_LINE_TYPE_Frules as DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"),DropDownList)
 if ORDER_LINE_TYPE_Frules.SelectedIndex >=0 Then
If (SD_ORDER_DETAIL_ORDER_LINE_TYPE.selecteditem.value<>"PULL_QRC_STOCK") Then
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
Else
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
End If
If (SD_ORDER_DETAIL_ORDER_LINE_TYPE.SELECTEDITEM.VALUE="CREATE_WO") Then
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=True
Else
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=False
End If
 if (SD_ORDER_DETAIL_ORDER_LINE_TYPE.SelectedIndex >=0) Then
End If
If (SD_ORDER_DETAIL_ORDER_LINE_TYPE.SELECTEDITEM.VALUE="PULL_QRC_STOCK") Then
LOVLOT_ITEM_SNO_CUSTLOC19156.Visible=True
SD_ORDER_DETAIL_LOT_NO.Visible=True
SD_ORDER_DETAIL_SERIAL_NO.Visible=True
Else
LOVLOT_ITEM_SNO_CUSTLOC19156.Visible=False
SD_ORDER_DETAIL_LOT_NO.Visible=False
SD_ORDER_DETAIL_SERIAL_NO.Visible=False
End If
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_CLOSED_ORDER( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SESSION("USER_ID") & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "')")="Y")) Then
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=True
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
SD_ORDER_DETAIL_ORDER_QTY.Enabled=True
SD_ORDER_DETAIL_ORDER_QTY.ReadOnly=False
EVENT_ORDER_CONFIG.Enabled=True
Else
SD_ORDER_DETAIL_CREATE_WORK_ORDER.Enabled=False
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
SD_ORDER_DETAIL_ORDER_QTY.Enabled=True
SD_ORDER_DETAIL_ORDER_QTY.ReadOnly=True
EVENT_ORDER_CONFIG.Enabled=False
End If
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM SD_PACKING_SLIP_DETAIL WHERE ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y")) Then
LOVORDER_ITEMS_LOV1171.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=False
Else
LOVORDER_ITEMS_LOV1171.Enabled=False
SD_ORDER_DETAIL_ITEM_NO.Enabled=True
SD_ORDER_DETAIL_ITEM_NO.ReadOnly=True
End If
End If
 Dim ITEM_NO_maxlength as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"),TextBox)
ITEM_NO_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & ITEM_NO_maxlength.ClientID & "',59 );")
 Dim ORDER_DOC_TYPE1171_lov as DropDownList = dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE")
            Dim oprp4 As ImageButton = CType(dgItem1.FindControl("LOVORDER_ITEMS_LOV1171"), ImageButton)
            Dim ITEM_NO_lov As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
            oprp4.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_ITEM_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_ITEM_NO.ClientID & "').value; else sval=''; if (document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "').value; else x1=''; if (document.getElementById('" & ORDER_DOC_TYPE1171_lov.ClientID & "') != null) x2=document.getElementById('" & ORDER_DOC_TYPE1171_lov.ClientID & "').value; else x2='';  window.open('ORDER_ITEMS_LOV.aspx?RETURN_ID="  & ITEM_NO_lov.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) + '&param2='+ encodeURIComponent(x2) ,'WIND1','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
            oprp4.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_ITEM_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_ITEM_NO.ClientID & "').value; else sval=''; if (document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_ITEM_NO.ClientID & "').value; else x1=''; if (document.getElementById('" & ORDER_DOC_TYPE1171_lov.ClientID & "') != null) x2=document.getElementById('" & ORDER_DOC_TYPE1171_lov.ClientID & "').value; else x2='';  strReturn=window.showModalDialog('ORDER_ITEMS_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) + '&param2='+ encodeURIComponent(x2) ,null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & ITEM_NO_lov.ClientID & "').value=strReturn;isDirty = 1;}")
End If
If (1=2) Then
SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE.Visible=True
Else
SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE.Visible=False
End If
If (CONN.SF_EXECUTE_SQL ("SELECT EDIT_SHIP_DELIVERY_DATE FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="S") Then
SD_ORDER_DETAIL_DUE_DATE.Enabled=True
Else
SD_ORDER_DETAIL_DUE_DATE.Enabled=False
End If
If ((SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="WE" OR SD_ORDER_DETAIL_ORDER_DOC_TYPE.SELECTEDITEM.VALUE="CP") AND (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0)) Then
EVENT_ORDER_CONFIG.Visible=True
Else
EVENT_ORDER_CONFIG.Visible=False
End If
If ((CONN.SF_EXECUTE_SQL("SELECT COUNT(1) FROM SD_PRODUCT_CONFIGURATOR WHERE ORDER_NO ='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "'  AND ORDER_LINE_NO = '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "'")="0") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y")) Then
SD_ORDER_DETAIL_ORDER_DOC_TYPE.Enabled=True
Else
SD_ORDER_DETAIL_ORDER_DOC_TYPE.Enabled=False
End If
If (SD_ORDER_HEADER_SHIP_COMPLETE.CHECKED=FALSE) Then
SD_ORDER_DETAIL_DUE_DATE.Enabled=True
Else
SD_ORDER_DETAIL_DUE_DATE.Enabled=False
End If
 if (SD_ORDER_DETAIL_ITEM_NO.Text <> ""  ) Then
End If
 if (SD_ORDER_DETAIL_ITEM_NO.Text <> ""  ) Then
End If
 Dim ITEM_NO_Frules as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"),TextBox)
 if (ITEM_NO_Frules.Text <> "" or ITEM_NO_Frules.Text = "" ) Then
If ((SD_ORDER_HEADER_BLANKET_ORDER.CHECKED=FALSE) AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_CLOSED_ORDER( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SESSION("USER_ID") & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "')")="Y")) Then
LOVUOM_CONVERSION_LOV1175.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.ReadOnly=False
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=False
LOVUOM_CONVERSION_LOV1178.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.ReadOnly=False
Else
LOVUOM_CONVERSION_LOV1175.Enabled=False
SD_ORDER_DETAIL_ORDER_UOM.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.ReadOnly=True
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=True
LOVUOM_CONVERSION_LOV1178.Enabled=False
SD_ORDER_DETAIL_PRICING_UOM.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.ReadOnly=True
End If
 if (SD_ORDER_DETAIL_ITEM_NO.Text <> ""  ) Then
End If
 if (SD_ORDER_DETAIL_ITEM_NO.Text <> ""  ) Then
End If
 if (SD_ORDER_DETAIL_ITEM_NO.Text <> ""  ) Then
End If
End If
 Dim LICENSE_TIED_UP_LINE_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"),TextBox)
LICENSE_TIED_UP_LINE_right_justify.Style("text-align") = "right"
 if (SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.Text <> ""  ) Then
End If
 if (SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE.Text <> ""  ) Then
Dim dbsqlst54  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  CASE     when LICENSE_EXPIRY_DATE-TRUNC(SYSDATE) between 0 and 60    THEN '<FONT COLOR=RED>License Expire in <60 Days'     ELSE      NULL   END  FROM sd_license WHERE LICENSE_NO='" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "'"
dbsqlst54.Clear()
dbad.Fill(dbsqlst54)
if (dbsqlst54.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst54.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
MSG_LICENSE.Text=dbsqlst54.Tables(0).Rows(0)(0)
Else
MSG_LICENSE.Text=""
End If
End If
End If
 Dim LOT_NO_maxlength as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"),TextBox)
LOT_NO_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & LOT_NO_maxlength.ClientID & "',149 );")
            Dim oprp6 As ImageButton = CType(dgItem1.FindControl("LOVLOT_ITEM_SNO_CUSTLOC19156"), ImageButton)
            Dim LOT_NO_lov As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
            oprp6.Attributes.Add("OnClick", "var strReturn,sval; if (document.getElementById('" & SD_ORDER_DETAIL_LOT_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_LOT_NO.ClientID & "').value; else sval=''; strReturn=window.open('LOT_ITEM_SNO_CUSTLOC.aspx?RETURN_ID="  & LOT_NO_lov.ClientID & "&sval='+encodeURIComponent(sval),'WIND1','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
            oprp6.Attributes.Add("OnClick", "var strReturn,sval; if (document.getElementById('" & SD_ORDER_DETAIL_LOT_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_LOT_NO.ClientID & "').value; else sval=''; strReturn=window.showModalDialog('LOT_ITEM_SNO_CUSTLOC.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & LOT_NO_lov.ClientID & "').value=strReturn;isDirty = 1;}")
End If
 if (SD_ORDER_DETAIL_LOT_NO.Text <> ""  ) Then
End If
 if (SD_ORDER_DETAIL_LOT_NO.Text <> ""  ) Then
End If
 if (SD_ORDER_DETAIL_LOT_NO.Text <> ""  ) Then
End If
 Dim CREATE_WORK_ORDER_ck as CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"),CheckBox)
 Dim CREATE_WORK_ORDER_lbl as Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER_lbl"),Label)
If (CREATE_WORK_ORDER_lbl .Text="Y") Then
CREATE_WORK_ORDER_ck.Checked=True
End If
 Dim CUSTOMER_ITEM_NO_maxlength as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"),TextBox)
CUSTOMER_ITEM_NO_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & CUSTOMER_ITEM_NO_maxlength.ClientID & "',59 );")
            Dim oprp11 As ImageButton = CType(dgItem1.FindControl("LOVCUSTOMER_ITEM_NO15997"), ImageButton)
            Dim CUSTOMER_ITEM_NO_lov As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
            oprp11.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.ClientID & "').value; else sval=''; if(document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1=''; window.open('CUSTOMER_ITEM_NO.aspx?RETURN_ID="  & CUSTOMER_ITEM_NO_lov.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIND1','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
            oprp11.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.ClientID & "').value; else sval=''; if(document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1=''; strReturn=window.showModalDialog('CUSTOMER_ITEM_NO.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:1000px;dialogHeight:700px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & CUSTOMER_ITEM_NO_lov.ClientID & "').value=strReturn;isDirty = 1;}")
End If
 if (SD_ORDER_DETAIL_CUSTOMER_ITEM_NO.Text <> ""  ) Then
End If
 Dim CUSTOMER_ITEM_NO_Frules as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"),TextBox)
 if (CUSTOMER_ITEM_NO_Frules.Text <> "" or CUSTOMER_ITEM_NO_Frules.Text = "" ) Then
If (CONN.SF_EXECUTE_SQL("SELECT COUNT(*) FROM MFG_WO_SALES_ORDERS WHERE SALES_ORDER_NO='" & SD_ORDER_HEADER_ORDER_NO.TEXT & "' AND ORDER_LINE_NO='" & SD_ORDER_DETAIL_LINE_NO.TEXT & "' ")=0 AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_ORDER_CHANGE( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "','L','" & SESSION("USER_ID") & "')")="Y") AND (CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_ACCESS_FOR_CLOSED_ORDER( '" & SD_ORDER_HEADER_ORDER_NO.TEXT & "','" & SESSION("USER_ID") & "', '" & SD_ORDER_DETAIL_LINE_NO.TEXT & "')")="Y")) Then
LOVUOM_CONVERSION_LOV1175.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.ReadOnly=False
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=False
LOVUOM_CONVERSION_LOV1178.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.ReadOnly=False
Else
LOVUOM_CONVERSION_LOV1175.Enabled=False
SD_ORDER_DETAIL_ORDER_UOM.Enabled=True
SD_ORDER_DETAIL_ORDER_UOM.ReadOnly=True
SD_ORDER_DETAIL_SALES_PRICE.Enabled=True
SD_ORDER_DETAIL_SALES_PRICE.ReadOnly=True
LOVUOM_CONVERSION_LOV1178.Enabled=False
SD_ORDER_DETAIL_PRICING_UOM.Enabled=True
SD_ORDER_DETAIL_PRICING_UOM.ReadOnly=True
End If
End If
 Dim DESCRIPTION_maxlength as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"),TextBox)
DESCRIPTION_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & DESCRIPTION_maxlength.ClientID & "',3999 );")
 Dim ORDER_QTY_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"),TextBox)
ORDER_QTY_right_justify.Style("text-align") = "right"
Dim ORDER_QTY_ft As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
IF (ORDER_QTY_ft.Text<>""  And dbkl1 = 0) Then
mytotal1174+= CDbl(ORDER_QTY_ft.Text)
End If
 if (SD_ORDER_DETAIL_ORDER_QTY.Text <> ""  ) Then
End If
 Dim TRIM_SIZE_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"),TextBox)
TRIM_SIZE_right_justify.Style("text-align") = "right"
 if (SD_ORDER_DETAIL_TRIM_SIZE.Text <> ""  ) Then
End If
 Dim DISP_SHIP_QTY_right_justify as Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"),Label)
DISP_SHIP_QTY_right_justify.Style("text-align") = "right"
 Dim ORDER_UOM_maxlength as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"),TextBox)
ORDER_UOM_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & ORDER_UOM_maxlength.ClientID & "',9 );")
 Dim ITEM_NO1175_lov as Textbox = dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO")
            Dim oprp19 As ImageButton = CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1175"), ImageButton)
            Dim ORDER_UOM_lov As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
            oprp19.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_ORDER_UOM.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_ORDER_UOM.ClientID & "').value; else sval=''; if (document.getElementById('" & ITEM_NO1175_lov.ClientID & "') != null) x1=document.getElementById('" & ITEM_NO1175_lov.ClientID & "').value; else x1=''; if (document.getElementById('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "') != null) x2=document.getElementById('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "').value; else x2='';  window.open('UOM_CONVERSION_LOV.aspx?RETURN_ID="  & ORDER_UOM_lov.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) + '&param2='+ encodeURIComponent(x2) ,'WIND1','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
            oprp19.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_ORDER_UOM.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_ORDER_UOM.ClientID & "').value; else sval=''; if (document.getElementById('" & ITEM_NO1175_lov.ClientID & "') != null) x1=document.getElementById('" & ITEM_NO1175_lov.ClientID & "').value; else x1=''; if (document.getElementById('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "') != null) x2=document.getElementById('" & SD_ORDER_HEADER_ORDERING_UOM.ClientID & "').value; else x2='';  strReturn=window.showModalDialog('UOM_CONVERSION_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) + '&param2='+ encodeURIComponent(x2) ,null,'status:no;dialogWidth:800px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & ORDER_UOM_lov.ClientID & "').value=strReturn;isDirty = 1;}")
End If
 Dim MULTIPLIER_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"),TextBox)
MULTIPLIER_right_justify.Style("text-align") = "right"
            Dim oprp20 As ImageButton = CType(dgItem1.FindControl("LOVLOV_MULTIPLIER18023"), ImageButton)
            Dim MULTIPLIER_lov As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
            oprp20.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_MULTIPLIER.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_MULTIPLIER.ClientID & "').value; else sval=''; if(document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1=''; window.open('LOV_MULTIPLIER.aspx?RETURN_ID="  & MULTIPLIER_lov.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIND1','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
            oprp20.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_MULTIPLIER.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_MULTIPLIER.ClientID & "').value; else sval=''; if(document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1=''; strReturn=window.showModalDialog('LOV_MULTIPLIER.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:1000px;dialogHeight:700px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & MULTIPLIER_lov.ClientID & "').value=strReturn;isDirty = 1;}")
End If
 if (SD_ORDER_DETAIL_MULTIPLIER.Text <> ""  ) Then
End If
 if (SD_ORDER_DETAIL_MULTIPLIER.Text <> ""  ) Then
End If
 Dim MSRP_SALES_PRICE_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"),TextBox)
MSRP_SALES_PRICE_right_justify.Style("text-align") = "right"
 if (SD_ORDER_DETAIL_MSRP_SALES_PRICE.Text <> ""  ) Then
End If
 if (SD_ORDER_DETAIL_MSRP_SALES_PRICE.Text <> ""  ) Then
End If
 Dim PRICING_UOM_maxlength as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"),TextBox)
PRICING_UOM_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & PRICING_UOM_maxlength.ClientID & "',9 );")
 Dim ITEM_NO1178_lov as Textbox = dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO")
            Dim oprp22 As ImageButton = CType(dgItem1.FindControl("LOVUOM_CONVERSION_LOV1178"), ImageButton)
            Dim PRICING_UOM_lov As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
            oprp22.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_PRICING_UOM.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_PRICING_UOM.ClientID & "').value; else sval=''; if (document.getElementById('" & ITEM_NO1178_lov.ClientID & "') != null) x1=document.getElementById('" & ITEM_NO1178_lov.ClientID & "').value; else x1=''; window.open('UOM_CONVERSION_LOV.aspx?RETURN_ID="  & PRICING_UOM_lov.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIND1','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
            oprp22.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_PRICING_UOM.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_PRICING_UOM.ClientID & "').value; else sval=''; if (document.getElementById('" & ITEM_NO1178_lov.ClientID & "') != null) x1=document.getElementById('" & ITEM_NO1178_lov.ClientID & "').value; else x1=''; strReturn=window.showModalDialog('UOM_CONVERSION_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:800px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & PRICING_UOM_lov.ClientID & "').value=strReturn;isDirty = 1;}")
End If
 Dim SALES_PRICE_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"),TextBox)
SALES_PRICE_right_justify.Style("text-align") = "right"
 if (SD_ORDER_DETAIL_SALES_PRICE.Text <> ""  ) Then
End If
 Dim EXPEDITE_ck as CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"),CheckBox)
 Dim EXPEDITE_lbl as Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE_lbl"),Label)
If (EXPEDITE_lbl .Text="Y") Then
EXPEDITE_ck.Checked=True
End If
 Dim EXPEDITE_Frules as CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"),CheckBox)
 if (EXPEDITE_Frules.Checked = True  or EXPEDITE_Frules.Checked = False) Then
If (SD_ORDER_DETAIL_EXPEDITE.CHECKED="TRUE") Then
LOVEXPEDITE_LOV18034.Visible=True
SD_ORDER_DETAIL_EXPEDIATE_VALUE.Visible=True
Else
LOVEXPEDITE_LOV18034.Visible=False
SD_ORDER_DETAIL_EXPEDIATE_VALUE.Visible=False
End If
 if (SD_ORDER_DETAIL_EXPEDITE.Checked = True  ) Then
End If
End If
 Dim EXPEDIATE_VALUE_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"),TextBox)
EXPEDIATE_VALUE_right_justify.Style("text-align") = "right"
 Dim ORDER_DOC_TYPE18034_lov as DropDownList = dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE")
            Dim oprp25 As ImageButton = CType(dgItem1.FindControl("LOVEXPEDITE_LOV18034"), ImageButton)
            Dim EXPEDIATE_VALUE_lov As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
            oprp25.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.ClientID & "').value; else sval=''; if (document.getElementById('" & ORDER_DOC_TYPE18034_lov.ClientID & "') != null) x1=document.getElementById('" & ORDER_DOC_TYPE18034_lov.ClientID & "').value; else x1=''; window.open('EXPEDITE_LOV.aspx?RETURN_ID="  & EXPEDIATE_VALUE_lov.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIND1','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
            oprp25.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_EXPEDIATE_VALUE.ClientID & "').value; else sval=''; if (document.getElementById('" & ORDER_DOC_TYPE18034_lov.ClientID & "') != null) x1=document.getElementById('" & ORDER_DOC_TYPE18034_lov.ClientID & "').value; else x1=''; strReturn=window.showModalDialog('EXPEDITE_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:1000px;dialogHeight:700px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & EXPEDIATE_VALUE_lov.ClientID & "').value=strReturn;isDirty = 1;}")
End If
 if (SD_ORDER_DETAIL_EXPEDIATE_VALUE.Text <> ""  ) Then
End If
 if (SD_ORDER_DETAIL_EXPEDIATE_VALUE.Text <> ""  ) Then
End If
 if (SD_ORDER_DETAIL_EXPEDIATE_VALUE.Text <> ""  ) Then
End If
 Dim LINE_EXTENDED_AMOUNT_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"),TextBox)
LINE_EXTENDED_AMOUNT_right_justify.Style("text-align") = "right"
Dim LINE_EXTENDED_AMOUNT_ft As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
IF (LINE_EXTENDED_AMOUNT_ft.Text<>""  And dbkl1 = 0) Then
mytotal1214+= CDbl(LINE_EXTENDED_AMOUNT_ft.Text)
End If
 Dim EXTRA_CHARGE_AMOUNT_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"),TextBox)
EXTRA_CHARGE_AMOUNT_right_justify.Style("text-align") = "right"
 Dim LINE_TOTAL_AMOUNT_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"),TextBox)
LINE_TOTAL_AMOUNT_right_justify.Style("text-align") = "right"
Dim LINE_TOTAL_AMOUNT_ft As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
IF (LINE_TOTAL_AMOUNT_ft.Text<>""  And dbkl1 = 0) Then
mytotal1705+= CDbl(LINE_TOTAL_AMOUNT_ft.Text)
End If
 Dim DRAWING_NO_maxlength as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"),TextBox)
DRAWING_NO_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & DRAWING_NO_maxlength.ClientID & "',29 );")
 Dim LICENSE_NO_maxlength as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"),TextBox)
LICENSE_NO_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & LICENSE_NO_maxlength.ClientID & "',29 );")
            Dim oprp40 As ImageButton = CType(dgItem1.FindControl("LOVLICENSE_NO_LOV18551"), ImageButton)
            Dim LICENSE_NO_lov As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
            oprp40.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_LICENSE_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_LICENSE_NO.ClientID & "').value; else sval=''; if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1=''; if (document.getElementById('" & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "') != null) x2=document.getElementById('" & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "').value; else x2='';  window.open('LICENSE_NO_LOV.aspx?RETURN_ID="  & LICENSE_NO_lov.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) + '&param2='+ encodeURIComponent(x2) ,'WIND1','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
            oprp40.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_LICENSE_NO.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_LICENSE_NO.ClientID & "').value; else sval=''; if (document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "') != null) x1=document.getElementById('" & SD_ORDER_HEADER_CUSTOMER_NO.ClientID & "').value; else x1=''; if (document.getElementById('" & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "') != null) x2=document.getElementById('" & SD_ORDER_HEADER_ULTIMATE_CONSIGNMENT.ClientID & "').value; else x2='';  strReturn=window.showModalDialog('LICENSE_NO_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) + '&param2='+ encodeURIComponent(x2) ,null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & LICENSE_NO_lov.ClientID & "').value=strReturn;isDirty = 1;}")
End If
 if (SD_ORDER_DETAIL_LICENSE_NO.Text <> ""  ) Then
Dim dbsqlst403  as new Data.Dataset
dbad.SelectCommand.CommandText ="SELECT  CASE     when LICENSE_EXPIRY_DATE-TRUNC(SYSDATE) between 0 and 60    THEN '<FONT COLOR=RED>License Expire in <60 Days'     ELSE      NULL   END  FROM sd_license WHERE LICENSE_NO='" & SD_ORDER_DETAIL_LICENSE_NO.TEXT & "'"
dbsqlst403.Clear()
dbad.Fill(dbsqlst403)
if (dbsqlst403.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst403.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
MSG_LICENSE.Text=dbsqlst403.Tables(0).Rows(0)(0)
Else
MSG_LICENSE.Text=""
End If
End If
End If
 Dim END_USER_CODE_maxlength as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"),TextBox)
END_USER_CODE_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & END_USER_CODE_maxlength.ClientID & "',29 );")
 Dim LICENSE_NO18556_lov as Textbox = dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO")
            Dim oprp41 As ImageButton = CType(dgItem1.FindControl("LOVEND_USER_CODE_LOV18556"), ImageButton)
            Dim END_USER_CODE_lov As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
            oprp41.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_END_USER_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_END_USER_CODE.ClientID & "').value; else sval=''; if (document.getElementById('" & LICENSE_NO18556_lov.ClientID & "') != null) x1=document.getElementById('" & LICENSE_NO18556_lov.ClientID & "').value; else x1=''; window.open('END_USER_CODE_LOV.aspx?RETURN_ID="  & END_USER_CODE_lov.ClientID & "&sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,'WIND1','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
            oprp41.Attributes.Add("OnClick", "var strReturn,sval,x1,x2,x3,x4,x5,x6; if (document.getElementById('" & SD_ORDER_DETAIL_END_USER_CODE.ClientID & "') != null) sval=document.getElementById('" & SD_ORDER_DETAIL_END_USER_CODE.ClientID & "').value; else sval=''; if (document.getElementById('" & LICENSE_NO18556_lov.ClientID & "') != null) x1=document.getElementById('" & LICENSE_NO18556_lov.ClientID & "').value; else x1=''; strReturn=window.showModalDialog('END_USER_CODE_LOV.aspx?sval='+encodeURIComponent(sval)+'&param1='+ encodeURIComponent(x1) ,null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & END_USER_CODE_lov.ClientID & "').value=strReturn;isDirty = 1;}")
End If
 Dim AM_CODE_ddl as DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"),DropDownList)
 Dim AM_CODE_lbl as Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE_lbl"),Label)
AM_CODE_ddl.Items.clear()
AM_CODE_ddl.Items.Add("")
AM_CODE_ddl.Items.Add("")
AM_CODE_ddl.Items(1).Text="AM Parts TTU"
AM_CODE_ddl.Items(1).Value="AMTTU"
AM_CODE_ddl.Items.Add("")
AM_CODE_ddl.Items(2).Text="AM Parts MRO"
AM_CODE_ddl.Items(2).Value="AMMRO"
AM_CODE_ddl.Items.Add("")
AM_CODE_ddl.Items(3).Text="AM Parts SPIR"
AM_CODE_ddl.Items(3).Value="AMSPIR"
AM_CODE_ddl.Items.Add("")
AM_CODE_ddl.Items(4).Text="OE"
AM_CODE_ddl.Items(4).Value="OE"
For ddli = 0 To AM_CODE_ddl.Items.Count-1
    If (AM_CODE_lbl.Text<>"") Then
    If (AM_CODE_ddl.Items(ddli).Value = AM_CODE_lbl.Text) Then
AM_CODE_ddl.SelectedIndex = ddli
        Exit For
    End If
    End If
Next
 Dim SPIF_ck as CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"),CheckBox)
 Dim SPIF_lbl as Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF_lbl"),Label)
If (SPIF_lbl .Text="Y") Then
SPIF_ck.Checked=True
End If
 Dim ATEX_ck as CheckBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"),CheckBox)
 Dim ATEX_lbl as Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_lbl"),Label)
If (ATEX_lbl .Text="Y") Then
ATEX_ck.Checked=True
End If
 Dim PO_LINE_NO_right_justify as TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"),TextBox)
PO_LINE_NO_right_justify.Style("text-align") = "right"
If ( conn.sf_execute_sql("select count(1) from V_ORDER_PACKING_SLIP_DETAILS where nvl(BLANKET_ORDER,'N')='Y' and BALANCE_QTY =0 and order_no='" & SD_ORDER_HEADER_ORDER_NO.Text & "' and line_no=" & SD_ORDER_DETAIL_LINE_NO.Text )>0) Then
dgItem1.visible=false
dbkl1 = 1
End If
End If
If (e.Item.ItemType = ListItemType.Footer) Then
dim Footer_txt as string
Footer_txt=""
Dim ORDER_QTY_footer As Label = CType(e.Item.FindControl("SD_ORDER_DETAIL_ORDER_QTY_footer"), Label)
ORDER_QTY_footer.Text=String.Format("{0:n}",CDBL(Footer_txt & mytotal1174))
ORDER_QTY_footer.Style("text-align") = "right"
Footer_txt=""
Footer_txt=""
Dim LINE_EXTENDED_AMOUNT_footer As Label = CType(e.Item.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT_footer"), Label)
LINE_EXTENDED_AMOUNT_footer.Text=String.Format("{0:C}",CDBL(Footer_txt & mytotal1214))
LINE_EXTENDED_AMOUNT_footer.Style("text-align") = "right"
Footer_txt=""
Footer_txt=""
Dim LINE_TOTAL_AMOUNT_footer As Label = CType(e.Item.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT_footer"), Label)
LINE_TOTAL_AMOUNT_footer.Text=String.Format("{0:C}",CDBL(Footer_txt & mytotal1705))
LINE_TOTAL_AMOUNT_footer.Style("text-align") = "right"
Footer_txt=""
 End If
    dbad.SelectCommand.Connection.Close()
Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
call insert_sys_log("ORDERDETAIL_ItemDataBound",ex.Message)
End Try
    End Sub
  Protected Sub dbgSALESREPBYSALESORDER_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.DataGridItemEventArgs) Handles dbgSALESREPBYSALESORDER.ItemDataBound
Try
dbad.SelectCommand.Connection = Session("db_connection")
        Dim dgItem1 As DataGridItem
Dim ddli As Integer
  If (e.Item.ItemIndex = 0) Then
Try
 If (CONN.SF_EXECUTE_SQL ("SELECT NVL(ORDER_TYPE_VISIBLE,'N') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE ='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "'")="N") Then
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Order Doc Type*")) Then
dcols(rii).Visible = False
End If
Next
Else
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Order Doc Type*")) Then
dcols(rii).Visible = True
End If
Next
End If
Catch ex As Exception
call insert_sys_log("SALESREPBYSALESORDER_ItemDataBound",ex.Message)
End Try
End If
  If (e.Item.ItemIndex = 0) Then
Try
 If (CONN.SF_EXECUTE_SQL(" SELECT NVL(CUSTOMER_ITEM_NO_REQUIRED,'N') FROM GL_BUSINESS_UNITS WHERE BUSINESS_UNIT_CODE='" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT & "' ")<>"Y") Then
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Customer Item No")) Then
dcols(rii).Visible = False
dcols(rii+1).Visible = False
End If
Next
Else
Dim dcols As DataGridColumnCollection
 Dim rii As Integer
 dcols = dbgORDERDETAIL.Columns
For rii = 0 To dcols.Count - 1
If (UCase(dcols(rii).HeaderText) = UCase("Customer Item No")) Then
dcols(rii).Visible = True
dcols(rii+1).Visible = True
End If
Next
End If
Catch ex As Exception
call insert_sys_log("SALESREPBYSALESORDER_ItemDataBound",ex.Message)
End Try
End If
Dim dbkl1 As Integer
dbkl1 = 0
If (e.Item.ItemType = ListItemType.Item Or e.Item.ItemType = ListItemType.AlternatingItem Or e.Item.ItemType = ListItemType.EditItem) Then
    dgItem1 = e.Item
Dim CheckBox0 As CheckBox = CType(dgItem1.FindControl("CheckBox0"), CheckBox)
Dim SD_SALES_REP_BY_SALES_ORDER_LINE_NO As Label = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_LINE_NO"), Label)
Dim SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO"), TextBox)
SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.Attributes.Add("onchange", "setDirty();")
Dim SALESREP_NAME As TextBox = CType(dgItem1.FindControl("SALESREP_NAME"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL"), TextBox)
Dim SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE"), TextBox)
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.Attributes.Add("onchange", "setDirty();")
if (Session("HIDE_MENU_OPTIONS") = "Y" ) Then
SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.Attributes.Add("ontouchmove", "open_window_drdl('SALES_REPS.aspx?SALES_REP_NO=','" & SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ClientID & "');")
Else
if (Session("BROWSER_OPTIONS") = "Y") Then
SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.Attributes.Add("ondblclick", "open_window_drdlbd('SALES_REPS.aspx?SALES_REP_NO=','" & SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ClientID & "');")
Else
SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.Attributes.Add("ondblclick", "open_window_drdl('SALES_REPS.aspx?SALES_REP_NO=','" & SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ClientID & "');")
End If
End If
Dim LOVSALES_REPS_LOV6969 As ImageButton=CType(dgItem1.FindControl("LOVSALES_REPS_LOV6969"), ImageButton)
 Dim LINE_NO_right_justify as Label = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_LINE_NO"),Label)
LINE_NO_right_justify.Style("text-align") = "right"
 Dim LINE_NO_Frules as Label = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_LINE_NO"),Label)
 if LINE_NO_Frules.Text <> "" Then
If (CONN.SF_EXECUTE_DB_FUNCTION("Pkg_status.sf_check_status( 'SD_ORDER_HEADER', '" &SD_ORDER_HEADER_ORDER_NO.TEXT & "',NULL,NULL,NULL,NULL,NULL) ")<> "Close") Then
LOVSALES_REPS_LOV6969.Enabled=True
SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.Enabled=True
SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ReadOnly=False
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.Enabled=True
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.ReadOnly=False
Else
LOVSALES_REPS_LOV6969.Enabled=False
SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.Enabled=True
SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ReadOnly=True
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.Enabled=True
SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE.ReadOnly=True
End If
End If
 Dim SALES_REP_NO_maxlength as TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO"),TextBox)
SALES_REP_NO_maxlength.Attributes.Add("onkeyup","return DisplayEvent('" & SALES_REP_NO_maxlength.ClientID & "',34 );")
            Dim oprp2 As ImageButton = CType(dgItem1.FindControl("LOVSALES_REPS_LOV6969"), ImageButton)
            Dim SALES_REP_NO_lov As TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO"), TextBox)
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
            oprp2.Attributes.Add("OnClick", "var strReturn,sval; if (document.getElementById('" & SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ClientID & "') != null) sval=document.getElementById('" & SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ClientID & "').value; else sval=''; strReturn=window.open('SALES_REPS_LOV.aspx?RETURN_ID="  & SALES_REP_NO_lov.ClientID & "&sval='+encodeURIComponent(sval),'WIND1','menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;")
Else
            oprp2.Attributes.Add("OnClick", "var strReturn,sval; if (document.getElementById('" & SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ClientID & "') != null) sval=document.getElementById('" & SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.ClientID & "').value; else sval=''; strReturn=window.showModalDialog('SALES_REPS_LOV.aspx?sval='+encodeURIComponent(sval),null,'status:no;dialogWidth:500px;dialogHeight:500px;dialogHide:true;help:no;scroll:yes');if (strReturn != null){ document.getElementById('" & SALES_REP_NO_lov.ClientID & "').value=strReturn;isDirty = 1;}")
End If
 if (SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO.Text <> ""  ) Then
Dim dbsqlst21  as new Data.Dataset
dbad.SelectCommand.CommandText ="select name,commission_rate from Sd_Sales_Reps where sales_rep_no='" & SD_SALES_REP_BY_SALES_ORDER_sales_rep_no.text & "'"
dbsqlst21.Clear()
dbad.Fill(dbsqlst21)
if (dbsqlst21.Tables(0).Rows.Count>0) Then
If Not (Equals(dbsqlst21.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SALESREP_NAME.Text=dbsqlst21.Tables(0).Rows(0)(0)
Else
SALESREP_NAME.Text=""
End If
End If
End If
 Dim COMMISSION_RATE_right_justify as TextBox = CType(dgItem1.FindControl("SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE"),TextBox)
COMMISSION_RATE_right_justify.Style("text-align") = "right"
End If
    dbad.SelectCommand.Connection.Close()
Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
call insert_sys_log("SALESREPBYSALESORDER_ItemDataBound",ex.Message)
End Try
    End Sub
Protected Sub DELETEGridRowBILLING_STAGE_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles DELETEGridRowBILLING_STAGE.Click
TRY
dbad.SelectCommand.Connection = Session("db_connection")
dbad.DeleteCommand.Connection = Session("db_connection")
Dim aclevel As Integer
Dim dbpage_acess as new Data.Dataset
                aclevel = 2
                If (session("aclevel") <> "") Then
                    aclevel = CInt(session("aclevel"))
                End If
            dbad.SelectCommand.CommandText = "select ACCESS_LEVEL from VS_USER_ACCESS_LEVEL where USER_ID='" & UCase(Session("User_id")) & "' and  upper(MENU_FILE_NAME)='SALES_ORDER.ASPX' and ACCESS_LEVEL is not null"
            dbpage_acess.Clear()
            dbad.Fill(dbpage_acess)
            If (dbpage_acess.Tables(0).Rows.Count > 0) Then
               aclevel = dbpage_acess.Tables(0).Rows(0)("ACCESS_LEVEL")
            End If
If (aclevel = 5) Then
Exit Sub
                End If
  	  Dim dgItemBILLING_STAGE As DataGridItem
        Dim ddxBILLING_STAGE As New Data.DataSet
        Dim pBILLING_STAGE
        Dim line_no1BILLING_STAGE, item_no1BILLING_STAGE, item_descrip1BILLING_STAGE As String
   For Each dgItemBILLING_STAGE In dbgBILLING_STAGE.Items
Dim CheckBox0 As CheckBox =CType(dgItemBILLING_STAGE.FindControl("CheckBox0"), CheckBox)
Dim LINE_NO As Label = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_LINE_NO"), Label)
Dim STAGE As TextBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_STAGE"), TextBox)
Dim BILLING_PERCENTAGE As TextBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_BILLING_PERCENTAGE"), TextBox)
Dim READY_FOR_INOVICE_DATE As TextBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_READY_FOR_INOVICE_DATE"), TextBox)
Dim APPROVED_FOR_INOVICE As CheckBox = CType(dgItemBILLING_STAGE.FindControl("SD_ORDERS_BILLING_STAGE_APPROVED_FOR_INOVICE"), CheckBox)
If ( LINE_NO.Text <>"" and STAGE.Text <>"" ) Then
        Dim dsfBILLING_STAGE As New Data.DataSet
	      dbad.SelectCommand.CommandText = "select  ORDER_NO,STAGE from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and STAGE='" & replace_c(STAGE.Text) & "' "
        dsfBILLING_STAGE.Clear()
        dbad.Fill(dsfBILLING_STAGE)
        If (dsfBILLING_STAGE.Tables(0).Rows.Count > 0) Then
 	      If CheckBox0.Checked = True Then
Dim delete_verify_flag As String
delete_verify_flag="Y"
dbad.SelectCommand.Connection = Session("db_connection")
Dim dvflag As New Data.DataSet
dbad.SelectCommand.CommandText ="select PKG_DELETE.SF_CHECK_DELETE('SD_ORDERS_BILLING_STAGE','" & SD_ORDER_HEADER_ORDER_NO.Text  & "','" &  STAGE.Text & "','','','','') rval1 from dual"
dvflag.Clear()
dbad.Fill(dvflag)
 If (dvflag.Tables(0).Rows.Count > 0) Then
If Not (Equals(dvflag.Tables(0).Rows(0)("rval1"), System.DBNull.Value)) Then
If (dvflag.Tables(0).Rows(0)("rval1") <> "Y") Then
delete_verify_flag=dvflag.Tables(0).Rows(0)("rval1")
End If
End If
End If
dbad.SelectCommand.Connection.Close()
if (delete_verify_flag="Y") Then
                        If (dbad.DeleteCommand.Connection.State = Data.ConnectionState.Closed) Then
                            dbad.DeleteCommand.Connection.Open()
                        End If
                        dbad.DeleteCommand.CommandText = "delete from SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and STAGE='" & replace_c(STAGE.Text) & "' "
                        dbad.DeleteCommand.ExecuteNonQuery()
Else
If (delete_verify_flag="N") Then
exception_message.Text="Can't Perform Delete Operation, As This Document Is Used In Another Place"
Else
exception_message.Text=delete_verify_flag
        End If
err_message.Visible=False
exception_message.visible=True
mpanel.Visible = True
End If
          End If
          End If
End If 
   Next
    dbad.SelectCommand.Connection.Close()
    dbad.DeleteCommand.Connection.Close()
If Save.Visible = True Then
    Call save_Click(sender, E)
If exception_message.text<>"" Then
exception_message.visible=True
mpanel.Visible = True
End If
End If
Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
    dbad.DeleteCommand.Connection.Close()
call insert_sys_log("BILLING_STAGE_ Update",ex.Message)
End Try
End Sub
Protected Sub DELETEGridRowORDERDETAIL_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles DELETEGridRowORDERDETAIL.Click
TRY
dbad.SelectCommand.Connection = Session("db_connection")
dbad.DeleteCommand.Connection = Session("db_connection")
Dim aclevel As Integer
Dim dbpage_acess as new Data.Dataset
                aclevel = 2
                If (session("aclevel") <> "") Then
                    aclevel = CInt(session("aclevel"))
                End If
            dbad.SelectCommand.CommandText = "select ACCESS_LEVEL from VS_USER_ACCESS_LEVEL where USER_ID='" & UCase(Session("User_id")) & "' and  upper(MENU_FILE_NAME)='SALES_ORDER.ASPX' and ACCESS_LEVEL is not null"
            dbpage_acess.Clear()
            dbad.Fill(dbpage_acess)
            If (dbpage_acess.Tables(0).Rows.Count > 0) Then
               aclevel = dbpage_acess.Tables(0).Rows(0)("ACCESS_LEVEL")
            End If
If (aclevel = 5) Then
Exit Sub
                End If
  	  Dim dgItemORDERDETAIL As DataGridItem
        Dim ddxORDERDETAIL As New Data.DataSet
        Dim pORDERDETAIL
        Dim line_no1ORDERDETAIL, item_no1ORDERDETAIL, item_descrip1ORDERDETAIL As String
   For Each dgItemORDERDETAIL In dbgORDERDETAIL.Items
Dim CheckBox0 As CheckBox =CType(dgItemORDERDETAIL.FindControl("CheckBox0"), CheckBox)
Dim LINE_NO As Label = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
Dim ORDER_DOC_TYPE As DropDownList = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
Dim ORDER_LINE_TYPE As DropDownList = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
Dim ITEM_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
Dim LICENSE_TIED_UP_LINE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
Dim LOT_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
Dim SERIAL_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
Dim CREATE_WORK_ORDER As CheckBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), CheckBox)
Dim CUSTOMER_ITEM_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
Dim ITEM_REVISION_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
Dim DESCRIPTION As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
Dim AES_DESCRIPTION As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
Dim ORDER_QTY As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
Dim TRIM_SIZE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
Dim SALES_QTY_ZERO_PRICE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
Dim ORDER_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
Dim MULTIPLIER As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
Dim MSRP_SALES_PRICE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
Dim PRICING_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
Dim SALES_PRICE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
Dim EXPEDITE As CheckBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_EXPEDITE"), CheckBox)
Dim EXPEDIATE_VALUE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
Dim LINE_EXTENDED_AMOUNT As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
Dim TAX_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
Dim TAX_AMOUNT As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
Dim EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
Dim LINE_TOTAL_AMOUNT As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
Dim BASE_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
Dim PROJECT_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
Dim ORDER_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
Dim DUE_DATE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
Dim PROMISED_DELIVERY_DATE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
Dim REQUESTED_SHIP_DATE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
Dim ORDER_PRIORITY_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
Dim TIME_AND_MATERIAL As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
Dim DRAWING_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
Dim LICENSE_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
Dim END_USER_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
Dim AM_CODE As DropDownList = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
Dim SPIF As CheckBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_SPIF"), CheckBox)
Dim CE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
Dim ATEX As CheckBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ATEX"), CheckBox)
Dim ATEX_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
Dim PO_LINE_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
Dim CANCELED_QTY As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
Dim CANCELED_QTY_BASE_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
Dim PRODUCTION_STATUS As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
Dim REASON_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
Dim REASON_NOTES As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
Dim BLANKET_RELEASE_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
Dim WORK_ORDER_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
Dim LINE_SHIP_TO_CODE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
Dim LINE_SHIPPING_ADDRESS As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
Dim LINE_SHIP_VIA As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
Dim INVOICE_BY As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
Dim CUSTOMER_PO_NO As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
Dim CUSTOMER_PO_DATE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
Dim CONFIGURATOR_ID As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
Dim TRIM_UOM As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
Dim STOCK_DUTY_POINT As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
Dim HEAD_UNITS As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
Dim FLOW_UNITS As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
Dim LICENSE_TIED_IP_LINE As TextBox = CType(dgItemORDERDETAIL.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
If ( LINE_NO.Text <>"" and ORDER_DOC_TYPE.SelectedIndex>0 And ORDER_QTY.Text <>"" and ORDER_QTY.Text <>"" ) Then
        Dim dsfORDERDETAIL As New Data.DataSet
	      dbad.SelectCommand.CommandText = "select  ORDER_NO,LINE_NO from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and LINE_NO='" & replace_c(LINE_NO.Text) & "' "
        dsfORDERDETAIL.Clear()
        dbad.Fill(dsfORDERDETAIL)
        If (dsfORDERDETAIL.Tables(0).Rows.Count > 0) Then
 	      If CheckBox0.Checked = True Then
Dim delete_verify_flag As String
delete_verify_flag="Y"
Try
dbad.SelectCommand.Connection = Session("db_connection")
 Dim f1 As Integer
 Dim stsetup As String
stsetup=""
If  (stsetup="") Then
Dim dvsetup0 As New Data.DataSet
dbad.SelectCommand.CommandText ="SELECT  WORK_ORDER_NO FROM  MFG_WO_SALES_ORDERS WHERE  SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' AND  ORDER_LINE_NO='" & replace_c(LINE_NO.Text) & "' AND ROWNUM<6"
dvsetup0 .Clear()
dbad.Fill(dvsetup0 )
 If (dvsetup0 .Tables(0).Rows.Count > 0) Then
  For f1 = 0 To dvsetup0 .Tables(0).Rows.Count - 1
 If Not (Equals(dvsetup0.Tables(0).Rows(f1)(0), System.DBNull.Value)) Then
stsetup=stsetup & dvsetup0.Tables(0).Rows(f1)(0) & ","
End If
Next
If  (stsetup<>"") Then
stsetup="Cannot perform delete operation as it is used in work order no : " & stsetup 
End If
        delete_verify_flag=stsetup
End If
End If
If  (stsetup="") Then
Dim dvsetup1 As New Data.DataSet
dbad.SelectCommand.CommandText ="SELECT  PACKING_SLIP_NO FROM  SD_PACKING_SLIP_DETAIL WHERE  ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' AND  ORDER_LINE_NO='" & replace_c(LINE_NO.Text) & "' AND ROWNUM<6"
dvsetup1 .Clear()
dbad.Fill(dvsetup1 )
 If (dvsetup1 .Tables(0).Rows.Count > 0) Then
  For f1 = 0 To dvsetup1 .Tables(0).Rows.Count - 1
 If Not (Equals(dvsetup1.Tables(0).Rows(f1)(0), System.DBNull.Value)) Then
stsetup=stsetup & dvsetup1.Tables(0).Rows(f1)(0) & ","
End If
Next
If  (stsetup<>"") Then
stsetup="Cannot perform delete operation as it is used in packing slip no : " & stsetup 
End If
        delete_verify_flag=stsetup
End If
End If
If  (stsetup="") Then
Dim dvsetup2 As New Data.DataSet
dbad.SelectCommand.CommandText ="SELECT  INVOICE_NO FROM  SD_INVOICE_DETAIL WHERE  ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' AND  LINE_NO='" & replace_c(LINE_NO.Text) & "' AND ROWNUM<6"
dvsetup2 .Clear()
dbad.Fill(dvsetup2 )
 If (dvsetup2 .Tables(0).Rows.Count > 0) Then
  For f1 = 0 To dvsetup2 .Tables(0).Rows.Count - 1
 If Not (Equals(dvsetup2.Tables(0).Rows(f1)(0), System.DBNull.Value)) Then
stsetup=stsetup & dvsetup2.Tables(0).Rows(f1)(0) & ","
End If
Next
If  (stsetup<>"") Then
stsetup="Cannot perform delete operation as it is used in Invoice Nos :" & stsetup 
End If
        delete_verify_flag=stsetup
End If
End If
dbad.SelectCommand.Connection.Close()
Catch ex As Exception
call insert_sys_log("Delete Verification",ex.Message)
End Try
if (delete_verify_flag="Y") Then
                        If (dbad.DeleteCommand.Connection.State = Data.ConnectionState.Closed) Then
                            dbad.DeleteCommand.Connection.Open()
                        End If
                        dbad.DeleteCommand.CommandText = "delete from SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and LINE_NO='" & replace_c(LINE_NO.Text) & "' "
                        dbad.DeleteCommand.ExecuteNonQuery()
Else
If (delete_verify_flag="N") Then
exception_message.Text="Can't Perform Delete Operation, As This Document Is Used In Another Place"
Else
exception_message.Text=delete_verify_flag
        End If
err_message.Visible=False
exception_message.visible=True
mpanel.Visible = True
End If
          End If
          End If
End If 
   Next
    dbad.SelectCommand.Connection.Close()
    dbad.DeleteCommand.Connection.Close()
If Save.Visible = True Then
    Call save_Click(sender, E)
If exception_message.text<>"" Then
exception_message.visible=True
mpanel.Visible = True
End If
End If
Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
    dbad.DeleteCommand.Connection.Close()
call insert_sys_log("ORDERDETAIL_ Update",ex.Message)
End Try
End Sub
Protected Sub DELETEGridRowSALESREPBYSALESORDER_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles DELETEGridRowSALESREPBYSALESORDER.Click
TRY
dbad.SelectCommand.Connection = Session("db_connection")
dbad.DeleteCommand.Connection = Session("db_connection")
Dim aclevel As Integer
Dim dbpage_acess as new Data.Dataset
                aclevel = 2
                If (session("aclevel") <> "") Then
                    aclevel = CInt(session("aclevel"))
                End If
            dbad.SelectCommand.CommandText = "select ACCESS_LEVEL from VS_USER_ACCESS_LEVEL where USER_ID='" & UCase(Session("User_id")) & "' and  upper(MENU_FILE_NAME)='SALES_ORDER.ASPX' and ACCESS_LEVEL is not null"
            dbpage_acess.Clear()
            dbad.Fill(dbpage_acess)
            If (dbpage_acess.Tables(0).Rows.Count > 0) Then
               aclevel = dbpage_acess.Tables(0).Rows(0)("ACCESS_LEVEL")
            End If
If (aclevel = 5) Then
Exit Sub
                End If
  	  Dim dgItemSALESREPBYSALESORDER As DataGridItem
        Dim ddxSALESREPBYSALESORDER As New Data.DataSet
        Dim pSALESREPBYSALESORDER
        Dim line_no1SALESREPBYSALESORDER, item_no1SALESREPBYSALESORDER, item_descrip1SALESREPBYSALESORDER As String
   For Each dgItemSALESREPBYSALESORDER In dbgSALESREPBYSALESORDER.Items
Dim CheckBox0 As CheckBox =CType(dgItemSALESREPBYSALESORDER.FindControl("CheckBox0"), CheckBox)
Dim LINE_NO As Label = CType(dgItemSALESREPBYSALESORDER.FindControl("SD_SALES_REP_BY_SALES_ORDER_LINE_NO"), Label)
Dim SALES_REP_NO As TextBox = CType(dgItemSALESREPBYSALESORDER.FindControl("SD_SALES_REP_BY_SALES_ORDER_SALES_REP_NO"), TextBox)
Dim EFFECTIVE_FROM As TextBox = CType(dgItemSALESREPBYSALESORDER.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_FROM"), TextBox)
Dim EFFECTIVE_TILL As TextBox = CType(dgItemSALESREPBYSALESORDER.FindControl("SD_SALES_REP_BY_SALES_ORDER_EFFECTIVE_TILL"), TextBox)
Dim COMMISSION_RATE As TextBox = CType(dgItemSALESREPBYSALESORDER.FindControl("SD_SALES_REP_BY_SALES_ORDER_COMMISSION_RATE"), TextBox)
If ( LINE_NO.Text <>"" and SALES_REP_NO.Text <>"" ) Then
        Dim dsfSALESREPBYSALESORDER As New Data.DataSet
	      dbad.SelectCommand.CommandText = "select  SALES_ORDER_NO,LINE_NO from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and LINE_NO='" & replace_c(LINE_NO.Text) & "' "
        dsfSALESREPBYSALESORDER.Clear()
        dbad.Fill(dsfSALESREPBYSALESORDER)
        If (dsfSALESREPBYSALESORDER.Tables(0).Rows.Count > 0) Then
 	      If CheckBox0.Checked = True Then
Dim delete_verify_flag As String
delete_verify_flag="Y"
dbad.SelectCommand.Connection = Session("db_connection")
Dim dvflag As New Data.DataSet
dbad.SelectCommand.CommandText ="select PKG_DELETE.SF_CHECK_DELETE('SD_SALES_REP_BY_SALES_ORDER','" & SD_ORDER_HEADER_ORDER_NO.Text  & "','" &  LINE_NO.Text & "','','','','') rval1 from dual"
dvflag.Clear()
dbad.Fill(dvflag)
 If (dvflag.Tables(0).Rows.Count > 0) Then
If Not (Equals(dvflag.Tables(0).Rows(0)("rval1"), System.DBNull.Value)) Then
If (dvflag.Tables(0).Rows(0)("rval1") <> "Y") Then
delete_verify_flag=dvflag.Tables(0).Rows(0)("rval1")
End If
End If
End If
dbad.SelectCommand.Connection.Close()
if (delete_verify_flag="Y") Then
                        If (dbad.DeleteCommand.Connection.State = Data.ConnectionState.Closed) Then
                            dbad.DeleteCommand.Connection.Open()
                        End If
                        dbad.DeleteCommand.CommandText = "delete from SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' and LINE_NO='" & replace_c(LINE_NO.Text) & "' "
                        dbad.DeleteCommand.ExecuteNonQuery()
Else
If (delete_verify_flag="N") Then
exception_message.Text="Can't Perform Delete Operation, As This Document Is Used In Another Place"
Else
exception_message.Text=delete_verify_flag
        End If
err_message.Visible=False
exception_message.visible=True
mpanel.Visible = True
End If
          End If
          End If
End If 
   Next
    dbad.SelectCommand.Connection.Close()
    dbad.DeleteCommand.Connection.Close()
If Save.Visible = True Then
    Call save_Click(sender, E)
If exception_message.text<>"" Then
exception_message.visible=True
mpanel.Visible = True
End If
End If
Catch ex As Exception
    dbad.SelectCommand.Connection.Close()
    dbad.DeleteCommand.Connection.Close()
call insert_sys_log("SALESREPBYSALESORDER_ Update",ex.Message)
End Try
End Sub
	Public Sub save_Detail_form()
 		Dim dsf As New Data.DataSet
    End Sub
	Public Sub fill_Detail_form()
dbad.SelectCommand.Connection.Close()
End sub
 Public Sub clear_detail_form()
End Sub
 Public Sub delete_details_form()
End sub
Protected Sub Event_SD_PROCESS_APPROVED_STAGES_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Event_SD_PROCESS_APPROVED_STAGES.Click
Try
if save.visible=True Then
  Call save_Click(sender, e)
End If
if not(mpanel.Visible=True and exception_message.Visible=True) Then
 call execute_storeProcedure ("Process_Approved_Stages","","","")
Call fill_header_info()
End If
Catch ex As Exception
call insert_sys_log("Event_SD_PROCESS_APPROVED_STAGESButton Click",ex.Message)
End Try
End Sub
Protected Sub Event_SHIP_COMPLETE_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Event_SHIP_COMPLETE.Click
Try
if save.visible=True Then
  Call save_Click(sender, e)
End If
if not(mpanel.Visible=True and exception_message.Visible=True) Then
 call execute_storeProcedure ("SP_UPDATE_SHIP_COMPLETE",SD_ORDER_HEADER_ORDER_NO.Text,"ORDER_NO","C")
Call fill_header_info()
End If
Catch ex As Exception
call insert_sys_log("Event_SHIP_COMPLETEButton Click",ex.Message)
End Try
End Sub
Protected Sub Event_BUT_SO_COPY_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Event_BUT_SO_COPY.Click
Try
if save.visible=True Then
  Call save_Click(sender, e)
End If
if not(mpanel.Visible=True and exception_message.Visible=True) Then
if (session("open_window_no")<>"") Then
session("open_window_no")=cstr(cint(session("open_window_no"))+1)
Else
session("open_window_no")="103"
End If
                        Dim strFile As String = "Copy Lines"
                        Dim strCmd As String = String.Format("ethdlk=window.open('SALES_ORDER_COPY.aspx?ORDER_NO=" & Replace(Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&Retrive_id=" & Retrive.ClientID & " ','win100SALESORDER" & session("open_window_no") & "','width=500,Height=200,scrollbars=2,resizable=1,menubar=1,toolbar=1, ');ethdlk.focus();", strFile)
                        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN38", strCmd, True)
End If
Catch ex As Exception
call insert_sys_log("Event_BUT_SO_COPYButton Click",ex.Message)
End Try
End Sub
Protected Sub Event_BTN_SUGGEST_DATE_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Event_BTN_SUGGEST_DATE.Click
Try
if save.visible=True Then
  Call save_Click(sender, e)
End If
if not(mpanel.Visible=True and exception_message.Visible=True) Then
 call execute_storeProcedure ("SP_SO_ATP_FOR_PUMPS",SD_ORDER_HEADER_ORDER_NO.Text & "#" & "SUGGEST" & "#" & SESSION("USER_ID"),"P_ORDER_NO#P_SUGGEST_UNSUGGEST#P_USER_ID","C#C#C")
Call fill_header_info()
End If
Catch ex As Exception
call insert_sys_log("Event_BTN_SUGGEST_DATEButton Click",ex.Message)
End Try
End Sub
Protected Sub Event_BTN_UNDO_SUGGEST_DATE_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Event_BTN_UNDO_SUGGEST_DATE.Click
Try
if save.visible=True Then
  Call save_Click(sender, e)
End If
if not(mpanel.Visible=True and exception_message.Visible=True) Then
 call execute_storeProcedure ("SP_SO_ATP_FOR_PUMPS",SD_ORDER_HEADER_ORDER_NO.Text & "#" & "UNSUGGEST" & "#" & SESSION("USER_ID"),"P_ORDER_NO#P_SUGGEST_UNSUGGEST#P_USER_ID","C#C#C")
Call fill_header_info()
End If
Catch ex As Exception
call insert_sys_log("Event_BTN_UNDO_SUGGEST_DATEButton Click",ex.Message)
End Try
End Sub
Protected Sub Event_BTN_RUN_SCH_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Event_BTN_RUN_SCH.Click
Try
if save.visible=True Then
  Call save_Click(sender, e)
End If
if not(mpanel.Visible=True and exception_message.Visible=True) Then
 call execute_storeProcedure ("SP_SO_ATP_FOR_PUMPS","NULL" & "#" & "NULL" & "#" & SESSION("USER_ID"),"P_ORDER_NO#P_SUGGEST_UNSUGGEST#P_USER_ID","C#C#C")
Call fill_header_info()
End If
Catch ex As Exception
call insert_sys_log("Event_BTN_RUN_SCHButton Click",ex.Message)
End Try
End Sub
Public Sub Event_ORDER_CONFIG_Click(ByVal sender As Object, ByVal e As System.EventArgs)
Try
        Dim dgItem1 As DataGridItem
        Dim p
        Dim dds As New Data.DataSet
        Dim oprp As New RadioButtonList
        Dim cell4 As TableCell
        Dim cb As New Button
        Dim lno, st1 As String
        cb = CType(sender, Button)
        cell4 = CType(cb.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
            Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
            Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
            Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
            Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
            Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
            Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
            Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), Checkbox)
            Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
            Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
            Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
            Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
            Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
            Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
            Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
            Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
            Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
            Dim SD_ORDER_DETAIL_EXPEDITE As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), Checkbox)
            Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
            Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
            Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
            Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
            Dim SD_ORDER_DETAIL_SPIF As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), Checkbox)
            Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
            Dim SD_ORDER_DETAIL_ATEX As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), Checkbox)
            Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
            Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
            Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
            Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
            Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
            Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
            Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
            Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
            Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
            Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
            Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
            Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
if save.visible=True Then
  Call save_Click(sender, e)
End If
if not(mpanel.Visible=True and exception_message.Visible=True) Then
if (session("open_window_no")<>"") Then
session("open_window_no")=cstr(cint(session("open_window_no"))+1)
Else
session("open_window_no")="103"
End If
                        Dim strFile As String = "Config"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
                       strCmd = String.Format("window.open('SD_PRODUCT_CONFIGURATOR_OQ.aspx?ORDER_NO=" & Replace(Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&ORDER_LINE_NO=" & Replace(Replace(Replace(SD_ORDER_DETAIL_LINE_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&CONFIGURATOR_ID=" & Replace(Replace(Replace(SD_ORDER_DETAIL_CONFIGURATOR_ID.Text, "'", "%27"),"&","%26"),"#","%23") & "&Retrive_id=" & Retrive.ClientID & "');", strFile)
Else
                       strCmd = String.Format("window.showModalDialog('SD_PRODUCT_CONFIGURATOR_OQ.aspx?ORDER_NO=" & Replace(Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&ORDER_LINE_NO=" & Replace(Replace(Replace(SD_ORDER_DETAIL_LINE_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&CONFIGURATOR_ID=" & Replace(Replace(Replace(SD_ORDER_DETAIL_CONFIGURATOR_ID.Text, "'", "%27"),"&","%26"),"#","%23") & "&Retrive_id=" & Retrive.ClientID & " ','win22SALESORDER" & session("open_window_no") & "','dialogWidth:1300px;dialogHeight:700px;center:yes;dialogHide:no;edge:raised;resizable:yes;scroll:yes;status:no;unadorned:no;');", strFile)
End If
                        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN45", strCmd, True)
End If
Catch ex As Exception
call insert_sys_log("Event_ORDER_CONFIGButton in Grid",ex.Message)
End Try
End Sub
Public Sub Event_ORDER_DETAILS_Click(ByVal sender As Object, ByVal e As System.EventArgs)
Try
        Dim dgItem1 As DataGridItem
        Dim p
        Dim dds As New Data.DataSet
        Dim oprp As New RadioButtonList
        Dim cell4 As TableCell
        Dim cb As New Button
        Dim lno, st1 As String
        cb = CType(sender, Button)
        cell4 = CType(cb.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
            Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
            Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
            Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
            Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
            Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
            Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
            Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), Checkbox)
            Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
            Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
            Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
            Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
            Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
            Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
            Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
            Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
            Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
            Dim SD_ORDER_DETAIL_EXPEDITE As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), Checkbox)
            Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
            Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
            Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
            Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
            Dim SD_ORDER_DETAIL_SPIF As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), Checkbox)
            Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
            Dim SD_ORDER_DETAIL_ATEX As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), Checkbox)
            Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
            Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
            Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
            Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
            Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
            Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
            Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
            Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
            Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
            Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
            Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
            Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
if save.visible=True Then
  Call save_Click(sender, e)
End If
if not(mpanel.Visible=True and exception_message.Visible=True) Then
if (session("open_window_no")<>"") Then
session("open_window_no")=cstr(cint(session("open_window_no"))+1)
Else
session("open_window_no")="103"
End If
                        Dim strFile As String = ">>"
                        Dim strCmd As String = String.Format("dtpt1=window.open('ORDER_DETAILS.aspx?ORDER_NO=" & Replace(Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&LINE_NO=" & Replace(Replace(Replace(SD_ORDER_DETAIL_LINE_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&BLANKET_ORDER=" & Replace(Replace(Replace( check_box_r(SD_ORDER_HEADER_BLANKET_ORDER), "'", "%27"),"&","%26"),"#","%23") & "&BUSINESS_UNIT_CODE=" & Replace(Replace(Replace( dropdown_list2(SD_ORDER_HEADER_BUSINESS_UNIT_CODE), "'", "%27"),"&","%26"),"#","%23") & "&CUSTOMER_NO=" & Replace(Replace(Replace(SD_ORDER_HEADER_CUSTOMER_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&PRICE_FROM_PRICING_INFO=" & Replace(Replace(Replace( check_box_r(SD_ORDER_HEADER_PRICE_FROM_PRICING_INFO), "'", "%27"),"&","%26"),"#","%23") & "&Retrive_id=" & Retrive.ClientID & " ','win22SALESORDER" & session("open_window_no") & "','width=1150,Height=700,scrollbars=2,resizable=1,menubar=1,toolbar=1, ');dtpt1.focus();", strFile)
                        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN48", strCmd, True)
End If
Catch ex As Exception
call insert_sys_log("Event_ORDER_DETAILSButton in Grid",ex.Message)
End Try
End Sub
Public Sub Event_ORDER_ATP_Click(ByVal sender As Object, ByVal e As System.EventArgs)
Try
        Dim dgItem1 As DataGridItem
        Dim p
        Dim dds As New Data.DataSet
        Dim oprp As New RadioButtonList
        Dim cell4 As TableCell
        Dim cb As New Button
        Dim lno, st1 As String
        cb = CType(sender, Button)
        cell4 = CType(cb.Parent, TableCell)
        dgItem1 = CType(cell4.Parent, DataGridItem)
            Dim SD_ORDER_DETAIL_LINE_NO As Label = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_NO"), Label)
            Dim SD_ORDER_DETAIL_ORDER_DOC_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_DOC_TYPE"), DropDownList)
            Dim SD_ORDER_DETAIL_ORDER_LINE_TYPE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_LINE_TYPE"), DropDownList)
            Dim SD_ORDER_DETAIL_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_NO"), TextBox)
            Dim SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_UP_LINE"), TextBox)
            Dim SD_ORDER_DETAIL_LOT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LOT_NO"), TextBox)
            Dim SD_ORDER_DETAIL_SERIAL_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SERIAL_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CREATE_WORK_ORDER As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CREATE_WORK_ORDER"), Checkbox)
            Dim SD_ORDER_DETAIL_CUSTOMER_ITEM_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_ITEM_NO"), TextBox)
            Dim SD_ORDER_DETAIL_ITEM_REVISION_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ITEM_REVISION_NO"), TextBox)
            Dim SD_ORDER_DETAIL_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DESCRIPTION"), TextBox)
            Dim SD_ORDER_DETAIL_AES_DESCRIPTION As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AES_DESCRIPTION"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY"), TextBox)
            Dim SD_ORDER_DETAIL_TRIM_SIZE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_SIZE"), TextBox)
            Dim DISP_SHIP_QTY As Label = CType(dgItem1.FindControl("DISP_SHIP_QTY"), Label)
            Dim SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_QTY_ZERO_PRICE"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_MULTIPLIER As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MULTIPLIER"), TextBox)
            Dim SD_ORDER_DETAIL_MSRP_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_MSRP_SALES_PRICE"), TextBox)
            Dim SD_ORDER_DETAIL_PRICING_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRICING_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_SALES_PRICE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SALES_PRICE"), TextBox)
            Dim SD_ORDER_DETAIL_EXPEDITE As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDITE"), Checkbox)
            Dim SD_ORDER_DETAIL_EXPEDIATE_VALUE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXPEDIATE_VALUE"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_EXTENDED_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_TAX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_TAX_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TAX_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_EXTRA_CHARGE_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_TOTAL_AMOUNT"), TextBox)
            Dim SD_ORDER_DETAIL_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BASE_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_PROJECT_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROJECT_NO"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_QTY_BASE_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_DUE_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DUE_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PROMISED_DELIVERY_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_REQUESTED_SHIP_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REQUESTED_SHIP_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_PRIORITY_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_PRIORITY_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_TIME_AND_MATERIAL As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TIME_AND_MATERIAL"), TextBox)
            Dim SD_ORDER_DETAIL_DRAWING_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_DRAWING_NO"), TextBox)
            Dim SD_ORDER_DETAIL_LICENSE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_NO"), TextBox)
            Dim SD_ORDER_DETAIL_END_USER_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_END_USER_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_AM_CODE As DropDownList = CType(dgItem1.FindControl("SD_ORDER_DETAIL_AM_CODE"), DropDownList)
            Dim SD_ORDER_DETAIL_SPIF As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_SPIF"), Checkbox)
            Dim SD_ORDER_DETAIL_CE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CE"), TextBox)
            Dim SD_ORDER_DETAIL_ATEX As Checkbox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX"), Checkbox)
            Dim SD_ORDER_DETAIL_ATEX_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ATEX_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_PO_LINE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PO_LINE_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CANCELED_QTY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY"), TextBox)
            Dim MSG_LICENSE As Label = CType(dgItem1.FindControl("MSG_LICENSE"), Label)
            Dim SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CANCELED_QTY_BASE_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_PRODUCTION_STATUS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_PRODUCTION_STATUS"), TextBox)
            Dim SD_ORDER_DETAIL_REASON_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_REASON_NOTES As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_REASON_NOTES"), TextBox)
            Dim SD_ORDER_DETAIL_BLANKET_RELEASE_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_BLANKET_RELEASE_NO"), TextBox)
            Dim SD_ORDER_DETAIL_WORK_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_WORK_ORDER_NO"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_SHIP_TO_CODE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_TO_CODE"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIPPING_ADDRESS"), TextBox)
            Dim SD_ORDER_DETAIL_LINE_SHIP_VIA As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LINE_SHIP_VIA"), TextBox)
            Dim SD_ORDER_DETAIL_INVOICE_BY As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_INVOICE_BY"), TextBox)
            Dim SD_ORDER_DETAIL_CUSTOMER_PO_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CUSTOMER_PO_DATE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CUSTOMER_PO_DATE"), TextBox)
            Dim SD_ORDER_DETAIL_ORDER_NO As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_ORDER_NO"), TextBox)
            Dim SD_ORDER_DETAIL_CONFIGURATOR_ID As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_CONFIGURATOR_ID"), TextBox)
            Dim SD_ORDER_DETAIL_TRIM_UOM As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_TRIM_UOM"), TextBox)
            Dim SD_ORDER_DETAIL_STOCK_DUTY_POINT As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_STOCK_DUTY_POINT"), TextBox)
            Dim SD_ORDER_DETAIL_HEAD_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_HEAD_UNITS"), TextBox)
            Dim SD_ORDER_DETAIL_FLOW_UNITS As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_FLOW_UNITS"), TextBox)
            Dim SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE As TextBox = CType(dgItem1.FindControl("SD_ORDER_DETAIL_LICENSE_TIED_IP_LINE"), TextBox)
if save.visible=True Then
  Call save_Click(sender, e)
End If
if not(mpanel.Visible=True and exception_message.Visible=True) Then
if (session("open_window_no")<>"") Then
session("open_window_no")=cstr(cint(session("open_window_no"))+1)
Else
session("open_window_no")="103"
End If
                        Dim strFile As String = "ATP"
Dim strCmd As String 
if (Session("HIDE_MENU_OPTIONS") = "Y" or Session("BROWSER_OPTIONS") = "Y") Then
                       strCmd = String.Format("window.open('ATP_SHOW_DETAILS.ASPX?ORDER_NO=" & Replace(Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&CUSTOMER_NO=" & Replace(Replace(Replace(SD_ORDER_HEADER_CUSTOMER_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&ITEM_NO=" & Replace(Replace(Replace(SD_ORDER_DETAIL_ITEM_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&QTY=" & Replace(Replace(Replace(SD_ORDER_DETAIL_ORDER_QTY.Text, "'", "%27"),"&","%26"),"#","%23") & "&LINE_NO=" & Replace(Replace(Replace(SD_ORDER_DETAIL_LINE_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&Retrive_id=" & Retrive.ClientID & "');", strFile)
Else
                       strCmd = String.Format("window.showModalDialog('ATP_SHOW_DETAILS.ASPX?ORDER_NO=" & Replace(Replace(Replace(SD_ORDER_HEADER_ORDER_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&CUSTOMER_NO=" & Replace(Replace(Replace(SD_ORDER_HEADER_CUSTOMER_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&ITEM_NO=" & Replace(Replace(Replace(SD_ORDER_DETAIL_ITEM_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&QTY=" & Replace(Replace(Replace(SD_ORDER_DETAIL_ORDER_QTY.Text, "'", "%27"),"&","%26"),"#","%23") & "&LINE_NO=" & Replace(Replace(Replace(SD_ORDER_DETAIL_LINE_NO.Text, "'", "%27"),"&","%26"),"#","%23") & "&Retrive_id=" & Retrive.ClientID & " ','win22SALESORDER" & session("open_window_no") & "','dialogWidth:1024px;dialogHeight:760px;center:yes;dialogHide:no;edge:raised;resizable:yes;scroll:yes;status:no;unadorned:no;');", strFile)
End If
                        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN45", strCmd, True)
End If
Catch ex As Exception
call insert_sys_log("Event_ORDER_ATPButton in Grid",ex.Message)
End Try
End Sub
Public Sub Copy1_imp

SD_ORDER_HEADER_REQUESTED_DATE_ECOPY.Text=NOW.DATE()
SD_ORDER_HEADER_ORDER_DATE_ECOPY.Text=NOW.DATE()
    End Sub
Protected Sub Copy2_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Copy2.Click
Try
 if (SD_ORDER_HEADER_ORDER_NO_ecopy.Text ="" ) Then
                SD_ORDER_HEADER_ORDER_NO_ECOPY.Text = CONN.SF_EXECUTE_DB_FUNCTION("SF_GET_SEQUENCE_ORDER_NO")
END If
 If (SD_ORDER_HEADER_ORDER_NO_ECOPY.Text<>"" and SD_ORDER_HEADER_ORDER_DATE_ECOPY.Text<>"" and SD_ORDER_HEADER_REQUESTED_DATE_ECOPY.Text<>"" and SD_ORDER_HEADER_AFFINITY_NO_ECOPY.Text<>""  ) Then
        dbad.InsertCommand.Connection = Session("db_connection")
SD_ORDER_HEADER_ORDER_NO_ecopy.Text=Trim(UCase(SD_ORDER_HEADER_ORDER_NO_ecopy.Text))
        dbad.InsertCommand.CommandText = "Insert into SD_ORDER_HEADER (ORDER_NO,BUSINESS_UNIT_CODE,ORDER_DATE,CUSTOMER_NO,NAME,STREET,CITY,STATE_CODE,POSTAL_CODE,COUNTRY,PHONE,FAX,EMAIL,CONTACT_NAME,DIFFERENT_BILLING_ADDRESS,BILLING_NAME,BILLING_STREET,BILLING_CITY,BILLING_STATE_CODE,BILLING_POSTAL_CODE,BILLING_COUNTRY,BILLING_PHONE,BILLING_FAX,BILLING_EMAIL,BILLING_CONTACT_NAME,DIFFERENT_SHIPPING_ADDRESS,SHIPTO_CODE,SHIPPING_NAME,SHIPPING_STREET,SHIPPING_CITY,SHIPPING_STATE_CODE,SHIPPING_POSTAL_CODE,SHIPPING_COUNTRY,SHIPPING_PHONE,SHIPPING_FAX,SHIPPING_EMAIL,SHIPPING_CONTACT_NAME,FREIGHT_BILLING_NAME,FREIGHT_BILLING_STREET,FREIGHT_BILLING_CITY,FREIGHT_BILLING_STATE_CODE,FREIGHT_BILLING_POSTAL_CODE,FREIGHT_BILLING_COUNTRY,FREIGHT_BILLING_PHONE,FREIGHT_BILLING_FAX,FREIGHT_BILLING_EMAIL,FREIGHT_BILLING_CONTACT_NAME,TERMS_CODE,SHIP_VIA,FOB,PAYMENT_METHOD,CUSTOMER_PO_NO,CUSTOMER_PO_DATE,SHIP_TO_PO_REFERENCE,REQUESTED_DATE,DUE_DATE,INTERNAL_NOTES,ORDER_NOTES,SHIPPING_INSTRUCTIONS,BLANKET_ORDER,ITEM_NO,BLANKET_QTY,ORDERING_UOM,BLANKET_QTY_BUOM,SALES_PRICE,PRICING_UOM,BLANKET_EFFECTIVE_FROM,BLANKET_EFFECTIVE_TILL,BLANKET_RELEASE_NO,INVOICE_BY,CUSTOMER_MESSAGE,CREATED_BY,CREATED_DATE,CHANGED_BY,CHANGED_DATE,BASE_CURRENCY_CODE,CONVERSION_CURRENCY_CODE,NO_OF_UNITS_OF_BASE_CURRENCY,NO_OF_UNITS_OF_CONVERSION_CURR,PRICE_FROM_PRICING_INFO,BALANCE_QTY_LINE,CONTACT_PHONE,CONTACT_EMAIL,ADVANCE_PERCENTAGE,ADVANCE_AMOUNT,ORDER_ACK_PREFERENCE,PROMISED_DELIVERY_DATE,PLANNING_STATUS,STATUS,QUOTATION_NO,CLOSE_DATE,CANCEL_DATE,HOLD,ULTIMATE_CONSIGNMENT,SHIP_COMPLETE,SE_PCT1,SE1,SE2,SE3,SE_PCT4,SE_PCT2,SE_PCT3,SE4,FLS_ORDER_NO,EXPORT_HOLD,FREIGHT_BILL_TYPE,CARRIER_ACC_NO,THIRD_PARTY_ADDRESS,EST_EXPORT_CLEARANCE_DATE,LICENSE_APPLICATION_REF,QUICK_SHIP,NONAG,ATEX_HOLD,AES_HOLD,INCOTERMS_LOCATION,PULL_INVENTORY_FROM_QRC,ORDER_ENTRY_SALES_CODE,QRC_SHIPPING_NO,QRC_LOCATION,WEB_ORDER_NO,INPROCESS,INPROCESS_MESSAGE,WEB_ORDER_CREATED_BY,SUGGESTED_DATE,AFFINITY_NO,DO_NOT_SERVICE) Select '" & replace_c(SD_ORDER_HEADER_ORDER_NO_ECOPY.Text) & "',BUSINESS_UNIT_CODE,NVL(to_date('" & replace_c(SD_ORDER_HEADER_ORDER_DATE_ECOPY.Text) & "','MM/DD/RRRR HH:MI:SS AM'),NULL),CUSTOMER_NO,NAME,STREET,CITY,STATE_CODE,POSTAL_CODE,COUNTRY,PHONE,FAX,EMAIL,CONTACT_NAME,DIFFERENT_BILLING_ADDRESS,BILLING_NAME,BILLING_STREET,BILLING_CITY,BILLING_STATE_CODE,BILLING_POSTAL_CODE,BILLING_COUNTRY,BILLING_PHONE,BILLING_FAX,BILLING_EMAIL,BILLING_CONTACT_NAME,DIFFERENT_SHIPPING_ADDRESS,SHIPTO_CODE,SHIPPING_NAME,SHIPPING_STREET,SHIPPING_CITY,SHIPPING_STATE_CODE,SHIPPING_POSTAL_CODE,SHIPPING_COUNTRY,SHIPPING_PHONE,SHIPPING_FAX,SHIPPING_EMAIL,SHIPPING_CONTACT_NAME,FREIGHT_BILLING_NAME,FREIGHT_BILLING_STREET,FREIGHT_BILLING_CITY,FREIGHT_BILLING_STATE_CODE,FREIGHT_BILLING_POSTAL_CODE,FREIGHT_BILLING_COUNTRY,FREIGHT_BILLING_PHONE,FREIGHT_BILLING_FAX,FREIGHT_BILLING_EMAIL,FREIGHT_BILLING_CONTACT_NAME,TERMS_CODE,SHIP_VIA,FOB,PAYMENT_METHOD,CUSTOMER_PO_NO,CUSTOMER_PO_DATE,SHIP_TO_PO_REFERENCE,NVL(to_date('" & replace_c(SD_ORDER_HEADER_REQUESTED_DATE_ECOPY.Text) & "','MM/DD/RRRR HH:MI:SS AM'),NULL),DUE_DATE,INTERNAL_NOTES,ORDER_NOTES,SHIPPING_INSTRUCTIONS,BLANKET_ORDER,ITEM_NO,BLANKET_QTY,ORDERING_UOM,BLANKET_QTY_BUOM,SALES_PRICE,PRICING_UOM,BLANKET_EFFECTIVE_FROM,BLANKET_EFFECTIVE_TILL,BLANKET_RELEASE_NO,INVOICE_BY,CUSTOMER_MESSAGE,'" & Session("user_id") & "',SYSDATE,NULL,NULL,BASE_CURRENCY_CODE,CONVERSION_CURRENCY_CODE,NO_OF_UNITS_OF_BASE_CURRENCY,NO_OF_UNITS_OF_CONVERSION_CURR,PRICE_FROM_PRICING_INFO,BALANCE_QTY_LINE,CONTACT_PHONE,CONTACT_EMAIL,ADVANCE_PERCENTAGE,ADVANCE_AMOUNT,ORDER_ACK_PREFERENCE,PROMISED_DELIVERY_DATE,PLANNING_STATUS,STATUS,QUOTATION_NO,CLOSE_DATE,CANCEL_DATE,HOLD,ULTIMATE_CONSIGNMENT,SHIP_COMPLETE,SE_PCT1,SE1,SE2,SE3,SE_PCT4,SE_PCT2,SE_PCT3,SE4,FLS_ORDER_NO,EXPORT_HOLD,FREIGHT_BILL_TYPE,CARRIER_ACC_NO,THIRD_PARTY_ADDRESS,EST_EXPORT_CLEARANCE_DATE,LICENSE_APPLICATION_REF,QUICK_SHIP,NONAG,ATEX_HOLD,AES_HOLD,INCOTERMS_LOCATION,PULL_INVENTORY_FROM_QRC,ORDER_ENTRY_SALES_CODE,QRC_SHIPPING_NO,QRC_LOCATION,WEB_ORDER_NO,INPROCESS,INPROCESS_MESSAGE,WEB_ORDER_CREATED_BY,SUGGESTED_DATE,'" & replace_c(SD_ORDER_HEADER_AFFINITY_NO_ECOPY.Text) & "',DO_NOT_SERVICE From SD_ORDER_HEADER where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "'"
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
        dbad.InsertCommand.ExecuteNonQuery()
        dbad.InsertCommand.CommandText = "Insert into SD_ORDERS_BILLING_STAGE (ORDER_NO,STAGE,BILLING_PERCENTAGE,READY_FOR_INOVICE_DATE,APPROVED_FOR_INOVICE,CREATED_BY,CREATED_DATE,CHANGED_BY,CHANGED_DATE,INVOICE_NO,LINE_NO) Select '" & replace_c(SD_ORDER_HEADER_ORDER_NO_ECOPY.Text) & "',STAGE,BILLING_PERCENTAGE,READY_FOR_INOVICE_DATE,APPROVED_FOR_INOVICE,'" & Session("user_id") & "',SYSDATE,NULL,NULL,INVOICE_NO,LINE_NO From SD_ORDERS_BILLING_STAGE where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
        dbad.InsertCommand.ExecuteNonQuery()
        dbad.InsertCommand.CommandText = "Insert into SD_ORDER_DETAIL (ORDER_NO,LINE_NO,ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,BASE_UOM,ORDER_QTY,ORDER_UOM,ORDER_QTY_BASE_UOM,SALES_PRICE,PRICING_UOM,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,INVOICE_BY,DUE_DATE,CANCELED_QTY,CANCELED_QTY_BASE_UOM,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,CREATE_WORK_ORDER,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,PROJECT_NO,CUSTOMER_PO_NO,CUSTOMER_PO_DATE,CREATED_BY,CREATED_DATE,CHANGED_BY,CHANGED_DATE,QUOTATION_NO,QUOTATION_LINE_NO,CONFIGURATOR_ID,CREATE_PACKING_SLIP,PICK_AND_PACK_NOTES,PICK_AND_PACK_QTY,TIME_AND_MATERIAL,CUSTOMER_SUPPLIED_MATERIAL,DRAWING_NO,ADDITIONAL_INFO1,ADDITIONAL_INFO2,PROMISED_DELIVERY_DATE,ORDER_DOC_TYPE,INTERNAL_NOTES,EDI_PREVIOUS_ORDER_QTY,EXPEDITE_NOTES,ORDER_PRIORITY_CODE,CUSTOMER_ITEM_NO,SERVICE_TICKET_NO,TOTAL_SURCHARGE,MSRP_SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,SERIES,MULTIPLIER,TRIM_SIZE,FLOW_VALUE,FLOW_UNITS,HEAD_VALUE,HEAD_UNITS,SG,VISCOSITY,SPEED,FLUID,CONCENTRATOR,TEMPERATURE,TEMP_UNITS,TAG_UNITS,STOCK_DUTY_POINT,TRIM_UOM,LICENSE_NO,END_USER_CODE,STATUS,COMMENTS,ASSEMBLED,READY_TO_SHIP,CSG_ITEM,CSG_STATUS,IMA_ITEM,IMA_STATUS,SLC_ITEM,SLC_STATUS,MAO_ITEM,MAO_STATUS,CSG_AVL,IMA_AVL,SLC_AVL,MAO_AVL,SHIP_THIS_PERIOD,PICK,PRINT,SPIF,ORDER_LINE_TYPE,SALES_QTY_ZERO_PRICE,LOT_NO,SERIAL_NO,AM_CODE,CE,ATEX,ATEX_CODE,ATEX_COMPL_ANCIL_EQUIP,SPEED_MIN_RPM,DRIVER_POWER,HZ,VOLTS,LANGUAGE_OF_USER,COUNTRY_OF_DESTINATION,SCOPE_OF_SUPPLY,LICENSE_TIED_UP_LINE,LICENSE_TIED_IP_LINE,AES_DESCRIPTION,QUICK_ORDER_FLAG,REQUESTED_SHIP_DATE,COPY_LINE,PRODUCTION_STATUS,PO_LINE_NO) Select '" & replace_c(SD_ORDER_HEADER_ORDER_NO_ECOPY.Text) & "',LINE_NO,ITEM_NO,ITEM_REVISION_NO,DESCRIPTION,BASE_UOM,ORDER_QTY,ORDER_UOM,ORDER_QTY_BASE_UOM,SALES_PRICE,PRICING_UOM,LINE_EXTENDED_AMOUNT,TAX_CODE,TAX_AMOUNT,EXTRA_CHARGE_AMOUNT,LINE_TOTAL_AMOUNT,INVOICE_BY,DUE_DATE,CANCELED_QTY,CANCELED_QTY_BASE_UOM,REASON_CODE,REASON_NOTES,BLANKET_RELEASE_NO,CREATE_WORK_ORDER,WORK_ORDER_NO,LINE_SHIP_TO_CODE,LINE_SHIPPING_ADDRESS,LINE_SHIP_VIA,PROJECT_NO,CUSTOMER_PO_NO,CUSTOMER_PO_DATE,'" & Session("user_id") & "',SYSDATE,NULL,NULL,QUOTATION_NO,QUOTATION_LINE_NO,CONFIGURATOR_ID,CREATE_PACKING_SLIP,PICK_AND_PACK_NOTES,PICK_AND_PACK_QTY,TIME_AND_MATERIAL,CUSTOMER_SUPPLIED_MATERIAL,DRAWING_NO,ADDITIONAL_INFO1,ADDITIONAL_INFO2,PROMISED_DELIVERY_DATE,ORDER_DOC_TYPE,INTERNAL_NOTES,EDI_PREVIOUS_ORDER_QTY,EXPEDITE_NOTES,ORDER_PRIORITY_CODE,CUSTOMER_ITEM_NO,SERVICE_TICKET_NO,TOTAL_SURCHARGE,MSRP_SALES_PRICE,EXPEDITE,EXPEDIATE_VALUE,SERIES,MULTIPLIER,TRIM_SIZE,FLOW_VALUE,FLOW_UNITS,HEAD_VALUE,HEAD_UNITS,SG,VISCOSITY,SPEED,FLUID,CONCENTRATOR,TEMPERATURE,TEMP_UNITS,TAG_UNITS,STOCK_DUTY_POINT,TRIM_UOM,LICENSE_NO,END_USER_CODE,STATUS,COMMENTS,ASSEMBLED,READY_TO_SHIP,CSG_ITEM,CSG_STATUS,IMA_ITEM,IMA_STATUS,SLC_ITEM,SLC_STATUS,MAO_ITEM,MAO_STATUS,CSG_AVL,IMA_AVL,SLC_AVL,MAO_AVL,SHIP_THIS_PERIOD,PICK,PRINT,SPIF,ORDER_LINE_TYPE,SALES_QTY_ZERO_PRICE,LOT_NO,SERIAL_NO,AM_CODE,CE,ATEX,ATEX_CODE,ATEX_COMPL_ANCIL_EQUIP,SPEED_MIN_RPM,DRIVER_POWER,HZ,VOLTS,LANGUAGE_OF_USER,COUNTRY_OF_DESTINATION,SCOPE_OF_SUPPLY,LICENSE_TIED_UP_LINE,LICENSE_TIED_IP_LINE,AES_DESCRIPTION,QUICK_ORDER_FLAG,REQUESTED_SHIP_DATE,COPY_LINE,PRODUCTION_STATUS,PO_LINE_NO From SD_ORDER_DETAIL where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
        dbad.InsertCommand.ExecuteNonQuery()
        dbad.InsertCommand.CommandText = "Insert into SD_SALES_REP_BY_SALES_ORDER (SALES_ORDER_NO,SALES_REP_NO,EFFECTIVE_FROM,EFFECTIVE_TILL,COMMISSION_RATE,CREATED_BY,CREATED_DATE,CHANGED_BY,CHANGED_DATE,LINE_NO) Select '" & replace_c(SD_ORDER_HEADER_ORDER_NO_ECOPY.Text) & "',SALES_REP_NO,EFFECTIVE_FROM,EFFECTIVE_TILL,COMMISSION_RATE,'" & Session("user_id") & "',SYSDATE,NULL,NULL,LINE_NO From SD_SALES_REP_BY_SALES_ORDER where SALES_ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
        dbad.InsertCommand.ExecuteNonQuery()
        dbad.InsertCommand.CommandText = "Insert into SD_ORDER_DETAIL_EXTRA_CHARGES (ORDER_NO,ORDER_LINE_NO,LINE_NO,EXTRA_CHARGE_CODE,DESCRIPTION,AMOUNT,CREATED_BY,CREATED_DATE,CHANGED_BY,CHANGED_DATE) Select '" & replace_c(SD_ORDER_HEADER_ORDER_NO_ECOPY.Text) & "',ORDER_LINE_NO,LINE_NO,EXTRA_CHARGE_CODE,DESCRIPTION,AMOUNT,'" & Session("user_id") & "',SYSDATE,NULL,NULL From SD_ORDER_DETAIL_EXTRA_CHARGES where ORDER_NO='" & replace_c(SD_ORDER_HEADER_ORDER_NO.Text) & "' "
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
        dbad.InsertCommand.ExecuteNonQuery()
        dbad.InsertCommand.Connection.Close()
call execute_storeProcedure("SP_CREATE_ORDERS_WORK_ORDER",SD_ORDER_HEADER_ORDER_NO_ecopy.TEXT & "#" & SESSION("USER_ID"),"P_ORDER_NO#P_USER_ID","C#C")
call execute_storeProcedure("SP_INSERT_BLANKET_LINE","SO" & "#" & SD_ORDER_HEADER_ORDER_NO_ecopy.TEXT & "#" & CHECK_BOX_R(SD_ORDER_HEADER_BLANKET_ORDER) & "#" & CHECK_BOX_R(SD_ORDER_HEADER_BALANCE_QTY_LINE),"P_DOC_TYPE#P_ORDER_NO#P_BLANKET_ORDER#P_INSERT_LINE","C#C#C#C")
call execute_storeProcedure("SP_UPDATE_ORDER_ADVANCE",SD_ORDER_HEADER_ORDER_NO_ecopy.TEXT & "#" & SD_ORDER_HEADER_ADVANCE_PERCENTAGE.TEXT,"P_ORDER_NO#P_ADVANCE_PERCENTAGE","C#N")
call execute_storeProcedure("SP_UPDATE_BILLING_STAGE",SD_ORDER_HEADER_ORDER_NO_ecopy.TEXT,"P_ORDER_NO","C")
call execute_storeProcedure("SP_UPDATE_DEFAULT_SALES_PRICE",SD_ORDER_HEADER_ORDER_NO_ecopy.TEXT & "#" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT,"P_ORDER_NO#P_CUSTOMER_NO","C#C")
call execute_storeProcedure("SP_CONVERT_TO_BLANKET_ORDER",SD_ORDER_HEADER_ORDER_NO_ecopy.TEXT & "#" & CHECK_BOX_R(SD_ORDER_HEADER_BLANKET_ORDER),"P_ORDER_NO#P_BLANKET_ORDER","C#C")
call execute_storeProcedure("PKG_SURCHARGE.SP_FILL_SURCHARGE_SO",SD_ORDER_HEADER_ORDER_NO_ecopy.TEXT & "#" & SESSION("USER_ID"),"P_ORDER_NO#P_USER","C#C")
call execute_storeProcedure("SP_UPD_LICNESE_TIE_UP",SD_ORDER_HEADER_ORDER_NO_ecopy.TEXT,"P_ORDER_NO","C")
call execute_storeProcedure("SP_UPDATE_SHIP_DELIVERY_DATE",SD_ORDER_HEADER_ORDER_NO_ecopy.TEXT & "#" & SD_ORDER_HEADER_CUSTOMER_NO.TEXT & "#" & SD_ORDER_HEADER_BUSINESS_UNIT_CODE.TEXT,"P_ORDER_NO#P_CUSTOMER_NO#P_BUSINESS_UNIT_CODE","C#C#C")
call execute_storeProcedure("SP_UPD_PO_LINE_NO",SD_ORDER_HEADER_ORDER_NO_ecopy.TEXT,"P_ORDER_NO","C")
Call conn.sf_execute_db_function("Pkg_Approval.Sf_CHECK_APPROVAL('SALES_ORDER','" & Replace(SD_ORDER_HEADER_ORDER_NO_ECOPY.Text,"'","''") & "',NULL,NULL,NULL,NULL,NULL)")
SD_ORDER_HEADER_ORDER_NO.Text=SD_ORDER_HEADER_ORDER_NO_ecopy.Text
 Call fill_header_info()
End If
Catch ex As Exception
call insert_sys_log("COPY_FEATURE",ex.Message)
End Try
    End Sub
Public Sub select_unselect_all(ByVal region_id As String, ByVal check_status As CheckBox, ByVal des_check As String)
        Dim dbg1 As New DataGrid
        Dim dgitem As DataGridItem
        dbg1 = CType(FindControlRecursive(Me, "dbg" & region_id), DataGrid)
        For Each dgitem In dbg1.Items
            Dim check1 As CheckBox = CType(dgitem.FindControl(des_check), CheckBox)
            If (check_status.Checked = True) Then
                check1.Checked = True
            Else
                check1.Checked = False
            End If
        Next
End Sub
Public Sub cka_ORDERDETAIL_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
Dim ckk as CheckBox
ckk = CType(sender, CheckBox)
call select_unselect_all("ORDERDETAIL",ckk,"CHECKBOX0")
End Sub
Public Sub cka_SALESREPBYSALESORDER_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
Dim ckk as CheckBox
ckk = CType(sender, CheckBox)
call select_unselect_all("SALESREPBYSALESORDER",ckk,"CHECKBOX0")
End Sub
Public Sub cka_BILLING_STAGE_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) 
Dim ckk as CheckBox
ckk = CType(sender, CheckBox)
call select_unselect_all("BILLING_STAGE",ckk,"CHECKBOX0")
End Sub
Protected Sub Edit_Related_links_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Edit_Related_links.Click
Try
        Dim strFile4 As String = "TEST1"
        Dim strCmd4 As String
        strCmd4 = String.Format("erlclk=window.open('EDIT_RELATED_LINKS.aspx?page_id=SALES_ORDER&Retrive_id=" & Retrive.ClientID & " ','_blank');erlclk.focus();", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN53", strCmd4, True)
Catch ex As Exception
call insert_sys_log("Edit Page LInks",ex.Message)
End Try
    End Sub
Protected Sub WHERE_USED_OBJECTS_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles WHERE_USED_OBJECTS.Click
Try
        Dim strFile4 As String = "WHEREUSED"
        Dim strCmd4 As String
        strCmd4 = String.Format("erlclk=window.open('WHERE_USED_OBJECTS.aspx?page_id=SALES_ORDER&Retrive_id=" & Retrive.ClientID & " ','_blank');erlclk.focus();", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN54", strCmd4, True)
Catch ex As Exception
call insert_sys_log("WHERE_USED_OBJECTS",ex.Message)
End Try
    End Sub
Protected Sub Edit_Page_links_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Edit_Page_links.Click
Try
        Dim strFile4 As String = "TEST"
        Dim strCmd4 As String
        strCmd4 = String.Format("erlclk=window.open('SYS_PAGE_MODEL.aspx?page_id=SALES_ORDER&Retrive_id=" & Retrive.ClientID & " ','_blank');erlclk.focus();", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN55", strCmd4, True)
Catch ex As Exception
call insert_sys_log("Edit Page LInks",ex.Message)
End Try
    End Sub
Protected Sub show_edit_links_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles show_edit_links.Click
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dsedt As New Data.DataSet
dbad.SelectCommand.CommandText = "SELECT COUNT(1) FROM SYS_PAGE_MODEL A, SYS_CHANGE_REQUEST_HEADER B WHERE A.CHANGE_REQUEST_NO IS NOT NULL  AND upper(A.PAGE_ID)='SALES_ORDER' AND A.CHANGE_REQUEST_NO =B.CHANGE_REQUEST_NO AND B.RELEASE_DATE IS NULL AND upper(B.CREATED_BY)=upper('" & session("user_id") & "')"
dsedt.Clear()
dbad.Fill(dsedt)
If (dsedt.Tables(0).Rows.Count > 0) Then
    If (dsedt.Tables(0).Rows(0)(0) > 0) Then
show_edit_links.Visible=False
Hide_edit_links.visible=True
imag1000.visible=True
aimag1000.visible=True
imag1085.visible=True
aimag1085.visible=True
imag1086.visible=True
aimag1086.visible=True
imag1087.visible=True
aimag1087.visible=True
imag1088.visible=True
aimag1088.visible=True
imag1089.visible=True
aimag1089.visible=True
imag1090.visible=True
aimag1090.visible=True
imag1091.visible=True
aimag1091.visible=True
imag1092.visible=True
aimag1092.visible=True
imag1093.visible=True
aimag1093.visible=True
imag1094.visible=True
aimag1094.visible=True
imag1095.visible=True
aimag1095.visible=True
imag10951.visible=True
aimag10951.visible=True
imag1096.visible=True
aimag1096.visible=True
imag1097.visible=True
aimag1097.visible=True
imag1098.visible=True
aimag1098.visible=True
imag1099.visible=True
aimag1099.visible=True
imag1100.visible=True
aimag1100.visible=True
imag1101.visible=True
aimag1101.visible=True
imag1102.visible=True
aimag1102.visible=True
imag1103.visible=True
aimag1103.visible=True
imag1104.visible=True
aimag1104.visible=True
imag1105.visible=True
aimag1105.visible=True
imag1106.visible=True
aimag1106.visible=True
imag1107.visible=True
aimag1107.visible=True
imag1108.visible=True
aimag1108.visible=True
imag1109.visible=True
aimag1109.visible=True
imag1110.visible=True
aimag1110.visible=True
imag1111.visible=True
aimag1111.visible=True
imag1112.visible=True
aimag1112.visible=True
imag1113.visible=True
aimag1113.visible=True
imag1114.visible=True
aimag1114.visible=True
imag1115.visible=True
aimag1115.visible=True
imag1116.visible=True
aimag1116.visible=True
imag1117.visible=True
aimag1117.visible=True
imag1118.visible=True
aimag1118.visible=True
imag1119.visible=True
aimag1119.visible=True
imag1120.visible=True
aimag1120.visible=True
imag1121.visible=True
aimag1121.visible=True
imag1122.visible=True
aimag1122.visible=True
imag1123.visible=True
aimag1123.visible=True
imag1124.visible=True
aimag1124.visible=True
imag1125.visible=True
aimag1125.visible=True
imag1126.visible=True
aimag1126.visible=True
imag1127.visible=True
aimag1127.visible=True
imag1128.visible=True
aimag1128.visible=True
imag1129.visible=True
aimag1129.visible=True
imag1130.visible=True
aimag1130.visible=True
imag1131.visible=True
aimag1131.visible=True
imag1132.visible=True
aimag1132.visible=True
imag1133.visible=True
aimag1133.visible=True
imag1134.visible=True
aimag1134.visible=True
imag1135.visible=True
aimag1135.visible=True
imag1136.visible=True
aimag1136.visible=True
imag1137.visible=True
aimag1137.visible=True
imag1138.visible=True
aimag1138.visible=True
imag1139.visible=True
aimag1139.visible=True
imag1140.visible=True
aimag1140.visible=True
imag1141.visible=True
aimag1141.visible=True
imag1142.visible=True
aimag1142.visible=True
imag1143.visible=True
aimag1143.visible=True
imag1144.visible=True
aimag1144.visible=True
imag1145.visible=True
aimag1145.visible=True
imag1146.visible=True
aimag1146.visible=True
imag1147.visible=True
aimag1147.visible=True
imag1148.visible=True
aimag1148.visible=True
imag1149.visible=True
aimag1149.visible=True
imag1150.visible=True
aimag1150.visible=True
imag1151.visible=True
aimag1151.visible=True
imag1152.visible=True
aimag1152.visible=True
imag1675.visible=True
aimag1675.visible=True
imag16965.visible=True
aimag16965.visible=True
imag1726.visible=True
aimag1726.visible=True
imag1729.visible=True
aimag1729.visible=True
imag18337.visible=True
aimag18337.visible=True
imag18338.visible=True
aimag18338.visible=True
imag18428.visible=True
aimag18428.visible=True
imag18547.visible=True
aimag18547.visible=True
imag18744.visible=True
aimag18744.visible=True
imag18749.visible=True
aimag18749.visible=True
imag18883.visible=True
aimag18883.visible=True
imag18884.visible=True
aimag18884.visible=True
imag18885.visible=True
aimag18885.visible=True
imag18886.visible=True
aimag18886.visible=True
imag18887.visible=True
aimag18887.visible=True
imag18888.visible=True
aimag18888.visible=True
imag18889.visible=True
aimag18889.visible=True
imag18890.visible=True
aimag18890.visible=True
imag18918.visible=True
aimag18918.visible=True
imag18924.visible=True
aimag18924.visible=True
imag18932.visible=True
aimag18932.visible=True
imag18945.visible=True
aimag18945.visible=True
imag18972.visible=True
aimag18972.visible=True
imag19060.visible=True
aimag19060.visible=True
imag19061.visible=True
aimag19061.visible=True
imag19093.visible=True
aimag19093.visible=True
imag19143.visible=True
aimag19143.visible=True
imag19201.visible=True
aimag19201.visible=True
imag19533.visible=True
aimag19533.visible=True
imag19648.visible=True
aimag19648.visible=True
imag19715.visible=True
aimag19715.visible=True
imag19794.visible=True
aimag19794.visible=True
imag20191.visible=True
aimag20191.visible=True
imag2028968.visible=True
aimag2028968.visible=True
imag2029087.visible=True
aimag2029087.visible=True
imag2029094.visible=True
aimag2029094.visible=True
imag2029314.visible=True
aimag2029314.visible=True
imag2029318.visible=True
aimag2029318.visible=True
imag2029323.visible=True
aimag2029323.visible=True
imag2029329.visible=True
aimag2029329.visible=True
imag2029333.visible=True
aimag2029333.visible=True
imag2029337.visible=True
aimag2029337.visible=True
imag2029341.visible=True
aimag2029341.visible=True
imag20295.visible=True
aimag20295.visible=True
imag20296.visible=True
aimag20296.visible=True
imag20297.visible=True
aimag20297.visible=True
imag20298.visible=True
aimag20298.visible=True
imag2032673.visible=True
aimag2032673.visible=True
imag2032698.visible=True
aimag2032698.visible=True
imag2032738.visible=True
aimag2032738.visible=True
imag3772.visible=True
aimag3772.visible=True
imag3773.visible=True
aimag3773.visible=True
imag3774.visible=True
aimag3774.visible=True
imag3775.visible=True
aimag3775.visible=True
imag5012.visible=True
aimag5012.visible=True
imag5015.visible=True
aimag5015.visible=True
imag5018.visible=True
aimag5018.visible=True
imag5282.visible=True
aimag5282.visible=True
imag5986.visible=True
aimag5986.visible=True
imag5987.visible=True
aimag5987.visible=True
imag6441.visible=True
aimag6441.visible=True
imag6442.visible=True
aimag6442.visible=True
imag6871.visible=True
aimag6871.visible=True
session("show_hide_links")="Y"
call show_hide_edit_links_grid()
Else
        Dim strFile4 As String = "slk"
        Dim strCmd4 As String
        strCmd4 = String.Format("alert('Changes are not allowed as it is locked  or Need to lock before doing changes');", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN56", strCmd4, True)
    End If
End If
    dbad.SelectCommand.Connection.Close()
Catch ex As Exception
call insert_sys_log("Show Edit LInks",ex.Message)
End Try
End Sub
Protected Sub hide_edit_links_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles hide_edit_links.Click
Try
show_edit_links.Visible=true
Hide_edit_links.visible=false
imag1000.visible=false
aimag1000.visible=false
imag1085.visible=false
aimag1085.visible=false
imag1086.visible=false
aimag1086.visible=false
imag1087.visible=false
aimag1087.visible=false
imag1088.visible=false
aimag1088.visible=false
imag1089.visible=false
aimag1089.visible=false
imag1090.visible=false
aimag1090.visible=false
imag1091.visible=false
aimag1091.visible=false
imag1092.visible=false
aimag1092.visible=false
imag1093.visible=false
aimag1093.visible=false
imag1094.visible=false
aimag1094.visible=false
imag1095.visible=false
aimag1095.visible=false
imag10951.visible=false
aimag10951.visible=false
imag1096.visible=false
aimag1096.visible=false
imag1097.visible=false
aimag1097.visible=false
imag1098.visible=false
aimag1098.visible=false
imag1099.visible=false
aimag1099.visible=false
imag1100.visible=false
aimag1100.visible=false
imag1101.visible=false
aimag1101.visible=false
imag1102.visible=false
aimag1102.visible=false
imag1103.visible=false
aimag1103.visible=false
imag1104.visible=false
aimag1104.visible=false
imag1105.visible=false
aimag1105.visible=false
imag1106.visible=false
aimag1106.visible=false
imag1107.visible=false
aimag1107.visible=false
imag1108.visible=false
aimag1108.visible=false
imag1109.visible=false
aimag1109.visible=false
imag1110.visible=false
aimag1110.visible=false
imag1111.visible=false
aimag1111.visible=false
imag1112.visible=false
aimag1112.visible=false
imag1113.visible=false
aimag1113.visible=false
imag1114.visible=false
aimag1114.visible=false
imag1115.visible=false
aimag1115.visible=false
imag1116.visible=false
aimag1116.visible=false
imag1117.visible=false
aimag1117.visible=false
imag1118.visible=false
aimag1118.visible=false
imag1119.visible=false
aimag1119.visible=false
imag1120.visible=false
aimag1120.visible=false
imag1121.visible=false
aimag1121.visible=false
imag1122.visible=false
aimag1122.visible=false
imag1123.visible=false
aimag1123.visible=false
imag1124.visible=false
aimag1124.visible=false
imag1125.visible=false
aimag1125.visible=false
imag1126.visible=false
aimag1126.visible=false
imag1127.visible=false
aimag1127.visible=false
imag1128.visible=false
aimag1128.visible=false
imag1129.visible=false
aimag1129.visible=false
imag1130.visible=false
aimag1130.visible=false
imag1131.visible=false
aimag1131.visible=false
imag1132.visible=false
aimag1132.visible=false
imag1133.visible=false
aimag1133.visible=false
imag1134.visible=false
aimag1134.visible=false
imag1135.visible=false
aimag1135.visible=false
imag1136.visible=false
aimag1136.visible=false
imag1137.visible=false
aimag1137.visible=false
imag1138.visible=false
aimag1138.visible=false
imag1139.visible=false
aimag1139.visible=false
imag1140.visible=false
aimag1140.visible=false
imag1141.visible=false
aimag1141.visible=false
imag1142.visible=false
aimag1142.visible=false
imag1143.visible=false
aimag1143.visible=false
imag1144.visible=false
aimag1144.visible=false
imag1145.visible=false
aimag1145.visible=false
imag1146.visible=false
aimag1146.visible=false
imag1147.visible=false
aimag1147.visible=false
imag1148.visible=false
aimag1148.visible=false
imag1149.visible=false
aimag1149.visible=false
imag1150.visible=false
aimag1150.visible=false
imag1151.visible=false
aimag1151.visible=false
imag1152.visible=false
aimag1152.visible=false
imag1675.visible=false
aimag1675.visible=false
imag16965.visible=false
aimag16965.visible=false
imag1726.visible=false
aimag1726.visible=false
imag1729.visible=false
aimag1729.visible=false
imag18337.visible=false
aimag18337.visible=false
imag18338.visible=false
aimag18338.visible=false
imag18428.visible=false
aimag18428.visible=false
imag18547.visible=false
aimag18547.visible=false
imag18744.visible=false
aimag18744.visible=false
imag18749.visible=false
aimag18749.visible=false
imag18883.visible=false
aimag18883.visible=false
imag18884.visible=false
aimag18884.visible=false
imag18885.visible=false
aimag18885.visible=false
imag18886.visible=false
aimag18886.visible=false
imag18887.visible=false
aimag18887.visible=false
imag18888.visible=false
aimag18888.visible=false
imag18889.visible=false
aimag18889.visible=false
imag18890.visible=false
aimag18890.visible=false
imag18918.visible=false
aimag18918.visible=false
imag18924.visible=false
aimag18924.visible=false
imag18932.visible=false
aimag18932.visible=false
imag18945.visible=false
aimag18945.visible=false
imag18972.visible=false
aimag18972.visible=false
imag19060.visible=false
aimag19060.visible=false
imag19061.visible=false
aimag19061.visible=false
imag19093.visible=false
aimag19093.visible=false
imag19143.visible=false
aimag19143.visible=false
imag19201.visible=false
aimag19201.visible=false
imag19533.visible=false
aimag19533.visible=false
imag19648.visible=false
aimag19648.visible=false
imag19715.visible=false
aimag19715.visible=false
imag19794.visible=false
aimag19794.visible=false
imag20191.visible=false
aimag20191.visible=false
imag2028968.visible=false
aimag2028968.visible=false
imag2029087.visible=false
aimag2029087.visible=false
imag2029094.visible=false
aimag2029094.visible=false
imag2029314.visible=false
aimag2029314.visible=false
imag2029318.visible=false
aimag2029318.visible=false
imag2029323.visible=false
aimag2029323.visible=false
imag2029329.visible=false
aimag2029329.visible=false
imag2029333.visible=false
aimag2029333.visible=false
imag2029337.visible=false
aimag2029337.visible=false
imag2029341.visible=false
aimag2029341.visible=false
imag20295.visible=false
aimag20295.visible=false
imag20296.visible=false
aimag20296.visible=false
imag20297.visible=false
aimag20297.visible=false
imag20298.visible=false
aimag20298.visible=false
imag2032673.visible=false
aimag2032673.visible=false
imag2032698.visible=false
aimag2032698.visible=false
imag2032738.visible=false
aimag2032738.visible=false
imag3772.visible=false
aimag3772.visible=false
imag3773.visible=false
aimag3773.visible=false
imag3774.visible=false
aimag3774.visible=false
imag3775.visible=false
aimag3775.visible=false
imag5012.visible=false
aimag5012.visible=false
imag5015.visible=false
aimag5015.visible=false
imag5018.visible=false
aimag5018.visible=false
imag5282.visible=false
aimag5282.visible=false
imag5986.visible=false
aimag5986.visible=false
imag5987.visible=false
aimag5987.visible=false
imag6441.visible=false
aimag6441.visible=false
imag6442.visible=false
aimag6442.visible=false
imag6871.visible=false
aimag6871.visible=false
session("show_hide_links")="N"
call show_hide_edit_links_grid()
Catch ex As Exception
call insert_sys_log("Hide Edit LInks",ex.Message)
End Try
End Sub
Public sub show_hide_edit_links_grid()
Try
Dim dgitem As DataGridItem
 Dim tname As Table
Dim i As Integer
 tname = dbgBILLING_STAGE.Controls(0)
For i = 0 To tname.Rows.Count - 1
dgitem = tname.Rows(i)
If (dgitem.ItemType = ListItemType.Header) Then
Try
Dim img111745 As Image = CType(dgitem.FindControl("imag11745"), Image)
if (session("show_hide_links")="Y") Then
img111745.Visible = True
Else
img111745.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img19703 As Image = CType(dgitem.FindControl("imag9703"), Image)
if (session("show_hide_links")="Y") Then
img19703.Visible = True
Else
img19703.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img19704 As Image = CType(dgitem.FindControl("imag9704"), Image)
if (session("show_hide_links")="Y") Then
img19704.Visible = True
Else
img19704.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img19705 As Image = CType(dgitem.FindControl("imag9705"), Image)
if (session("show_hide_links")="Y") Then
img19705.Visible = True
Else
img19705.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img19706 As Image = CType(dgitem.FindControl("imag9706"), Image)
if (session("show_hide_links")="Y") Then
img19706.Visible = True
Else
img19706.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img19707 As Image = CType(dgitem.FindControl("imag9707"), Image)
if (session("show_hide_links")="Y") Then
img19707.Visible = True
Else
img19707.Visible = False
End If
Catch ex As Exception
End Try
 Exit For
 End If
 Next
 tname = dbgORDERDETAIL.Controls(0)
For i = 0 To tname.Rows.Count - 1
dgitem = tname.Rows(i)
If (dgitem.ItemType = ListItemType.Header) Then
Try
Dim img11169 As Image = CType(dgitem.FindControl("imag1169"), Image)
if (session("show_hide_links")="Y") Then
img11169.Visible = True
Else
img11169.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11170 As Image = CType(dgitem.FindControl("imag1170"), Image)
if (session("show_hide_links")="Y") Then
img11170.Visible = True
Else
img11170.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11171 As Image = CType(dgitem.FindControl("imag1171"), Image)
if (session("show_hide_links")="Y") Then
img11171.Visible = True
Else
img11171.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11172 As Image = CType(dgitem.FindControl("imag1172"), Image)
if (session("show_hide_links")="Y") Then
img11172.Visible = True
Else
img11172.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11173 As Image = CType(dgitem.FindControl("imag1173"), Image)
if (session("show_hide_links")="Y") Then
img11173.Visible = True
Else
img11173.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11174 As Image = CType(dgitem.FindControl("imag1174"), Image)
if (session("show_hide_links")="Y") Then
img11174.Visible = True
Else
img11174.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11175 As Image = CType(dgitem.FindControl("imag1175"), Image)
if (session("show_hide_links")="Y") Then
img11175.Visible = True
Else
img11175.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11176 As Image = CType(dgitem.FindControl("imag1176"), Image)
if (session("show_hide_links")="Y") Then
img11176.Visible = True
Else
img11176.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11177 As Image = CType(dgitem.FindControl("imag1177"), Image)
if (session("show_hide_links")="Y") Then
img11177.Visible = True
Else
img11177.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11178 As Image = CType(dgitem.FindControl("imag1178"), Image)
if (session("show_hide_links")="Y") Then
img11178.Visible = True
Else
img11178.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11179 As Image = CType(dgitem.FindControl("imag1179"), Image)
if (session("show_hide_links")="Y") Then
img11179.Visible = True
Else
img11179.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11180 As Image = CType(dgitem.FindControl("imag1180"), Image)
if (session("show_hide_links")="Y") Then
img11180.Visible = True
Else
img11180.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11181 As Image = CType(dgitem.FindControl("imag1181"), Image)
if (session("show_hide_links")="Y") Then
img11181.Visible = True
Else
img11181.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11182 As Image = CType(dgitem.FindControl("imag1182"), Image)
if (session("show_hide_links")="Y") Then
img11182.Visible = True
Else
img11182.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11183 As Image = CType(dgitem.FindControl("imag1183"), Image)
if (session("show_hide_links")="Y") Then
img11183.Visible = True
Else
img11183.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11184 As Image = CType(dgitem.FindControl("imag1184"), Image)
if (session("show_hide_links")="Y") Then
img11184.Visible = True
Else
img11184.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11185 As Image = CType(dgitem.FindControl("imag1185"), Image)
if (session("show_hide_links")="Y") Then
img11185.Visible = True
Else
img11185.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11186 As Image = CType(dgitem.FindControl("imag1186"), Image)
if (session("show_hide_links")="Y") Then
img11186.Visible = True
Else
img11186.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11187 As Image = CType(dgitem.FindControl("imag1187"), Image)
if (session("show_hide_links")="Y") Then
img11187.Visible = True
Else
img11187.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11188 As Image = CType(dgitem.FindControl("imag1188"), Image)
if (session("show_hide_links")="Y") Then
img11188.Visible = True
Else
img11188.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11189 As Image = CType(dgitem.FindControl("imag1189"), Image)
if (session("show_hide_links")="Y") Then
img11189.Visible = True
Else
img11189.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11213 As Image = CType(dgitem.FindControl("imag1213"), Image)
if (session("show_hide_links")="Y") Then
img11213.Visible = True
Else
img11213.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11214 As Image = CType(dgitem.FindControl("imag1214"), Image)
if (session("show_hide_links")="Y") Then
img11214.Visible = True
Else
img11214.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11215 As Image = CType(dgitem.FindControl("imag1215"), Image)
if (session("show_hide_links")="Y") Then
img11215.Visible = True
Else
img11215.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img113317 As Image = CType(dgitem.FindControl("imag13317"), Image)
if (session("show_hide_links")="Y") Then
img113317.Visible = True
Else
img113317.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11524 As Image = CType(dgitem.FindControl("imag1524"), Image)
if (session("show_hide_links")="Y") Then
img11524.Visible = True
Else
img11524.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img115997 As Image = CType(dgitem.FindControl("imag15997"), Image)
if (session("show_hide_links")="Y") Then
img115997.Visible = True
Else
img115997.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11676 As Image = CType(dgitem.FindControl("imag1676"), Image)
if (session("show_hide_links")="Y") Then
img11676.Visible = True
Else
img11676.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11699 As Image = CType(dgitem.FindControl("imag1699"), Image)
if (session("show_hide_links")="Y") Then
img11699.Visible = True
Else
img11699.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11704 As Image = CType(dgitem.FindControl("imag1704"), Image)
if (session("show_hide_links")="Y") Then
img11704.Visible = True
Else
img11704.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11705 As Image = CType(dgitem.FindControl("imag1705"), Image)
if (session("show_hide_links")="Y") Then
img11705.Visible = True
Else
img11705.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11716 As Image = CType(dgitem.FindControl("imag1716"), Image)
if (session("show_hide_links")="Y") Then
img11716.Visible = True
Else
img11716.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11728 As Image = CType(dgitem.FindControl("imag1728"), Image)
if (session("show_hide_links")="Y") Then
img11728.Visible = True
Else
img11728.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11797 As Image = CType(dgitem.FindControl("imag1797"), Image)
if (session("show_hide_links")="Y") Then
img11797.Visible = True
Else
img11797.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img11798 As Image = CType(dgitem.FindControl("imag1798"), Image)
if (session("show_hide_links")="Y") Then
img11798.Visible = True
Else
img11798.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img118023 As Image = CType(dgitem.FindControl("imag18023"), Image)
if (session("show_hide_links")="Y") Then
img118023.Visible = True
Else
img118023.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img118024 As Image = CType(dgitem.FindControl("imag18024"), Image)
if (session("show_hide_links")="Y") Then
img118024.Visible = True
Else
img118024.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img118029 As Image = CType(dgitem.FindControl("imag18029"), Image)
if (session("show_hide_links")="Y") Then
img118029.Visible = True
Else
img118029.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img118034 As Image = CType(dgitem.FindControl("imag18034"), Image)
if (session("show_hide_links")="Y") Then
img118034.Visible = True
Else
img118034.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img118412 As Image = CType(dgitem.FindControl("imag18412"), Image)
if (session("show_hide_links")="Y") Then
img118412.Visible = True
Else
img118412.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img118416 As Image = CType(dgitem.FindControl("imag18416"), Image)
if (session("show_hide_links")="Y") Then
img118416.Visible = True
Else
img118416.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img118420 As Image = CType(dgitem.FindControl("imag18420"), Image)
if (session("show_hide_links")="Y") Then
img118420.Visible = True
Else
img118420.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img118424 As Image = CType(dgitem.FindControl("imag18424"), Image)
if (session("show_hide_links")="Y") Then
img118424.Visible = True
Else
img118424.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img118551 As Image = CType(dgitem.FindControl("imag18551"), Image)
if (session("show_hide_links")="Y") Then
img118551.Visible = True
Else
img118551.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img118556 As Image = CType(dgitem.FindControl("imag18556"), Image)
if (session("show_hide_links")="Y") Then
img118556.Visible = True
Else
img118556.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119070 As Image = CType(dgitem.FindControl("imag19070"), Image)
if (session("show_hide_links")="Y") Then
img119070.Visible = True
Else
img119070.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119098 As Image = CType(dgitem.FindControl("imag19098"), Image)
if (session("show_hide_links")="Y") Then
img119098.Visible = True
Else
img119098.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119104 As Image = CType(dgitem.FindControl("imag19104"), Image)
if (session("show_hide_links")="Y") Then
img119104.Visible = True
Else
img119104.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119138 As Image = CType(dgitem.FindControl("imag19138"), Image)
if (session("show_hide_links")="Y") Then
img119138.Visible = True
Else
img119138.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119156 As Image = CType(dgitem.FindControl("imag19156"), Image)
if (session("show_hide_links")="Y") Then
img119156.Visible = True
Else
img119156.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119157 As Image = CType(dgitem.FindControl("imag19157"), Image)
if (session("show_hide_links")="Y") Then
img119157.Visible = True
Else
img119157.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119359 As Image = CType(dgitem.FindControl("imag19359"), Image)
if (session("show_hide_links")="Y") Then
img119359.Visible = True
Else
img119359.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119516 As Image = CType(dgitem.FindControl("imag19516"), Image)
if (session("show_hide_links")="Y") Then
img119516.Visible = True
Else
img119516.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119517 As Image = CType(dgitem.FindControl("imag19517"), Image)
if (session("show_hide_links")="Y") Then
img119517.Visible = True
Else
img119517.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119518 As Image = CType(dgitem.FindControl("imag19518"), Image)
if (session("show_hide_links")="Y") Then
img119518.Visible = True
Else
img119518.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img119795 As Image = CType(dgitem.FindControl("imag19795"), Image)
if (session("show_hide_links")="Y") Then
img119795.Visible = True
Else
img119795.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img120187 As Image = CType(dgitem.FindControl("imag20187"), Image)
if (session("show_hide_links")="Y") Then
img120187.Visible = True
Else
img120187.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img120188 As Image = CType(dgitem.FindControl("imag20188"), Image)
if (session("show_hide_links")="Y") Then
img120188.Visible = True
Else
img120188.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img12028387 As Image = CType(dgitem.FindControl("imag2028387"), Image)
if (session("show_hide_links")="Y") Then
img12028387.Visible = True
Else
img12028387.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img12029095 As Image = CType(dgitem.FindControl("imag2029095"), Image)
if (session("show_hide_links")="Y") Then
img12029095.Visible = True
Else
img12029095.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img12029327 As Image = CType(dgitem.FindControl("imag2029327"), Image)
if (session("show_hide_links")="Y") Then
img12029327.Visible = True
Else
img12029327.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img12032680 As Image = CType(dgitem.FindControl("imag2032680"), Image)
if (session("show_hide_links")="Y") Then
img12032680.Visible = True
Else
img12032680.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img12032720 As Image = CType(dgitem.FindControl("imag2032720"), Image)
if (session("show_hide_links")="Y") Then
img12032720.Visible = True
Else
img12032720.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img12032724 As Image = CType(dgitem.FindControl("imag2032724"), Image)
if (session("show_hide_links")="Y") Then
img12032724.Visible = True
Else
img12032724.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img15774 As Image = CType(dgitem.FindControl("imag5774"), Image)
if (session("show_hide_links")="Y") Then
img15774.Visible = True
Else
img15774.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img15775 As Image = CType(dgitem.FindControl("imag5775"), Image)
if (session("show_hide_links")="Y") Then
img15775.Visible = True
Else
img15775.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img16003 As Image = CType(dgitem.FindControl("imag6003"), Image)
if (session("show_hide_links")="Y") Then
img16003.Visible = True
Else
img16003.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img17069 As Image = CType(dgitem.FindControl("imag7069"), Image)
if (session("show_hide_links")="Y") Then
img17069.Visible = True
Else
img17069.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img17463 As Image = CType(dgitem.FindControl("imag7463"), Image)
if (session("show_hide_links")="Y") Then
img17463.Visible = True
Else
img17463.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img18641 As Image = CType(dgitem.FindControl("imag8641"), Image)
if (session("show_hide_links")="Y") Then
img18641.Visible = True
Else
img18641.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img18881 As Image = CType(dgitem.FindControl("imag8881"), Image)
if (session("show_hide_links")="Y") Then
img18881.Visible = True
Else
img18881.Visible = False
End If
Catch ex As Exception
End Try
 Exit For
 End If
 Next
 tname = dbgSALESREPBYSALESORDER.Controls(0)
For i = 0 To tname.Rows.Count - 1
dgitem = tname.Rows(i)
If (dgitem.ItemType = ListItemType.Header) Then
Try
Dim img16969 As Image = CType(dgitem.FindControl("imag6969"), Image)
if (session("show_hide_links")="Y") Then
img16969.Visible = True
Else
img16969.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img16971 As Image = CType(dgitem.FindControl("imag6971"), Image)
if (session("show_hide_links")="Y") Then
img16971.Visible = True
Else
img16971.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img16972 As Image = CType(dgitem.FindControl("imag6972"), Image)
if (session("show_hide_links")="Y") Then
img16972.Visible = True
Else
img16972.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img16973 As Image = CType(dgitem.FindControl("imag6973"), Image)
if (session("show_hide_links")="Y") Then
img16973.Visible = True
Else
img16973.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img16974 As Image = CType(dgitem.FindControl("imag6974"), Image)
if (session("show_hide_links")="Y") Then
img16974.Visible = True
Else
img16974.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img17720 As Image = CType(dgitem.FindControl("imag7720"), Image)
if (session("show_hide_links")="Y") Then
img17720.Visible = True
Else
img17720.Visible = False
End If
Catch ex As Exception
End Try
Try
Dim img17721 As Image = CType(dgitem.FindControl("imag7721"), Image)
if (session("show_hide_links")="Y") Then
img17721.Visible = True
Else
img17721.Visible = False
End If
Catch ex As Exception
End Try
 Exit For
 End If
 Next
Catch ex As Exception
call insert_sys_log("Show Hide Edit Links",ex.Message)
End Try
End Sub
Protected Sub Show_preferences_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Show_preferences.Click
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dsedt,dsedt1,dsedt2 As New Data.DataSet
dbad.SelectCommand.CommandText = "SELECT COUNT(1) FROM SYS_PAGE_MODEL WHERE CHANGE_REQUEST_NO IS NULL  AND upper(PAGE_ID)='SALES_ORDER'"
dsedt1.Clear()
dbad.Fill(dsedt1)
dbad.SelectCommand.CommandText = "SELECT COUNT(1) FROM SYS_PAGE_MODEL A, SYS_CHANGE_REQUEST_HEADER B WHERE A.CHANGE_REQUEST_NO IS NOT NULL  AND upper(A.PAGE_ID)='SALES_ORDER' AND A.CHANGE_REQUEST_NO =B.CHANGE_REQUEST_NO AND B.RELEASE_DATE IS NULL AND upper(B.CREATED_BY)=upper('" & session("user_id") & "')"
dsedt.Clear()
dbad.Fill(dsedt)
If (dsedt.Tables(0).Rows.Count > 0) Then
    If (dsedt.Tables(0).Rows(0)(0) > 0 or dsedt1.Tables(0).Rows(0)(0) > 0) Then
dbad.SelectCommand.CommandText = "SELECT CHANGE_REQUEST_NO FROM SYS_PAGE_MODEL WHERE CHANGE_REQUEST_NO IS NOT NULL  AND upper(PAGE_ID)='SALES_ORDER'"
dsedt2.Clear()
dbad.Fill(dsedt2)
        Dim strFile4 As String = "Preferences"
        Dim strCmd4 As String
If (dsedt2.Tables(0).Rows.Count > 0) Then
        strCmd4 = String.Format("erlclk=window.open('PRE_SHOW_PREFERENCES.aspx?page_id=SALES_ORDER&pname=Orders&mflag=Y&CHANGE_REQUEST_NO=" & dsedt2.Tables(0).Rows(0)(0) & "&searid=SD_ORDERS_SEARCH','_blank');erlclk.focus();", strFile4)
Else
        strCmd4 = String.Format("erlclk=window.open('PRE_SHOW_PREFERENCES.aspx?page_id=SALES_ORDER&pname=Orders&mflag=Y&searid=SD_ORDERS_SEARCH','_blank');erlclk.focus();", strFile4)
    End If
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN57", strCmd4, True)
Else
        Dim strFile4 As String = "slk"
        Dim strCmd4 As String
        strCmd4 = String.Format("alert('Changes are not allowed as it is locked.');", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN58", strCmd4, True)
    End If
End If
    dbad.SelectCommand.Connection.Close()
Catch ex As Exception
call insert_sys_log("Edit Page LInks",ex.Message)
End Try
    End Sub
Protected Sub ADD_NEW_BUTTON_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles ADD_NEW_BUTTON.Click
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dsedt,dsedt1,dsedt2 As New Data.DataSet
dbad.SelectCommand.CommandText = "SELECT COUNT(1) FROM SYS_PAGE_MODEL WHERE CHANGE_REQUEST_NO IS NULL  AND upper(PAGE_ID)='SALES_ORDER'"
dsedt1.Clear()
dbad.Fill(dsedt1)
dbad.SelectCommand.CommandText = "SELECT COUNT(1) FROM SYS_PAGE_MODEL A, SYS_CHANGE_REQUEST_HEADER B WHERE A.CHANGE_REQUEST_NO IS NOT NULL  AND upper(A.PAGE_ID)='SALES_ORDER' AND A.CHANGE_REQUEST_NO =B.CHANGE_REQUEST_NO AND B.RELEASE_DATE IS NULL AND upper(B.CREATED_BY)=upper('" & session("user_id") & "')"
dsedt.Clear()
dbad.Fill(dsedt)
If (dsedt.Tables(0).Rows.Count > 0) Then
    If (dsedt.Tables(0).Rows(0)(0) > 0 or dsedt1.Tables(0).Rows(0)(0) > 0) Then
dbad.SelectCommand.CommandText = "SELECT CHANGE_REQUEST_NO FROM SYS_PAGE_MODEL WHERE CHANGE_REQUEST_NO IS NOT NULL  AND upper(PAGE_ID)='SALES_ORDER'"
dsedt2.Clear()
dbad.Fill(dsedt2)
        Dim strFile4 As String = "addnewbutton"
        Dim strCmd4 As String
If (dsedt2.Tables(0).Rows.Count > 0) Then
        strCmd4 = String.Format("erlclk=window.open('PRE_ADD_NEW_BUTTON.aspx?page_id=SALES_ORDER&pname=Orders&mflag=Y&CHANGE_REQUEST_NO=" & dsedt2.Tables(0).Rows(0)(0) & "&searid=SD_ORDERS_SEARCH','_blank');erlclk.focus();", strFile4)
Else
        strCmd4 = String.Format("erlclk=window.open('PRE_ADD_NEW_BUTTON.aspx?page_id=SALES_ORDER&pname=Orders&mflag=Y&searid=SD_ORDERS_SEARCH','_blank');erlclk.focus();", strFile4)
    End If
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN59", strCmd4, True)
Else
        Dim strFile4 As String = "slk"
        Dim strCmd4 As String
        strCmd4 = String.Format("alert('Changes are not allowed as it is locked.');", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN60", strCmd4, True)
    End If
End If
    dbad.SelectCommand.Connection.Close()
Catch ex As Exception
call insert_sys_log("Edit Page LInks",ex.Message)
End Try
    End Sub
Protected Sub ADD_NEW_FIELD_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles ADD_NEW_FIELD.Click
Try
dbad.SelectCommand.Connection = Session("db_connection")
Dim dsedt,dsedt1,dsedt2 As New Data.DataSet
dbad.SelectCommand.CommandText = "SELECT COUNT(1) FROM SYS_PAGE_MODEL WHERE CHANGE_REQUEST_NO IS NULL  AND upper(PAGE_ID)='SALES_ORDER'"
dsedt1.Clear()
dbad.Fill(dsedt1)
dbad.SelectCommand.CommandText = "SELECT COUNT(1) FROM SYS_PAGE_MODEL A, SYS_CHANGE_REQUEST_HEADER B WHERE A.CHANGE_REQUEST_NO IS NOT NULL  AND upper(A.PAGE_ID)='SALES_ORDER' AND A.CHANGE_REQUEST_NO =B.CHANGE_REQUEST_NO AND B.RELEASE_DATE IS NULL AND upper(B.CREATED_BY)=upper('" & session("user_id") & "')"
dsedt.Clear()
dbad.Fill(dsedt)
If (dsedt.Tables(0).Rows.Count > 0) Then
    If (dsedt.Tables(0).Rows(0)(0) > 0 or dsedt1.Tables(0).Rows(0)(0) > 0) Then
        Dim strFile4 As String = "Addnew"
        Dim strCmd4 As String
dbad.SelectCommand.CommandText = "SELECT CHANGE_REQUEST_NO FROM SYS_PAGE_MODEL WHERE CHANGE_REQUEST_NO IS not NULL  AND upper(PAGE_ID)='SALES_ORDER'"
dsedt2.Clear()
dbad.Fill(dsedt2)
If (dsedt2.Tables(0).Rows.Count > 0) Then
        strCmd4 = String.Format("erlclk=window.open('PRE_ADD_NEW_FIELD.aspx?page_id=SALES_ORDER&pname=Orders&CHANGE_REQUEST_NO=" & dsedt2.Tables(0).Rows(0)(0) & "&Retrive_id=" & Retrive.ClientID & " ','_blank');erlclk.focus();", strFile4)
Else
        strCmd4 = String.Format("erlclk=window.open('PRE_ADD_NEW_FIELD.aspx?page_id=SALES_ORDER&pname=Orders&Retrive_id=" & Retrive.ClientID & " ','_blank');erlclk.focus();", strFile4)
    End If
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN61", strCmd4, True)
Else
        Dim strFile4 As String = "slk"
        Dim strCmd4 As String
        strCmd4 = String.Format("alert('Changes are not allowed as it is locked.');", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN62", strCmd4, True)
    End If
End If
    dbad.SelectCommand.Connection.Close()
Catch ex As Exception
call insert_sys_log("Edit Page LInks",ex.Message)
End Try
    End Sub
Protected Sub VIEW_PAGE_MODEL_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles VIEW_PAGE_MODEL.Click
Try
        Dim strFile4 As String = "View Page"
        Dim strCmd4 As String
        strCmd4 = String.Format("erlcl12=window.open('SYS_VIEW_PAGE_MODEL.aspx?PAGE_ID=SALES_ORDER&Retrive_id=" & Retrive.ClientID & " ','_blank');erlcl12.focus();", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN63", strCmd4, True)
Catch ex As Exception
call insert_sys_log("View Page",ex.Message)
End Try
    End Sub
Protected Sub Edit_Page_Help_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Edit_Page_Help.Click
Try
        Dim strFile4 As String = "Addnew"
        Dim strCmd4 As String
        strCmd4 = String.Format("erlclk=window.open('SYS_PAGE_HELP_OVERVIEW.aspx?page_id=SALES_ORDER&Retrive_id=" & Retrive.ClientID & " ','_blank');erlclk.focus();", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN64", strCmd4, True)
Catch ex As Exception
call insert_sys_log("Edit Page Help",ex.Message)
End Try
    End Sub
Protected Sub Edit_Page_CUSTOM_Help_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Edit_Page_CUSTOM_Help.Click
Try
        Dim strFile4 As String = "Addnew"
        Dim strCmd4 As String
        strCmd4 = String.Format("erlclk=window.open('SYS_PAGE_HELP_OVERVIEW_CUSTOM.aspx?page_id=SALES_ORDER&Retrive_id=" & Retrive.ClientID & " ','_blank');erlclk.focus();", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN65", strCmd4, True)
Catch ex As Exception
call insert_sys_log("Edit Page Help",ex.Message)
End Try
    End Sub
Protected Sub Data_Dictionary_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Data_Dictionary.Click
Try
        Dim strFile4 As String = "DD"
        Dim strCmd4 As String
        strCmd4 = String.Format("erlclk=window.open('PAGE_TABLE_LIST.aspx?page_id=SALES_ORDER&Retrive_id=" & Retrive.ClientID & " ','_blank');erlclk.focus();", strFile4)
        ScriptManager.RegisterStartupScript(Me, Me.GetType(), "GEN66", strCmd4, True)
Catch ex As Exception
call insert_sys_log("Edit Page Help",ex.Message)
End Try
    End Sub
Protected Sub Add_favorates_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Add_favorates.Click
Try
  dbad.SelectCommand.Connection = Session("db_connection")
Dim dsfav as New Data.Dataset
dbad.SelectCommand.CommandText = "Select PAGE_ID, USER_ID from SYS_FAVORITES where upper(PAGE_ID)=upper('SALES_ORDER') and upper(USER_ID)=upper('" & Session("User_id")& "')"
dsfav.Clear()
 dbad.Fill(dsfav)
If Not(dsfav.Tables(0).Rows.Count>0) Then
Dim mid123, ssid123 As String
mid123 = Request.QueryString.Get("mid")
ssid123 = Request.QueryString.Get("sssid")
dbad.InsertCommand.Connection = Session("db_connection")
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
dbad.InsertCommand.CommandText = "Insert Into SYS_FAVORITES(PAGE_ID, MENU_ID, SSS_ID, USER_ID, ACTIVE_FLAG,CREATED_BY, CREATED_DATE) values('SALES_ORDER','" & mid123 & "','" & ssid123 & "','" & Session("User_id") & "','Y','" & Session("User_id") & "',SYSDATE)"
dbad.InsertCommand.ExecuteNonQuery()
dbad.InsertCommand.Connection.Close()
End If
        dbad.SelectCommand.Connection.Close()
Catch ex As Exception
        dbad.SelectCommand.Connection.Close()
        dbad.InsertCommand.Connection.Close()
call insert_sys_log("Add Favorites",ex.Message)
End Try
    End Sub
Public Sub insert_sys_log(ByVal str1 As String, ByVal message As String)
err_message.Text = ""
exception_message.Text =  str1 & "---" & message 
err_message.Visible = False
exception_message.Visible = True
mpanel.Visible = True
        Dim sterr1, sterr2, sterr3, sterr4, sterr As String
        sterr = Replace(message, "'", "''")
        If (Len(sterr) > 4000) Then
            sterr1 = Mid(sterr, 1, 4000)
            If (Len(sterr) > 8000) Then
                sterr2 = Mid(sterr, 4000, 8000)
                If (Len(sterr) > 12000) Then
                    sterr3 = Mid(sterr, 8000, 12000)
                    If (Len(sterr) > 16000) Then
                        sterr4 = Mid(sterr, 12000, 16000)
                    Else
                        sterr4 = Mid(sterr, 12000, Len(sterr))
                    End If
                Else
                    sterr3 = Mid(sterr, 8000, Len(sterr))
                    sterr4 = ""
                End If
            Else
                sterr2 = Mid(sterr, 4000, Len(sterr))
                sterr3 = ""
                sterr3 = ""
                sterr4 = ""
            End If
        Else
            sterr1 = sterr
            sterr2 = ""
            sterr3 = ""
            sterr4 = ""
        End If
Try
        dbad.InsertCommand.Connection = Session("db_connection")
	                If (dbad.InsertCommand.Connection.State = Data.ConnectionState.Closed) Then
        	            	dbad.InsertCommand.Connection.Open()
                	End If
        dbad.InsertCommand.CommandText = "Insert into SYS_ACTIVATE_STATUS_LOG (LINE_NO, CHANGE_REQUEST_NO,  OBJECT_TYPE, OBJECT_NAME, ERROR_TEXT, STATUS,LOG_DATE,ERROR_TEXT1, ERROR_TEXT2, ERROR_TEXT3) values ((select nvl(max(to_number(line_no)),0)+1 from SYS_ACTIVATE_STATUS_LOG),'','SALES_ORDER','" & str1 & "','" & sterr1 & "','N',sysdate,'" & sterr2 & "','" & sterr3 & "','" & sterr4 & "')"
        dbad.InsertCommand.ExecuteNonQuery()
        dbad.InsertCommand.Connection.Close()
Catch ex As Exception
    Response.Redirect("login.aspx")
End Try
    End Sub
 Public Sub set_navigation_seq()
        Try
 Dim dnavi123 As New Data.DataSet
dbad.SelectCommand.Connection = Session("db_connection")
 If (Session("SD_ORDERS_SEARCH") <> "") Then
                dbad.SelectCommand.CommandText = "SELECT ORDER_NO " & Session("SD_ORDERS_SEARCH")
 dnavi123.Clear()
dbad.Fill(dnavi123)
If (dnavi123.Tables(0).Rows.Count > 0) Then
Dim dnavi1 As Integer
  For dnavi1 = 0 To dnavi123.Tables(0).Rows.Count - 1
If (dnavi123.Tables(0).Rows(dnavi1)("ORDER_NO") = SD_ORDER_HEADER_ORDER_NO.Text) Then
 Session("SALES_ORDER_move_record") = dnavi1
Exit For
            End If
 Next
            End If
Else 
Dim dwhere As String
dwhere = return_default_where()
      If (dwhere <> "") Then
                dbad.SelectCommand.CommandText = "SELECT ORDER_NO FROM  SD_ORDER_HEADER where " & dwhere 
      Else
                dbad.SelectCommand.CommandText = "SELECT ORDER_NO FROM  SD_ORDER_HEADER ORDER BY ORDER_NO"
      End If
 dnavi123.Clear()
dbad.Fill(dnavi123)
If (dnavi123.Tables(0).Rows.Count > 0) Then
Dim dnavi1 As Integer
  For dnavi1 = 0 To dnavi123.Tables(0).Rows.Count - 1
If (dnavi123.Tables(0).Rows(dnavi1)("ORDER_NO") = SD_ORDER_HEADER_ORDER_NO.Text) Then
 Session("SALES_ORDER_move_record") = dnavi1
Exit For
            End If
 Next
            End If
            End If
        Catch ex As Exception
            Call insert_sys_log("Set Navigation", ex.Message)
        End Try
 End Sub
Public Function return_default_where() As String
        Try
            Dim defaultWhereClause As String
            defaultWhereClause = ""
            dbad.SelectCommand.Connection = Session("db_connection")
            Dim dnavi As New Data.DataSet
            dbad.SelectCommand.CommandText = "SELECT DEFAULT_WHERE_CLAUSE FROM SYS_SEARCH_MASTER WHERE UPPER(SEARCH_ID) = UPPER('SD_ORDERS_SEARCH') AND DEFAULT_WHERE_CLAUSE IS NOT NULL"
            dnavi.Clear()
            dbad.Fill(dnavi)
            If (dnavi.Tables(0).Rows.Count > 0) Then
                defaultWhereClause = trim(dnavi.Tables(0).Rows(0)(0))
                If defaultWhereClause <> "" Then
                    defaultWhereClause = Replace(defaultWhereClause.ToString, "#linked_customer_no#", Session("linkedCustomerNo").ToString())
                    defaultWhereClause = Replace(defaultWhereClause.ToString, "#linked_vendor_no#", Session("linkedVendorNo").ToString())
                    defaultWhereClause = Replace(defaultWhereClause.ToString, "#linked_employee_id#", Session("linkedEmployeeId").ToString())
                    defaultWhereClause = Replace(defaultWhereClause.ToString, "#linked_salesrep_no#", Session("linkedsalesrepno").ToString())
                    defaultWhereClause = Replace(defaultWhereClause.ToString, "#user_id#", Session("user_id").ToString())
                End If
            End If
            dbad.SelectCommand.Connection.close()
            Return defaultWhereClause
        Catch ex As Exception
            Call insert_sys_log("Deafult where", ex.Message)
            Return ""
            dbad.SelectCommand.Connection.close()
        End Try
    End Function
Protected Sub MOVE_FIRST_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles MOVE_FIRST.Click
 Session("SALES_ORDER_move_record") = 0
        Try
            Dim dnavi As New Data.DataSet
            dbad.SelectCommand.Connection = Session("db_connection")
            If (Session("SD_ORDERS_SEARCH") = "") Then
Dim dwhere As String
dwhere = return_default_where()
      If (dwhere <> "") Then
                dbad.SelectCommand.CommandText = "SELECT MIN(ORDER_NO)  FROM  SD_ORDER_HEADER where " & dwhere 
      Else
                dbad.SelectCommand.CommandText = "SELECT MIN(ORDER_NO)  FROM  SD_ORDER_HEADER"
      End If
            Else
                dbad.SelectCommand.CommandText = "SELECT MIN(ORDER_NO)  " & Session("SD_ORDERS_SEARCH")
            End If
            dnavi.Clear()
            dbad.Fill(dnavi)
            If (dnavi.Tables(0).Rows.Count > 0) Then
If Not (Equals(dnavi.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_ORDER_NO.Text=dnavi.Tables(0).Rows(0)(0)
                Call fill_header_info()
            End If
            End If
            dbad.SelectCommand.Connection.Close()
        Catch ex As Exception
            Call insert_sys_log("MOVE FIRST", ex.Message)
        End Try
    End Sub
Protected Sub MOVE_FWD_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles MOVE_FWD.Click
        Try
 if (SD_ORDER_HEADER_ORDER_NO.Text="") then
Call MOVE_LAST_Click(sender,e)
Exit Sub
End If
            Dim dnavi As New Data.DataSet
            dbad.SelectCommand.Connection = Session("db_connection")
            If (Session("SD_ORDERS_SEARCH") = "") Then
Dim dwhere As String
dwhere = return_default_where()
      If (dwhere <> "") Then
                dbad.SelectCommand.CommandText = "SELECT MIN(ORDER_NO)  FROM  SD_ORDER_HEADER where " & dwhere  & " and ORDER_NO > '" & SD_ORDER_HEADER_ORDER_NO.Text & "'"
      Else
                dbad.SelectCommand.CommandText = "SELECT MIN(ORDER_NO)  FROM  SD_ORDER_HEADER where   ORDER_NO > '" & SD_ORDER_HEADER_ORDER_NO.Text & "'"
      End If
            Else
Dim xstr As String
xstr = Session("SD_ORDERS_SEARCH")
If (InStr(UCase(xstr), "WHERE") > 0) Then
 xstr = Replace(xstr, "WHERE", " WHERE   ORDER_NO > '" & SD_ORDER_HEADER_ORDER_NO.Text & "' AND ")
Else
    If (InStr(UCase(xstr), "ORDER BY") > 0) Then
        xstr = Replace(xstr, "ORDER BY"," WHERE   ORDER_NO > '" & SD_ORDER_HEADER_ORDER_NO.Text & "' ORDER BY " )
    Else
        xstr = xstr  & "   where   ORDER_NO > '" & SD_ORDER_HEADER_ORDER_NO.Text & "'"
    End If
End If
dbad.SelectCommand.CommandText = "SELECT MIN(ORDER_NO) " &   xstr 
            End If
            dnavi.Clear()
            dbad.Fill(dnavi)
            If (dnavi.Tables(0).Rows.Count > 0) Then
If Not (Equals(dnavi.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_ORDER_NO.Text=dnavi.Tables(0).Rows(0)(0)
    Call fill_header_info()
            End If
            End If
            dbad.SelectCommand.Connection.Close()
        Catch ex As Exception
            Call insert_sys_log("MOVE FWD", ex.Message)
        End Try
    End Sub
Protected Sub MOVE_PRE_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles MOVE_PRE.Click
        Try
 if (SD_ORDER_HEADER_ORDER_NO.Text="") then
Call MOVE_FIRST_Click(sender,e)
Exit Sub
End If
            Dim dnavi As New Data.DataSet
            dbad.SelectCommand.Connection = Session("db_connection")
            If (Session("SD_ORDERS_SEARCH") = "") Then
Dim dwhere As String
dwhere = return_default_where()
      If (dwhere <> "") Then
                dbad.SelectCommand.CommandText = "SELECT MAX(ORDER_NO)  FROM  SD_ORDER_HEADER where " & dwhere  & " and ORDER_NO < '" & SD_ORDER_HEADER_ORDER_NO.Text & "'"
      Else
                dbad.SelectCommand.CommandText = "SELECT MAX(ORDER_NO)  FROM  SD_ORDER_HEADER where   ORDER_NO < '" & SD_ORDER_HEADER_ORDER_NO.Text & "'"
      End If
            Else
Dim xstr As String
xstr = Session("SD_ORDERS_SEARCH")
If (InStr(UCase(xstr), "WHERE") > 0) Then
 xstr = Replace(xstr, "WHERE", " WHERE   ORDER_NO < '" & SD_ORDER_HEADER_ORDER_NO.Text & "' AND ")
Else
    If (InStr(UCase(xstr), "ORDER BY") > 0) Then
        xstr = Replace(xstr, "ORDER BY"," WHERE   ORDER_NO < '" & SD_ORDER_HEADER_ORDER_NO.Text & "' ORDER BY " )
    Else
        xstr = xstr  & "   where   ORDER_NO < '" & SD_ORDER_HEADER_ORDER_NO.Text & "'"
    End If
End If
dbad.SelectCommand.CommandText = "SELECT MAX(ORDER_NO) " &   xstr 
            End If
            dnavi.Clear()
            dbad.Fill(dnavi)
            If (dnavi.Tables(0).Rows.Count > 0) Then
If Not (Equals(dnavi.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_ORDER_NO.Text=dnavi.Tables(0).Rows(0)(0)
    Call fill_header_info()
            End If
            End If
            dbad.SelectCommand.Connection.Close()
        Catch ex As Exception
            Call insert_sys_log("MOVE PRE", ex.Message)
        End Try
    End Sub
 Public Sub resetset_navigation_seq()
        Try
            Dim dnavi As New Data.DataSet
            dbad.SelectCommand.Connection = Session("db_connection")
                dbad.SelectCommand.CommandText = "SELECT ORDER_NO FROM  SD_ORDER_HEADER ORDER BY ORDER_NO"
            dnavi.Clear()
            dbad.Fill(dnavi)
            If (dnavi.Tables(0).Rows.Count > 0) Then
    Session("SALES_ORDER_move_record") = dnavi.Tables(0).Rows.Count
            End If
            dbad.SelectCommand.Connection.Close()
        Catch ex As Exception
            Call insert_sys_log("RESET SEQ", ex.Message)
        End Try
    End Sub
Protected Sub MOVE_LAST_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles MOVE_LAST.Click
        Try
            Dim dnavi As New Data.DataSet
            dbad.SelectCommand.Connection = Session("db_connection")
            If (Session("SD_ORDERS_SEARCH") = "") Then
Dim dwhere As String
dwhere = return_default_where()
      If (dwhere <> "") Then
                dbad.SelectCommand.CommandText = "SELECT MAX(ORDER_NO)  FROM  SD_ORDER_HEADER where " & dwhere 
      Else
                dbad.SelectCommand.CommandText = "SELECT MAX(ORDER_NO)  FROM  SD_ORDER_HEADER"
      End If
            Else
                dbad.SelectCommand.CommandText = "SELECT MAX(ORDER_NO)  " & Session("SD_ORDERS_SEARCH")
            End If
            dnavi.Clear()
            dbad.Fill(dnavi)
            If (dnavi.Tables(0).Rows.Count > 0) Then
    Session("SALES_ORDER_move_record") = dnavi.Tables(0).Rows.Count - 1
If Not (Equals(dnavi.Tables(0).Rows(0)(0), System.DBNull.Value)) Then
SD_ORDER_HEADER_ORDER_NO.Text=dnavi.Tables(0).Rows(0)(0)
    Call fill_header_info()
            End If
            End If
            dbad.SelectCommand.Connection.Close()
        Catch ex As Exception
            Call insert_sys_log("MOVE LAST", ex.Message)
        End Try
    End Sub
  Protected Sub Page_PreRender(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.PreRender
EVENT_SHIP_COMPLETE.Visible=False
    End Sub
End Class
